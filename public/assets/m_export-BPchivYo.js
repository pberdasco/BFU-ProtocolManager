import{o as y,m,al as Ge,bi as Ue,i as C,z as Ke,E as S,bq as E,an as V,ab as N,h as Q,O as b,a6 as k,de as qe,aA as D,b5 as L,aq as O,x as W,aa as de,b8 as ee,aJ as je,H as te,aS as Xe,df as Ye,D as A,ap as Je,bX as Ze,aG as Qe,c as M,d as x,V as Me,at as ce,bL as et,aU as ue,c_ as tt,ca as nt,aB as T,K as it,dg as st,dh as ot,n as ne,di as rt,y as P,a9 as Oe,dj as at,dk as lt,au as K,cr as dt,f as q,dl as ct,u as F,bf as he,dm as ut,a$ as ht,g as H,cd as ie,c6 as pt,b0 as mt,a5 as j,bs as gt,c8 as _t,G as ft,q as Ct,ah as St,bn as yt,dn as It,bU as bt,a_ as vt,aW as xt,cW as wt}from"./index-BkPAYC4t.js";const fn=i=>class extends i{_applyColumnState(e){var t;const n=this.option("rtlEnabled"),s=this._getColumnAlignment(e.column.alignment,n),o=y(!0,{columnAlignment:s},e),a=o.rootElement.hasClass("dx-group-panel-item"),r=this._createIndicatorContainer(o,a),c=m("<span>").addClass(this._getIndicatorClassName(e.name)),l=(t=this.component)===null||t===void 0?void 0:t.getController("columns"),u=(l==null?void 0:l.getHeaderContentAlignment(s))||s;return o.container=r,o.indicator=c,this._renderIndicator(o),r[(a||!e.showColumnLines)&&u==="left"?"appendTo":"prependTo"](e.rootElement),c}_getIndicatorClassName(e){}_getColumnAlignment(e,t){return t=t||this.option("rtlEnabled"),e&&e!=="center"?e:Ge(t)}_createIndicatorContainer(e,t){let n=this._getIndicatorContainer(e.rootElement);const s=e.columnAlignment==="left"?"right":"left";return n.length||(n=m("<div>").addClass("dx-column-indicators")),this.setAria("role","presentation",n),n.css("float",e.showColumnLines&&!t?s:null)}_getIndicatorContainer(e){return e&&e.find(".dx-column-indicators")}_getIndicatorElements(e){const t=this._getIndicatorContainer(e);return t&&t.children()}_renderIndicator(e){const t=e.container,n=e.indicator;t&&n&&t.append(n)}_updateIndicators(e){const t=this,n=t.getColumns(),s=t.getColumnElements();let o;if(!(!s||n.length!==s.length))for(let a=0;a<n.length;a++){o=s.eq(a),t._updateIndicator(o,n[a],e);const r=o.parent().data("options");r&&r.cells&&(r.cells[o.index()].column=n[a])}}_updateIndicator(e,t,n){if(!t.command)return this._applyColumnState({name:n,rootElement:e,column:t,showColumnLines:this.option("showColumnLines")})}},Et=["rowsView"],w={borderedTop:"dx-bordered-top-view",borderedBottom:"dx-bordered-bottom-view"},At=i=>{let{columnHeadersView:e,rowsView:t}=i;return e!=null&&e.isVisible()?e.element():t.element()},Mt=i=>{let{filterPanelView:e,footerView:t,rowsView:n}=i;return e!=null&&e.isVisible()?e.element():t!=null&&t.isVisible()?t.element():n.element()},pe=(i,e)=>{const t=Object.values(i).find(n=>{var s;return n==null||(s=n.element())===null||s===void 0?void 0:s.hasClass(e)});return(t==null?void 0:t.element())??null},Ot=(i,e)=>{var t;if(!Object.keys(e).includes(i))return!1;const{rowsView:n}=e,s=Ue(e,Et);return C(n==null||(t=n.element)===null||t===void 0?void 0:t.call(n))?Object.values(s).filter(o=>{var a;return o==null||(a=o.isVisible)===null||a===void 0?void 0:a.call(o)}).every(o=>C(o==null?void 0:o.element())):!1},Tt=(i,e)=>{if(!Ot(i,e))return;const t=pe(e,w.borderedTop),n=pe(e,w.borderedBottom),s=At(e),o=Mt(e);t&&!t.is(s)&&t.removeClass(w.borderedTop),n&&!n.is(o)&&n.removeClass(w.borderedBottom),s.hasClass(w.borderedTop)||s.addClass(w.borderedTop),o.hasClass(w.borderedBottom)||o.addClass(w.borderedBottom)};class Te{constructor(e){const t=this;t._updateLockCount=0,t.component=e,t._actions={},t._actionConfigs={},S(this.callbackNames()||[],function(n,s){const o=t.callbackFlags(s)||{};o.unique=!0,o.syncStrategy=!0,t[this]=N(o)})}_endUpdateCore(){}init(){}callbackNames(){}callbackFlags(e){}publicMethods(){return[]}beginUpdate(){this._updateLockCount++}endUpdate(){this._updateLockCount>0&&(this._updateLockCount--,this._updateLockCount||this._endUpdateCore())}option(e){const{component:t}=this,n=t._optionCache;return arguments.length===1&&n?(e in n||(n[e]=t.option(e)),n[e]):t.option.apply(t,arguments)}_silentOption(e,t){const{component:n}=this,s=n._optionCache;return s&&(s[e]=t),n._setOptionWithoutOptionChange(e,t)}localize(e){const t=this.component._optionCache;return t?(e in t||(t[e]=k.format(e)),t[e]):k.format(e)}on(e,t){return this.component.on.apply(this.component,arguments)}off(){return this.component.off.apply(this.component,arguments)}optionChanged(e){e.name in this._actions&&(this.createAction(e.name,this._actionConfigs[e.name]),e.handled=!0)}getAction(e){return this._actions[e]}setAria(e,t,n){const s=n.get(0),o=e!=="role"&&e!=="id"?"aria-":"";s.setAttribute?s.setAttribute(o+e,t):n.attr(o+e,t)}_createComponent(e,t,n){return this.component._createComponent(e,t,n)}getController(e){return this.component._controllers[e]}createAction(e,t){if(b(e)){const n=this.component._createAction(e.bind(this),t);return function(s){n({event:s})}}this._actions[e]=this.component._createActionByOption(e,t),this._actionConfigs[e]=t}executeAction(e,t){const n=this._actions[e];return n&&n(t)}dispose(){const e=this;S(e.callbackNames()||[],function(){e[this].empty()})}addWidgetPrefix(e){return`dx-${this.component.NAME.slice(2).toLowerCase()}${e?`-${e}`:""}`}getWidgetContainerClass(){const e=this.component.NAME==="dxDataGrid"?null:"container";return this.addWidgetPrefix(e)}elementIsInsideGrid(e){return e.closest(`.${this.getWidgetContainerClass()}`).parent().is(this.component.$element())}}class ae extends Te{}class Dt extends ae{getView(e){return this.component._views[e]}getViews(){return this.component._views}}class De extends Te{constructor(e){super(e),this.renderCompleted=N(),this.resizeCompleted=N()}_isReady(){return this.component.isReady()}_endUpdateCore(){super._endUpdateCore(),!this._isReady()&&this._requireReady&&(this._requireRender=!1,this.component._requireResize=!1),this._requireRender&&(this._requireRender=!1,this.render(this._$parent))}_invalidate(e,t){this._requireRender=!0,this.component._requireResize=Q()&&(this.component._requireResize||e),this._requireReady=this._requireReady||t}_renderCore(e){}_resizeCore(){}_parentElement(){return this._$parent}element(){return this._$element}getElementHeight(){const e=this.element();if(!e)return 0;const t=parseFloat(e.css("marginTop"))||0,n=parseFloat(e.css("marginBottom"))||0,{offsetHeight:s}=e.get(0);return s+t+n}isVisible(){return!0}getTemplate(e){return this.component._getTemplate(e)}getView(e){return this.component._views[e]}_getBorderedViews(){return{columnHeadersView:this.component._views.columnHeadersView,rowsView:this.component._views.rowsView,filterPanelView:this.component._views.filterPanelView,footerView:this.component._views.footerView}}render(e,t){let n=this._$element;const s=this.isVisible();if(!(!n&&!e)&&(this._requireReady=!1,n||(n=this._$element=m("<div>").appendTo(e),this._$parent=e),n.toggleClass("dx-hidden",!s),this.component._views&&Tt(this.name,this._getBorderedViews()),s)){this.component._optionCache={};const o=this._renderCore(t);this.component._optionCache=void 0,o?o.done(()=>{this.renderCompleted.fire(t)}):this.renderCompleted.fire(t)}}resize(){this.isResizing=!0,this._resizeCore(),this.resizeCompleted.fire(),this.isResizing=!1}focus(e){this.element().get(0).focus({preventScroll:e})}}function me(i){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const t={};return Object.entries(e).forEach(n=>{let[s,o]=n;const a=i[s];if(a)if(b(o))t[s]=o(a);else{const r=a;t[s]=r.inherit(o)}}),t}function kt(i,e,t){const n=t.publicMethods();n&&S(n,(s,o)=>{if(t[o])if(!i[o])i[o]=function(){return t[o](...arguments)};else throw E.Error("E1005",o);else throw E.Error("E1006",e,o)})}function Lt(i,e){const{modules:t}=e,{modulesOrder:n}=e;function s(u){const d={};return S(u,(h,p)=>{const g=new p(i);g.name=h,kt(i,h,g),d[h]=g}),d}n&&t.sort((u,d)=>{let h=n.indexOf(u.name),p=n.indexOf(d.name);return h<0&&(h=1e6),p<0&&(p=1e6),h-p});const o={},a={};t.forEach(u=>{let{name:d,controllers:h={},views:p={}}=u;Object.entries(h).forEach(g=>{let[f,_]=g;if(o[f])throw E.Error("E1001",d,f);if(!((_==null?void 0:_.prototype)instanceof ae))throw E.Error("E1002",d,f);o[f]=_}),Object.entries(p).forEach(g=>{let[f,_]=g;if(a[f])throw E.Error("E1003",d,f);if(!((_==null?void 0:_.prototype)instanceof De))throw E.Error("E1004",d,f);a[f]=_})});const r=t.filter(u=>{let{extenders:d}=u;return!!d}),c=r.reduce((u,d)=>{let{extenders:h}=d;return V({},u,me(u,h==null?void 0:h.controllers))},o),l=r.reduce((u,d)=>{let{extenders:h}=d;return V({},u,me(u,h==null?void 0:h.views))},a);i._controllers=s(c),i._views=s(l)}const Ft=function(i,e,t){t=t||[],i._controllers&&S(i._controllers,function(){this[e]&&this[e].apply(this,t)}),i._views&&S(i._views,function(){this[e]&&this[e].apply(this,t)})},ke={modules:[],View:De,ViewController:Dt,Controller:ae,registerModule(i,e){const{modules:t}=this;for(let n=0;n<t.length;n++)if(t[n].name===i)return;e.name=i,t.push(e)},registerModulesOrder(i){this.modulesOrder=i},unregisterModule(i){this.modules=Ke(this.modules,e=>e.name!==i)},processModules:Lt,callModuleItemsMethod:Ft},Vt=qe({format:function(i,e){const t=D(e)&&e!==""||W(e)||b(e),n=de(i)||ee(i);if(!t||!n)return C(i)?i.toString():"";if(b(e))return e(i);if(D(e)&&(e={type:e}),de(i))return je.format(i,e);if(ee(i))return O.format(i,e)},getTimeFormat:function(i){return i?"longtime":"shorttime"},_normalizeFormat:function(i){return Array.isArray(i)?i.length===1?i[0]:function(e){return i.map(function(t){return O.format(e,t)}).join(" ")}:i},getDateFormatByDifferences:function(i,e){const t=[],n=e&&i.millisecond&&!(i.year||i.month||i.day);if(n){const s=function(o){return o.getSeconds()+o.getMilliseconds()/1e3+"s"};t.push(s)}else i.millisecond&&t.push("millisecond");if((i.hour||i.minute||!n&&i.second)&&t.unshift(this.getTimeFormat(i.second)),i.year&&i.month&&i.day)return e&&e==="month"?"monthandyear":(t.unshift("shortdate"),this._normalizeFormat(t));if(i.year&&i.month)return"monthandyear";if(i.year&&i.quarter)return"quarterandyear";if(i.year)return"year";if(i.quarter)return"quarter";if(i.month&&i.day){if(e){const s=function(o){return O.getMonthNames("abbreviated")[o.getMonth()]+" "+O.format(o,"day")};t.unshift(s)}else t.unshift("monthandday");return this._normalizeFormat(t)}if(i.month)return"month";if(i.day){if(e)t.unshift("day");else{const s=function(o){return O.format(o,"dayofweek")+", "+O.format(o,"day")};t.unshift(s)}return this._normalizeFormat(t)}return this._normalizeFormat(t)},getDateFormatByTicks:function(i){let e,t,n;if(i.length>1)for(e=L.getDatesDifferences(i[0],i[1]),n=1;n<i.length-1;n++)t=L.getDatesDifferences(i[n],i[n+1]),e.count<t.count&&(e=t);else e={year:!0,month:!0,day:!0,hour:i[0].getHours()>0,minute:i[0].getMinutes()>0,second:i[0].getSeconds()>0,millisecond:i[0].getMilliseconds()>0};return this.getDateFormatByDifferences(e)},getDateFormatByTickInterval:function(i,e,t){let n;const s=function(r,c,l){switch(c){case"year":case"quarter":r.month=l;case"month":r.day=l;case"week":case"day":r.hour=l;case"hour":r.minute=l;case"minute":r.second=l;case"second":r.millisecond=l}};t=D(t)?t.toLowerCase():t;const o=L.getDatesDifferences(i,e);return i!==e&&function(r,c,l){!l.getMilliseconds()&&l.getSeconds()?l.getSeconds()-c.getSeconds()===1&&(r.millisecond=!0,r.second=!1):!l.getSeconds()&&l.getMinutes()?l.getMinutes()-c.getMinutes()===1&&(r.second=!0,r.minute=!1):!l.getMinutes()&&l.getHours()?l.getHours()-c.getHours()===1&&(r.minute=!0,r.hour=!1):!l.getHours()&&l.getDate()>1?l.getDate()-c.getDate()===1&&(r.hour=!0,r.day=!1):l.getDate()===1&&l.getMonth()?l.getMonth()-c.getMonth()===1&&(r.day=!0,r.month=!1):!l.getMonth()&&l.getFullYear()&&l.getFullYear()-c.getFullYear()===1&&(r.month=!0,r.year=!1)}(o,i>e?e:i,i>e?i:e),n=L.getDateUnitInterval(o),s(o,n,!0),n=L.getDateUnitInterval(t||"second"),s(o,n,!1),o[{week:"day"}[n]||n]=!0,this.getDateFormatByDifferences(o)}}),Pt=["year","month","day"],Ht=["year","month","day","hour","minute"],se=function(i){return i==="date"||i==="datetime"},X=function(i){let e,t=[];const n=["year","month","day","hour","minute","second"],s=i.headerFilter&&i.headerFilter.groupInterval,o=s==="quarter"?"month":s;if(se(i.dataType)&&s!==null)return t=i.dataType==="datetime"?Ht:Pt,e=n.indexOf(o),e>=0&&(t=n.slice(0,e),t.push(s)),t;if(C(s))return Array.isArray(s)?s:[s]},zt=function(){const i=function(s,o){let a=s.dataField||s.selector;return o==="search"&&(a=s.displayField||s.calculateDisplayValue||a),a},e=function(s,o){const a=this;let r,c,l;const u=i(a,o);if(Array.isArray(s)&&C(s[0])&&C(s[1]))return c=[u,">=",s[0]],l=[u,"<=",s[1]],se(a.dataType)&&(d=s[1],d.getHours()+d.getMinutes()+d.getSeconds()+d.getMilliseconds()<1)&&(r=new Date(s[1].getTime()),a.dataType==="date"&&r.setDate(s[1].getDate()+1),l=[u,"<",r]),[c,"and",l];var d},t=function(s,o,a){const r=this;let c,l,u;const d=function(p){return ee(p)?[p.getFullYear(),p.getMonth(),p.getDate(),p.getHours(),p.getMinutes(),p.getSeconds()]:te((""+p).split("/"),function(g,f){return f===1?Number(g)-1:Number(g)})}(s),h=i(r,a);switch(a==="headerFilter"?u=X(r)[d.length-1]:r.dataType==="datetime"&&(u="minute"),u){case"year":c=new Date(d[0],0,1),l=new Date(d[0]+1,0,1);break;case"month":c=new Date(d[0],d[1],1),l=new Date(d[0],d[1]+1,1);break;case"quarter":c=new Date(d[0],3*d[1],1),l=new Date(d[0],3*d[1]+3,1);break;case"hour":c=new Date(d[0],d[1],d[2],d[3]),l=new Date(d[0],d[1],d[2],d[3]+1);break;case"minute":c=new Date(d[0],d[1],d[2],d[3],d[4]),l=new Date(d[0],d[1],d[2],d[3],d[4]+1);break;case"second":c=new Date(d[0],d[1],d[2],d[3],d[4],d[5]),l=new Date(d[0],d[1],d[2],d[3],d[4],d[5]+1);break;default:c=new Date(d[0],d[1],d[2]),l=new Date(d[0],d[1],d[2]+1)}switch(o){case"<":return[h,"<",c];case"<=":return[h,"<",l];case">":return[h,">=",l];case">=":return[h,">=",c];case"<>":return[[h,"<",c],"or",[h,">=",l]];default:return[[h,">=",c],"and",[h,"<",l]]}},n=function(s,o,a){const r=i(this,a),c=X(this);if(a==="headerFilter"&&c&&C(s)){const l=(""+s).split("/"),u=Number(l[l.length-1]),d=c[l.length-1],h=[r,">=",u],p=[r,"<",u+d];return[h,"and",p]}return[r,o||"=",s]};return{defaultCalculateFilterExpression:function(s,o,a){const r=this,c=i(r,a),l=r.calculateDisplayValue&&a==="search",u=l&&r.lookup&&r.lookup.dataType||r.dataType;let d=null;if((a==="headerFilter"||a==="filterBuilder")&&s===null)d=[c,o||"=",null],u==="string"&&(d=[d,o==="="?"or":"and",[c,o||"=",""]]);else if(u==="string"&&(!r.lookup||l))d=[c,o||"contains",s];else{if(o==="between")return e.apply(r,[s,a]);if(se(u)&&C(s))return t.apply(r,arguments);if(u==="number")return n.apply(r,arguments);d=[c,o||"=",s]}return d},getGroupInterval:X}}(),Bt="scrolling.legacyMode",Rt="scrolling.rowRenderingMode",Nt={year:i=>i&&i.getFullYear(),month:i=>i&&i.getMonth()+1,day:i=>i&&i.getDate(),quarter:i=>i&&Math.floor(i.getMonth()/3)+1,hour:i=>i&&i.getHours(),minute:i=>i&&i.getMinutes(),second:i=>i&&i.getSeconds()},$t=function(){const i=arguments[1],e=this.calculateCellValue(i);if(!C(e))return null;if(Le(this.dataType)){const t=arguments[0];return Nt[t](e)}if(this.dataType==="number"){const t=arguments[0];return Math.floor(Number(e)/t)*t}},Wt=function(i,e){return b(i)&&b(e)&&i.originalCallback&&e.originalCallback?i.originalCallback===e.originalCallback&&i.columnIndex===e.columnIndex:i===e};function Le(i){return i==="date"||i==="datetime"}const ge=function(i){i.get(0).textContent=" "},Y=function(i){i=i||[];const e=nt(i);for(let t=0;t<i.length;t++)i&&i[t]&&i[t].isExpanded!==void 0&&(e[t].isExpanded=i[t].isExpanded),i&&i[t]&&i[t].groupInterval!==void 0&&(e[t].groupInterval=i[t].groupInterval);return e},Fe=function(i,e){const t=Vt.format(i,e.format)||i&&i.toString()||"",n={value:i,valueText:e.getDisplayFormat?e.getDisplayFormat(t):t,target:e.target||"row",groupInterval:e.groupInterval};return e.customizeText?e.customizeText.call(e,n):n.valueText},_e=function(i,e){const t=i.displayFormat||i.columnCaption&&e[`${i.summaryType}OtherColumn`]||e[i.summaryType];return Fe(i.value,{format:i.valueFormat,getDisplayFormat:n=>t?it(t,n,i.columnCaption):n,customizeText:i.customizeText})},fe=function(i){const e=i.data&&i.data(),t=e&&e.dxComponents,n=t&&t[0];return n&&e[n]},Ve=function(i,e){if(Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;for(let t=0;t<i.length;t++)if(!Ve(i[t],e[t]))return!1;return!0}return b(i)&&i.columnIndex>=0&&b(e)&&e.columnIndex>=0?i.columnIndex===e.columnIndex&&T(i.filterValue)===T(e.filterValue)&&T(i.selectedFilterOperation)===T(e.selectedFilterOperation):T(i)==T(e)},Gt=function(i){return{index:i.index,columnIndex:i.columnIndex,x:i.x,y:i.y}},Ce=function(i,e,t){let n=!1;if(t&&(n=t(e)),!n){const s=Gt(e);i.push(s)}};function Ut(i){return Array.isArray(i)||(i=[i]),i.map((e,t)=>D(e)?{selector:e,isExpanded:t<i.length-1}:e)}const oe={renderNoDataText(i){const e=this;if(i=i||this.element(),!i)return;const t=e.addWidgetPrefix("nodata");let n=i.find(`.${t}`).last();const s=this._dataController.isEmpty(),o=this._dataController.isLoading();n.length||(n=m("<span>").addClass(t)),n.parent().is(i)||n.appendTo(i),s&&!o?n.removeClass("dx-hidden").text(e._getNoDataText()):n.addClass("dx-hidden")},renderLoadPanel(i,e,t){const n=this;let s;n._loadPanel&&n._loadPanel.$element().remove(),s=n.option("loadPanel"),s&&(s.enabled==="auto"?!t:s.enabled)?(s=y({shading:!1,message:s.text,container:e},s),n._loadPanel=n._createComponent(m("<div>").appendTo(e),tt,s)):n._loadPanel=null},calculateLoadPanelPosition(i){const e=m(M());return ue(i)>ue(e)?{of:e,boundary:i,collision:"fit"}:{of:i}},getIndexByKey(i,e,t){let n=-1;if(i!==void 0&&Array.isArray(e)){t=arguments.length<=2?"key":t;for(let s=0;s<e.length;s++){const o=C(t)?e[s][t]:e[s];if(et(i,o)){n=s;break}}}return n},combineFilters(i,e){let t=[];e=e||"and";for(let s=0;s<i.length;s++){var n;if(i[s]){if(((n=i[s])===null||n===void 0?void 0:n.length)===1&&i[s][0]==="!"){if(e==="and")return["!"];if(e==="or")continue}t.length&&t.push(e),t.push(i[s])}}if(t.length===1&&(t=t[0]),t.length)return t},checkChanges(i,e){let t=0;for(let n=0;n<e.length;n++)i[e[n]]&&t++;return i.length&&i.length===t},equalFilterParameters:Ve,proxyMethod(i,e,t){i[e]||(i[e]=function(){const n=this._dataSource;return n?n[e].apply(n,arguments):t})},formatValue:Fe,getFormatOptionsByColumn:(i,e)=>({format:i.format,getDisplayFormat:i.getDisplayFormat,customizeText:i.customizeText,target:e,trueText:i.trueText,falseText:i.falseText}),getDisplayValue(i,e,t,n){return i.displayValueMap&&i.displayValueMap[e]!==void 0?i.displayValueMap[e]:i.calculateDisplayValue&&t&&n!=="group"?i.calculateDisplayValue(t):i.lookup&&!(n==="group"&&(i.calculateGroupValue||i.calculateDisplayValue))?i.lookup.calculateCellValue(e):e},getGroupRowSummaryText(i,e){let t="(";for(let n=0;n<i.length;n++){const s=i[n];t+=(n>0?", ":"")+_e(s,e)}return t+")"},getSummaryText:_e,normalizeSortingInfo:Y,getFormatByDataType(i){switch(i){case"date":return"shortDate";case"datetime":return"shortDateShortTime";default:return}},getHeaderFilterGroupParameters(i,e){let t=[];const n=i.dataField||i.name,s=zt.getGroupInterval(i);return s?(S(s,(o,a)=>{t.push(e?{selector:n,groupInterval:a,isExpanded:o<s.length-1}:$t.bind(i,a))}),t):(e?t=[{selector:n,isExpanded:!1}]:(t=function(o){let a=i.calculateCellValue(o);return(a===void 0||a==="")&&(a=null),a},i.sortingMethod&&(t=[{selector:t,compare:i.sortingMethod.bind(i)}])),t)},equalSortParameters(i,e,t){if(i=Y(i),e=Y(e),Array.isArray(i)&&Array.isArray(e)){if(i.length!==e.length)return!1;for(let n=0;n<i.length;n++)if(!Wt(i[n].selector,e[n].selector)||i[n].desc!==e[n].desc||i[n].groupInterval!==e[n].groupInterval||!t&&!!i[n].isExpanded!=!!e[n].isExpanded)return!1;return!0}return(!i||!i.length)==(!e||!e.length)},getPointsByColumns(i,e,t){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;const o=[],a=i.length;let r,c={left:0,top:0},l={width:0,height:0},u=n,d;for(let p=0;p<=a;p++){var h;p<a&&(r=i.eq(p),c=r.offset(),l=ce(r.get(0)),d=r.css("direction")==="rtl");const g=c.left+l.width,f=c.top+l.height,_={index:u,columnIndex:u,item:(h=r)===null||h===void 0?void 0:h.get(0),x:!t&&d!==(p===a)?g:c.left,y:t&&p===a?f:c.top};if(!t&&p>0){const I=i.eq(p-1).offset(),{width:G}=ce(i[p-1]),le=d?I.left:I.left+G;if(I.top<_.y&&(_.y=I.top),s&&Math.round(le)!==Math.round(_.x)){const U=V({},_,{item:i[p-1],x:le});d?(_.isRightBoundary=!0,U.isLeftBoundary=!0):(_.isLeftBoundary=!0,U.isRightBoundary=!0),Ce(o,U,e)}}Ce(o,_,e),u++}return o},getExpandCellTemplate:()=>({allowRenderToDetachedContainer:!0,render(i,e){const t=m(i);if(C(e.value)&&!(e.data&&e.data.isContinuation)&&!e.row.isNewRow){const n=e.component.getView("rowsView");t.addClass("dx-datagrid-expand").addClass("dx-selection-disabled"),m("<div>").addClass(e.value?"dx-datagrid-group-opened":"dx-datagrid-group-closed").appendTo(t),n.setAria("label",e.value?n.localize("dxDataGrid-ariaCollapse"):n.localize("dxDataGrid-ariaExpand"),t)}else ge(t)}}),setEmptyText:ge,isDateType:Le,getSelectionRange(i){try{if(i)return{selectionStart:i.selectionStart,selectionEnd:i.selectionEnd}}catch{}return{}},setSelectionRange(i,e){try{i&&i.setSelectionRange&&i.setSelectionRange(e.selectionStart,e.selectionEnd)}catch{}},focusAndSelectElement(i,e){const t=e.is(":focus");x.trigger(e,"focus");const n=i.option("editing.selectTextOnEditStart"),s=e.get(0);if(!t&&n&&e.is(".dx-texteditor-input")&&!e.is("[readonly]")){const o=fe(e.closest(".dx-texteditor"));Me(o&&o._loadItemDeferred).done(()=>{s.select()})}},getWidgetInstance:fe,getLastResizableColumnIndex(i,e){const t=i.some(s=>s&&!s.command&&!s.fixed&&s.allowResizing!==!1);let n;for(n=i.length-1;i[n];n--){const s=i[n],o=e&&e[n],a=!t||s.allowResizing!==!1;if(!s.command&&!s.fixed&&o!=="adaptiveHidden"&&a)break}return n},isElementInCurrentGrid(i,e){return e&&e.length?e.closest(`.${i.getWidgetContainerClass()}`).parent().is(i.component.$element()):!1},isVirtualRowRendering(i){const e=i.option(Rt),t=i.option("scrolling.mode")==="virtual",n=i.option("scrolling.mode")==="infinite";return i.option(Bt)===!1&&(t||n)?!0:e==="virtual"},getPixelRatio:i=>i.devicePixelRatio||1,getContentHeightLimit(i){return i.mozilla?8e6:15e6/this.getPixelRatio(M())},normalizeLookupDataSource(i){let e;return i.items?e=i.items:(e=i.dataSource,b(e)&&!Ze.isWrapped(e)&&(e=e({}))),Qe(e)},getWrappedLookupDataSource(i,e,t){if(!e)return[];const n=this.normalizeLookupDataSource(i.lookup);if(i.calculateCellValue!==i.defaultCalculateCellValue)return n;const s=e.remoteOperations().groupPaging,o=i.displayField&&D(i.displayField);let a,r,c;const l=(d,h)=>{const p=h.skip??0,g=h.take?p+h.take:d.length;return d.slice(p,g)};return V({},n,{__dataGridSourceFilter:t,load:d=>{const h=new A;return(p=>{const g=Ut(o?[i.dataField,i.displayField]:i.dataField),f=new A;return a&&(!s||p.skip===c&&p.take===r)?f.resolve(l(a,p)):(c=p.skip,r=p.take,e.load({filter:t,group:g,take:s?p.take:void 0,skip:s?p.skip:void 0}).done(I=>{a=I,f.resolve(s?I:l(I,p))}).fail(f.fail)),f})(d).done(p=>{if(p.length===0){h.resolve([]);return}const g=this.combineFilters(p.flatMap(_=>_.key).map(_=>[i.lookup.valueExpr,_]),"or");new Je(V({},n,d,{filter:this.combineFilters([g,d.filter],"and"),paginate:!1})).load().done(h.resolve).fail(h.fail)}).fail(h.fail),h},key:i.lookup.valueExpr,byKey(d){const h=A();return this.load({filter:[i.lookup.valueExpr,"=",d]}).done(p=>{h.resolve(p[0])}),h.promise()}})},logHeaderFilterDeprecatedWarningIfNeed(i){const e=i._logDeprecatedOptionWarning.bind(i);C(i.option("headerFilter.allowSearch"))&&e("headerFilter.allowSearch",{since:"23.1",alias:"headerFilter.search.enabled"}),C(i.option("headerFilter.searchTimeout"))&&e("headerFilter.searchTimeout",{since:"23.1",alias:"headerFilter.search.timeout"});const t=i.NAME==="dxPivotGrid"?"dataSource.fields":"columns",n=i.option(t);if(!Array.isArray(n))return;const s=o=>{o.forEach(a=>{var r;const c=a.headerFilter||{};C(c.allowSearch)&&e(`${t}[].headerFilter.allowSearch`,{since:"23.1",alias:`${t}[].headerFilter.search.enabled`}),C(c.searchMode)&&e(`${t}[].headerFilter.searchMode`,{since:"23.1",alias:`${t}[].headerFilter.search.mode`}),(r=a.columns)!==null&&r!==void 0&&r.length&&s(a.columns)})};s(n)},getComponentBorderWidth(i,e){return i.option("showBorders")?Math.ceil(Xe(e)-Ye(e)):0},isCustomCommandColumn(i,e){return!!i.filter(n=>n.type===e.type).length}},Cn=i=>class extends i{_applyColumnState(e){const t=this;let n,s;const o=t.option("sorting.mode"),{rootElement:a}=e,{column:r}=e,c=t._getIndicatorContainer(a);if(e.name==="sort"){a.find(".dx-sort").remove(),!c.children().length&&c.remove();const l=o!=="none"&&r.allowSorting,u=t.getController&&!!t.getController("columns").columnOption("sortIndex:1");return!C(r.groupIndex)&&(l||C(r.sortOrder))&&(n=r.sortOrder==="asc"?"ascending":"descending",s=super._applyColumnState(e).toggleClass("dx-sort-up",r.sortOrder==="asc").toggleClass("dx-sort-down",r.sortOrder==="desc"),u&&t.option("sorting.showSortIndexes")&&r.sortIndex>=0&&(m("<span>").addClass("dx-sort-index-icon").text(r.sortIndex+1).appendTo(s),s.addClass("dx-sort-index")),l&&e.rootElement.addClass(t.addWidgetPrefix("action"))),this._setAriaSortAttribute(r,n,a,u),s}return super._applyColumnState(e)}_setAriaSortAttribute(e,t,n,s){if(n.removeAttr("aria-roledescription"),e.isGrouped){let o=this.localize("dxDataGrid-ariaNotSortedColumn");C(e.sortOrder)&&(o=e.sortOrder==="asc"?this.localize("dxDataGrid-ariaSortedAscendingColumn"):this.localize("dxDataGrid-ariaSortedDescendingColumn")),this.setAria("roledescription",o,n)}else if(!C(e.sortOrder))this.setAria("sort","none",n);else if(this.setAria("sort",t,n),s&&e.sortIndex>=0){const o=k.format("dxDataGrid-ariaColumnHeader"),a=k.format("dxDataGrid-ariaSortIndex",e.sortIndex+1),r=`${o}, ${a}`;this.setAria("roledescription",r,n)}}_getIndicatorClassName(e){return e==="sort"?"dx-sort":e==="sortIndex"?"dx-sort-index-icon":super._getIndicatorClassName(e)}_renderIndicator(e){const{column:t}=e,n=e.container,s=e.indicator;if(e.name==="sort"){const o=this.option("rtlEnabled");if(C(t.sortOrder)||s&&s.addClass("dx-sort-none"),n.children().length&&(!o&&e.columnAlignment==="left"||o&&e.columnAlignment==="right")){n.prepend(s);return}}super._renderIndicator(e)}_updateIndicator(e,t,n){if(!(n==="sort"&&C(t.groupIndex)))return super._updateIndicator.apply(this,arguments)}_getIndicatorElements(e,t){const n=super._getIndicatorElements(e);return t?n:n&&n.not(".dx-sort-none")}},Kt=st;class qt extends ot{_getPlainItems(){return te(this._collectionWidget.option("items"),function e(t){return t.items?[t].concat(te(t.items,e)):t})}_stringifyItem(e){return JSON.stringify(e,(t,n)=>t==="template"?this._getTemplateString(n):n)}_getTemplateString(e){let t;return typeof e=="object"?t=m(e).text():t=e.toString(),t}}const v="dx-menu-item",jt=`${v}-content`,J=`${v}-selected`,Se=`${v}-wrapper`,Xt=`${v}-expanded`,Yt=`${v}-has-text`,Jt=`${v}-has-icon`,Zt=`${v}-has-submenu`,Pe=`${v}-popout`,Qt=`${Pe}-container`,He=`${v}-text`,en={show:50,hide:300},tn=`${He}-with-url`;class ze extends Kt{_getDefaultOptions(){return y(super._getDefaultOptions(),{items:[],cssClass:"",activeStateEnabled:!0,showSubmenuMode:{name:"onHover",delay:{show:50,hide:300}},animation:{show:{type:"fade",from:0,to:1,duration:100},hide:{type:"fade",from:1,to:0,duration:100}},selectByClick:!1,focusOnSelectedItem:!1,keyExpr:null,_itemAttributes:{role:"menuitem"},useInkRipple:!1})}_itemDataKey(){return"dxMenuItemDataKey"}_itemClass(){return v}_setAriaSelectionAttribute(e,t){}_selectedItemClass(){return J}_widgetClass(){return"dx-menu-base"}_focusTarget(){return this._itemContainer()}_clean(){this.option("focusedElement",null),super._clean()}_supportedKeys(){return y(super._supportedKeys(),{space:()=>{const e=m(this.option("focusedElement"));!e.length||!this._isSelectionEnabled()||this.selectItem(e[0])},pageUp:ne,pageDown:ne})}_isSelectionEnabled(){return this.option("selectionMode")==="single"}_init(){this._activeStateUnit=`.${v}`,super._init(),this._renderSelectedItem(),this._initActions()}_getLinkContainer(e,t,n){const{linkAttr:s,url:o}=n;return e==null||e.addClass("dx-icon-with-url"),t==null||t.addClass(tn),super._getLinkContainer(e,t,{linkAttr:s,url:o})}_addContent(e,t){const{html:n,url:s}=t;if(s){e.html(n);const o=this._getLinkContainer(this._getIconContainer(t),this._getTextContainer(t),t);e.append(o)}else super._addContent(e,t);e.append(this._getPopoutContainer(t)),this._addContentClasses(t,e.parent())}_getTextContainer(e){const{text:t}=e;if(!t)return;const n=m("<span>").addClass(He),s=W(e)?t:String(e);return n.text(s)}_getItemExtraPropNames(){return["url","linkAttr"]}_getPopoutContainer(e){const{items:t}=e;let n;if(t&&t.length){const s=m("<div>").addClass(Pe);n=m("<span>").addClass(Qt).append(s)}return n}_getDataAdapterOptions(){return{rootValue:0,multipleSelection:!1,recursiveSelection:!1,recursiveExpansion:!1,searchValue:""}}_selectByItem(e){if(!e)return;const t=this._dataAdapter.getNodeByItem(e);this._dataAdapter.toggleSelection(t.internalFields.key,!0)}_renderSelectedItem(){const e=this._dataAdapter.getSelectedNodesKeys(),t=e.length&&e[0],n=this.option("selectedItem");if(!t){this._selectByItem(n);return}const s=this._dataAdapter.getNodeByKey(t);if(s.selectable!==!1){if(!n){this.option("selectedItem",s.internalFields.item);return}n!==s.internalFields.item&&(this._dataAdapter.toggleSelection(t,!1),this._selectByItem(n))}}_initActions(){}_initMarkup(){super._initMarkup(),this.option("useInkRipple")&&this._renderInkRipple()}_renderInkRipple(){this._inkRipple=rt()}_toggleActiveState(e,t,n){if(super._toggleActiveState.apply(this,arguments),!this._inkRipple)return;const s={element:e,event:n};t?this._inkRipple.showWave(s):this._inkRipple.hideWave(s)}_getShowSubmenuMode(){let e=this.option("showSubmenuMode");return e=P(e)?e.name:e,this._isDesktopDevice()?e:"onClick"}_initSelectedItems(){}_isDesktopDevice(){return Oe.real().deviceType==="desktop"}_initEditStrategy(){const e=qt;this._editStrategy=new e(this)}_addCustomCssClass(e){e.addClass(this.option("cssClass"))}_itemWrapperSelector(){return`.${Se}`}_hoverStartHandler(e){const t=this._getItemElementByEventArgs(e);!t||this._isItemDisabled(t)||(e.stopPropagation(),this._getShowSubmenuMode()==="onHover"&&(clearTimeout(this._showSubmenusTimeout),this._showSubmenusTimeout=setTimeout(this._showSubmenu.bind(this,t),this._getSubmenuDelay("show"))))}_getAvailableItems(e){return super._getAvailableItems(e).filter(function(){return m(this).css("visibility")!=="hidden"})}_isItemDisabled(e){return this._disabledGetter(e.data(this._itemDataKey()))}_showSubmenu(e){this._addExpandedClass(e)}_addExpandedClass(e){m(e).addClass(Xt)}_getSubmenuDelay(e){const{delay:t}=this.option("showSubmenuMode");return C(t)?P(t)?t[e]:t:en[e]}_getItemElementByEventArgs(e){let t=m(e.target);if(t.hasClass(this._itemClass())||t.get(0)===e.currentTarget)return t;for(;!t.hasClass(this._itemClass());)if(t=t.parent(),t.hasClass("dx-submenu"))return null;return t}_hoverEndHandler(e){clearTimeout(this._showSubmenusTimeout)}_hasSubmenu(e){return e&&e.internalFields.childrenKeys.length}_renderContentImpl(){this._renderItems(this._dataAdapter.getRootNodes())}_renderItems(e,t){if(!e.length)return;this.hasIcons=!1;const n=this._renderContainer(this.$element(),t);let s=-1,o=-1;S(e,(a,r)=>{const c=r.visible!==!1;c&&s<0&&(s=a),s<a&&(r.beginGroup||a===o)&&(o=c?a:a+1),a===o&&s<a&&this._renderSeparator(n),this._renderItem(a,r,n)}),this.hasIcons||n.addClass("dx-menu-no-icons")}_renderContainer(e,t){const n=m("<ul>");return this.setAria("role","none",n),n.appendTo(e).addClass("dx-menu-items-container")}_createDOMElement(e){const t=m("<li>");return this.setAria("role","none",t),t.appendTo(e).addClass(Se)}_renderItem(e,t,n,s){const{items:o=[]}=this.option(),a=s??this._createDOMElement(n);o[e+1]&&o[e+1].beginGroup&&a.addClass("dx-menu-last-group-item");const r=super._renderItem(e,t.internalFields.item,a);t.internalFields.item===this.option("selectedItem")&&r.addClass(J),r.attr("tabIndex",-1),this._hasSubmenu(t)&&this.setAria("haspopup","true",r)}_renderItemFrame(e,t,n){const s=n.children(`.${v}`);return s.length?s:super._renderItemFrame.apply(this,arguments)}_refreshItem(e,t){const n=this._dataAdapter.getNodeByItem(t),s=e.data(this._itemIndexKey()),o=e.closest("ul"),a=e.closest("li");this._renderItem(s,n,o,a)}_addContentClasses(e,t){const n=e.text?!!e.text.length:!1,s=!!e.icon,o=e.items?!!e.items.length:!1;t.toggleClass(Yt,n),t.toggleClass(Jt,s),this.hasIcons||(this.hasIcons=s),t.toggleClass(Zt,o)}_getItemContent(e){let t=super._getItemContent(e);return t.length||(t=e.children(`.${jt}`)),t}_postprocessRenderItem(e){const t=m(e.itemElement),n=this._dataAdapter.getSelectedNodesKeys();if(!n.length||!this._selectedGetter(e.itemData)||!this._isItemSelectable(e.itemData)){this._setAriaSelectionAttribute(t,"false");return}this._dataAdapter.getNodeByItem(e.itemData).internalFields.key===n[0]?(t.addClass(this._selectedItemClass()),this._setAriaSelectionAttribute(t,"true")):this._setAriaSelectionAttribute(t,"false")}_isItemSelectable(e){return e.selectable!==!1}_renderSeparator(e){m("<li>").appendTo(e).addClass("dx-menu-separator")}_itemClickHandler(e){if(e._skipHandling)return;const t=this._createAction(this._updateSubmenuVisibilityOnClick.bind(this));this._itemDXEventHandler(e,"onItemClick",{},{beforeExecute:this._itemClick,afterExecute:t.bind(this)}),e._skipHandling=!0}_itemClick(e){const{event:t,itemData:n}=e.args[0],s=this._getItemElementByEventArgs(t),o=s&&s.find(".dx-item-url").get(0);n.url&&o&&o.click()}_updateSubmenuVisibilityOnClick(e){this._updateSelectedItemOnClick(e),this._getShowSubmenuMode()==="onClick"&&this._addExpandedClass(e.args[0].itemElement)}_updateSelectedItemOnClick(e){const t=e.args?e.args[0]:e;if(!this._isItemSelectAllowed(t.itemData))return;const n=this._dataAdapter.getSelectedNodesKeys(),s=n.length&&this._dataAdapter.getNodeByKey(n[0]);s&&this._toggleItemSelection(s,!1),!s||s.internalFields.item!==t.itemData?this.selectItem(t.itemData):(this._fireSelectionChangeEvent(null,this.option("selectedItem")),this._setOptionWithoutOptionChange("selectedItem",null))}_isItemSelectAllowed(e){const t=this._isSelectionEnabled()&&this.option("selectByClick");return!this._isContainerEmpty()&&t&&this._isItemSelectable(e)&&!this._itemsGetter(e)}_isContainerEmpty(){return this._itemContainer().is(":empty")}_syncSelectionOptions(){return at()}_optionChanged(e){switch(e.name){case"showSubmenuMode":break;case"selectedItem":{const t=this._dataAdapter.getNodeByItem(e.value),n=this._dataAdapter.getSelectedNodesKeys()[0];if(t&&t.internalFields.key!==n){if(t.selectable===!1)break;n&&this._toggleItemSelection(this._dataAdapter.getNodeByKey(n),!1),this._toggleItemSelection(t,!0),this._updateSelectedItems()}break}case"cssClass":case"position":case"selectByClick":case"animation":case"useInkRipple":this._invalidate();break;default:super._optionChanged(e)}}_toggleItemSelection(e,t){const n=this._getElementByItem(e.internalFields.item);n&&m(n).toggleClass(J),this._dataAdapter.toggleSelection(e.internalFields.key,t)}_getElementByItem(e){let t;return S(this._itemElements(),(n,s)=>m(s).data(this._itemDataKey())!==e?!0:(t=s,!1)),t}_updateSelectedItems(e,t){(e||t)&&this._fireSelectionChangeEvent(t,e)}_fireSelectionChangeEvent(e,t){this._createActionByOption("onSelectionChanged",{excludeValidators:["disabled","readOnly"]})({addedItems:[e],removedItems:[t]})}selectItem(e){const t=e.nodeType?this._getItemData(e):e,n=this._dataAdapter.getSelectedNodesKeys()[0],s=this.option("selectedItem"),o=this._dataAdapter.getNodeByItem(t);o.internalFields.key!==n&&(n&&this._toggleItemSelection(this._dataAdapter.getNodeByKey(n),!1),this._toggleItemSelection(o,!0),this._updateSelectedItems(s,t),this._setOptionWithoutOptionChange("selectedItem",t))}unselectItem(e){const t=e.nodeType?this._getItemData(e):e,n=this._dataAdapter.getNodeByItem(t),s=this.option("selectedItem");n.internalFields.selected&&(this._toggleItemSelection(n,!1),this._updateSelectedItems(s,null),this._setOptionWithoutOptionChange("selectedItem",null))}}ze.ItemClass=lt;const nn="dx-menu-phone-overlay",ye=["onShowing","onShown","onSubmenuCreated","onHiding","onHidden","onPositioning","onLeftFirstItem","onLeftLastItem","onCloseRootSubmenu","onExpandLastSubmenu"],sn=["up","down","first","last"],Ie=M();class on extends ze{getShowEvent(e){if(P(e)){if(e.name!==null)return e.name??"dxcontextmenu"}else return e;return null}getShowDelay(e){return P(e)&&e.delay}_getDefaultOptions(){return y(super._getDefaultOptions(),{showEvent:"dxcontextmenu",hideOnOutsideClick:!0,position:{at:"top left",my:"top left"},onShowing:null,onShown:null,onSubmenuCreated:null,onHiding:null,onHidden:null,onPositioning:null,submenuDirection:"auto",visible:!1,target:void 0,onLeftFirstItem:null,onLeftLastItem:null,onCloseRootSubmenu:null,onExpandLastSubmenu:null})}_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:()=>!Q(),options:{animation:null}}])}_setDeprecatedOptions(){super._setDeprecatedOptions(),y(this._deprecatedOptions,{closeOnOutsideClick:{since:"22.2",alias:"hideOnOutsideClick"}})}_initActions(){this._actions={},S(ye,(e,t)=>{this._actions[t]=this._createActionByOption(t)||ne})}_setOptionsByReference(){super._setOptionsByReference(),y(this._optionsByReference,{animation:!0,selectedItem:!0})}_focusInHandler(){}_itemContainer(){return this._overlay?this._overlay.$content():m()}_eventBindingTarget(){return this._itemContainer()}itemsContainer(){return this._overlay?this._overlay.$content():void 0}_supportedKeys(){return y(super._supportedKeys(),{space:()=>{const e=m(this.option("focusedElement"));this.hide(),!(!e.length||!this._isSelectionEnabled())&&this.selectItem(e[0])},escape:this.hide})}_getActiveItem(e){const t=this._getAvailableItems(),n=t.filter(".dx-state-focused"),s=t.filter(".dx-state-hover");return s.closest(".dx-menu-items-container").find(".dx-menu-item").index(n)>=0?n:s.length?s:super._getActiveItem()}_moveFocus(e){const t=this._getItemsByLocation(e),n=this._getActiveItem(!0),s=this.itemsContainer().find(".dx-state-hover"),a=!!(m(this.option("focusedElement")).length||s.length);let r;switch(e){case"up":r=a?this._prevItem(t):n,this._setFocusedElement(r),n.is(t.first())&&this._actions.onLeftFirstItem(n);break;case"down":r=a?this._nextItem(t):n,this._setFocusedElement(r),n.is(t.last())&&this._actions.onLeftLastItem(n);break;case"right":r=this.option("rtlEnabled")?this._hideSubmenuHandler():this._expandSubmenuHandler(t,e),this._setFocusedElement(r);break;case"left":r=this.option("rtlEnabled")?this._expandSubmenuHandler(t,e):this._hideSubmenuHandler(),this._setFocusedElement(r);break;case"first":r=t.first(),this._setFocusedElement(r);break;case"last":r=t.last(),this._setFocusedElement(r);break;default:return super._moveFocus(e)}}_setFocusedElement(e){e&&e.length!==0&&(this.option("focusedElement",K(e)),this._scrollToElement(e))}_scrollToElement(e){const n=e.closest(".dx-scrollable").dxScrollable("instance");n==null||n.scrollToElement(e)}_getItemsByLocation(e){const t=this._getActiveItem(!0);let n;return sn.includes(e)&&(n=t.closest(".dx-menu-items-container").children().children()),n=this._getAvailableItems(n),n}_getAriaTarget(){return this.$element()}_refreshActiveDescendant(){if(C(this._overlay)){const e=this._overlay.$content();super._refreshActiveDescendant(e)}}_hideSubmenuHandler(){const e=this._getActiveItem(!0),t=e.parents(".dx-menu-item-expanded").first();if(t.length)return this._hideSubmenusOnSameLevel(t),this._hideSubmenu(e.closest(".dx-submenu")),t;this._actions.onCloseRootSubmenu(e)}_expandSubmenuHandler(e,t){const n=this._getActiveItem(!0),s=this._getItemData(n),o=this._dataAdapter.getNodeByItem(s),a=this._hasSubmenu(o),r=n.children(".dx-submenu");if(a&&!n.hasClass("dx-state-disabled"))return(!r.length||r.css("visibility")==="hidden")&&this._showSubmenu(n),this._nextItem(this._getItemsByLocation(t));this._actions.onExpandLastSubmenu(n)}_clean(){this._overlay&&(this._overlay.$element().remove(),this._overlay=null),this._detachShowContextMenuEvents(this._getTarget()),super._clean()}_initMarkup(){this.$element().addClass("dx-has-context-menu"),super._initMarkup()}_render(){super._render(),this._renderVisibility(this.option("visible")),this._addWidgetClass()}_isTargetOutOfComponent(e){return!(m(e).closest(".dx-context-menu").length!==0)}_focusOutHandler(e){const{relatedTarget:t}=e;t&&this._isTargetOutOfComponent(t)&&this.hide(),super._focusOutHandler(e)}_renderContentImpl(){this._detachShowContextMenuEvents(this._getTarget()),this._attachShowContextMenuEvents()}_attachKeyboardEvents(){!this._keyboardListenerId&&this._focusTarget().length&&super._attachKeyboardEvents()}_renderContextMenuOverlay(){if(this._overlay)return;const e=this._getOverlayOptions();this._overlay=this._createComponent(m("<div>").appendTo(this._$element),dt,e);const t=this._overlay.$content();t.addClass("dx-context-menu"),this._addCustomCssClass(t),this._addPlatformDependentClass(t),this._attachContextMenuEvent()}preventShowingDefaultContextMenuAboveOverlay(){const e=this._itemContainer(),t=q(ct,this.NAME);x.off(e,t,".dx-submenu"),x.on(e,t,".dx-submenu",n=>{n.stopPropagation(),n.preventDefault(),x.off(e,t,".dx-submenu")})}_itemContextMenuHandler(e){super._itemContextMenuHandler(e),e.stopPropagation()}_addPlatformDependentClass(e){Oe.current().phone&&e.addClass(nn)}_detachShowContextMenuEvents(e){const t=this.getShowEvent(this.option("showEvent"));if(!t)return;const n=q(t,this.NAME);this._showContextMenuEventHandler?x.off(F.getDocument(),n,e,this._showContextMenuEventHandler):x.off(m(e),n)}_attachShowContextMenuEvents(){const e=this._getTarget(),t=this.getShowEvent(this.option("showEvent"));if(!t)return;const n=q(t,this.NAME);let s=this._createAction(a=>{const r=this.getShowDelay(this.option("showEvent"));r?setTimeout(()=>this._show(a.event),r):this._show(a.event)},{validatingTargetName:"target"});const o=a=>s({event:a,target:m(a.currentTarget)});s=this._createAction(s),he(e)||e.nodeType||ut(e)?(this._showContextMenuEventHandler=void 0,x.on(e,n,o)):(this._showContextMenuEventHandler=o,x.on(F.getDocument(),n,e,this._showContextMenuEventHandler))}_hoverEndHandler(e){super._hoverEndHandler(e),e.stopPropagation()}_renderDimensions(){}_renderContainer(e,t){const n=t||this._itemContainer();e=m("<div>"),e.appendTo(n).addClass("dx-submenu").css("visibility",t?"hidden":"visible"),e.parent().hasClass("dx-overlay-content")||this._addCustomCssClass(e);const s=super._renderContainer(e);return t?s:this.option("width")?s.css("minWidth",this.option("width")):this.option("height")?s.css("minHeight",this.option("height")):s}_renderSubmenuItems(e,t){this._renderItems(this._getChildNodes(e),t);const n=t.children(".dx-submenu");this._actions.onSubmenuCreated({itemElement:K(t),itemData:e.internalFields.item,submenuElement:K(n)}),this._initScrollable(n),this.setAria({role:"menu"},n)}_getOverlayOptions(){const e=this.option("position");return{focusStateEnabled:this.option("focusStateEnabled"),animation:this.option("animation"),innerOverlay:!0,hideOnOutsideClick:n=>this._hideOnOutsideClickHandler(n),propagateOutsideClick:!0,hideOnParentScroll:!0,deferRendering:!1,position:{at:e.at,my:e.my,of:this._getTarget(),collision:"flipfit"},shading:!1,showTitle:!1,height:"auto",width:"auto",onShown:this._overlayShownActionHandler.bind(this),onHiding:this._overlayHidingActionHandler.bind(this),onHidden:this._overlayHiddenActionHandler.bind(this),visualContainer:Ie}}_overlayShownActionHandler(e){this._actions.onShown(e)}_overlayHidingActionHandler(e){this._actions.onHiding(e),e.cancel||(this._hideAllShownSubmenus(),this._setOptionWithoutOptionChange("visible",!1))}_overlayHiddenActionHandler(e){this._actions.onHidden(e)}_shouldHideOnOutsideClick(e){const{closeOnOutsideClick:t,hideOnOutsideClick:n}=this.option();return b(n)?n(e):b(t)?t(e):n||t}_hideOnOutsideClickHandler(e){if(!this._shouldHideOnOutsideClick(e))return!1;if(F.isDocument(e.target))return!0;const t=this._getActiveItemsContainer(e.target),n=this._getItemsContainers(),s=this._searchActiveItem(e.target),o=this.$element().parents(".dx-menu-item"),a=s[0]===o[0]&&s.length&&o.length;return this._isIncludeOverlay(t,n)&&s.length||a?(this._getShowSubmenuMode()==="onClick"&&this._hideAllShownChildSubmenus(s),!1):!0}_getActiveItemsContainer(e){return m(e).closest(".dx-menu-items-container")}_getItemsContainers(){return this._overlay.$content().find(".dx-menu-items-container")}_searchActiveItem(e){return m(e).closest(".dx-menu-item").eq(0)}_isIncludeOverlay(e,t){let n=!1;return S(t,(s,o)=>{e.is(o)&&!n&&(n=!0)}),n}_hideAllShownChildSubmenus(e){const t=e.find(".dx-submenu"),n=y([],this._shownSubmenus);t.length>0&&S(n,(s,o)=>{const a=this._searchActiveItem(o.context).parent();a.parent().is(e.parent().parent())&&!a.is(e.parent())&&this._hideSubmenu(o)})}_initScrollable(e){this._createComponent(e,ht,{useKeyboard:!1,_onVisibilityChanged:t=>{t.scrollTo(0)}})}_setSubMenuHeight(e,t,n){const s=e.find(".dx-menu-items-container"),o=H(s),a=this._getMaxHeight(t,!n),r=Math.min(o,a);e.css("height",n?r:"100%")}_getMaxHeight(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=H(Ie),s=he(e),o=F.getDocument(),a=e.length&&e[0]===o;if(!s||a)return n;const r=e[0].getBoundingClientRect().top,c=H(e);return(t?Math.max(r,n-r-c):Math.max(r+c,n-r))-10}_dimensionChanged(){this._shownSubmenus&&this._shownSubmenus.forEach(e=>{const t=e.closest(".dx-menu-item");this._setSubMenuHeight(e,t,!0),this._scrollToElement(t);const n=this._getSubmenuPosition(t);ie.setup(e,n)})}_getSubmenuBorderWidth(){return pt(mt())?0:1}_showSubmenu(e){const t=this._dataAdapter.getNodeByItem(this._getItemData(e));if(this._hideSubmenusOnSameLevel(e),!this._hasSubmenu(t))return;let n=e.children(".dx-submenu");const s=n.length;super._showSubmenu(e),s||(this._renderSubmenuItems(t,e),n=e.children(".dx-submenu")),this._setSubMenuHeight(n,e,!0),this._isSubmenuVisible(n)||this._drawSubmenu(e)}_hideSubmenusOnSameLevel(e){const t=e.parent(".dx-menu-item-wrapper").siblings().find(".dx-menu-item-expanded");t.length&&(t.removeClass("dx-menu-item-expanded"),this._hideSubmenu(t.find(".dx-submenu")))}_hideSubmenuGroup(e){this._isSubmenuVisible(e)&&this._hideSubmenuCore(e)}_isSubmenuVisible(e){return e.css("visibility")==="visible"}_drawSubmenu(e){const t=this.option("animation")?this.option("animation").show:{},n=e.children(".dx-submenu"),s=this._getSubmenuPosition(e);this._overlay&&this._overlay.option("visible")&&(C(this._shownSubmenus)||(this._shownSubmenus=[]),this._shownSubmenus.includes(n)||this._shownSubmenus.push(n),t&&j.stop(n),ie.setup(n,s),t&&(W(t.to)&&(t.to.position=s),this._animate(n,t)),n.css("visibility","visible"))}_animate(e,t){j.animate(e,t)}_getSubmenuPosition(e){const t=this.option("submenuDirection").toLowerCase(),s={collision:"flip",of:e.parent(".dx-menu-item-wrapper"),offset:{h:0,v:-1}};switch(t){case"left":s.at="left top",s.my="right top";break;case"right":s.at="right top",s.my="left top";break;default:this.option("rtlEnabled")?(s.at="left top",s.my="right top"):(s.at="right top",s.my="left top")}return s}_updateSubmenuVisibilityOnClick(e){if(!e.args.length)return;const{itemData:t}=e.args[0],n=this._dataAdapter.getNodeByItem(t);if(!n)return;const s=m(e.args[0].itemElement);let o=s.find(".dx-submenu");if(this._hasSubmenu(n)&&!o.length&&(this._renderSubmenuItems(n,s),o=s.find(".dx-submenu")),s.context===o.context&&o.css("visibility")==="visible")return;this._updateSelectedItemOnClick(e);const r=t&&t.closeMenuOnClick===!1;if(!(!t||t.disabled||r))if(o.length===0){const c=m(s.parents(".dx-submenu")[0]);this._hideSubmenu(c),!e.canceled&&this._overlay&&this._overlay.option("visible")&&this.option("visible",!1)}else this._shownSubmenus&&this._shownSubmenus.length>0&&this._shownSubmenus[0].is(o)&&this._hideSubmenu(o),this._showSubmenu(s)}_hideSubmenu(e){const t=y([],this._shownSubmenus);S(t,(n,s)=>{(e.is(s)||gt(e[0],s[0]))&&(s.parent().removeClass("dx-menu-item-expanded"),this._hideSubmenuCore(s))})}_hideSubmenuCore(e){const t=this._shownSubmenus.indexOf(e),n=this.option("animation")?this.option("animation").hide:null;t>=0&&this._shownSubmenus.splice(t,1),this._stopAnimate(e),n&&this._animate(e,n),e.css("visibility","hidden"),e.dxScrollable("instance").scrollTo(0),this.option("focusedElement",null)}_stopAnimate(e){j.stop(e,!0)}_hideAllShownSubmenus(){const e=y([],this._shownSubmenus);this._overlay.$content().find(".dx-menu-item-expanded").removeClass("dx-menu-item-expanded"),S(e,(n,s)=>{this._hideSubmenu(s)})}_visibilityChanged(e){e&&this._renderContentImpl()}_optionChanged(e){if(ye.includes(e.name)){this._initActions();return}switch(e.name){case"visible":this._renderVisibility(e.value);break;case"showEvent":case"position":case"submenuDirection":this._invalidate();break;case"target":e.previousValue&&this._detachShowContextMenuEvents(e.previousValue),this._invalidate();break;case"closeOnOutsideClick":case"hideOnOutsideClick":break;default:super._optionChanged(e)}}_renderVisibility(e){return e?this._show():this._hide()}_toggleVisibility(){}_show(e){const t={jQEvent:e};let n=A().reject().promise();if(this._actions.onShowing(t),t.cancel)return n;const s=this._positionContextMenu(e);if(s){var o;this._overlay||(this._renderContextMenuOverlay(),this._overlay.$content().addClass(this._widgetClass()),this._renderFocusState(),this._attachHoverEvents(),this._attachClickEvent(),this._renderItems(this._dataAdapter.getRootNodes()));const a=m(this._overlay.content()).children(".dx-submenu");this._setOptionWithoutOptionChange("visible",!0),this._overlay.option({height:()=>this._getMaxHeight(s.of),maxHeight:()=>{const r=a.find(".dx-menu-items-container"),c=this._getSubmenuBorderWidth();return H(r)+2*c},position:s}),a.length&&this._setSubMenuHeight(a,s.of,!1),n=this._overlay.show(),e&&e.stopPropagation(),this._setAriaAttributes(),(e==null||(o=e.originalEvent)===null||o===void 0?void 0:o.type)===_t.name&&this.preventShowingDefaultContextMenuAboveOverlay()}return n}_renderItems(e,t){super._renderItems(e,t);const n=m(this._overlay.content()).children(".dx-submenu");n.length&&this._initScrollable(n)}_setAriaAttributes(){this._overlayContentId=`dx-${new ft}`,this.setAria("owns",this._overlayContentId),this.setAria({id:this._overlayContentId,role:"menu"},this._overlay.$content())}_cleanAriaAttributes(){this._overlay&&this.setAria("id",null,this._overlay.$content()),this.setAria("owns",void 0)}_getTarget(){return this.option("target")||this.option("position").of||m(F.getDocument())}_getContextMenuPosition(){return y({},this.option("position"),{of:this._getTarget()})}_positionContextMenu(e){let t=this._getContextMenuPosition();const n=this._isInitialOptionValue("position"),s=this._createActionByOption("onPositioning");e&&e.preventDefault&&n&&(t.of=e);const o={position:t,event:e};return s(o),o.cancel?t=null:o.event&&(o.event.cancel=!0,e.preventDefault()),t}_refresh(){if(!Q())super._refresh();else if(this._overlay){const e=this._overlay.option("position");super._refresh(),this._overlay&&this._overlay.option("position",e)}else super._refresh()}_hide(){let e;return this._overlay&&(e=this._overlay.hide(),this._setOptionWithoutOptionChange("visible",!1)),this._cleanAriaAttributes(),this.option("focusedElement",null),e||A().reject().promise()}toggle(e){const t=this.option("visible");return e=e===void 0?!t:e,this._renderVisibility(e)}show(){return this.toggle(!0)}hide(){return this.toggle(!1)}}Ct("dxContextMenu",on);const rn=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/,Be=function(i){i&&S(i,(e,t)=>{if(W(t)||Array.isArray(t))Be(t);else if(typeof t=="string"){const n=rn.exec(t);n&&(i[e]=new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6])))}})},be=function(i){const e=i.type==="sessionStorage"?It():M().localStorage;if(!e)throw new Error("E1007");return e},ve=function(i){return C(i.storageKey)?i.storageKey:"storage"};class an extends ke.ViewController{getDataController(){return this.getController("data")}getExportController(){return this.getController("export")}getColumnsController(){return this.getController("columns")}init(){return this._state={},this._isLoaded=!1,this._isLoading=!1,this._windowUnloadHandler=()=>{this._savingTimeoutID!==void 0&&this._saveState(this.state())},x.on(M(),"visibilitychange",this._windowUnloadHandler),this}optionChanged(e){const t=this;e.name==="stateStoring"?(t.isEnabled()&&!t.isLoading()&&t.load(),e.handled=!0):super.optionChanged(e)}dispose(){clearTimeout(this._savingTimeoutID),x.off(M(),"visibilitychange",this._windowUnloadHandler)}_loadState(){const e=this.option("stateStoring");if(e.type==="custom")return e.customLoad&&e.customLoad();try{return JSON.parse(be(e).getItem(ve(e)))}catch(t){E.log("W1022","State storing",t.message)}}_saveState(e){const t=this.option("stateStoring");if(t.type==="custom"){t.customSave&&t.customSave(e);return}try{be(t).setItem(ve(t),JSON.stringify(e))}catch(n){E.log(n.message)}}publicMethods(){return["state"]}isEnabled(){return this.option("stateStoring.enabled")}isLoaded(){return this._isLoaded}isLoading(){return this._isLoading}load(){this._isLoading=!0;const e=St(this._loadState());return e.always(()=>{this._isLoaded=!0,this._isLoading=!1}).done(t=>{t!==null&&!yt(t)&&this.state(t)}),e}state(e){const t=this;if(!arguments.length)return y(!0,{},t._state);t._state=y({},e),Be(t._state)}save(){const e=this;clearTimeout(e._savingTimeoutID),e._savingTimeoutID=setTimeout(()=>{e._saveState(e.state()),e._savingTimeoutID=void 0},e.option("stateStoring.savingTimeout"))}}const Sn={StateStoringController:an},Z="scrolling.legacyMode",Re=i=>i.option("scrolling.loadTwoPagesOnStart")||i._controller.isVirtual()||i._controller.getViewportItemIndex()>0,B=i=>i._cache.length?i._cache[0].pageIndex:-1,re=i=>i._cache.length?i._cache[i._cache.length-1].pageIndex:-1,$=(i,e,t)=>{i._isChangedFiring=!0,e(t),i._isChangedFiring=!1},xe=(i,e,t)=>{if(i._isDelayChanged)return i._isDelayChanged=!1,$(i,e,t),!0},ln=i=>{const e=i._dataOptions.pageSize();if(i.option("scrolling.preventPreload"))return 0;let n=i._controller.viewportSize();if(i._controller.isVirtualMode()&&i.option("scrolling.removeInvisiblePages")){n=0;const s=i._controller.viewportSize()*i._controller.viewportItemSize();let o=i._controller.getContentOffset();const a=i._controller.getViewportPosition(),r=i._controller.virtualItemsCount(),c=i._dataOptions.totalItemsCount();for(let l=r.begin;l<c&&!(o>=a+s);l++){const u=i._controller.getItemSizes()[l]||i._controller.viewportItemSize();o+=u,o>=a&&n++}}return e&&n>0?Math.ceil(n/e):1},R=(i,e)=>{const t=i.option("scrolling.preloadEnabled");let n=ln(i);const s=i._controller.isAppendMode();return n&&(e?n=t?1:0:(t&&n++,(s||!Re(i))&&n--)),n},dn=i=>{let e=-1;const t=B(i),n=i._dataOptions;return t<0?e=i._pageIndex:i._cache[i._pageIndex-t]?t>=0&&i._controller.viewportSize()>=0&&(t>0&&(re(i)+1===n.pageCount()&&i._cache.length<R(i)+1||i._pageIndex===t&&R(i,!0))&&(e=t-1),e<0&&t+i._cache.length<=i._pageIndex+R(i)&&(e=t+i._cache.length)):e=i._pageIndex,i._loadingPageIndexes[e]&&(e=-1),e},cn=(i,e)=>{const t=i._dataOptions;if(e===i.pageIndex()||!t.isLoading()&&e<t.pageCount()||!t.hasKnownLastPage()&&e===t.pageCount())return t.pageIndex(e),i._loadingPageIndexes[e]=!0,Me(t.load()).always(()=>{i._loadingPageIndexes[e]=!1})},we=(i,e,t,n,s)=>{const o=i._dataOptions,a=o.items().slice();let r=P(t)?t:void 0;const c=t==="prepend",l=o.viewportItems();t&&D(t)&&!i._isDelayChanged&&(r={changeType:t,items:a},s&&(r.removeCount=s.itemsCount,r.removeCount&&o.correctCount&&(r.removeCount=o.correctCount(l,r.removeCount,c))));let u=s?s.itemsLength:0;u&&o.correctCount&&(u=o.correctCount(l,u,c)),t==="append"?(l.push.apply(l,a),s&&l.splice(0,u)):c?(l.unshift.apply(l,a),s&&l.splice(-u)):i._dataOptions.viewportItems(a),o.updateLoading(),i._lastPageIndex=i.pageIndex(),i._isDelayChanged=n,n||$(i,e,r)};class un{constructor(e,t){this._dataOptions=t,this._controller=e,this._pageIndex=this._lastPageIndex=t.pageIndex(),this._cache=[],this._loadingPageIndexes={}}option(){return this._controller.option.apply(this._controller,arguments)}viewportItemIndexChanged(e){const t=this._dataOptions.pageSize(),n=this._dataOptions.pageCount(),s=this._controller.isVirtualMode(),o=this._controller.isAppendMode(),a=this._dataOptions.totalItemsCount();let r;if(t&&(s||o)&&a>=0){const c=this._controller.viewportSize();if(c&&e+c>=a&&!this._controller.isVirtual())if(this._dataOptions.hasKnownLastPage()){r=n-1;const l=a%t;r>0&&l>0&&l<c&&r--}else r=n;else{r=Math.floor(e/t);const l=n-1;r=Math.max(r,0),r=Math.min(r,l)}return this.pageIndex(r),this.load()}}pageIndex(e){const t=this._controller.isVirtualMode(),n=this._controller.isAppendMode();return this.option(Z)!==!1&&(t||n)?(e!==void 0&&(this._pageIndex=e),this._pageIndex):this._dataOptions.pageIndex(e)}beginPageIndex(e){let t=B(this);return t<0&&(t=e!==void 0?e:this.pageIndex()),t}endPageIndex(){const e=re(this);return e>0?e:this._lastPageIndex}pageSize(){return this._dataOptions.pageSize()}load(){const e=this._dataOptions;let t;const n=this._controller.isVirtualMode(),s=this._controller.isAppendMode();if(this.option(Z)!==!1&&(n||s)){const o=dn(this);if(o>=0){const a=cn(this,o);a&&(t=new A,a.done(()=>{const r=this._delayDeferred;r?r.done(t.resolve).fail(t.reject):t.resolve()}).fail(t.reject),e.updateLoading())}}else t=e.load();return!t&&this._lastPageIndex!==this.pageIndex()&&this._dataOptions.onChanged({changeType:"pageIndex"}),t||new A().resolve()}loadIfNeed(){const e=this._controller.isVirtualMode(),t=this._controller.isAppendMode();if((e||t)&&!this._dataOptions.isLoading()&&(!this._isChangedFiring||this._controller.isVirtual())){const n=this._controller.getViewportPosition();n>0?this._controller._setViewportPositionCore(n):this.load()}}handleDataChanged(e,t){const n=this._dataOptions;let s=this._cache.length,o,a;const r=this._controller.isVirtualMode(),c=this._controller.isAppendMode();if(t&&t.changes)$(this,e,t);else if(this.option(Z)!==!1&&(r||c)){const l=B(this);if(l>=0&&(r&&l+this._cache.length!==n.pageIndex()&&l-1!==n.pageIndex()&&(s=0,this._cache=[]),c)){if(n.pageIndex()===0)this._cache=[];else if(n.pageIndex()<re(this)){$(this,e,{changeType:"append",items:[]});return}}const u={pageIndex:n.pageIndex(),itemsLength:n.items(!0).length,itemsCount:this.itemsCount(!0)};this.option("scrolling.removeInvisiblePages")&&r?a=this._cache.length>Math.max(R(this)+(this.option("scrolling.preloadEnabled")?1:0),2):xe(this,e,{isDelayed:!0});let d;l===n.pageIndex()+1?(a&&(d=this._cache.pop()),o="prepend",this._cache.unshift(u)):(a&&(d=this._cache.shift()),o="append",this._cache.push(u));const h=r&&s===0&&Re(this);we(this,e,this._cache.length>1?o:void 0,h,d),this._delayDeferred=this.load().done(()=>{xe(this,e)&&this.load()})}else we(this,e,t)}getDelayDeferred(){return this._delayDeferred}itemsCount(e){let t=0;const n=this._controller.isVirtualMode();return!e&&n?this._cache.forEach(s=>{t+=s.itemsCount}):t=this._dataOptions.itemsCount(),t}virtualItemsCount(){let e=B(this);e<0&&(e=this._dataOptions.pageIndex());const t=e*this._dataOptions.pageSize(),n=this._cache.length*this._dataOptions.pageSize(),s=Math.max(0,this._dataOptions.totalItemsCount()-n-t);return{begin:t,end:s}}reset(){this._loadingPageIndexes={},this._cache=[]}}const z="scrolling.legacyMode",Ee=i=>i.option("scrolling.mode")==="virtual"||i._isVirtual,hn=i=>i.option("scrolling.mode")==="infinite"&&!i._isVirtual;function pn(i,e,t){let n;const s=[],o=[];t=t||i;function a(u){const d=u.element?u.$element():u,h=ie.offset(d);return h?u.scrollTop()-(h.top-i.offset().top):i.offset().top}const r={on(u,d,h){u.on("scroll",h)},off(u,d,h){u.off("scroll",h)}};function c(u){const d=u.get(0).nodeName==="#document",h=u.get(0).nodeType===M().Node.ELEMENT_NODE;let p=u.data("dxScrollable"),g=r;if(!p&&(p=d&&m(M())||h&&u.css("overflowY")==="auto"&&u,g=x,!p))return;const f=function(_){return function(){let I=_.scrollTop()-a(_);I=I>0?I:0,e(I)}}(p);g.on(p,"scroll",f),s.push(_=>{const I=a(p),G=p.scrollTo?"scrollTo":"scrollTop";_-I>=0&&p[G](_+I)}),o.push(()=>{g.off(p,"scroll",f)})}const l=u=>m(u.get(0).parentNode??u.get(0).host);for(n=t.parent();n.length;n=l(n))c(n);return{scrollTo(u){S(s,(d,h)=>{h(u)})},dispose(){S(o,(u,d)=>{d()})}}}class mn{constructor(e,t,n){this._dataOptions=t,this.component=e,this._viewportSize=e.option(z)===!1?15:0,this._viewportItemSize=20,this._viewportItemIndex=0,this._position=0,this._isScrollingBack=!1,this._contentSize=0,this._itemSizes={},this._sizeRatio=1,this._isVirtual=n,this.positionChanged=N(),this._dataLoader=new un(this,this._dataOptions)}getItemSizes(){return this._itemSizes}option(e,t){return this.component.option.apply(this.component,arguments)}isVirtual(){return this._isVirtual}virtualItemsCount(){if(Ee(this)){const e=this._dataOptions,t=e.totalItemsCount();if(this.option(z)===!1&&t!==-1){const n=this.getViewportParams(),s=e.loadedOffset(),o=e.loadedItemCount(),a=Math.max(n.skip,s),r=Math.min(n.take,o),c=Math.max(t-(a+r),0);return{begin:a,end:c}}return this._dataLoader.virtualItemsCount.apply(this._dataLoader,arguments)}}getScrollingTimeout(){const e=this.option("scrolling.renderAsync");let t=0;return C(e)?e&&(t=this.option("scrolling.timeout")??0):(t=Math.min(this.option("scrolling.timeout")||0,this._dataOptions.changingDuration()),t<this.option("scrolling.renderingThreshold")&&(t=this.option("scrolling.minTimeout")||0)),t}setViewportPosition(e){const t=new A,n=this.getScrollingTimeout();return clearTimeout(this._scrollTimeoutID),n>0?this._scrollTimeoutID=setTimeout(()=>{this._setViewportPositionCore(e),t.resolve()},n):(this._setViewportPositionCore(e),t.resolve()),t.promise()}getViewportPosition(){return this._position}getItemIndexByPosition(e,t,n){e=e??this._position;const s=this.getItemSize();let o=0,a=0;const r=Object.keys(this._itemSizes).concat(-1);for(let c=0;c<r.length&&o<e;c++){const l=parseInt(r[c]);let u=(e-o)/s;if(l<0||a+u<l){a+=u,this._sizeRatio<1&&C(t)&&(a=t+n/this._viewportItemSize);break}else u=l-a,o+=u*s,a+=u;const d=this._itemSizes[l];o+=d,a+=o<e?1:(e-o+d)/d}return Math.round(50*a)/50}isScrollingBack(){return this._isScrollingBack}_setViewportPositionCore(e){const t=this._position||0;this._position=e,t!==this._position&&(this._isScrollingBack=this._position<t);const n=this.getItemIndexByPosition(),s=this.setViewportItemIndex(n);return this.positionChanged.fire(),s}setContentItemSizes(e){const t=this.virtualItemsCount();if(this._contentSize=e.reduce((n,s)=>n+s,0),t){e.forEach((o,a)=>{this._itemSizes[t.begin+a]=o});const n=(t.begin+t.end+this.itemsCount())*this._viewportItemSize,s=oe.getContentHeightLimit(bt);n>s?this._sizeRatio=s/n:this._sizeRatio=1}}getItemSize(){return this._viewportItemSize*this._sizeRatio}getItemOffset(e,t){const n=this.virtualItemsCount();let s=e;if(!n)return 0;let o=0;const a=this._dataOptions.totalItemsCount();return Object.keys(this._itemSizes).forEach(r=>{s&&(t?r>=a-e:r<e)&&(o+=this._itemSizes[r],s--)}),Math.floor(o+s*this._viewportItemSize*this._sizeRatio)}getContentOffset(e){const t=e==="end",n=this.virtualItemsCount();return n?this.getItemOffset(t?n.end:n.begin,t):0}getVirtualContentSize(){return this.virtualItemsCount()?this.getContentOffset("begin")+this.getContentOffset("end")+this._contentSize:0}getViewportItemIndex(){return this._viewportItemIndex}setViewportItemIndex(e){if(this._viewportItemIndex=e,this.option(z)!==!1)return this._dataLoader.viewportItemIndexChanged.apply(this._dataLoader,arguments)}viewportItemSize(e){return e!==void 0&&(this._viewportItemSize=e),this._viewportItemSize}viewportSize(e){return e!==void 0&&(this._viewportSize=e),this._viewportSize}viewportHeight(e,t){const n=t??this._position,s=this.getItemIndexByPosition(n),o=this.getItemIndexByPosition(n+e,s,e);this.viewportSize(Math.ceil(o-s)),!C(t)&&this._viewportItemIndex!==s&&this._setViewportPositionCore(n)}reset(e){this._dataLoader.reset(),e||(this._itemSizes={})}subscribeToWindowScrollEvents(e){this._windowScroll=this._windowScroll||pn(e,t=>{this.viewportItemSize()&&this.setViewportPosition(t)})}dispose(){clearTimeout(this._scrollTimeoutID),this._windowScroll&&this._windowScroll.dispose(),this._windowScroll=null}scrollTo(e){this._windowScroll&&this._windowScroll.scrollTo(e)}isVirtualMode(){return Ee(this)}isAppendMode(){return hn(this)}getViewportParams(){const e=this.option("scrolling.mode")==="virtual",t=this._dataOptions.totalItemsCount(),s=this._dataOptions.hasKnownLastPage()&&this._viewportItemIndex>t?t:this._viewportItemIndex,o=this._viewportSize+s,a=this.option("scrolling.prerenderedRowChunkSize")||1,r=this.isScrollingBack(),c=this.option("scrolling.prerenderedRowCount")??1,l=r?c:0,u=r?0:c,d=Math.floor(Math.max(0,s-l)/a)*a;let h=Math.ceil((o+u-d)/a)*a;if(e){const p=Math.max(0,t-d);h=Math.min(h,p)}return{skip:d,take:h}}itemsCount(){let e=0;return this.option(z)?e=this._dataLoader.itemsCount.apply(this._dataLoader,arguments):e=this._dataOptions.itemsCount(),e}pageIndex(){return this._dataLoader.pageIndex(...arguments)}beginPageIndex(){return this._dataLoader.beginPageIndex(...arguments)}endPageIndex(){return this._dataLoader.endPageIndex(...arguments)}pageSize(){return this._dataLoader.pageSize(...arguments)}load(){return this._dataLoader.load(...arguments)}loadIfNeed(){return this._dataLoader.loadIfNeed(...arguments)}handleDataChanged(){return this._dataLoader.handleDataChanged(...arguments)}getDelayDeferred(){return this._dataLoader.getDelayDeferred()}}const yn={VirtualScrollController:mn};function Ne(i){i=i||[];for(let e=0;e<i.length;e++)i[e].selected=!1,Ne(i[e].items)}function $e(i){const e=i.NAME==="dxTreeView"?".dx-treeview-select-all-item":".dx-list-select-all-checkbox";return i.$element().find(e).dxCheckBox("instance")}function Ae(i,e){if(i.component.option("searchValue"))return;const t=$e(i.component);t&&e&&e.length&&t.option("value",void 0)}function In(i,e,t){if(e^t){if(i.selected=!0,t&&i.items){for(let n=0;n<i.items.length;n++)if(!i.items[n].selected){i.selected=void 0;break}}}else(t||i.selected)&&(i.selected=!1,Ne(i.items))}let bn=class extends ke.View{getPopupContainer(){return this._popupContainer}getListComponent(){return this._listComponent}applyHeaderFilter(e){const t=this.getListComponent(),n=t.option("searchValue"),s=$e(t),o=!n&&!e.isFilterBuilder&&(s==null?void 0:s.option("value")),a=[],r=function(c,l,u){S(l,(d,h)=>{if(h.selected!==void 0&&!!h.selected^u){const p=t._getNode(h),f=t._hasChildren(p)&&h.items&&h.items.some(_=>_.selected);if(!n||!f){c.push(h.value);return}}h.items&&h.items.length&&r(c,h.items,u)})};o?(e.type==="tree"&&(e.filterType="exclude"),Array.isArray(e.filterValues)&&(e.filterValues=[])):e.type==="tree"&&(e.filterType&&(e.filterType="include"),r(a,t.option("items"),!1),e.filterValues=a),e.filterValues&&!e.filterValues.length&&(e.filterValues=null),e.apply(),this.hideHeaderFilterMenu()}showHeaderFilterMenu(e,t){const n=this;if(t){n._initializePopupContainer(t);const s=n.getPopupContainer();n.hideHeaderFilterMenu(),n.updatePopup(e,t),s.show()}}hideHeaderFilterMenu(){const e=this.getPopupContainer();e&&e.hide()}updatePopup(e,t){const n=this,s=this.option("showColumnLines"),o=t.alignment==="right"^!s?"left":"right";n._popupContainer.setAria({role:"dialog",label:k.format("dxDataGrid-headerFilterLabel")}),n._popupContainer&&(n._cleanPopupContent(),n._popupContainer.option("position",{my:`${o} top`,at:`${o} bottom`,of:e,collision:"fit fit"}))}_getSearchExpr(e,t){const{lookup:n}=e,{useDefaultSearchExpr:s}=e,o=t.dataSource,a=t.search.searchExpr;if(a)return a;if(s||C(o)&&!b(o))return"text";if(n)return n.displayExpr||"this";if(e.dataSource){const{group:r}=e.dataSource;if(Array.isArray(r)&&r.length>0)return r[0].selector;if(b(r)&&!e.remoteFiltering)return r}return e.dataField||e.selector}_cleanPopupContent(){this._popupContainer&&this._popupContainer.$content().empty()}_initializePopupContainer(e){const t=this,n=t.element(),s=this._normalizeHeaderFilterOptions(e),{height:o,width:a}=s,r={width:a,height:o,visible:!1,shading:!1,showTitle:!1,showCloseButton:!1,hideOnParentScroll:!1,dragEnabled:!1,hideOnOutsideClick:!0,wrapperAttr:{class:"dx-header-filter-menu"},focusStateEnabled:!1,toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:s.texts.ok,onClick(){t.applyHeaderFilter(e)}}},{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:s.texts.cancel,onClick(){t.hideHeaderFilterMenu()}}}],resizeEnabled:!0,onShowing(c){c.component.$content().parent().addClass("dx-dropdowneditor-overlay"),t._initializeListContainer(e,s),e.onShowing&&e.onShowing(c)},onShown(){t.getListComponent().focus()},onHidden:e.onHidden,onInitialized(c){const{component:l}=c;l.option("animation",l._getDefaultOptions().animation)},_loopFocus:!0};C(t._popupContainer)?t._popupContainer.option(r):t._popupContainer=t._createComponent(n,vt,r)}_initializeListContainer(e,t){const n=this,s=n._popupContainer.$content(),o=!e.isFilterBuilder&&t.allowSelectAll,a={searchEnabled:t.search.enabled,searchTimeout:t.search.timeout,searchEditorOptions:t.search.editorOptions,searchMode:t.search.mode||"",dataSource:e.dataSource,onContentReady(){n.renderCompleted.fire()},itemTemplate(c,l,u){const d=m(u);return e.encodeHtml?d.text(c.text):d.html(c.text)}};function r(c){c.fullName==="searchValue"&&o&&n.option("headerFilter.hideSelectAllOnSearch")!==!1&&(e.type==="tree"?c.component.option("showCheckBoxesMode",c.value?"normal":"selectAll"):c.component.option("selectionMode",c.value?"multiple":"all"))}e.type==="tree"?n._listComponent=n._createComponent(m("<div>").appendTo(s),xt,y(a,{showCheckBoxesMode:o?"selectAll":"normal",onOptionChanged:r,keyExpr:"id"})):n._listComponent=n._createComponent(m("<div>").appendTo(s),wt,y(a,{searchExpr:n._getSearchExpr(e,t),pageLoadMode:"scrollBottom",showSelectionControls:!0,selectionMode:o?"all":"multiple",onOptionChanged:r,onSelectionChanged(c){const l=c.component.option("items"),u=c.component.option("selectedItems");if(!c.component._selectedItemsUpdating&&!c.component.option("searchValue")&&!e.isFilterBuilder){const d=e.filterValues||[],h=e.filterType==="exclude";u.length===0&&l.length&&(d.length<=1||h&&d.length===l.length-1)?(e.filterType="include",e.filterValues=[]):u.length===l.length&&(e.filterType="exclude",e.filterValues=[])}S(l,(d,h)=>{const p=oe.getIndexByKey(h,u,null)>=0;if(!!h.selected!==p){h.selected=p,e.filterValues=e.filterValues||[];const f=oe.getIndexByKey(h.value,e.filterValues,null);f>=0&&e.filterValues.splice(f,1);const _=e.filterType==="exclude";p^_&&e.filterValues.push(h.value)}}),Ae(c,e.filterValues)},onContentReady(c){const{component:l}=c,u=l.option("items"),d=[];S(u,function(){this.selected&&d.push(this)}),l._selectedItemsUpdating=!0,l.option("selectedItems",d),l._selectedItemsUpdating=!1,Ae(c,e.filterValues)}}))}_normalizeHeaderFilterOptions(e){const t=this.option("headerFilter")||{},n=e.headerFilter||{},s={search:{enabled:t.allowSearch,timeout:t.searchTimeout}},o={search:{enabled:n.allowSearch,mode:n.searchMode,timeout:n.searchTimeout}};return y(!0,{},t,s,n,o)}_renderCore(){this.element().addClass("dx-header-filter-menu")}};const gn=function(i){return C(i.allowHeaderFiltering)?i.allowHeaderFiltering:i.allowFiltering},xn=i=>class extends i{optionChanged(e){if(e.name==="headerFilter"){const t=this.name==="columnHeadersView";this._invalidate(t,t),e.handled=!0}else super.optionChanged(e)}_applyColumnState(e){let t;const{rootElement:n}=e,{column:s}=e;if(e.name==="headerFilter"){if(n.find(".dx-header-filter").remove(),gn(s)){t=super._applyColumnState(e).toggleClass("dx-header-filter-empty",this._isHeaderFilterEmpty(s)),this.option("useLegacyKeyboardNavigation")||t.attr("tabindex",this.option("tabindex")||0);const o=k.format("dxDataGrid-headerFilterIndicatorLabel",s.caption);t.attr("aria-label",o),t.attr("aria-haspopup","dialog"),t.attr("role","button")}return t}return super._applyColumnState(e)}_isHeaderFilterEmpty(e){return!e.filterValues||!e.filterValues.length}_getIndicatorClassName(e){return e==="headerFilter"?"dx-header-filter":super._getIndicatorClassName(e)}_renderIndicator(e){const t=e.container,n=e.indicator;if(e.name==="headerFilter"){const s=this.option("rtlEnabled");if(t.children().length&&(!s&&e.columnAlignment==="right"||s&&e.columnAlignment==="left")){t.prepend(n);return}}super._renderIndicator(e)}};function We(i,e,t,n,s,o){t=t||0,n=n||[],o=o||[],n[t]=n[t]||0;const a=i[t],r=o[t]+1||0;let c=0,l;if(a){for(l=r;l<a.length;l++){const u=a[l],d=l+n[t],h=u.colspan||1;if(We(i,e,t+(u.rowspan||1),n,h,o),n[t]+=h-1,c+=h,u.rowspan)for(let p=t+1;p<t+u.rowspan;p++)n[p]=n[p]||0,n[p]+=u.colspan||1;if(e(u,d,t,l)===!1||s!==void 0&&c>=s)break}o[t]=l}}function wn(i,e,t){const n=[];We(i,(s,o,a)=>{let r=s,c;const l=r.colspan||1,u=o+l-1>=e&&o<t;if(n[a]=n[a]||[],u)o<e?(c=l-(e-o),o=e):c=l,o+c>t&&(c=t-o),c!==l&&(r=y({},r,{colspan:c})),n[a].push(r);else if(o>t)return!1});for(let s=0;s<n.length;s++)n[s]=n[s]||[];return n}function En(i,e){const t=l=>l||1,n=[],s=(i[0]||[]).reduce((l,u)=>l+t(u.colspan),0),o=(l=>{let u=0,d=0;return()=>{const h=l[u]||[],p=h[d++];return d>=h.length&&(u++,d=0),p&&(p.colspan=t(p.colspan),p.rowspan=t(p.rowspan)),p}})(i),a=(l,u,d)=>{const h=n[l]=n[l]||[];if(h[u]=d,d.colspan>1||d.rowspan>1){const p=(g=>y({},g,e))(d);for(let g=1;g<d.colspan;g++)a(l,u+g,p);for(let g=1;g<d.rowspan;g++)for(let f=0;f<d.colspan;f++)a(l+g,u+f,p)}};let r=o(),c=0;for(;r;){for(let l=0;l<s&&r;l++)n[c]&&n[c][l]||(a(c,l,r),l+=r.colspan-1,r=o());c++}return n}export{fn as C,bn as H,ze as M,an as S,yn as V,We as a,Cn as b,wn as c,on as d,ke as e,Vt as f,oe as g,xn as h,zt as i,pn as j,mn as k,gn as l,En as p,Sn as s,In as u};
