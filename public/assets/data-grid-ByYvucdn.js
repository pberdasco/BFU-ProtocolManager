import{n as We,d as x,m as g,bP as xe,o as y,u as M,h as ft,c as ve,al as Zt,G as ot,bU as ee,i as f,ad as te,bV as Rr,aZ as Hi,bf as Ho,O as X,aA as U,D as E,bW as xt,V as F,au as ie,bM as dd,aw as Tr,at as Z,E as b,aS as ye,a9 as K,g as se,aU as J,a7 as Ae,l as q,a3 as _,an as A,bX as ao,H as zn,y as Y,aD as Vn,az as Fn,J as ud,ar as ce,bL as G,bY as cd,bZ as Ne,aJ as ri,b_ as zo,L as Vr,bq as oe,aH as Fr,aq as zi,x as en,U as hd,aG as Wn,ap as Kt,a8 as Le,b$ as pd,c0 as gd,b1 as pe,A as Or,ax as md,aE as fd,c1 as xn,c2 as $e,f as H,bQ as On,a$ as gt,aY as li,aI as _e,c3 as Cd,c4 as _d,c5 as wd,aV as Dr,c6 as xd,br as vd,q as uo,c7 as yd,c8 as Pr,aa as Ut,a6 as me,b0 as jt,c9 as bd,a4 as co,a_ as tn,aW as ho,ca as qt,v as $n,W as nn,cb as Gn,aB as Wi,cc as Id,z as Ed,cd as $i,ce as Wo,cf as $o,a5 as Xt,cg as Sd,e as Go,ch as Ar,ci as Rd,cj as Ze,ae as Pt,bn as on,aX as Td,ck as Vd,cl as Kn,cm as kr,cn as bt,co as Gi,cp as Br,cq as Fd,aT as tt,cr as Mt,cs as Od,ct as Dd,cu as Ko,as as Un,bx as Pd,a1 as Ad,cv as Ki,cw as kd,cx as Bd,cy as Mr,cz as Nr,cA as je,cB as ge,K as Yt,cC as Ke,cD as vt,cE as Ue,cF as Md,cG as jn,cH as po,cI as Q,bI as Nd,cJ as Lr,cK as ze,cL as Ld,cM as Hr,cN as Hd,bC as Uo,cO as zd,cP as Wd,cQ as $d,bi as Gd,aR as Kd,k as Dn,ac as Ud,aL as jo,aM as qo,aN as Xo,a2 as Yo,cR as lt,cS as jd,cT as At,ay as zr,cU as qd,be as Xd,cV as Yd,cW as Qd,b8 as Jd,bv as Qo,cX as Zd,r as I,C as eu,b2 as R}from"./index-Dyddoe5k.js";import{C as tu,e as L,g as v,i as yt,b as Wr,d as $r,S as nu,j as iu,k as Gr,M as ou,u as su,H as ru,h as Kr,l as go,f as lu,c as ai,p as au}from"./m_export-BSg2CvWz.js";const Pn={draggableColumn:"draggable-column"},Ui="dx-state-focused",du="dx-cell-focus-disabled",Ur=".dx-datagrid-rowsview .dx-row",Jo=`${Ur} > td`,jr=".dx-treelist-rowsview .dx-row",Zo=`${jr} > td`,es={groupPanel:[".dx-datagrid-group-panel .dx-group-panel-item[tabindex]"],columnHeaders:[".dx-datagrid-headers .dx-header-row > td.dx-datagrid-action",".dx-treelist-headers .dx-header-row > td.dx-treelist-action"],filterRow:[".dx-datagrid-headers .dx-datagrid-filter-row .dx-editor-cell .dx-texteditor-input",".dx-treelist-headers .dx-treelist-filter-row .dx-editor-cell .dx-texteditor-input"],rowsView:[".dx-row-focused",`${Ur}[tabindex]`,`${Jo}[tabindex]`,`${Jo}`,`${jr}[tabindex]`,`${Zo}[tabindex]`,`${Zo}`],footer:[".dx-datagrid-total-footer .dx-datagrid-summary-item",".dx-treelist-total-footer .dx-treelist-summary-item"],filterPanel:[".dx-datagrid-filter-panel .dx-icon-filter",".dx-treelist-filter-panel .dx-icon-filter"],pager:[".dx-datagrid-pager [tabindex]",".dx-treelist-pager [tabindex]"]};let di=!1,An=!1,dt=null;function uu(r,e,t,n,i,o){if(hu(e,t.originalEvent,o))return;const l=xe(t);l==="enter"||l==="space"?(qr(t.target,e),n&&n({event:t})):l==="tab"?i.addClass(Ui):fo(r,e,t)}function qr(r,e){const t=g(r),n=t.attr("aria-label"),o=Xr(n,e.element()).index(t);dt=y({},{ariaLabel:n,index:o},{viewInstance:e})}function Xr(r,e){const t=g(e);let n;if(r){const i=r==null?void 0:r.replace(/\\/g,"\\\\").replace(/"/g,'\\"');n=t.find(`[aria-label="${i}"][tabindex]`)}else n=t.find("[tabindex]");return n}function cu(r,e){const t=(e==null?void 0:e.getRootNode())||M.getDocument();for(const n in r){const i=r[n],o=g(t).find(i).first();if(o.length)return o}}function hu(r,e,t){const n={event:e,handled:!1};return t?t(n):r._createActionByOption("onKeyDown")(n),n.handled}function Yr(){An=M.getDocument().visibilityState==="visible"}function pu(){x.on(M.getDocument(),"visibilitychange",Yr)}function ts(){x.off(M.getDocument(),"visibilitychange",Yr)}function gu(r,e){An=!0,r.focus({preventScroll:e}),An=!1}function Qr(r,e,t,n,i,o){if(e.option("useLegacyKeyboardNavigation"))return We;const s=()=>g(e.element()),l=u=>uu(r,e,u,i,s(),o),a=()=>{di=!0,s().removeClass(Ui)},d=()=>{!di&&!An&&s().addClass(Ui),di=!1};return x.on(t,"keydown",n,l),x.on(t,"mousedown",n,a),x.on(t,"focusin",n,d),()=>{x.off(t,"keydown",n,l),x.off(t,"mousedown",n,a),x.off(t,"focusin",n,d)}}function mo(r){if(!r.option("useLegacyKeyboardNavigation")&&dt){const e=dt.viewInstance;if(e){const n=Xr(dt.ariaLabel,e.element()).eq(dt.index);dt=null,x.trigger(n,"focus")}}}function fo(r,e,t){const n=xe(t);if(t.ctrlKey&&(n==="upArrow"||n==="downArrow")){const i=Object.keys(es);let o=i.indexOf(r);for(;o>=0&&o<i.length;){o=n==="upArrow"?--o:++o;const s=i[o],l=es[s],a=cu(l,t.target);if(a&&a.length){a.attr("tabindex",e.option("tabindex")||0),x.trigger(a,"focus"),a.removeClass(du);break}}}}function mu(r,e){r.option("useLegacyKeyboardnavigation")||e.attr("tabindex",r.option("tabindex")||0)}const Nt=function(r,e,t,n,i){const o=e.getController("keyboardNavigation");e.option("useLegacyKeyboardNavigation")||o&&!o.isKeyboardEnabled()||(e.createAction("onKeyDown"),Qr(r,e,t,n,i,s=>{e.executeAction("onKeyDown",s)}))},ui="dx-master-detail-row",ci="dxCellHintVisible",fu={render(r){r.container.append(r.content)}},Cu=function(r,e){let t,n,i;function o(s){return setTimeout(()=>{t=n=null},s)}x.on(e,"touchstart touchend",".dx-row",s=>{clearTimeout(i),s.type==="touchstart"?(t=s.target,n=s.currentTarget,i=o(1e3)):i=o()}),x.on(e,[te,Rr,q.down].join(" "),".dx-row",r.createAction(s=>{const{event:l}=s;t&&(l.target=t,l.currentTarget=n),g(l.target).closest("a").length||(s.rowIndex=r.getRowIndex(l.currentTarget),s.rowIndex>=0&&(s.rowElement=ie(g(l.currentTarget)),s.columns=r.getColumns(),l.type===q.down?r._rowPointerDown(s):l.type===te?r._rowClick(s):r._rowDblClick(s)))}))},an=function(r){return r==="auto"?"":Ae(r)?`${r}px`:r},_u=function(r,e,t){r.style.width=r.style.maxWidth=e.width==="auto"?"":t},wu=function(r,e){if(!r||!e)return;const t=r.attributes,n=e.attributes;let i;for(i=0;i<t.length;i++){const o=t[i].nodeName;e.hasAttribute(o)||r.removeAttribute(o)}for(i=0;i<n.length;i++)r.setAttribute(n[i].nodeName,n[i].nodeValue)},xu=function(r){r.resolve()},Jr=r=>typeof r=="number"?`${r.toFixed(3)}px`:r==="adaptiveHidden"?"0.0001px":r;class sn extends tu(L.View){init(){this._scrollLeft=-1,this._columnsController=this.getController("columns"),this._dataController=this.getController("data"),this._adaptiveColumnsController=this.getController("adaptiveColumns"),this._columnChooserController=this.getController("columnChooser"),this._editorFactoryController=this.getController("editorFactory"),this._selectionController=this.getController("selection"),this._columnChooserView=this.getView("columnChooserView"),this._delayedTemplates=[],this._templateDeferreds=new Set,this._templatesCache={},this._templateTimeouts=new Set,this.createAction("onCellClick"),this.createAction("onRowClick"),this.createAction("onCellDblClick"),this.createAction("onRowDblClick"),this.createAction("onCellHoverChanged",{excludeValidators:["disabled","readOnly"]}),this.createAction("onCellPrepared",{excludeValidators:["disabled","readOnly"],category:"rendering"}),this.createAction("onRowPrepared",{excludeValidators:["disabled","readOnly"],category:"rendering",afterExecute:e=>{this._afterRowPrepared(e)}}),this._columnsController.columnsChanged.add(this._columnOptionChanged.bind(this)),this._dataController&&this._dataController.changed.add(this._handleDataChanged.bind(this))}dispose(){if(ft()){var e,t;const n=ve();(e=this._templateTimeouts)===null||e===void 0||e.forEach(i=>n.clearTimeout(i)),(t=this._templateTimeouts)===null||t===void 0||t.clear()}}optionChanged(e){switch(super.optionChanged(e),e.name){case"cellHintEnabled":case"onCellPrepared":case"onRowPrepared":case"onCellHoverChanged":this._invalidate(!0,!0),e.handled=!0;break;case"keyboardNavigation":e.fullName==="keyboardNavigation.enabled"&&this._invalidate(!0,!0),e.handled=!0}}_createScrollableOptions(){const e=this.option("scrolling");let t=this.option("scrolling.useNative");const n=y({},e,{direction:"both",bounceEnabled:!1,useKeyboard:!1});return t===void 0&&(t=!0),t==="auto"?(delete n.useNative,delete n.useSimulatedScrollbar):(n.useNative=!!t,n.useSimulatedScrollbar=!t),n}_updateCell(e,t){t.rowType&&this._cellPrepared(e,t)}_needToSetCellWidths(){return this.option("columnAutoWidth")}_createCell(e){const{column:t}=e,n=t.alignment||Zt(this.option("rtlEnabled")),i=this._needToSetCellWidths(),o=M.createElement("td");o.style.textAlign=n;const s=g(o);return e.rowType==="data"&&t.headerId&&!t.type&&this.component.option("showColumnHeaders")&&this.setAria("describedby",t.headerId,s),t.cssClass&&s.addClass(t.cssClass),Array.isArray(t.elementAttr)&&t.elementAttr.forEach(l=>{let{name:a,value:d}=l;s.attr(a,d)}),t.command==="expand"&&(s.addClass(t.cssClass),s.addClass(this.addWidgetPrefix("group-space"))),t.colspan>1?s.attr("colSpan",t.colspan):!t.isBand&&t.visibleWidth!=="auto"&&i&&((t.width||t.minWidth)&&(o.style.minWidth=an(t.minWidth||t.width)),t.width&&_u(o,t,an(t.width))),s}_createRow(e,t){t=t||"tr";const n=g(`<${t}>`).addClass("dx-row");return t==="tr"&&this.setAria("role","row",n),n}_isAltRow(e){return e&&e.dataIndex%2===1}_createTable(e,t){const n=g("<table>").addClass(this.addWidgetPrefix("table")).addClass(this.addWidgetPrefix("table-fixed"));if(e&&!t?(n.attr("id",`dx-${new ot}`).append(this._createColGroup(e)),ee.safari&&n.append(g("<thead>").append("<tr>")),this.setAria("role","presentation",n)):this.setAria("hidden",!0,n),this.setAria("role","presentation",g("<tbody>").appendTo(n)),t)return n;ee.mozilla&&x.on(n,"mousedown","td",o=>{o.ctrlKey&&o.preventDefault()}),this.option("cellHintEnabled")&&x.on(n,"mousemove",".dx-row > td",this.createAction(o=>{const s=o.event,l=g(s.target),a=g(s.currentTarget),d=a.parent(),u=this._columnsController.getVisibleColumns(),c=d.data("options"),h=a.index(),p=c&&c.cells&&c.cells[h],m=p?p.column:u[h],C=d.hasClass("dx-header-row"),w=d.hasClass("dx-data-row"),S=d.hasClass(ui),V=d.hasClass("dx-group-row"),O=d.hasClass(this.addWidgetPrefix("filter-row")),P=w&&(!m||m.cellTemplate),k=w&&p&&(c.isEditing||p.isEditing||(m==null?void 0:m.showEditorAlways)),B=C&&(!m||m.headerCellTemplate),$=V&&(!m||m.groupIndex&&m.groupCellTemplate);!S&&!O&&!k&&!P&&!B&&!$&&(l.data(ci)&&(l.removeAttr("title"),l.data(ci,!1)),l[0].scrollWidth-l[0].clientWidth>0&&!f(l.attr("title"))&&(l.attr("title",l.text()),l.data(ci,!0)))}));const i=o=>{const s=g(o.currentTarget),l=g(o.target).closest(".dx-field-item-content"),a=s.parent(),d=a.data("options"),u=d&&d.cells&&d.cells[s.index()];if(!s.closest("table").is(o.delegateTarget))return;const c=y({},u,{cellElement:ie(s),event:o,eventType:o.type});if(c.rowIndex=this.getRowIndex(a),l.length){const h=l.data("dx-form-item");h.column&&(c.column=h.column,c.columnIndex=this._columnsController.getVisibleIndex(c.column.index))}return c};return x.on(n,"mouseover",".dx-row > td",o=>{const s=i(o);s&&this.executeAction("onCellHoverChanged",s)}),x.on(n,"mouseout",".dx-row > td",o=>{const s=i(o);s&&this.executeAction("onCellHoverChanged",s)}),x.on(n,te,".dx-row > td",o=>{const s=i(o);s&&this.executeAction("onCellClick",s)}),x.on(n,Rr,".dx-row > td",o=>{const s=i(o);s&&this.executeAction("onCellDblClick",s)}),Cu(this,n),n}_rowPointerDown(e){}_rowClick(){}_rowDblClick(){}_createColGroup(e){const t=g("<colgroup>");for(let n=0;n<e.length;n++){const i=e[n].colspan||1;for(let o=0;o<i;o++)t.append(this._createCol(e[n]))}return t}_createCol(e){let t=e.visibleWidth||e.width;t==="adaptiveHidden"&&(t="0.0001px");const n=g("<col>");return Hi(n,t),n}renderDelayedTemplates(e){const t=this._delayedTemplates,n=t.filter(o=>!o.async),i=t.filter(o=>o.async);this._delayedTemplates=[],this._renderDelayedTemplatesCore(n,!1,e),this._renderDelayedTemplatesCoreAsync(i)}_renderDelayedTemplatesCoreAsync(e){if(e.length){const t=ve().setTimeout(()=>{this._templateTimeouts.delete(t),this._renderDelayedTemplatesCore(e,!0)});this._templateTimeouts.add(t)}}_renderDelayedTemplatesCore(e,t,n){const i=new Date;for(;e.length;){const o=e.shift(),{options:s}=o,l=M.getRootNode(g(s.container).get(0)),a=this.needWaitAsyncTemplates();if((!t||g(s.container).closest(l).length||a)&&(n&&(s.change=n),o.template.render(s)),t&&new Date-i>30){this._renderDelayedTemplatesCoreAsync(e);break}}!e.length&&this._delayedTemplates.length&&this.renderDelayedTemplates()}_processTemplate(e,t){const n=this;let i;if(e&&e.render&&!Ho(e))i={allowRenderToDetachedContainer:e.allowRenderToDetachedContainer,render(o){e.render(o.container,o.model,o.change),o.deferred&&o.deferred.resolve()}};else if(X(e))i={render(o){const s=e(ie(o.container),o.model,o.change);s&&(s.nodeType||Ho(s))&&o.container.append(s),o.deferred&&o.deferred.resolve()}};else{const o=U(e)?e:g(e).attr("id");o?(n._templatesCache[o]||(n._templatesCache[o]=n.getTemplate(e)),i=n._templatesCache[o]):i=n.getTemplate(e)}return i}renderTemplate(e,t,n,i,o){const s=this._processTemplate(t,n),{column:l}=n,a=n.rowType==="data",d=new E,u={container:e,model:n,deferred:d,onRendered:()=>{this.isDisposed()?d.reject():d.resolve()}};if(s){n.component=this.component;const c=l&&(l.renderAsync&&a||this.option("renderAsync")&&(l.renderAsync!==!1&&(l.command||l.showEditorAlways)&&a||n.rowType==="filter")),h=n.renderAsync??c;(s.allowRenderToDetachedContainer||i)&&!h?s.render(u):this._delayedTemplates.push({template:s,options:u,async:h}),this._templateDeferreds.add(d),x.on(e,xt,xu.bind(null,d))}else d.reject();return d.promise().always(()=>{this._templateDeferreds.delete(d)})}_getBodies(e){return g(e).children("tbody").not(".dx-header").not(".dx-footer")}_needWrapRow(e){var t;return!!this.option().rowTemplate&&!!((t=this._getBodies(e))!==null&&t!==void 0&&t.filter(".dx-row").length)}_wrapRowIfNeed(e,t,n){const i=n?e||this._tableElement:this._tableElement||e;if(this._needWrapRow(i)){const s=g("<tbody>").addClass(t.attr("class"));return this.setAria("role","presentation",s),s.append(t)}return t}_appendRow(e,t,n){n=n||fu,n.render({content:t,container:e})}_resizeCore(){const e=this._scrollLeft;e>=0&&(this._scrollLeft=0,this.scrollTo({left:e}))}_renderCore(e){const t=this.element().parent();(!t||t.parent().length)&&this.renderDelayedTemplates(e)}_renderTable(e){e=e||{},e.columns=this._columnsController.getVisibleColumns();const t=e.change&&e.change.changeType,n=this._createTable(e.columns,t==="append"||t==="prepend"||t==="update");return this._renderRows(n,e),n}_renderRows(e,t){const n=this,i=n._getRows(t.change),o=t.change&&t.change.columnIndices||[],s=t.change&&t.change.changeTypes||[];for(let l=0;l<i.length;l++)n._renderRow(e,y({row:i[l],columnIndices:o[l],changeType:s[l]},t))}_renderRow(e,t){t.columnIndices||(t.row.cells=[]);const n=this._createRow(t.row),i=this._wrapRowIfNeed(e,n);t.changeType!=="remove"&&this._renderCells(n,t),this._appendRow(e,i);const o=y({columns:t.columns},t.row);this._addWatchMethod(o,t.row),this._rowPrepared(i,o,t.row)}_needRenderCell(e,t){return!t||t.indexOf(e)>=0}_renderCells(e,t){const n=this;let i=0;const{row:o}=t,{columns:s}=t;for(let l=0;l<s.length;l++)this._needRenderCell(l,t.columnIndices)&&n._renderCell(e,y({column:s[l],columnIndex:i,value:o.values&&o.values[i],oldValue:o.oldValues&&o.oldValues[i]},t)),s[l].colspan>1?i+=s[l].colspan:i++}_updateCells(e,t,n,i){var o;const s=this,l=e.children(),a=t.children(),d=this.option("highlightChanges"),u=this.addWidgetPrefix("cell-updated-animation");i!=null&&(o=i.node)!==null&&o!==void 0&&o.hasChildren&&l.each(function(){s.setAria("expanded",i.isExpanded,g(this))}),n.forEach((c,h)=>{const p=l.eq(c),m=a.eq(h);p.replaceWith(m),d&&!m.hasClass("dx-command-expand")&&m.addClass(u)}),wu(e.get(0),t.get(0))}_setCellAriaAttributes(e,t,n){if(t.rowType!=="freeSpace"){var i;if(this.setAria("role","gridcell",e),n!=null&&(i=n.row)!==null&&i!==void 0&&(i=i.node)!==null&&i!==void 0&&i.hasChildren){const{row:l}=n;this.setAria("expanded",l.isExpanded,e)}const o=this._columnsController.getColumnIndexOffset(),s=t.columnIndex+o+1;this.setAria("colindex",s,e)}}_renderCell(e,t){const n=this._getCellOptions(t);if(t.columnIndices){if(t.row.cells){const o=t.row.cells.findIndex(s=>s.columnIndex===n.columnIndex);t.row.cells[o]=n}}else t.row.cells.push(n);const i=this._createCell(n);return this._setCellAriaAttributes(i,n,t),this._renderCellContent(i,n,t),e.get(0).appendChild(i.get(0)),i}_renderCellContent(e,t,n){const i=this._getCellTemplate(t);F(!i||this.renderTemplate(e,i,t,void 0,n.change)).done(()=>{this._updateCell(e,t)})}_getCellTemplate(e){}_getRows(e){return[]}_getCellOptions(e){const t={column:e.column,columnIndex:e.columnIndex,rowType:e.row.rowType,rowIndex:e.row.rowIndex,isAltRow:this._isAltRow(e.row)};return this._addWatchMethod(t),t}_addWatchMethod(e,t){if(!this.option("repaintChangesOnly"))return;const n=[];return t=t||e,t.watch=t.watch||function(i,o,s){let l=i(t.data);const a=function(d){d&&s&&s(d);const u=i(t.data);JSON.stringify(l)!==JSON.stringify(u)&&(d&&o(u),l=u)};return n.push(a),function(){const d=n.indexOf(a);d>=0&&n.splice(d,1)}},t.update=t.update||function(i,o){i&&(this.data=e.data=i.data,this.rowIndex=e.rowIndex=i.rowIndex,this.dataIndex=e.dataIndex=i.dataIndex,this.isExpanded=e.isExpanded=i.isExpanded,e.row&&!o&&(e.row=i)),n.forEach(s=>{s(i)})},t!==e&&(e.watch=t.watch.bind(t)),e}_cellPrepared(e,t){t.cellElement=ie(g(e)),this.executeAction("onCellPrepared",t)}_rowPrepared(e,t,n){dd(e.get(0),"options",t),t.rowElement=ie(e),this.executeAction("onRowPrepared",t)}_columnOptionChanged(e){const{optionNames:t}=e;if(v.checkChanges(t,["width","visibleWidth"])){const i=this._columnsController.getVisibleColumns().map(o=>o.visibleWidth||o.width);this.setColumnWidths({widths:i,optionNames:t});return}this._requireReady||this.render()}getCellIndex(e,t){return e.length?e[0].cellIndex:-1}getTableElements(){return this._tableElement||g()}getTableElement(e){return this._tableElement}setTableElement(e,t){this._tableElement=e}_afterRowPrepared(e){}_handleDataChanged(e){}callbackNames(){return["scrollChanged"]}_updateScrollLeftPosition(){const e=this._scrollLeft;e>=0&&(this._scrollLeft=0,this.scrollTo({left:e}))}scrollTo(e){const t=this.element(),n=t&&t.children(`.${this.addWidgetPrefix("scroll-container")}`).not(`.${this.addWidgetPrefix("content-fixed")}`);f(e)&&f(e.left)&&this._scrollLeft!==e.left&&(this._scrollLeft=e.left,n&&n.scrollLeft(e.left))}getContent(e){var t;return(t=this._tableElement)===null||t===void 0?void 0:t.parent()}_removeContent(e){const t=this.getContent(e);t!=null&&t.length&&t.remove()}_wrapTableInScrollContainer(e,t){const n=g("<div>"),i=this.option("scrolling.useNative");return(i===!1||i==="auto"&&!Tr.nativeScrolling)&&n.addClass(this.addWidgetPrefix("scrollable-simulated")),x.on(n,"scroll",()=>{const o=n.scrollLeft();o!==this._scrollLeft&&this.scrollChanged.fire({left:o},this.name)}),n.addClass(this.addWidgetPrefix("content")).addClass(this.addWidgetPrefix("scroll-container")).append(e).appendTo(this.element()),this.setAria("role","presentation",n),n}needWaitAsyncTemplates(){return this.option("templatesRenderAsynchronously")&&this.option("renderAsync")===!1}waitAsyncTemplates(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=new E;if(!(e||this.needWaitAsyncTemplates()))return t.resolve();const i=()=>F.apply(this,Array.from(this._templateDeferreds)).done(()=>{this.isDisposed()?t.reject():this._templateDeferreds.size>0?i():t.resolve()}).fail(t.reject);return i(),t.promise()}_updateContent(e,t,n){return this.waitAsyncTemplates().done(()=>{this._removeContent(n),this.setTableElement(e,n),this._wrapTableInScrollContainer(e,n)})}_findContentElement(e){}_getWidths(e){if(!e)return[];const t=[];return e.toArray().forEach(i=>{let o=i.offsetWidth;if(i.getBoundingClientRect){const s=Z(i);s.width>i.offsetWidth-1&&(o=s.width)}t.push(o)}),t}getColumnWidths(e,t){if((this.option("forceApplyBindings")||We)(),e=e??this.getTableElement(),e){const n=e.children("tbody:not(.dx-header)").children();for(let i=0;i<n.length;i++){const o=n.eq(i),s=o.hasClass("dx-group-row"),l=o.hasClass(ui),a=o.hasClass("dx-error-row");if(o.get(0).style.display!=="none"&&!o.hasClass("dx-state-invisible")&&(!s&&!l&&!a)){const c=o.children("td");return this._getWidths(c)}}}return[]}getVisibleColumnIndex(e,t){return e}setCellPropertiesCore(e,t,n){const i=t.hasClass("dx-group-row")?t.find(`td[aria-colindex='${n+1}']:not(.dx-group-cell)`):t.find("td").eq(n);for(let o=0;o<i.length;o+=1){const s=i.get(o);Object.assign(s.style,e)}}setCellProperties(e,t,n){const i=this.getTableElement();if(!(i!=null&&i.length))return;const o=i.children().children(".dx-row").not(`.${ui}`);if(f(n))this.setCellPropertiesCore(e,o.eq(n),t);else for(let s=0;s<o.length;s++){const l=this.getVisibleColumnIndex(t,s);l>=0&&this.setCellPropertiesCore(e,o.eq(s),l)}}setColumnWidths(e){let{widths:t,optionNames:n}=e;const i=this.getTableElement();if(!(i!=null&&i.length)||!t)return;const o=this.getColumns(),s=this._needToSetCellWidths(),l=i.children("colgroup").children("col");l.toArray().forEach(a=>a.removeAttribute("style")),o.forEach((a,d)=>{if(s&&a.width&&!a.command){const c={},h=an(a.visibleWidth||a.width),p=an(a.minWidth||h);c.width=a.width==="auto"?"":h,c.maxWidth=c.width,c.minWidth=p,this.setCellProperties(c,d)}const u=Jr(t[d]);f(u)&&Hi(l.eq(d),u)})}getCellElements(e){return this._getCellElementsCore(e)}_getCellElementsCore(e){return e<0?void 0:this._getRowElements().eq(e).children()}_getCellElement(e,t){const n=this.getCellElements(e),i=this._getVisibleColumnIndex(n,e,t);if(!(n!=null&&n.length)||i<0)return;const o=n.eq(i);return o.length>0?o:void 0}_getRowElement(e){const t=this;let n=g();const i=t.getTableElements();if(b(i,(o,s)=>{n=n.add(t._getRowElements(g(s)).eq(e))}),n.length)return n}getCellElement(e,t){const n=this._getCellElement(e,t);if(n)return ie(n)}getRowElement(e){const t=this._getRowElement(e);let n=[];if(t&&!ie(t).get)for(let i=0;i<t.length;i++)n.push(t[i]);else n=t;return n}_getVisibleColumnIndex(e,t,n){if(U(n)){const i=this._columnsController.columnOption(n,"index");return this._columnsController.getVisibleIndex(i)}return n}getColumnElements(){}getColumns(e,t){return this._columnsController.getVisibleColumns(e)}getCell(e,t,n){const i=t||this._getRowElements();let o;if(i.length>0&&e.rowIndex>=0){var s;if(this.option("scrolling.mode")!=="virtual"&&this.option("scrolling.rowRenderingMode")!=="virtual"&&(e.rowIndex=e.rowIndex<i.length?e.rowIndex:i.length-1),o=n||this.getCellElements(e.rowIndex),((s=o)===null||s===void 0?void 0:s.length)>0)return o.eq(o.length>e.columnIndex?e.columnIndex:o.length-1)}}getRowsCount(){const e=this.getTableElement();return e&&e.length===1?e[0].rows.length:0}_getRowElementsCore(e){if(e=e||this.getTableElement(),e){const n=(this.option().rowTemplate||this.option("dataRowTemplate"))&&e.find("> tbody.dx-row");return n&&n.length?n:e.find("> tbody > .dx-row, > .dx-row")}return g()}_getRowElements(e){return this._getRowElementsCore(e)}getRowIndex(e){return this._getRowElements().index(e)}getBoundingRect(){}getName(){}setScrollerSpacing(e){const t=this.element(),n=this.option("rtlEnabled");t&&t.css({paddingLeft:n?e:"",paddingRight:n?"":e})}isScrollbarVisible(e){const t=this.element(),n=this._tableElement;return t&&n?e?ye(n)-K(t)>0:se(n)-J(t)>0:!1}isDisposed(){var e;return(e=this.component)===null||e===void 0?void 0:e._disposed}}const vu="dx-link",hi=function(r,e,t){const n=g("<div>").addClass(r.addWidgetPrefix("text-content"));r.setAria("role","presentation",n),Zr(r,e,t.column,n);const i=r.option("showColumnLines"),o=r.getController("columns").getHeaderContentAlignment(t.column.alignment);return n[i||o==="right"?"appendTo":"prependTo"](e)};function Zr(r,e,t,n){const i=r._getIndicatorElements(e,!0),o=r._getIndicatorElements(e),s=i&&i.length,l=r._getColumnAlignment(t.alignment),a=`.${r._getIndicatorClassName("sort")}`,d=`.${r._getIndicatorClassName("sortIndex")}`,u=o.filter(a),c=o.children().filter(d);n=n||e.children(`.${r.addWidgetPrefix("text-content")}`),n.toggleClass("dx-text-content-alignment-"+l,s>0).toggleClass("dx-text-content-alignment-"+(l==="left"?"right":"left"),s>0&&t.alignment==="center").toggleClass("dx-sort-indicator",!!u.length).toggleClass("dx-sort-index-indicator",!!c.length).toggleClass("dx-header-filter-indicator",!!o.filter(`.${r._getIndicatorClassName("headerFilter")}`).length)}class yu extends sn{init(){super.init(),this._headerPanelView=this.getView("headerPanel"),this._headerFilterController=this.getController("headerFilter"),this._dataController=this.getController("data")}_createTable(){const e=super._createTable.apply(this,arguments);return x.on(e,"mousedown selectstart",this.createAction(t=>{const{event:n}=t;n.shiftKey&&n.preventDefault()})),e}_isLegacyKeyboardNavigation(){return this.option("useLegacyKeyboardNavigation")}_getDefaultTemplate(e){const t=this;return function(n,i){const{caption:o}=e,s=!e.command||o&&e.command!=="expand";e.command==="empty"?t._renderEmptyMessage(n,i):s?hi(t,n,i).text(o):e.command&&n.html("&nbsp;")}}_renderEmptyMessage(e,t){const n=this._getEmptyHeaderText();if(!n){e.html("&nbsp;");return}const i=hi(this,e,t);if(n.includes("{0}")){const[s,l]=n.split("{0}"),a=_.format("dxDataGrid-emptyHeaderColumnChooserText"),d=this._columnChooserView,u=g("<a>").text(a).addClass(vu);x.on(u,"click",this.createAction(()=>d.showColumnChooser())),i.append(M.createTextNode(s)).append(u).append(M.createTextNode(l))}else i.text(n)}_getEmptyHeaderText(){const e=!!this._columnChooserView.hasHiddenColumns(),t=!!this._headerPanelView.hasGroupedColumns();switch(!0){case(e&&t):return _.format("dxDataGrid-emptyHeaderWithColumnChooserAndGroupPanelText");case t:return _.format("dxDataGrid-emptyHeaderWithGroupPanelText");case e:return _.format("dxDataGrid-emptyHeaderWithColumnChooserText");default:return""}}_getHeaderTemplate(e){return e.headerCellTemplate||{allowRenderToDetachedContainer:!0,render:this._getDefaultTemplate(e)}}_processTemplate(e,t){const n=this;let i;const{column:o}=t,s=super._processTemplate(e);return t.rowType==="header"&&s&&o.headerCellTemplate&&!o.command?i={render(l){const a=hi(n,l.container,l.model);s.render(y({},l,{container:a}))}}:i=s,i}_handleDataChanged(e){e.changeType==="refresh"&&(this._isGroupingChanged||this._requireReady)&&(this._isGroupingChanged=!1,this.render())}_renderCell(e,t){const n=super._renderCell(e,t);return t.row.rowType==="header"&&(n.addClass("dx-cell-focus-disabled"),this._isLegacyKeyboardNavigation()||t.column&&!t.column.type&&n.attr("tabindex",this.option("tabindex")||0)),n}_setCellAriaAttributes(e,t,n){super._setCellAriaAttributes(e,t,n),t.rowType==="header"&&(t.column.type||this.setAria("role","columnheader",e),t.column&&!t.column.command&&!t.column.isBand&&(e.attr("id",t.column.headerId),this.setAria("label",`${_.format("dxDataGrid-ariaColumn")} ${t.column.caption}`,e)))}_createRow(e){const t=super._createRow.apply(this,arguments);return t.toggleClass("dx-column-lines",this.option("showColumnLines")),e.rowType==="header"&&(t.addClass("dx-header-row"),this._isLegacyKeyboardNavigation()||Nt("columnHeaders",this,t,"td",this._handleActionKeyDown.bind(this))),t}_processHeaderAction(e,t){}_handleActionKeyDown(e){const{event:t}=e,n=g(t.target);if(this._lastActionElement=t.target,n.is(".dx-header-filter")){const i=this._headerFilterController,o=n.closest("td"),s=this.getColumnIndexByElement(o);s>=0&&i.showHeaderFilterMenu(s,!1)}else{const i=n.closest(".dx-row");this._processHeaderAction(t,i)}t.preventDefault()}_renderCore(){const e=this.element(),t={};if(this._tableElement&&!this._dataController.isLoaded()&&!this._hasRowElements)return;e.addClass(this.addWidgetPrefix("headers")).toggleClass(this.addWidgetPrefix("nowrap"),!this.option("wordWrapEnabled")).empty(),this.setAria("role","presentation",e);const n=this._updateContent(this._renderTable({change:t}),t);return e.toggleClass("dx-header-multi-row",this.getRowCount()>1),super._renderCore.apply(this,arguments),n}_renderRows(){const e=this;(e._dataController.isLoaded()||e._hasRowElements)&&(super._renderRows.apply(e,arguments),e._hasRowElements=!0)}_renderRow(e,t){const n=this.getRowCount()===1?null:t.row.rowIndex;t.columns=this.getColumns(n),super._renderRow(e,t)}_createCell(e){const{column:t}=e,n=super._createCell.apply(this,arguments);return t.rowspan>1&&e.rowType==="header"&&n.attr("rowSpan",t.rowspan),n}_getRows(){const e=[],t=this.getRowCount();if(this.option("showColumnHeaders"))for(let n=0;n<t;n++)e.push({rowType:"header",rowIndex:n});return e}_getCellTemplate(e){if(e.rowType==="header")return this._getHeaderTemplate(e.column)}_columnOptionChanged(e){const{changeTypes:t}=e,{optionNames:n}=e;if(t.grouping||t.groupExpanding){t.grouping&&(this._isGroupingChanged=!0);return}super._columnOptionChanged(e),(n.width||n.visible)&&this.resizeCompleted.fire()}_isElementVisible(e){return e&&e.visible}_alignCaptionByCenter(e){let t=this._getIndicatorContainer(e,!0);t&&t.length&&(t.filter(".dx-visibility-hidden").remove(),t=this._getIndicatorContainer(e),t.clone().addClass("dx-visibility-hidden").css("float","").insertBefore(e.children(`.${this.addWidgetPrefix("text-content")}`)))}_updateCell(e,t){t.rowType==="header"&&t.column.alignment==="center"&&this._alignCaptionByCenter(e),super._updateCell.apply(this,arguments)}_updateIndicator(e,t,n){const i=super._updateIndicator.apply(this,arguments);return t.alignment==="center"&&this._alignCaptionByCenter(e),Zr(this,e,t),i}_getIndicatorContainer(e,t){const n=super._getIndicatorContainer(e);return t?n:n.filter(":not(.dx-visibility-hidden)")}_isSortableElement(e){return!0}getHeadersRowHeight(){const e=this.getTableElement(),t=e&&e.find(".dx-header-row");return t&&t.toArray().reduce((n,i)=>n+J(i),0)||0}getHeaderElement(e){const t=this.getColumnElements();return(t==null?void 0:t.eq(e))??g("")}getColumnElements(e,t){const n=this;let i;const o=n._columnsController,s=n.getRowCount();if(n.option("showColumnHeaders")){if(s>1&&(!f(e)||f(t))){const l=[],a=f(t)?o.getChildrenByBandColumn(t,!0):o.getVisibleColumns();return b(a,(d,u)=>{const c=f(e)?e:o.getRowIndex(u.index);i=n._getCellElement(c,o.getVisibleIndex(u.index,c)),i&&l.push(i.get(0))}),g(l)}if(!e||e<s)return n.getCellElements(e||0)}}getColumnIndexByElement(e){const t=this.getCellIndex(e),n=e.closest(".dx-row"),{rowIndex:i}=n[0],o=this.getColumns(i)[t];return o?o.index:-1}getVisibleColumnIndex(e,t){const n=this.getColumns()[e];return n?this._columnsController.getVisibleIndex(n.index,t):-1}getColumnWidths(e,t){const n=this.getColumnElements(t);return n&&n.length?this._getWidths(n):super.getColumnWidths.apply(this,arguments)}allowDragging(e){const t=e&&this._columnsController.getRowIndex(e.index),n=this.getColumns(t);return(this.option("allowColumnReordering")??this._columnsController.isColumnOptionUsed("allowReordering"))&&e.allowReordering&&n.length>1}getBoundingRect(){const e=this,t=e.getColumnElements();return t&&t.length?{top:e.getTableElement().offset().top}:null}getName(){return"headers"}getColumnCount(){const e=this.getColumnElements();return e?e.length:0}isVisible(){return this.option("showColumnHeaders")}optionChanged(e){const t=this;switch(e.name){case"showColumnHeaders":case"wordWrapEnabled":case"showColumnLines":t._invalidate(!0,!0),e.handled=!0;break;default:super.optionChanged(e)}}getHeight(){return this.getElementHeight()}getContextMenuItems(e){const t=this,{column:n}=e;if(e.row&&(e.row.rowType==="header"||e.row.rowType==="detailAdaptive")){const i=t.option("sorting");if(i&&i.mode!=="none"&&n&&n.allowSorting){const o=function(s){setTimeout(()=>{t._columnsController.changeSortOrder(n.index,s.itemData.value)})};return[{text:i.ascendingText,value:"asc",disabled:n.sortOrder==="asc",icon:"context-menu-sort-asc",onItemClick:o},{text:i.descendingText,value:"desc",disabled:n.sortOrder==="desc",icon:"context-menu-sort-desc",onItemClick:o},{text:i.clearText,value:"none",disabled:!n.sortOrder,icon:"context-menu-sort-none",onItemClick:o}]}}}getRowCount(){return this._columnsController&&this._columnsController.getRowCount()}toggleDraggableColumnClass(e,t,n){let i,o;const s=this.getRowCount(),l=this._columnsController.getColumns(),a=l&&l[e],d=a&&a.isBand&&a.index,u=(c,h)=>{c.ownerBand===d&&(o.eq(h).toggleClass(this.addWidgetPrefix(Pn.draggableColumn),t),c.isBand&&this.toggleDraggableColumnClass(c.index,t,i+1))};if(f(d))for(n=n||0,i=n;i<s;i++)o=this.getCellElements(i),o&&this.getColumns(i).forEach(u)}}const el={defaultOptions:()=>({showColumnHeaders:!0,cellHintEnabled:!0}),views:{columnHeadersView:yu}},T=A({},L,v,{modules:[]});el.views.columnHeadersView;T.registerModule("columnHeaders",el);const bu=2;var N;(function(r){r.Left="left",r.Right="right",r.Sticky="sticky"})(N||(N={}));const z={stickyColumn:"sticky-column",stickyColumnLeft:"sticky-column-left",stickyColumnRight:"sticky-column-right",stickyColumnBorderRight:"sticky-column-border-right",stickyColumnBorderLeft:"sticky-column-border-left",stickyColumns:"sticky-columns",firstHeader:"first-header",columnNoBorder:"column-no-border",groupRowContainer:"group-row-container",focusedFixedElement:"dx-focused-fixed-element"},tl=["filterValues","filterType","fixed","fixedPosition"],kn=["visibleIndex","dataField","name","dataType","width","visible","sortOrder","lastSortOrder","sortIndex","groupIndex","filterValue","bufferedFilterValue","selectedFilterOperation","bufferedSelectedFilterOperation","added"].concat(tl),Iu={visibleWidth:!0,bestFitWidth:!0,bufferedFilterValue:!0},Eu="dx-command-expand",ns=Number.MAX_SAFE_INTEGER||9007199254740991,Ge="groupExpand",Su="detailExpand",pi=/columns\[(\d+)\]\.?/gi,Ru={visible:!0,showInColumnChooser:!0},Tu={number:["=","<>","<",">","<=",">=","between"],string:["contains","notcontains","startswith","endswith","=","<>"],date:["=","<>","<",">","<=",">=","between"],datetime:["=","<>","<",">","<=",">=","between"]},Vu={visibleIndex:!0,groupIndex:!0,grouped:!0,sortIndex:!0,sortOrder:!0},ut="group",ct="columnChooser",Co="adaptiveHidden",Ct=(r,e)=>{const{fixedPosition:t}=e,n=r.option("rtlEnabled"),i=e.command&&e.command==="expand";return e.command&&!v.isCustomCommandColumn(r._columns,e)&&n&&!i?t===N.Right?N.Left:N.Right:t??N.Left},_o=function(r,e){return r.isVirtualMode()&&!!e.fixed&&e.fixedPosition===N.Sticky},is=function(r,e){return e.map(t=>_o(r,t)?A({},t,{fixed:!1,fixedPosition:""}):t)},wo=function(r,e){return e.visibleWidth!==Co&&(!e.isBand||!!r.getVisibleDataColumnsByBandColumn(e.index).length)},os=function(r,e){return!e.some(t=>!t.fixed&&wo(r,t))},dn=function(r,e,t,n,i,o){const s=e[n],l=f(s.ownerBand),a=i===N.Right,d=s.fixedPosition===N.Sticky,u=a?e.slice(n+1):e.slice(0,n).reverse(),c=a?t.slice(n+1):t.slice(0,n).reverse();let h=0,p=0,m=!os(r,u)&&d&&u.length?1:0;if(u.forEach((w,S)=>{if(w.fixed&&(!f(o)||s.ownerBand===w.ownerBand)){const V=w.fixedPosition===N.Sticky;h+=c[S],d&&V&&!os(r,u.slice(S+1))&&(S!==p?(m+=1,p=S+1):p+=1)}else wo(r,w)||(p+=1)}),l&&f(o)){var C;return h+=(o==null||(C=o[s.ownerBand])===null||C===void 0?void 0:C[i])??0,h}return h-m*bu},nl=function(r,e,t){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,o=arguments.length>5?arguments[5]:void 0;const l=r.option("rtlEnabled")!==i?"isLastColumn":"isFirstColumn";if(e.fixedPosition===N.Sticky){const a=r.getParentColumn(e)??e;if(r[l](a,0))return!1}return r[l](e,t,n,o)},Fu=function(r,e,t,n){const i=r.getVisibleIndex(e.index,n);return t==null?void 0:t.slice(0,i).reverse().find(o=>wo(r,o))},il=function(r,e,t,n,i){const o={},s=e[n];if(s)switch(Ct(r,s)){case N.Sticky:{const a=dn(r,e,t,n,N.Left,i),d=dn(r,e,t,n,N.Right,i);o.left=a,o.right=d;break}case N.Right:{const a=dn(r,e,t,n,N.Right,i);o.right=a;break}default:{const a=dn(r,e,t,n,N.Left,i);o.left=a}}return o},ss=function(r,e,t,n){const i=Fu(r,e,t,n),o=Ct(r,e),s=i&&Ct(r,i);return!!(i!=null&&i.fixed)&&!_o(r,i)&&(!e.fixed||o===N.Sticky||s===N.Sticky)},Ou=function(r,e,t){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=r.getVisibleColumns(n?null:t),o=r.getParentColumn(e);return o?r.isFirstColumn(e,t,!0)&&ss(r,o,r.getVisibleColumns(0),0):ss(r,e,i,t)},ol=function(r){const e={};return f(r.left)&&(e.left=`${r.left}px`),f(r.right)&&(e.right=`${r.right}px`),e},Du=function(r,e,t){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=arguments.length>4?arguments[4]:void 0;return nl(r,e,t,n,!1,i)},Pu=function(r,e,t){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=arguments.length>4?arguments[4]:void 0;return nl(r,e,t,n,!0,i)},sl=function(r,e,t){return!(f(r.isLeftBoundary)||f(r.isRightBoundary))&&!!e&&!!t&&e.fixed!==t.fixed},rl=function(r){r.filterOperations=r.defaultFilterOperations};let Au=1;const qn=function(r,e,t,n){let i={};if(e){U(e)&&(e={dataField:e}),r.setName(e);let o={};if(e.command)o=Ne(i,e);else{i=r.getCommonSettings(e),t&&t.name&&t.dataField&&(e=y({},e,{dataField:t.dataField}));const s=r._createCalculatedColumnOptions(e,n);e.type||(o={headerId:"dx-col-"+Au++}),o=Ne(o,Ru,!1,!0),Ne(o,i,!1,!0),Ne(o,s,!1,!0),Ne(o,e,!1,!0),Ne(o,{selector:null},!1,!0)}return e.filterOperations===e.defaultFilterOperations&&rl(o),o}},Qe=function(r,e,t,n){let i=[];return e&&b(e,(o,s)=>{const l=(n??0)+i.length,a=r._columnsUserState&&xo(s,r._columnsUserState[l])&&r._columnsUserState[l],d=qn(r,s,a,t);d&&(t&&(d.ownerBand=t),i.push(d),d.columns&&(i=i.concat(Qe(r,d.columns,d,i.length)),delete d.columns,d.hasColumns=!0))}),i},De=function(r,e){const t=[];let n=e[r];for(;n;)t.unshift(n),r=n.index,n=e[r];return t},ll=function(r,e,t){let n=[];const i=e[r];if(i)for(let o=0;o<i.length;o++){const s=i[o];(!f(s.groupIndex)||s.showWhenGrouped)&&(n.push(s),t&&s.isBand&&(n=n.concat(ll(s.index,e,t))))}return n},ku=function(r,e){let t,n;const i=r.getBandColumnsCache(),o=function(s){const l=t?t.index:void 0;return s.ownerBand===l};if(i.isPlain)t=r._columns[e[0]];else{n=r._columns.filter(o);for(let s=0;s<e.length;s++)t=n[e[s]],t&&(n=r._columns.filter(o))}return t},Bu=function(r,e){let t=[],n;const i=r.getBandColumnsCache(),o=function(s){return s.ownerBand===e.ownerBand};if(i.isPlain){const s=r._columns.indexOf(e);s>=0&&(t=[`columns[${s}]`])}else for(n=r._columns.filter(o);n.length&&n.indexOf(e)!==-1;)t.unshift(`columns[${n.indexOf(e)}]`),e=i.columnParentByIndex[e.index],n=e?r._columns.filter(o):[];return t.join(".")},al=function(r,e){let t=0;const n=r.getChildrenByBandColumn(e,!0);return b(n,(i,o)=>{o.isBand?(o.colspan=o.colspan||al(r,o.index),t+=o.colspan||1):t+=1}),t},Mu=function(r,e,t){let n;for(let i=0;i<e.length;i++){const o=e[i];(o.visible||o.command)&&(o.isBand&&(o.colspan=o.colspan||al(r,o.index)),(!o.isBand||!o.colspan)&&(n=r.getRowCount(),!o.command&&(!f(o.groupIndex)||o.showWhenGrouped)&&(n-=De(o.index,t.columnParentByIndex).length),n>1&&(o.rowspan=n)))}},gi=function(r){let e=ud(r);return e!=="string"&&e!=="boolean"&&e!=="number"&&e!=="date"&&e!=="object"&&(e=void 0),e},rs=function(r,e){switch(r){case"date":case"datetime":return Fn.getDateSerializationFormat(e);case"number":if(U(e))return"string";if(Ae(e))return null}},ls=function(r,e){r.deserializeValue||(v.isDateType(e)&&(r.deserializeValue=function(t){return Fn.deserializeDate(t)},r.serializeValue=function(t){return U(t)?t:Fn.serializeDate(t,this.serializationFormat)}),e==="number"&&(r.deserializeValue=function(t){const n=parseFloat(t);return isNaN(n)?t:n},r.serializeValue=function(t,n){return n==="filter"?t:f(t)&&this.serializationFormat==="string"?t.toString():t}))},Nu=function(r,e){switch(r){case"number":return"right";case"boolean":return"center";default:return Zt(e)}},Lu=function(r){return r.value===!0?this.trueText||"true":r.value===!1?this.falseText||"false":r.valueText||""},as=function(r){if(r==="boolean")return Lu},Hu=function(r,e){const t=r._getFirstItems(e);let n;const i={},o=[];for(let s=0;s<t.length;s++)if(t[s])for(n in t[s])(!X(t[s][n])||ao.isWrapped(t[s][n]))&&(i[n]=!0);for(n in i)if(n.indexOf("__")!==0){const s=qn(r,n);o.push(s)}return o},dl=function(r){b(r._columns,(e,t)=>{t.index=e}),b(r._columns,(e,t)=>{Y(t.ownerBand)&&(t.ownerBand=t.ownerBand.index)}),b(r._commandColumns,(e,t)=>{t.index=-(e+1)})},ul=function(r,e){Vn(r._columns,"groupIndex",e,t=>{const{grouped:n}=t;return delete t.grouped,n})},zu=function(r,e){b(r._columns,(t,n)=>{f(n.sortIndex)&&!Bn(n.sortOrder)&&delete n.sortIndex}),Vn(r._columns,"sortIndex",e,t=>!f(t.groupIndex)&&Bn(t.sortOrder))},Wu=function(r,e){let t;const n=[],i=r.getBandColumnsCache(),o=[],s=r._columns.filter(l=>!l.command);for(let l=0;l<s.length;l++)t=s[l],De(l,i.columnParentByIndex).length?o.push(t):n.push(t);Vn(o,"visibleIndex",e),Vn(n,"visibleIndex",e)},mi=function(r,e,t){const n=Y(e)?e.rowIndex:null,i=t===ut?r.getGroupColumns():t===ct?r.getChooserColumns():r.getVisibleColumns(n);let o;return e=Y(e)?e.columnIndex:e,o=i[e],o&&o.type===Ge&&(o=r._columns.filter(s=>o.type===s.type)[0]||o),o&&f(o.index)?o.index:-1},$u=function(r,e,t){const n=r.getGroupColumns();let i;if(t>=0)for(i=0;i<n.length;i++)n[i].groupIndex>=t&&n[i].groupIndex++;else for(t=0,i=0;i<n.length;i++)t=Math.max(t,n[i].groupIndex+1);return t};function xo(r,e){return r&&e&&e.name===(r.name||r.dataField)&&(e.dataField===r.dataField||r.name)}const ds=function(r){const e=r._columnsUserState,t=r._ignoreColumnOptionNames||[],n=r._columns,i={};let o=[],s=!0;const l=[];let a,d,u;function c(p,m){if(m)for(let C=0;C<kn.length;C++){const w=kn[C];t.includes(w)||(w==="dataType"?p[w]=p[w]||m[w]:tl.includes(w)?w in m&&(p[w]=m[w]):(w==="selectedFilterOperation"&&m[w]&&(p.defaultSelectedFilterOperation=p[w]||null),p[w]=m[w]))}}function h(p,m){const C=m.name||m.dataField;let w=i[C]||0;for(let S=0;S<p.length;S++)if(xo(m,p[S]))if(w)w--;else return i[C]=i[C]||0,i[C]++,S;return-1}if(e){for(u=0;u<n.length;u++)d=h(e,n[u]),s=s&&d>=0,l.push(d);for(u=0;u<n.length;u++)a=n[u],d=l[u],(r._hasUserState||s)&&c(a,e[d]),d>=0&&f(e[d].initialIndex)?o[d]=a:o.push(a);let p=!1;for(u=0;u<e.length;u++){const m=e[u];m.added&&h(n,m)<0&&(a=qn(r,m.added),c(a,m),o.push(a),m.added.columns&&(p=!0))}p&&(dl(r),o=Qe(r,o)),ht(r,o)}},Ye=function(r,e){dl(r),ul(r,e),zu(r,e),hl(r),Wu(r,e)},Xn=function(r){r.resetColumnsCache()};function ht(r,e){r._previousColumns=r._columns,r._columns=e,Xn(r),r.updateColumnDataTypes()}const be=function(r,e,t,n){const i=r._columnChanges||{optionNames:{length:0},changeTypes:{length:0},columnIndex:n};t=t||"all",t=t.split(".")[0];const{changeTypes:o}=i;e&&!o[e]&&(o[e]=!0,o.length++);const{optionNames:s}=i;t&&!s[t]&&(s[t]=!0,s.length++),(n===void 0||n!==i.columnIndex)&&(f(n)&&(i.columnIndices??(i.columnIndices=[]),f(i.columnIndex)&&i.columnIndices.push(i.columnIndex),i.columnIndices.push(n)),delete i.columnIndex),r._columnChanges=i,Xn(r)},It=function(r){const e=r.option("onColumnsChanging"),t=r._columnChanges,n=["dataField","lookup","dataType","columns"];r.isInitialized()&&!r._updateLockCount&&t&&(e&&(r._updateLockCount++,e(y({component:r.component},t)),r._updateLockCount--),r._columnChanges=void 0,i=t.optionNames,i&&n.some(o=>i[o])?(r._reinitAfterLookupChanges=t==null?void 0:t.optionNames.lookup,r.reinit(),r._reinitAfterLookupChanges=void 0):r.columnsChanged.fire(t));var i},Gu=function(r,e,t,n){const i=n>=0;if(t>=0)i||(e.lastSortOrder=e.sortOrder);else{const o=r.option("sorting.mode");let s=e.lastSortOrder;o==="single"&&r._columns.some(a=>a!==e&&f(a.sortIndex))&&(s=void 0),e.sortOrder=s}},Ku=function(r,e){const{value:t}=e,{optionName:n}=e,{prevValue:i}=e,{fullOptionName:o}=e,s=`${o}.${n}`;!Iu[n]&&r._skipProcessingColumnsChange!==s&&(r._skipProcessingColumnsChange=s,r.component._notifyOptionChanged(s,t,i),r._skipProcessingColumnsChange=!1)},fi=function(r,e,t,n,i){const o=ce(t),s=e.index;let l,a,d;if(arguments.length===3)return o(e,{functionsAsIs:!0});const u=o(e,{functionsAsIs:!0});if(!G(u,n,{maxDepth:5})){t==="groupIndex"||t==="calculateGroupValue"?(a="grouping",Gu(r,e,n,u)):t==="sortIndex"||t==="sortOrder"||t==="calculateSortValue"?a="sorting":a="columns";const c=cd(t);c(e,n,{functionsAsIs:!0});const h=Bu(r,e);Vu[t]&&(Ye(r,e),n=o(e)),(t==="name"||t==="allowEditing")&&r._checkColumns(),!f(u)&&!f(n)&&t.indexOf("buffer")!==0&&(i=!0),i?Xn(r):(!kn.includes(t)&&t!=="visibleWidth"&&(l=r.option("columns"),d=r.getColumnByPath(h,l),U(d)&&(d=l[s]={dataField:d}),d&&xo(d,e)&&c(d,n,{functionsAsIs:!0})),be(r,a,t,s)),h&&Ku(r,{fullOptionName:h,optionName:t,value:n,prevValue:u})}};function Bn(r){return r==="asc"||r==="desc"}const Uu=function(r){const e=r._getExpandColumnOptions();r.addCommandColumn(e)},ju=function(r,e){if(!this.dataField)return;const t=this.dataField.split("."),n=t.length-1;this.serializeValue&&(e=this.serializeValue(e));for(let i=0;i<n;i++){const o=t[i];r=r[o]=r[o]||{}}r[t[n]]=e},cl=function(r,e,t){const n=[];return e=e||0,r[e]&&b(r[e],(i,o)=>{(o.ownerBand===t||o.type===Ge)&&(!o.isBand||!o.colspan?(!o.command||e<1)&&n.push(o):n.push.apply(n,cl(r,e+1,o.index)))}),n},qu=function(r){let e=1;const t=r.getBandColumnsCache(),{columnParentByIndex:n}=t;return r._columns.forEach(i=>{const o=De(i.index,n),s=o.filter(l=>!l.visible);i.visible&&!s.length&&(e=Math.max(e,o.length+1))}),e},us=function(r,e){const t=r.option("rtlEnabled");return e.command&&!v.isCustomCommandColumn(r._columns,e)||!e.fixedPosition?t?"right":"left":e.fixedPosition},cs=function(r,e,t,n){let i;const o=this.getRowCount();let s=r[n]&&r[n].rowspan,l=e.filter(a=>a.type===t);return r.forEach((a,d)=>{a.type===t&&(i=d,s=r[d+1]?r[d+1].rowspan:o)}),s>1&&(l=zn(l,a=>y({},a,{rowspan:s}))),l.unshift.apply(l,f(i)?[i,1]:[n,0]),r.splice.apply(r,l),s||1},Xu=function(r){let e;for(e=0;r>1;e++)r/=10;return e},hs=function(r,e){let t=r?r.toString():"0";for(;t.length<e;)t=`0${t}`;return t},ps=(r,e,t,n)=>{let i,o,s=e.slice().map(c=>y({},c));const l=r._isColumnFixing();let a=t.slice().map(c=>y({fixed:l},c));const d=c=>t.reduce((h,p,m)=>{const C=n&&c.type===Ge?"expand":c.type;return p.type===C||p.command===c.command?m:h},-1),u=c=>c.command!==t[o].command;for(let c=0;c<e.length;c++)if(i=e[c],o=i&&(i.type||i.command)?d(i):-1,o>=0)if(n)s[c]=y({fixed:l},t[o],i),i.type!==Ge&&(a=a.filter(u));else{const h={visibleIndex:i.visibleIndex,index:i.index,headerId:i.headerId,allowFixing:i.groupIndex===0,allowReordering:i.groupIndex===0,groupIndex:i.groupIndex};s[c]=y({},i,t[o],i.type===Ge&&h)}return e.length&&n&&a.length&&(s=s.concat(a)),s},gs=(r,e)=>f(e.fixed)||!e.type?e.fixed&&e.fixedPosition!==N.Sticky:r._isColumnFixing(),Yu=r=>{r.forEach(e=>{f(e.ownerBand)&&(e.ownerBand=r[e.ownerBand])})},hl=r=>{r._bandColumnsCache=void 0},ms=(r,e)=>{const t=U(e)&&e.substr(0,e.indexOf(":"));let n;if(e!==void 0)return t&&(e=e.substr(t.length+1)),t?n=r.filter(i=>`${i[t]}`===e)[0]:["index","name","dataField","caption"].some(i=>(n=r.filter(o=>o[i]===e)[0],!!n)),n},Qu=(r,e)=>{if(e!=="asc"&&e!=="desc")return r;const t=e==="asc"?1:-1;return r.sort((n,i)=>{const o=n.caption||"",s=i.caption||"";return t*o.localeCompare(s)}),r},Ju=function(r,e){const t=ri.parse(r);if(Ae(t)){const n=ri.format(t,e),i=ri.format(t,"decimal");if(n===r||i===r)return t}},Zu=function(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=arguments.length>4?arguments[4]:void 0;return e.every((o,s)=>t&&s===0||pl(r,o,s,t,n,i))},pl=function(r,e,t){var n,i;let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,l=arguments.length>5?arguments[5]:void 0;const a=e.index,d=(u=t,r.getVisibleColumns(u).filter(h=>{let p=!0;return h.visibleWidth===Co?!1:(o&&e?p&&(p=h.ownerBand===e.ownerBand):l&&p&&(p=h.fixed&&Ct(r,h)===l),p)}));var u;const c=r.getVisibleIndex(a,t);return s?c===r.getVisibleIndex((n=d[d.length-1])===null||n===void 0?void 0:n.index,t):c===r.getVisibleIndex((i=d[0])===null||i===void 0?void 0:i.index,t)},fs=function(r,e,t){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,o=arguments.length>5?arguments[5]:void 0;const s=e.index,l=r.getBandColumnsCache(),a=De(s,l.columnParentByIndex);return a!=null&&a.length?Zu(r,a.concat([e]),n,i,o):n||pl(r,e,t,n,i,o)};class ec extends L.Controller{init(e){this._dataController=this.getController("data"),this._focusController=this.getController("focus"),this._stateStoringController=this.getController("stateStoring");const t=this.option("columns");this._commandColumns=this._commandColumns||[],this._columns=this._columns||[],this._isColumnsFromOptions=!!t,this._isColumnsFromOptions?(ht(this,t?Qe(this,t):[]),ds(this)):ht(this,this._columnsUserState?Qe(this,this._columnsUserState):this._columns),Uu(this),this._dataSourceApplied?this.applyDataSource(this._dataSource,!0,e):Ye(this),this._checkColumns()}_getExpandColumnOptions(){return{type:"expand",command:"expand",width:"auto",cssClass:Eu,allowEditing:!1,allowGrouping:!1,allowSorting:!1,allowResizing:!1,allowReordering:!1,allowHiding:!1}}_getFirstItems(e){let t,n=[];const i=function(o,s){if(!o||!s)return o;for(let l=0;l<o.length;l++){const a=i(o[l].items||o[l].collapsedItems,s-1);if(a&&a.length)return a}};return e&&e.items().length>0&&(t=v.normalizeSortingInfo(e.group()).length,n=i(e.items(),t)||[]),n}_endUpdateCore(){!this._skipProcessingColumnsChange&&It(this)}callbackNames(){return["columnsChanged"]}getColumnByPath(e,t){const n=this;let i;const o=[];return e.replace(pi,(s,l)=>(o.push(parseInt(l)),"")),o.length&&(t?i=o.reduce((s,l)=>s&&s.columns&&s.columns[l],{columns:t}):i=ku(n,o)),i}optionChanged(e){let t;switch(e.name){case"adaptColumnWidthByRatio":e.handled=!0;break;case"dataSource":e.value!==e.previousValue&&!this.option("columns")&&(!Array.isArray(e.value)||!Array.isArray(e.previousValue))&&(this._columns=[]);break;case"columns":t=this._skipProcessingColumnsChange,e.handled=!0,this._skipProcessingColumnsChange||(e.name===e.fullName?(this._columnsUserState=null,this._ignoreColumnOptionNames=null,this.init()):(this._columnOptionChanged(e),t=!0)),t&&this._updateRequireResize(e);break;case"commonColumnSettings":case"columnAutoWidth":case"allowColumnResizing":case"allowColumnReordering":case"columnFixing":case"grouping":case"groupPanel":case"regenerateColumnsByVisibleItems":case"customizeColumns":case"columnHidingEnabled":case"dateSerializationFormat":case"columnResizingMode":case"columnMinWidth":case"columnWidth":{e.handled=!0;const n=e.fullName==="columnWidth"&&["width"];this.reinit(n);break}case"rtlEnabled":this.reinit();break;default:super.optionChanged(e)}}_columnOptionChanged(e){let t={};const n=this.getColumnByPath(e.fullName),i=e.fullName.replace(pi,"");n&&(i?t[i]=e.value:t=e.value,this._skipProcessingColumnsChange=e.fullName,this.columnOption(n.index,t),this._skipProcessingColumnsChange=!1)}_updateRequireResize(e){const{component:t}=this;e.fullName.replace(pi,"")==="width"&&t._updateLockCount&&(t._requireResize=!0)}publicMethods(){return["addColumn","deleteColumn","columnOption","columnCount","clearSorting","clearGrouping","getVisibleColumns","getVisibleColumnIndex"]}applyDataSource(e,t,n){const i=this,o=e&&e.isLoaded();if(i._dataSource=e,!i._dataSourceApplied||i._dataSourceColumnsCount===0||t||i.option("regenerateColumnsByVisibleItems")){if(o){if(!i._isColumnsFromOptions){const s=Hu(i,e);s.length&&(ht(i,s),i._dataSourceColumnsCount=i._columns.length,ds(i))}return i.updateColumns(e,t,n)}i._dataSourceApplied=!1,Ye(i)}else if(o&&!i.isAllDataTypesDefined(!0)&&i.updateColumnDataTypes(e))return be(i,"columns"),It(i),new E().reject().promise()}reset(){this._dataSource=null,this._dataSourceApplied=!1,this._dataSourceColumnsCount=void 0,this.reinit()}resetColumnsCache(){this._visibleColumns=void 0,this._fixedColumns=void 0,this._rowCount=void 0,hl(this)}reinit(e){this._columnsUserState=this.getUserState(),this._ignoreColumnOptionNames=e||null,this.init(),e&&(this._ignoreColumnOptionNames=null)}isInitialized(){return!!this._columns.length||!!this.option("columns")}isDataSourceApplied(){return this._dataSourceApplied}getCommonSettings(e){const t=(!e||!e.type)&&this.option("commonColumnSettings")||{},n=this.option("grouping")??{},i=this.option("groupPanel")??{};return y({allowFixing:this.option("columnFixing.enabled"),allowResizing:this.option("allowColumnResizing")||void 0,allowReordering:this.option("allowColumnReordering"),minWidth:this.option("columnMinWidth"),width:this.option("columnWidth"),autoExpandGroup:n.autoExpandAll,allowCollapsing:n.allowCollapsing,allowGrouping:i.allowColumnDragging&&i.visible||n.contextMenuEnabled},t)}isColumnOptionUsed(e){for(let t=0;t<this._columns.length;t++)if(this._columns[t][e])return!0}isAllDataTypesDefined(e){const t=this._columns;if(!t.length)return!1;for(let n=0;n<t.length;n++)if(!(!t[n].dataField&&t[n].calculateCellValue===t[n].defaultCalculateCellValue)&&(!t[n].dataType||e&&t[n].deserializeValue&&t[n].serializationFormat===void 0))return!1;return!0}getColumns(){return this._columns}isBandColumnsUsed(){return this.getColumns().some(e=>e.isBand)}getGroupColumns(){const e=[];return b(this._columns,function(){const t=this;f(t.groupIndex)&&(e[t.groupIndex]=t)}),e}_shouldReturnVisibleColumns(){return!0}_compileVisibleColumns(e){return this._visibleColumns=this._visibleColumns||this._compileVisibleColumnsCore(),e=f(e)?e:this._visibleColumns.length-1,this._visibleColumns[e]||[]}getVisibleColumns(e,t){return this._shouldReturnVisibleColumns()?this._compileVisibleColumns.apply(this,arguments):[]}getFixedColumns(e){return this._fixedColumns=this._fixedColumns||this._getFixedColumnsCore(),e=f(e)?e:this._fixedColumns.length-1,this._fixedColumns[e]||[]}getFilteringColumns(){return this.getColumns().filter(e=>(e.dataField||e.name)&&(e.allowFiltering||e.allowHeaderFiltering)).map(e=>{const t=y(!0,{},e);return f(t.dataField)||(t.dataField=t.name),t.filterOperations=e.filterOperations!==e.defaultFilterOperations?t.filterOperations:null,t})}getColumnIndexOffset(){return 0}getStickyColumns(e){return this.getVisibleColumns(e,!0).filter(n=>n.fixed)}_getFixedColumnsCore(){const e=this,t=[],n=e.getRowCount(),i=e._isColumnFixing(),o={command:"transparent"};let s=0,l,a,d;if(i)for(let u=0;u<=n;u++){l=0,d=null,a=null;const c=e.getVisibleColumns(u,!0);for(let h=0;h<c.length;h++){const p=c[h-1],m=c[h];!m.fixed||m.fixedPosition===N.Sticky?(u===0&&(m.isBand&&m.colspan?s+=m.colspan:s++),l++,f(a)||(a=h)):p&&p.fixed&&us(e,p)!==us(e,m)?f(a)||(a=h):d=m.fixedPosition}if(u===0&&(l===0||l>=c.length))return[];f(a)||(a=d==="right"?0:c.length),t[u]=c.slice(0),o.colspan||(o.colspan=s),t[u].splice(a,l,o)}return t.map(u=>u.map(c=>{const h=A({},c);return h.headerId&&(h.headerId+="-fixed"),h}))}_isColumnFixing(){let e=this.option("columnFixing.enabled");return!e&&b(this._columns,(t,n)=>{if(n.fixed)return e=!0,!1}),e}_getExpandColumnsCore(){return this.getGroupColumns()}getExpandColumns(){let e=this._getExpandColumnsCore(),t;const n=e.filter(l=>l.groupIndex===0)[0],i=n&&n.fixed,o=this._isColumnFixing(),s=this.option("rtlEnabled");return e.length&&(t=this.columnOption("command:expand")),e=zn(e,l=>y({},l,{visibleWidth:null,minWidth:null,cellTemplate:f(l.groupIndex)?null:l.cellTemplate,headerCellTemplate:null,fixed:!f(l.groupIndex)||!i?o:!0,fixedPosition:s?"right":"left"},t,{index:l.index,type:l.type||Ge})),e}getBandColumnsCache(){if(!this._bandColumnsCache){const e=this._columns,t={},n={};let i=!0;e.forEach(o=>{const{ownerBand:s}=o;let l=Y(s)?s.index:s;const a=e[l];o.hasColumns&&(i=!1),o.colspan&&(o.colspan=void 0),o.rowspan&&(o.rowspan=void 0),a?n[o.index]=a:l=-1,t[l]=t[l]||[],t[l].push(o)}),this._bandColumnsCache={isPlain:i,columnChildrenByIndex:t,columnParentByIndex:n}}return this._bandColumnsCache}_isColumnVisible(e){return e.visible&&this.isParentColumnVisible(e.index)}_isColumnInGroupPanel(e){return f(e.groupIndex)&&!e.showWhenGrouped}hasVisibleDataColumns(){return this._columns.some(t=>{const n=this._isColumnVisible(t),i=this._isColumnInGroupPanel(t),o=!!t.command;return n&&!i&&!o})}_compileVisibleColumnsCore(){const e=this.getBandColumnsCache(),t=ps(this,this._columns,this._commandColumns,!0);Mu(this,t,e);const n=this._getIndexedColumns(t),i=this._getVisibleColumnsFromIndexed(n);return!this.hasVisibleDataColumns()&&this._columns.length&&i[i.length-1].push({command:"empty"}),i}_getIndexedColumns(e){const t=this.option("rtlEnabled"),n=this.getRowCount(),i=Xu(e.length),o=this.getBandColumnsCache(),s=[],l=[];for(let a=0;a<n;a+=1)l[a]=[{}],s[a]=[{},{},{}];return e.forEach(a=>{let{visibleIndex:d}=a,u;const c=De(a.index,o.columnParentByIndex),h=this._isColumnVisible(a),p=this._isColumnInGroupPanel(a);if(h&&!p){const w=c.length;if(d<0)d=-d,u=l[w];else{var m,C;if(a.fixed=((m=c[0])===null||m===void 0?void 0:m.fixed)??a.fixed,a.fixedPosition=((C=c[0])===null||C===void 0?void 0:C.fixedPosition)??a.fixedPosition,a.fixed&&a.fixedPosition!==N.Sticky){const S=!!a.command&&!v.isCustomCommandColumn(this._columns,a);let V=a.fixedPosition==="right";t&&!S&&(V=!V),u=V?s[w][2]:s[w][0]}else u=s[w][1]}if(c.length){d=hs(d,i);for(let S=c.length-1;S>=0;S-=1)d=hs(c[S].visibleIndex,i)+d}u[d]=u[d]||[],u[d].push(a)}}),{positiveIndexedColumns:s,negativeIndexedColumns:l}}_getVisibleColumnsFromIndexed(e){let{positiveIndexedColumns:t,negativeIndexedColumns:n}=e;const i=[],o=this.getRowCount(),s=ps(this,this.getExpandColumns(),this._columns);let l=0,a=0;for(let d=0;d<o;d+=1){i.push([]),zo(n[d],(h,p)=>{i[d].unshift.apply(i[d],p)});const u=i[d].length;t[d].forEach(h=>{zo(h,(p,m)=>{i[d].push.apply(i[d],m)})}),a<=d&&(a+=cs.call(this,i[d],s,Su,u)),l<=d&&(l+=cs.call(this,i[d],s,Ge,u))}return i.push(cl(i)),i}getInvisibleColumns(e,t){const n=this;let i=[],o;return e=e||n._columns,b(e,(s,l)=>{if(l.ownerBand===t){if(l.isBand){l.visible?o=n.getInvisibleColumns(n.getChildrenByBandColumn(l.index),l.index):o=n.getChildrenByBandColumn(l.index),o.length&&(i.push(l),i=i.concat(o));return}l.visible||i.push(l)}}),i}getChooserColumns(e){const n=(e?this.getColumns():this.getInvisibleColumns()).filter(o=>o.showInColumnChooser),i=this.option("columnChooser.sortOrder");return Qu(n,i)}allowMoveColumn(e,t,n,i){const o=mi(this,e,n),s=this._columns[o];return s&&(s.allowReordering||s.allowGrouping||s.allowHiding)?n===i?n===ct?!1:(e=Y(e)?e.columnIndex:e,t=Y(t)?t.columnIndex:t,e!==t&&e+1!==t):n===ut&&i!==ct||i===ut?s&&s.allowGrouping:n===ct||i===ct?s&&s.allowHiding:!0:!1}moveColumn(e,t,n,i){const o=this,s={};let l;const a=mi(o,e,n),d=mi(o,t,i);let u;if(a>=0){const c=o._columns[a];if(t=Y(t)?t.columnIndex:t,u=d>=0?o._columns[d].groupIndex:-1,f(c.groupIndex)&&n===ut&&(u>c.groupIndex&&u--,i!==ut?s.groupIndex=void 0:(l=c.groupIndex,delete c.groupIndex,ul(o))),i===ut)s.groupIndex=$u(o,c,u),c.groupIndex=l;else if(t>=0){const p=o._columns[d];!p||c.ownerBand!==p.ownerBand||gs(o,c)^gs(o,p)?s.visibleIndex=ns:s.visibleIndex=p.visibleIndex}const h=i!==ct;c.visible!==h&&(s.visible=h),o.columnOption(c.index,s)}}changeSortOrder(e,t){const n=this,i={},o=n.option("sorting"),s=o&&o.mode,l=s==="single"||!t,a=s==="single"||s==="multiple",d=n._columns[e];a&&d&&d.allowSorting&&(l&&!f(d.groupIndex)&&b(n._columns,function(u){u!==e&&this.sortOrder&&(f(this.groupIndex)||delete this.sortOrder,delete this.sortIndex)}),Bn(t)?d.sortOrder!==t&&(i.sortOrder=t):t==="none"?d.sortOrder&&(i.sortIndex=void 0,i.sortOrder=void 0):function(u){if(t==="ctrl"){if(!("sortOrder"in u&&"sortIndex"in u))return!1;i.sortOrder=void 0,i.sortIndex=void 0}else f(u.groupIndex)||f(u.sortIndex)?i.sortOrder=u.sortOrder==="desc"?"asc":"desc":i.sortOrder="asc";return!0}(d)),n.columnOption(d.index,i)}getSortDataSourceParameters(e){const t=[],n=[];return b(this._columns,function(){(this.dataField||this.selector||this.calculateCellValue)&&f(this.sortIndex)&&!f(this.groupIndex)&&(t[this.sortIndex]=this)}),b(t,function(){const i=this&&this.sortOrder;if(Bn(i)){const o={selector:this.calculateSortValue||this.displayField||this.calculateDisplayValue||e&&this.selector||this.dataField||this.calculateCellValue,desc:this.sortOrder==="desc"};this.sortingMethod&&(o.compare=this.sortingMethod.bind(this)),n.push(o)}}),n.length>0?n:null}getGroupDataSourceParameters(e){const t=[];return b(this.getGroupColumns(),function(){const n=this.calculateGroupValue||this.displayField||this.calculateDisplayValue||e&&this.selector||this.dataField||this.calculateCellValue;if(n){const i={selector:n,desc:this.sortOrder==="desc",isExpanded:!!this.autoExpandGroup};this.sortingMethod&&(i.compare=this.sortingMethod.bind(this)),t.push(i)}}),t.length>0?t:null}refresh(e){const t=[];return b(this._columns,function(){const{lookup:n}=this;if(n&&!this.calculateDisplayValue){if(e&&n.valueMap)return;n.update&&t.push(n.update())}}),F.apply(g,t).done(Xn.bind(null,this))}_updateColumnOptions(e,t){var n,i;const o=this._reinitAfterLookupChanges&&((n=this._previousColumns)===null||n===void 0?void 0:n[t]);e.selector=e.selector??(a=>e.calculateCellValue(a)),e.selector.columnIndex=t,e.selector.originalCallback=o?((i=this._previousColumns[t].selector)===null||i===void 0?void 0:i.originalCallback)??e.selector:e.selector,b(["calculateSortValue","calculateGroupValue","calculateDisplayValue"],(a,d)=>{const u=e[d];if(X(u))if(u.originalCallback)e[d].context.column=e;else{const c={column:e};e[d]=function(h){return u.call(c.column,h)},e[d].originalCallback=u,e[d].columnIndex=t,e[d].context=c}}),U(e.calculateDisplayValue)&&(e.displayField=e.calculateDisplayValue,e.calculateDisplayValue=ce(e.displayField)),e.calculateDisplayValue&&(e.displayValueMap=e.displayValueMap||{}),ls(e,e.dataType);const{lookup:s}=e;s&&ls(s,s.dataType);const l=s?s.dataType:e.dataType;l&&(e.alignment=e.alignment||Nu(l,this.option("rtlEnabled")),e.format=e.format||v.getFormatByDataType(l),e.customizeText=e.customizeText||as(l),e.defaultFilterOperations=e.defaultFilterOperations||!s&&Tu[l]||[],f(e.filterOperations)||rl(e),e.defaultFilterOperation=e.filterOperations&&e.filterOperations[0]||"=",e.showEditorAlways=f(e.showEditorAlways)?e.showEditorAlways:l==="boolean"&&!e.cellTemplate&&!e.lookup)}updateColumnDataTypes(e){const t=this,n=t.option("dateSerializationFormat"),i=t._getFirstItems(e);let o=!1;return b(t._columns,(s,l)=>{let a,d,u,c,h;const{lookup:p}=l;if(v.isDateType(l.dataType)&&l.serializationFormat===void 0&&(l.serializationFormat=n),p&&v.isDateType(p.dataType)&&l.serializationFormat===void 0&&(p.serializationFormat=n),l.calculateCellValue&&i.length){if(!l.dataType||p&&!p.dataType){for(a=0;a<i.length;a++)d=l.calculateCellValue(i[a]),l.dataType||(h=gi(d),u=u||h,u&&h&&u!==h&&(u="string")),p&&!p.dataType&&(h=gi(v.getDisplayValue(l,d,i[a])),c=c||h,c&&h&&c!==h&&(c="string"));(u||c)&&(u&&(l.dataType=u),p&&c&&(p.dataType=c),o=!0)}if(l.serializationFormat===void 0||p&&p.serializationFormat===void 0)for(a=0;a<i.length;a++)d=l.calculateCellValue(i[a],!0),l.serializationFormat===void 0&&(l.serializationFormat=rs(l.dataType,d)),p&&p.serializationFormat===void 0&&(p.serializationFormat=rs(p.dataType,p.calculateCellValue(d,!0)))}t._updateColumnOptions(l,s)}),o}_customizeColumns(e){const t=this,n=t.option("customizeColumns");n&&(e.some(o=>Y(o.ownerBand))&&Ye(t),n(e),ht(t,Qe(t,e)))}updateColumns(e,t,n){if(t||this.updateSortingGrouping(e),!e||e.isLoaded()){const i=e?e.sort()||[]:this.getSortDataSourceParameters(),o=e?e.group()||[]:this.getGroupDataSourceParameters(),s=e==null?void 0:e.lastLoadOptions().filter;n||this._customizeColumns(this._columns),Ye(this);const l=this._columns;return F(this.refresh(!0)).always(()=>{this._columns===l&&(this._updateChanges(e,{sorting:i,grouping:o,filtering:s}),It(this))})}}_updateChanges(e,t){e&&(this.updateColumnDataTypes(e),this._dataSourceApplied=!0),v.equalSortParameters(t.sorting,this.getSortDataSourceParameters())||be(this,"sorting"),v.equalSortParameters(t.grouping,this.getGroupDataSourceParameters())||be(this,"grouping"),this._dataController&&!v.equalFilterParameters(t.filtering,this._dataController.getCombinedFilter())&&be(this,"filtering"),be(this,"columns")}updateSortingGrouping(e,t){const n=this;let i,o;const s=function(l,a,d){b(l,(u,c)=>{if(delete c[d],a)for(let h=0;h<a.length;h++){const{selector:p}=a[h],{isExpanded:m}=a[h];if(p===c.dataField||p===c.name||p===c.displayField||p===c.selector||p===c.calculateCellValue||p===c.calculateGroupValue||p===c.calculateDisplayValue){t?c.sortOrder="sortOrder"in c?c.sortOrder:a[h].desc?"desc":"asc":c.sortOrder=c.sortOrder||(a[h].desc?"desc":"asc"),m!==void 0&&(c.autoExpandGroup=m),c[d]=h;break}}})};if(e){i=v.normalizeSortingInfo(e.sort());const l=v.normalizeSortingInfo(e.group()),a=n.getGroupDataSourceParameters(),d=n.getSortDataSourceParameters(),u=!v.equalSortParameters(l,a,!0),c=!u&&!v.equalSortParameters(l,a);n._columns.length||(b(l,(h,p)=>{n._columns.push(p.selector)}),b(i,(h,p)=>{X(p.selector)||n._columns.push(p.selector)}),ht(n,Qe(n,n._columns))),(t||!a&&!n._hasUserState)&&(u||c)&&(s(n._columns,l,"groupIndex"),t&&(u&&be(n,"grouping"),c&&be(n,"groupExpanding"),o=!0)),(t||!d&&!n._hasUserState)&&!v.equalSortParameters(i,d)&&(s(n._columns,i,"sortIndex"),t&&(be(n,"sorting"),o=!0)),o&&It(n)}}updateFilter(e,t,n,i){const o=this;if(!Array.isArray(e))return e;if(e=y([],e),n=e.columnIndex!==void 0?e.columnIndex:n,i=e.filterValue!==void 0?e.filterValue:i,U(e[0])&&e[0]!=="!"){const s=o.columnOption(e[0]);t?Vr().forceIsoDateParsing&&s&&s.serializeValue&&e.length>1&&(e[e.length-1]=s.serializeValue(e[e.length-1],"filter")):s&&s.selector&&(e[0]=s.selector,e[0].columnIndex=s.index)}else X(e[0])&&(e[0].columnIndex=n,e[0].filterValue=i,e[0].selectedFilterOperation=e.selectedFilterOperation);for(let s=0;s<e.length;s++)e[s]=o.updateFilter(e[s],t,n,i);return e}columnCount(){return this._columns?this._columns.length:0}columnOption(e,t,n,i){const o=this,s=o._columns.concat(o._commandColumns),l=ms(s,e);if(l){if(arguments.length===1)return y({},l);if(U(t)){if(arguments.length===2)return fi(o,l,t);fi(o,l,t,n,i)}else Y(t)&&b(t,(a,d)=>{fi(o,l,a,d,i)});It(o)}}clearSorting(){const e=this,t=this.columnCount();e.beginUpdate();for(let n=0;n<t;n++)e.columnOption(n,"sortOrder",void 0),delete ms(e._columns,n).sortOrder;e.endUpdate()}clearGrouping(){const e=this,t=this.columnCount();e.beginUpdate();for(let n=0;n<t;n++)e.columnOption(n,"groupIndex",void 0);e.endUpdate()}getVisibleIndex(e,t){const n=this.getVisibleColumns(t);for(let i=n.length-1;i>=0;i--)if(n[i].index===e)return i;return-1}getVisibleIndexByColumn(e,t){const n=this.getVisibleColumns(t),i=n.filter(o=>o.index===e.index&&o.command===e.command)[0];return n.indexOf(i)}getVisibleColumnIndex(e,t){const n=this.columnOption(e,"index");return this.getVisibleIndex(n,t)}addColumn(e){const t=this;let n=qn(t,e);const i=t._columns.length;t._columns.push(n),n.isBand&&(t._columns=Qe(t,t._columns),n=t._columns[i]),n.added=e,Ye(t,n),t.updateColumns(t._dataSource),t._checkColumns()}deleteColumn(e){const t=this,n=t.columnOption(e);if(n&&n.index>=0){if(Yu(t._columns),t._columns.splice(n.index,1),n.isBand){const i=t.getChildrenByBandColumn(n.index).map(o=>o.index);t._columns=t._columns.filter(o=>i.indexOf(o.index)<0)}Ye(t),t.updateColumns(t._dataSource)}}addCommandColumn(e){let t=this._commandColumns.filter(n=>n.command===e.command)[0];t||(t=e,this._commandColumns.push(t))}getUserState(){const e=this._columns,t=[];let n;function i(o,s){e[n][s]!==void 0&&(t[n][s]=e[n][s])}for(n=0;n<e.length;n++)t[n]={},b(kn,i);return t}setName(e){e.name=e.name||e.dataField||e.type}setUserState(e){const t=this,n=t._dataSource;let i=t.option("stateStoring.ignoreColumnOptionNames");if(e==null||e.forEach(this.setName),!i){i=[];const o=t.getCommonSettings();t.option("columnChooser.enabled")||i.push("visible"),t.option("sorting.mode")==="none"&&i.push("sortIndex","sortOrder"),o.allowGrouping||i.push("groupIndex"),o.allowFixing||i.push("fixed","fixedPosition"),o.allowResizing||i.push("width","visibleWidth");const s=!t.option("filterPanel.visible");!t.option("filterRow.visible")&&s&&i.push("filterValue","selectedFilterOperation"),!t.option("headerFilter.visible")&&s&&i.push("filterValues","filterType")}t._columnsUserState=e,t._ignoreColumnOptionNames=i,t._hasUserState=!!e,be(t,"filtering"),t.init(!0),n&&(n.sort(t.getSortDataSourceParameters()),n.group(t.getGroupDataSourceParameters()))}_checkColumns(){const e={};let t=!1;const n=[];this._columns.forEach(i=>{var o;const{name:s}=i,l=(o=i.columns)===null||o===void 0?void 0:o.length,a=i.allowEditing&&(i.dataField||i.setCellValue)&&!l;s?(e[s]&&n.push(`"${s}"`),e[s]=!0):a&&(t=!0)}),n.length&&oe.log("E1059",n.join(", ")),t&&oe.log("E1060")}_createCalculatedColumnOptions(e,t){let n={},{dataField:i}=e;if((Array.isArray(e.columns)&&e.columns.length||e.isBand)&&(n.isBand=!0,i=null),i){if(U(i)){const o=ce(i);n={caption:Fr.captionize(i),calculateCellValue(s,l){const a=o(s);return this.deserializeValue&&!l?this.deserializeValue(a):a},setCellValue:ju,parseValue(s){const l=this;let a,d;return l.dataType==="number"?U(s)&&l.format?a=Ju(s.trim(),l.format):f(s)&&Ae(s)&&(a=Number(s)):l.dataType==="boolean"?s===l.trueText?a=!0:s===l.falseText&&(a=!1):v.isDateType(l.dataType)?(d=zi.parse(s,l.format),d&&(a=d)):a=s,a}}}n.allowFiltering=!0}else n.allowFiltering=!!e.calculateFilterExpression;return n.calculateFilterExpression=function(){return yt.defaultCalculateFilterExpression.apply(this,arguments)},n.defaultFilterOperation="=",n.createFilterExpression=function(o,s){let l;return this.calculateFilterExpression&&(l=this.calculateFilterExpression.apply(this,arguments)),X(l)&&(l=[l,"=",!0]),l&&(l.columnIndex=this.index,l.filterValue=o,l.selectedFilterOperation=s),l},(!i||!U(i))&&y(!0,n,{allowSorting:!1,allowGrouping:!1,calculateCellValue:()=>null}),t&&(n.allowFixing=!1),e.dataType&&(n.userDataType=e.dataType),e.selectedFilterOperation&&!("defaultSelectedFilterOperation"in n)&&(n.defaultSelectedFilterOperation=e.selectedFilterOperation),e.lookup&&(n.lookup={calculateCellValue(o,s){return this.valueExpr&&(o=this.valueMap&&this.valueMap[o]),this.deserializeValue&&!s?this.deserializeValue(o):o},updateValueMap(){if(this.valueMap={},this.items){const o=ce(this.valueExpr),s=ce(this.displayExpr);for(let l=0;l<this.items.length;l++){const a=this.items[l],d=s(a);this.valueMap[o(a)]=d,this.dataType=this.dataType||gi(d)}}},update(){const o=this;let{dataSource:s}=o;if(s)if(X(s)&&!ao.isWrapped(s)&&(s=s({})),en(s)||s instanceof hd||Array.isArray(s)){if(o.valueExpr){const l=Wn(s);return l.paginate=!1,s=new Kt(l),s.load().done(a=>{o.items=a,o.updateValueMap&&o.updateValueMap()})}}else oe.log("E1016");else o.updateValueMap&&o.updateValueMap()}}),n.resizedCallbacks=Le(),e.resized&&n.resizedCallbacks.add(e.resized.bind(e)),b(n,o=>{if(X(n[o])&&o.indexOf("default")!==0){const s=`default${o.charAt(0).toUpperCase()}${o.substr(1)}`;n[s]=n[o]}}),n}getRowCount(){return this._rowCount=this._rowCount||qu(this),this._rowCount}getRowIndex(e,t){const n=this._columns[e],i=this.getBandColumnsCache();return n&&(t||n.visible&&!(n.command||f(n.groupIndex)))?De(e,i.columnParentByIndex).length:0}getChildrenByBandColumn(e,t){const n=this.getBandColumnsCache(),i=ll(e,n.columnChildrenByIndex,!t);return t?i.filter(o=>o.visible&&!o.command).sort((o,s)=>o.visibleIndex-s.visibleIndex):i}getVisibleDataColumnsByBandColumn(e){const t=this.getBandColumnsCache();return this.getChildrenByBandColumn(e,t.columnChildrenByIndex).filter(i=>!i.isBand&&i.visible)}isParentBandColumn(e,t){let n=!1;const i=this._columns[e],o=this.getBandColumnsCache(),s=i&&De(e,o.columnParentByIndex);return s&&b(s,(l,a)=>{if(a.index===t)return n=!0,!1}),n}isParentColumnVisible(e){let t=!0;const n=this.getBandColumnsCache(),i=e>=0&&De(e,n.columnParentByIndex);return i&&b(i,(o,s)=>(t=t&&s.visible,t)),t}getParentColumn(e){const t=this.getBandColumnsCache();return De(e.index,t.columnParentByIndex)[0]}isFirstColumn(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3?arguments[3]:void 0;return fs(this,e,t,n,!1,i)}isLastColumn(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3?arguments[3]:void 0;return fs(this,e,t,n,!0,i)}getColumnId(e){return e.command&&e.type===Ge?v.isCustomCommandColumn(this._columns,e)?`type:${e.type}`:`command:${e.command}`:e.index}getCustomizeTextByDataType(e){return as(e)}getHeaderContentAlignment(e){return this.option("rtlEnabled")?e==="left"?"right":"left":e}isVirtualMode(){return!1}}const Cs={defaultOptions:()=>({commonColumnSettings:{allowFiltering:!0,allowHiding:!0,allowSorting:!0,allowEditing:!0,encodeHtml:!0,trueText:_.format("dxDataGrid-trueText"),falseText:_.format("dxDataGrid-falseText")},allowColumnReordering:!1,allowColumnResizing:!1,columnResizingMode:"nextColumn",columnMinWidth:void 0,columnWidth:void 0,adaptColumnWidthByRatio:!0,columns:void 0,regenerateColumnsByVisibleItems:!1,customizeColumns:null,dateSerializationFormat:void 0}),controllers:{columns:ec}};T.registerModule("columns",{defaultOptions:()=>y(!0,{},Cs.defaultOptions(),{commonColumnSettings:{allowExporting:!0}}),controllers:Cs.controllers});const _s="_dataSourceChangedHandler",ws="_getSpecificDataSourceOption",xs="_normalizeDataSource",tc=r=>class extends r{postCtor(){this.on("disposing",()=>{this._disposeDataSource()})}_refreshDataSource(){this._initDataSource(),this._loadDataSource()}_initDataSource(){let e=ws in this?this[ws]():this.option("dataSource"),t,n;this._disposeDataSource(),e&&(e instanceof Kt?(this._isSharedDataSource=!0,this._dataSource=e):(t="_dataSourceOptions"in this?this._dataSourceOptions():{},n=this._dataSourceType?this._dataSourceType():Kt,e=Wn(e,{fromUrlLoadMode:"_dataSourceFromUrlLoadMode"in this&&this._dataSourceFromUrlLoadMode()}),this._dataSource=new n(y(!0,{},t,e))),xs in this&&(this._dataSource=this[xs](this._dataSource)),this._addDataSourceHandlers(),this._initDataController())}_initDataController(){var e;const t=(e=this.option)===null||e===void 0?void 0:e.call(this,"_dataController"),n=this._dataSource;t?this._dataController=t:this._dataController=new pd(n)}_addDataSourceHandlers(){_s in this&&this._addDataSourceChangeHandler(),"_dataSourceLoadErrorHandler"in this&&this._addDataSourceLoadErrorHandler(),"_dataSourceLoadingChangedHandler"in this&&this._addDataSourceLoadingChangedHandler(),this._addReadyWatcher()}_addReadyWatcher(){this.readyWatcher=(function(e){this._ready&&this._ready(!e)}).bind(this),this._dataSource.on("loadingChanged",this.readyWatcher)}_addDataSourceChangeHandler(){const e=this._dataSource;this._proxiedDataSourceChangedHandler=(function(t){this[_s](e.items(),t)}).bind(this),e.on("changed",this._proxiedDataSourceChangedHandler)}_addDataSourceLoadErrorHandler(){this._proxiedDataSourceLoadErrorHandler=this._dataSourceLoadErrorHandler.bind(this),this._dataSource.on("loadError",this._proxiedDataSourceLoadErrorHandler)}_addDataSourceLoadingChangedHandler(){this._proxiedDataSourceLoadingChangedHandler=this._dataSourceLoadingChangedHandler.bind(this),this._dataSource.on("loadingChanged",this._proxiedDataSourceLoadingChangedHandler)}_loadDataSource(){const e=this._dataSource;e&&(e.isLoaded()?this._proxiedDataSourceChangedHandler&&this._proxiedDataSourceChangedHandler():e.load())}_loadSingle(e,t){return e=e==="this"?this._dataSource.key()||"this":e,this._dataSource.loadSingle(e,t)}_isLastPage(){return!this._dataSource||this._dataSource.isLastPage()||!this._dataSource._pageSize}_isDataSourceLoading(){return this._dataSource&&this._dataSource.isLoading()}_disposeDataSource(){this._dataSource&&(this._isSharedDataSource?(delete this._isSharedDataSource,this._proxiedDataSourceChangedHandler&&this._dataSource.off("changed",this._proxiedDataSourceChangedHandler),this._proxiedDataSourceLoadErrorHandler&&this._dataSource.off("loadError",this._proxiedDataSourceLoadErrorHandler),this._proxiedDataSourceLoadingChangedHandler&&this._dataSource.off("loadingChanged",this._proxiedDataSourceLoadingChangedHandler),this._dataSource._eventsStrategy&&this._dataSource._eventsStrategy.off("loadingChanged",this.readyWatcher)):this._dataSource.dispose(),delete this._dataSource,delete this._proxiedDataSourceChangedHandler,delete this._proxiedDataSourceLoadErrorHandler,delete this._proxiedDataSourceLoadingChangedHandler)}getDataSource(){return this._dataSource||null}},vs=function(r,e,t){const n=r._dataSource;if(n){if(t!==void 0){if(r._getPagingOptionValue(e)!==t){e==="pageSize"&&n.pageIndex(0),n[e](t),r._skipProcessingPagingChange=!0,r.option(`paging.${e}`,t),r._skipProcessingPagingChange=!1;const o=n.pageIndex();return r._isPaging=e==="pageIndex",n[e==="pageIndex"?"load":"reload"]().done(()=>{r._isPaging=!1,r.pageChanged.fire(o)})}return E().resolve().promise()}return n[e]()}return e==="pageIndex"&&t!==void 0?E().resolve().promise():0};class nc extends tc(L.Controller){init(){this._items=[],this._cachedProcessedItems=null,this._columnsController=this.getController("columns"),this._adaptiveColumnsController=this.getController("adaptiveColumns"),this._editingController=this.getController("editing"),this._editorFactoryController=this.getController("editorFactory"),this._errorHandlingController=this.getController("errorHandling"),this._filterSyncController=this.getController("filterSync"),this._applyFilterController=this.getController("applyFilter"),this._keyboardNavigationController=this.getController("keyboardNavigation"),this._focusController=this.getController("focus"),this._headerFilterController=this.getController("headerFilter"),this._selectionController=this.getController("selection"),this._stateStoringController=this.getController("stateStoring"),this._validatingController=this.getController("validating"),this._isPaging=!1,this._currentOperationTypes=null,this._dataChangedHandler=e=>{this._currentOperationTypes=this._dataSource.operationTypes(),this._handleDataChanged(e),this._currentOperationTypes=null},this._columnsChangedHandler=this._handleColumnsChanged.bind(this),this._loadingChangedHandler=this._handleLoadingChanged.bind(this),this._loadErrorHandler=this._handleLoadError.bind(this),this._customizeStoreLoadOptionsHandler=this._handleCustomizeStoreLoadOptions.bind(this),this._changingHandler=this._handleChanging.bind(this),this._dataPushedHandler=this._handleDataPushed.bind(this),this._columnsController.columnsChanged.add(this._columnsChangedHandler),this._isLoading=!1,this._isCustomLoading=!1,this._repaintChangesOnly=void 0,this._changes=[],this.createAction("onDataErrorOccurred"),this.dataErrorOccurred.add(e=>this.executeAction("onDataErrorOccurred",{error:e})),this._refreshDataSource(),this.postCtor()}_getPagingOptionValue(e){return this._dataSource[e]()}callbackNames(){return["changed","loadingChanged","dataErrorOccurred","pageChanged","dataSourceChanged","pushed"]}callbackFlags(e){if(e==="dataErrorOccurred")return{stopOnFalse:!0}}publicMethods(){return["_disposeDataSource","beginCustomLoading","byKey","clearFilter","endCustomLoading","filter","getCombinedFilter","getDataByKeys","getDataSource","getKeyByRowIndex","getRowIndexByKey","getVisibleRows","keyOf","pageCount","pageIndex","pageSize","refresh","repaintRows","totalCount"]}reset(){this._columnsController.reset(),this._items=[],this._refreshDataSource()}_handleDataSourceChange(e){if(e.value===e.previousValue||this.option("columns")&&Array.isArray(e.value)&&Array.isArray(e.previousValue)){if(e.value!==e.previousValue){const n=this.store();n&&(n._array=e.value)}return this.needToRefreshOnDataSourceChange(e)&&this.refresh(this.option("repaintChangesOnly")),!0}return!1}needToRefreshOnDataSourceChange(e){return!0}optionChanged(e){const t=this;let n,i;function o(){e.handled=!0}if(e.name==="dataSource"&&e.name===e.fullName&&this._handleDataSourceChange(e)){o();return}switch(e.name){case"cacheEnabled":case"repaintChangesOnly":case"highlightChanges":case"loadingTimeout":o();break;case"remoteOperations":case"keyExpr":case"dataSource":case"scrolling":o(),t.reset();break;case"paging":if(n=t.dataSource(),n&&(i=t._setPagingOptions(n),i)){const s=n.pageIndex();this._isPaging=i.isPageIndexChanged,n.load().done(()=>{this._isPaging=!1,t.pageChanged.fire(s)})}o();break;case"rtlEnabled":t.reset();break;case"columns":n=t.dataSource(),n&&n.isLoading()&&e.name===e.fullName&&(this._useSortingGroupingFromColumns=!0,n.load());break;default:super.optionChanged(e)}}isReady(){return!this._isLoading}getDataSource(){return this._dataSource&&this._dataSource._dataSource}getCombinedFilter(e){return this.combinedFilter(void 0,e)}combinedFilter(e,t){if(!this._dataSource)return e;let n=e??this._dataSource.filter();if(this._columnsController.isDataSourceApplied()||this._columnsController.isAllDataTypesDefined()){const s=this._calculateAdditionalFilter();n=s?v.combineFilters([s,n]):n}const o=this._dataSource.remoteOperations().filtering||t;return n=this._columnsController.updateFilter(n,o),n}waitReady(){return this._updateLockCount?(this._readyDeferred=new E,this._readyDeferred):F()}_endUpdateCore(){const e=this._changes;if(e.length){this._changes=[];const t=e.every(n=>n.repaintChangesOnly);this.updateItems(e.length===1?e[0]:{repaintChangesOnly:t})}this._readyDeferred&&(this._readyDeferred.resolve(),this._readyDeferred=null)}_handleCustomizeStoreLoadOptions(e){var t;const n=this._columnsController,i=this._dataSource,{storeLoadOptions:o}=e;e.isCustomLoading&&!o.isLoadingAll||(o.filter=this.combinedFilter(o.filter),((t=o.filter)===null||t===void 0?void 0:t.length)===1&&o.filter[0]==="!"&&(e.data=[],e.extra=e.extra||{},e.extra.totalCount=0),n.isDataSourceApplied()||n.updateColumnDataTypes(i),this._columnsUpdating=!0,n.updateSortingGrouping(i,!this._useSortingGroupingFromColumns),this._columnsUpdating=!1,o.sort=n.getSortDataSourceParameters(),o.group=n.getGroupDataSourceParameters(),i.sort(o.sort),i.group(o.group),o.sort=n.getSortDataSourceParameters(!i.remoteOperations().sorting),e.group=n.getGroupDataSourceParameters(!i.remoteOperations().grouping))}_handleColumnsChanged(e){const t=this,{changeTypes:n}=e,{optionNames:i}=e;let o,s,l;const a=function(d){var u;t._columnsController.columnsChanged.remove(a),t.updateItems({repaintChangesOnly:!1,virtualColumnsScrolling:d==null||(u=d.changeTypes)===null||u===void 0?void 0:u.virtualColumnsScrolling})};if(n.sorting||n.grouping)t._dataSource&&!t._columnsUpdating&&(t._dataSource.group(t._columnsController.getGroupDataSourceParameters()),t._dataSource.sort(t._columnsController.getSortDataSourceParameters()),t.reload());else if(n.columns&&(s=t._columnsController.columnOption(e.columnIndex,"filterValues"),(i.filterValues||i.filterType&&Array.isArray(s)||i.filterValue||i.selectedFilterOperation||i.allowFiltering)&&(o=t._columnsController.columnOption(e.columnIndex,"filterValue"),(Array.isArray(s)||e.columnIndex===void 0||f(o)||!i.selectedFilterOperation||i.filterValue)&&(t._applyFilter(),l=!0)),!t._needApplyFilter&&!v.checkChanges(i,["width","visibleWidth","filterValue","bufferedFilterValue","selectedFilterOperation","filterValues","filterType"])&&t._columnsController.columnsChanged.add(a),f(i.visible))){const d=t._columnsController.columnOption(e.columnIndex);d&&(f(d.filterValue)||f(d.filterValues))&&(t._applyFilter(),l=!0)}!l&&n.filtering&&!this._needApplyFilter&&t.reload()}_handleDataChanged(e){const t=this,n=t._dataSource,i=t._columnsController;let o=!1;this._useSortingGroupingFromColumns=!1,n&&!t._isDataSourceApplying&&(t._isDataSourceApplying=!0,F(t._columnsController.applyDataSource(n)).done(()=>{t._isLoading&&t._handleLoadingChanged(!1),o&&e&&e.isDelayed&&(e.isDelayed=!1),t._isDataSourceApplying=!1;const s=t._needApplyFilter;t._needApplyFilter=!1,s&&!t._isAllDataTypesDefined&&(()=>{const l=t._calculateAdditionalFilter();return l&&l.length})()?(oe.log("W1005",t.component.NAME),t._applyFilter()):t.updateItems(e,!0)}).fail(()=>{t._isDataSourceApplying=!1}),t._isDataSourceApplying&&(o=!0,t._handleLoadingChanged(!0)),t._needApplyFilter=!t._columnsController.isDataSourceApplied(),t._isAllDataTypesDefined=i.isAllDataTypesDefined())}_handleLoadingChanged(e){this._isLoading=e,this._fireLoadingChanged()}_handleLoadError(e){this.dataErrorOccurred.fire(e)}_handleDataPushed(e){this.pushed.fire(e)}fireError(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.dataErrorOccurred.fire(oe.Error.apply(oe,t))}_setPagingOptions(e){const t=this.option("paging.pageIndex"),n=this.option("paging.pageSize"),i=this.option("paging.enabled"),o=this.option("scrolling.mode"),s=o==="infinite",a=i||o==="virtual"||s;let d=!1,u=!1,c=!1;return e.requireTotalCount(!s),i!==void 0&&e.paginate()!==a&&(e.paginate(a),d=!0),n!==void 0&&e.pageSize()!==n&&(e.pageSize(n),u=!0),t!==void 0&&e.pageIndex()!==t&&(e.pageIndex(t),c=!0),d||u||c?{isPaginateChanged:d,isPageSizeChanged:u,isPageIndexChanged:c}:!1}_getSpecificDataSourceOption(){const e=this.option("dataSource");return Array.isArray(e)?{store:{type:"array",data:e,key:this.option("keyExpr")}}:e}_initDataSource(){const e=this,t=this._dataSource;super._initDataSource();const n=e._dataSource;if(e._useSortingGroupingFromColumns=!0,e._cachedProcessedItems=null,n){const i=e._setPagingOptions(n);this._isPaging=i==null?void 0:i.isPageIndexChanged,e.setDataSource(n)}else t&&e.updateItems()}_loadDataSource(){const e=this,t=e._dataSource,n=new E;return F(this._columnsController.refresh(!0)).always(()=>{t?t.load().done(function(){e._isPaging=!1,n.resolve.apply(n,arguments)}).fail(n.reject):n.resolve()}),n.promise()}_beforeProcessItems(e){return e.slice(0)}getRowIndexDelta(){return 0}getDataIndex(e){const t=this._items,n=e.changeType==="append"&&t.length>0?t[t.length-1]:null;return f(n==null?void 0:n.dataIndex)?n.dataIndex+1:0}_processItems(e,t){const n=this,i=n.getRowIndexDelta(),{changeType:o}=t,s=n._columnsController.getVisibleColumns(null,o==="loadingAll"),l=this.getDataIndex(t),a={visibleColumns:s,dataIndex:l},d=[];return b(e,(u,c)=>{f(c)&&(a.rowIndex=u-i,c=n._processItem(c,a),d.push(c))}),d}_processItem(e,t){return e=this._generateDataItem(e,t),e=this._processDataItem(e,t),e.dataIndex=t.dataIndex++,e}_generateDataItem(e,t){return{rowType:"data",data:e,key:this.keyOf(e)}}_processDataItem(e,t){return e.values=this.generateDataValues(e.data,t.visibleColumns),e}generateDataValues(e,t,n){const i=[];let o;for(let s=0;s<t.length;s++){const l=t[s];o=n?void 0:null,l.command||(l.calculateCellValue?o=l.calculateCellValue(e):l.dataField&&(o=e[l.dataField])),i.push(o)}return i}_applyChange(e){const t=this;e.changeType==="update"?t._applyChangeUpdate(e):t.items().length&&e.repaintChangesOnly&&e.changeType==="refresh"?t._applyChangesOnly(e):e.changeType==="refresh"&&t._applyChangeFull(e)}_applyChangeFull(e){this._items=e.items.slice(0)}_getRowIndices(e){const t=e.rowIndices.slice(0),n=this.getRowIndexDelta();t.sort((i,o)=>i-o);for(let i=0;i<t.length;i++){let o=t[i];e.allowInvisibleRowIndices&&(o+=n),o<0&&(t.splice(i,1),i--)}return t}_applyChangeUpdate(e){const t=this,{items:n}=e,i=t._getRowIndices(e),o=t.getRowIndexDelta(),s=t.option("repaintChangesOnly");let l=-1,a=0,d;e.items=[],e.rowIndices=[],e.columnIndices=[],e.changeTypes=[];const u=function(c,h,p){let m=c&&h&&G(c.key,h.key);return m&&p&&(m=c.rowType===h.rowType&&(h.rowType!=="detail"||c.isEditing===h.isEditing)),m};b(i,(c,h)=>{let p;if(h+=a+o,l===h)return;l=h;const m=t._items[h],C=t._items[h+1],w=n[h],S=n[h+1],V=u(m,C)||u(w,S);if(w&&(w.rowIndex=h,e.items.push(w)),m&&w&&u(m,w,V))d="update",t._items[h]=w,m.visible!==w.visible?e.items.splice(-1,1,{visible:w.visible}):s&&!e.isFullUpdate&&(p=t._partialUpdateRow(m,w,h-o));else if(w&&!m||S&&u(m,S,V))d="insert",t._items.splice(h,0,w),a++;else if(m&&!w||C&&u(w,C,V))d="remove",t._items.splice(h,1),a--,l=-1;else if(w)d="update",t._items[h]=w;else return;e.rowIndices.push(h-o),e.changeTypes.push(d),e.columnIndices.push(p)})}_isCellChanged(e,t,n,i,o){if(JSON.stringify(e.values[i])!==JSON.stringify(t.values[i]))return!0;function s(l,a){return l.modifiedValues?l.modifiedValues[a]!==void 0:!1}return s(e,i)!==s(t,i)}_getChangedColumnIndices(e,t,n,i){let o;if(e.rowType===t.rowType){if(t.rowType!=="group"&&t.rowType!=="groupFooter"&&(o=[],t.rowType!=="detail"))for(let s=0;s<e.values.length;s++)this._isCellChanged(e,t,n,s,i)&&o.push(s);t.rowType==="group"&&e.cells&&t.isExpanded===e.isExpanded&&t.data.isContinuation===e.data.isContinuation&&t.data.isContinuationOnNextPage===e.data.isContinuationOnNextPage&&(o=e.cells.map((l,a)=>{var d;return((d=l.column)===null||d===void 0?void 0:d.type)!=="groupExpand"?a:-1}).filter(l=>l>=0))}return o}_partialUpdateRow(e,t,n,i){var o;let s=this._getChangedColumnIndices(e,t,n,i);return(o=s)!==null&&o!==void 0&&o.length&&this.option("dataRowTemplate")&&(s=void 0),s&&(e.cells&&e.cells.forEach((l,a)=>{!(s.indexOf(a)>=0)&&l&&l.update&&l.update(t)}),t.update=e.update,t.watch=e.watch,t.cells=e.cells,i&&(t.oldValues=e.values),e.update&&e.update(t)),s}_isItemEquals(e,t){if(JSON.stringify(e.values)!==JSON.stringify(t.values)||["modified","isNewRow","removed","isEditing"].some(l=>e[l]!==t[l]))return!1;if(e.rowType==="group"||e.rowType==="groupFooter"){var n,i,o,s;const l=e.isExpanded===t.isExpanded,a=JSON.stringify(e.summaryCells)===JSON.stringify(t.summaryCells),d=((n=e.data)===null||n===void 0?void 0:n.isContinuation)===((i=t.data)===null||i===void 0?void 0:i.isContinuation)&&((o=e.data)===null||o===void 0?void 0:o.isContinuationOnNextPage)===((s=t.data)===null||s===void 0?void 0:s.isContinuationOnNextPage);if(!l||!a||!d)return!1}return!0}_applyChangesOnly(e){const t=[],n=[],i=[],o=[],s={},l=(e==null?void 0:e.isLiveUpdate)??!0;function a(h){if(h)return`${h.rowType},${JSON.stringify(h.key)}`}const d=this._items,u=d.slice();e.items.forEach((h,p)=>{const m=a(h);s[m]=p,h.rowIndex=p});const c=gd(u,e.items,a,(h,p)=>this._isItemEquals(h,p)?(h.cells&&(h.update&&h.update(p),h.cells.forEach(m=>{m&&m.update&&m.update(p,!0)})),!0):!1);if(!c){this._applyChangeFull(e);return}c.forEach(h=>{switch(h.type){case"update":{const{index:p}=h,m=h.data,{oldItem:C}=h,w=this._partialUpdateRow(C,m,p,l);t.push(p),i.push("update"),o.push(m),d[p]=m,n.push(w);break}case"insert":t.push(h.index),i.push("insert"),o.push(h.data),n.push(void 0),d.splice(h.index,0,h.data);break;case"remove":t.push(h.index),i.push("remove"),d.splice(h.index,1),o.push(h.oldItem),n.push(void 0)}}),e.repaintChangesOnly=!0,e.changeType="update",e.rowIndices=t,e.columnIndices=n,e.changeTypes=i,e.items=o,u.length&&(e.isLiveUpdate=!0),this._correctRowIndices(h=>{const p=this._rowIndexOffset||0,m=this.getRowIndexOffset(),C=u[h-p],w=a(C),S=s[w];return S>=0?S+m-h:0})}_correctRowIndices(e){}_afterProcessItems(e,t){return e}_updateItemsCore(e){let t;const n=this._dataSource,i=e.changeType||"refresh";if(e.changeType=i,n){const o=this._cachedProcessedItems;e.useProcessedItemsCache&&o?t=o:(t=e.items||n.items(),t=this._beforeProcessItems(t),t=this._processItems(t,e),this._cachedProcessedItems=t),t=this._afterProcessItems(t,e),e.items=t;const s=this._items.length===t.length&&this._items;this._applyChange(e);const l=this.getRowIndexDelta();b(this._items,(a,d)=>{d.rowIndex=a-l,s&&(d.cells=s[a].cells??[]);const u=t[a];u&&(d.loadIndex=u.loadIndex)}),this._rowIndexOffset=this.getRowIndexOffset()}else this._items=[]}_handleChanging(e){const t=this.getVisibleRows();this.dataSource()&&e.changes.forEach(i=>{if(i.type==="insert"&&i.index>=0){let o=0;for(let s=0;s<i.index;s++){const l=t[s];l&&(l.rowType==="data"||l.rowType==="group")&&o++}i.index=o}})}updateItems(e,t){e=e||{};const n=this;if(n._repaintChangesOnly!==void 0)e.repaintChangesOnly=e.repaintChangesOnly??n._repaintChangesOnly,e.needUpdateDimensions=e.needUpdateDimensions||n._needUpdateDimensions;else if(e.changes)e.repaintChangesOnly=n.option("repaintChangesOnly");else if(t){const i=n.dataSource().operationTypes();e.repaintChangesOnly=i&&!i.grouping&&!i.filtering&&n.option("repaintChangesOnly"),e.isDataChanged=!0,i&&(i.reload||i.paging||i.groupExpanding)&&(e.needUpdateDimensions=!0)}if(n._updateLockCount&&!e.cancel){n._changes.push(e);return}n._updateItemsCore(e),!e.cancel&&n._fireChanged(e)}loadingOperationTypes(){const e=this.dataSource();return e&&e.loadingOperationTypes()||{}}_fireChanged(e){this._currentOperationTypes&&(e.operationTypes=this._currentOperationTypes,this._currentOperationTypes=null),pe(()=>{this.changed.fire(e)})}isLoading(){return this._isLoading||this._isCustomLoading}_fireLoadingChanged(){this.loadingChanged.fire(this.isLoading(),this._loadingText)}_calculateAdditionalFilter(){return null}_applyFilter(){const e=this._dataSource;return e?(e.pageIndex(0),this._isFilterApplying=!0,this.reload().done(()=>{this._isFilterApplying&&this.pageChanged.fire()})):new E().resolve()}resetFilterApplying(){this._isFilterApplying=!1}filter(e){const t=this._dataSource,n=t&&t.filter();if(arguments.length===0)return n;e=arguments.length>1?Array.prototype.slice.call(arguments,0):e,!v.equalFilterParameters(n,e)&&(t&&t.filter(e),this._applyFilter())}clearFilter(e){const t=this,n=t._columnsController,i=function(o){const s=n.columnCount();for(let l=0;l<s;l++)n.columnOption(l,o,void 0)};if(t.component.beginUpdate(),arguments.length>0)switch(e){case"dataSource":t.filter(null);break;case"search":t.searchByText("");break;case"header":i("filterValues");break;case"row":i("filterValue")}else t.filter(null),t.searchByText(""),i("filterValue"),i("bufferedFilterValue"),i("filterValues");t.component.endUpdate()}_fireDataSourceChanged(){const e=this,t=function(){e.changed.remove(t),e.dataSourceChanged.fire()};e.changed.add(t)}_getDataSourceAdapter(){}_createDataSourceAdapterCore(e,t){const i=this._getDataSourceAdapter().create(this.component);return i.init(e,t),i}isLocalStore(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.store())instanceof Or}isCustomStore(e){return e=e||this.store(),e instanceof md}_createDataSourceAdapter(e){let t=this.option("remoteOperations");const n=e.store(),i={filtering:!0,sorting:!0,paging:!0,grouping:!0,summary:!0};return Y(t)&&t.groupPaging&&(t=y({},i,t)),t==="auto"&&(t=this.isLocalStore(n)||this.isCustomStore(n)?{}:{filtering:!0,sorting:!0,paging:!0}),t===!0&&(t=i),this._createDataSourceAdapterCore(e,t)}setDataSource(e){const t=this,n=t._dataSource;!e&&n&&(n.cancelAll(),n.changed.remove(t._dataChangedHandler),n.loadingChanged.remove(t._loadingChangedHandler),n.loadError.remove(t._loadErrorHandler),n.customizeStoreLoadOptions.remove(t._customizeStoreLoadOptionsHandler),n.changing.remove(t._changingHandler),n.pushed.remove(t._dataPushedHandler),n.dispose(t._isSharedDataSource)),e&&(e=t._createDataSourceAdapter(e)),t._dataSource=e,e&&(t._fireDataSourceChanged(),t._isLoading=!e.isLoaded(),t._needApplyFilter=!0,t._isAllDataTypesDefined=t._columnsController.isAllDataTypesDefined(),e.changed.add(t._dataChangedHandler),e.loadingChanged.add(t._loadingChangedHandler),e.loadError.add(t._loadErrorHandler),e.customizeStoreLoadOptions.add(t._customizeStoreLoadOptionsHandler),e.changing.add(t._changingHandler),e.pushed.add(t._dataPushedHandler))}items(e){return this._items}isEmpty(){return!this.items().length}pageCount(){return this._dataSource?this._dataSource.pageCount():1}dataSource(){return this._dataSource}store(){const e=this._dataSource;return e&&e.store()}loadAll(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this,i=new E,o=n._dataSource;if(o)if(e){const s={data:e,isCustomLoading:!0,storeLoadOptions:{isLoadingAll:!0},loadOptions:{filter:t?null:n.getCombinedFilter(),group:o.group(),sort:o.sort()}};o._handleDataLoaded(s),F(s.data).done(l=>{var a;l=n._beforeProcessItems(l),i.resolve(n._processItems(l,{changeType:"loadingAll"}),(a=s.extra)===null||a===void 0?void 0:a.summary)}).fail(i.reject)}else if(o.isLoading())i.reject();else{const s=y({},o.loadOptions(),{isLoadingAll:!0,requireTotalCount:!1});o.load(s).done((l,a)=>{l=n._beforeProcessItems(l),l=n._processItems(l,{changeType:"loadingAll"}),i.resolve(l,a&&a.summary)}).fail(i.reject)}else i.resolve([]);return i}getKeyByRowIndex(e,t){const n=this.items(t)[e];if(n)return n.key}getRowIndexByKey(e,t){return v.getIndexByKey(e,this.items(t))}keyOf(e){const t=this.store();if(t)return t.keyOf(e)}byKey(e){const t=this.store(),n=this.getRowIndexByKey(e);let i;if(t)return n>=0&&(i=new E().resolve(this.items()[n].data)),i||t.byKey(e)}key(){const e=this.store();if(e)return e.key()}getRowIndexOffset(e){return 0}getDataByKeys(e){const t=this,n=new E,i=[],o=[];return b(e,(s,l)=>{i.push(t.byKey(l).done(a=>{o[s]=a}))}),F.apply(g,i).always(()=>{n.resolve(o)}),n}pageIndex(e){return vs(this,"pageIndex",e)}pageSize(e){return vs(this,"pageSize",e)}beginCustomLoading(e){this._isCustomLoading=!0,this._loadingText=e||"",this._fireLoadingChanged()}endCustomLoading(){this._isCustomLoading=!1,this._loadingText=void 0,this._fireLoadingChanged()}refresh(e){e===!0?e={reload:!0,changesOnly:!0}:e||(e={lookup:!0,selection:!0,reload:!0});const t=this,n=t.getDataSource(),{changesOnly:i}=e,o=new E,s=function(){t._repaintChangesOnly=!!i};return F(!e.lookup||t._columnsController.refresh()).always(()=>{e.load||e.reload?(n&&n.on("customizeLoadResult",s),F(t.reload(e.reload,i)).always(()=>{n&&n.off("customizeLoadResult",s),t._repaintChangesOnly=void 0}).done(o.resolve).fail(o.reject)):(t.updateItems({repaintChangesOnly:e.changesOnly}),o.resolve())}),o.promise()}getVisibleRows(){return this.items()}_disposeDataSource(){this._dataSource&&this._dataSource._eventsStrategy&&this._dataSource._eventsStrategy.off("loadingChanged",this.readyWatcher),this.setDataSource(null)}dispose(){this._disposeDataSource(),super.dispose()}repaintRows(e,t){e=Array.isArray(e)?e:[e],(e.length>1||f(e[0]))&&this.updateItems({changeType:"update",rowIndices:e,isFullUpdate:!t})}skipProcessingPagingChange(e){return this._skipProcessingPagingChange&&(e==="paging.pageIndex"||e==="paging.pageSize")}getUserState(){return{searchText:this.option("searchPanel.text"),pageIndex:this.pageIndex(),pageSize:this.pageSize()}}getCachedStoreData(){return this._dataSource&&this._dataSource.getCachedStoreData()}isLastPageLoaded(){const e=this.pageIndex(),t=this.pageCount();return e===t-1}load(){var e;return(e=this._dataSource)===null||e===void 0?void 0:e.load()}reload(e,t){var n;return(n=this._dataSource)===null||n===void 0?void 0:n.reload(e,t)}push(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return(e=this._dataSource)===null||e===void 0?void 0:e.push(...n)}itemsCount(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.itemsCount():0}totalItemsCount(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.totalItemsCount():0}hasKnownLastPage(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.hasKnownLastPage():!0}isLoaded(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.isLoaded():!0}totalCount(){var e;return this._dataSource?(e=this._dataSource)===null||e===void 0?void 0:e.totalCount():0}hasLoadOperation(){var e;const t=((e=this._dataSource)===null||e===void 0?void 0:e.operationTypes())??{};return Object.keys(t).some(n=>t[n])}}const ic={defaultOptions:()=>({loadingTimeout:0,dataSource:null,cacheEnabled:!0,repaintChangesOnly:!1,highlightChanges:!1,onDataErrorOccurred:null,remoteOperations:"auto",paging:{enabled:!0,pageSize:void 0,pageIndex:void 0}})},vn=function(r,e){if(r&&(r=r.slice(0),e))for(let t=0;t<r.length;t++)r[t]=y({key:r[t].key},r[t]),r[t].items=vn(r[t].items,e-1);return r},ys=function(r,e,t){let n={reload:!0,fullReload:!0};return e&&(n={sorting:!v.equalSortParameters(r.sort,e.sort),grouping:!v.equalSortParameters(r.group,e.group,!0),groupExpanding:!v.equalSortParameters(r.group,e.group)||e.groupExpand,filtering:!v.equalFilterParameters(r.filter,e.filter),pageIndex:r.pageIndex!==e.pageIndex,skip:r.skip!==e.skip,take:r.take!==e.take,pageSize:r.pageSize!==e.pageSize,fullReload:t,reload:!1,paging:!1},n.reload=t||n.sorting||n.grouping||n.filtering,n.paging=n.pageIndex||n.pageSize||n.take),n},oc=function(r,e){f(e)?fd.executeAsync(r,e):r()},Et=function(){return{items:{}}},bs=function(r,e){const t=v.normalizeSortingInfo(r.group||r.storeLoadOptions.group||r.loadOptions.group).length,n=[];if(gl(n,r,t))return n;e&&rc(n,r,t)},gl=function(r,e,t,n){var i;const{storeLoadOptions:o}=e,s=e.take??o.take??0,l=(i=e.cachedData)===null||i===void 0?void 0:i.items;if(s&&l){const a=e.skip??o.skip??0;for(let d=0;d<s;d+=1){const u=n?s-1-d:d,c=u+a,h=l[c];if(h===void 0&&c in l)return!0;const p=sc(e,h,t,u,s);if(p)r.push(p);else return!1}return!0}return!1},sc=function(r,e,t,n,i){if(t&&e){const o=n===0&&r.skips||[],s=n===i-1&&r.takes||[];return ml(e,t,o,s)}return e},ml=function(r,e,t,n){if(e&&r){const i=A({},r),o=t[0]||0,s=n[0],{items:l}=r;if(l){if(s===void 0&&!l[o])return;i.items=[],t.length&&(i.isContinuation=!0),s&&(i.isContinuationOnNextPage=r.count>s);for(let a=0;s===void 0?l[a+o]:a<s;a+=1){const d=l[a+o],u=a+1===s,c=ml(d,e-1,a===0?t.slice(1):[],u?n.slice(1):[]);if(c!==void 0)i.items.push(c);else return}}return i}return r},rc=function(r,e,t){const n=r.length,{storeLoadOptions:i}=e;if(i.skip!==void 0&&i.take&&!t){const o=[];gl(o,e,t,!0);const s=o.length;(n||s)&&(e.skip=e.skip??i.skip,e.take=e.take??i.take),n&&(i.skip+=n,i.take-=n,e.cachedDataPartBegin=r),s&&(i.take-=s,e.cachedDataPartEnd=o.reverse())}},lc=function(r,e,t){const{storeLoadOptions:n}=r,i=r.skip??n.skip??0,o=r.take??n.take??0;for(let s=0;s<o;s+=1){const l=s+i,a=r.cachedData.items,d=s===0&&r.skips||[];a[l]=fl(a[l],e[s],t,d)}},fl=function(r,e,t,n){if(t&&e){const i=A({},e);delete i.isContinuation,delete i.isContinuationOnNextPage;const o=n[0]||0;return e.items&&(i.items=(r==null?void 0:r.items)||{},e.items.forEach((s,l)=>{const a=l+o,d=l===0?n.slice(1):[];i.items[a]=fl(i.items[a],s,t-1,d)})),i}return e};class ac extends L.Controller{init(e,t){const n=this;n._dataSource=e,n._remoteOperations=t||{},n._isLastPage=!e.isLastPage(),n._hasLastPage=!1,n._currentTotalCount=0,n._cachedData=Et(),n._lastOperationTypes={},n._eventsStrategy=e._eventsStrategy,n._totalCountCorrection=0,n._isLoadingAll=!1,n.changed=Le(),n.loadingChanged=Le(),n.loadError=Le(),n.customizeStoreLoadOptions=Le(),n.changing=Le(),n.pushed=Le(),n._dataChangedHandler=n._handleDataChanged.bind(n),n._customizeStoreLoadOptionsHandler=n._handleCustomizeStoreLoadOptions.bind(n),n._dataLoadedHandler=n._handleDataLoaded.bind(n),n._loadingChangedHandler=n._handleLoadingChanged.bind(n),n._loadErrorHandler=n._handleLoadError.bind(n),n._pushHandler=n._handlePush.bind(n),n._changingHandler=n._handleChanging.bind(n),e.on("changed",n._dataChangedHandler),e.on("customizeStoreLoadOptions",n._customizeStoreLoadOptionsHandler),e.on("customizeLoadResult",n._dataLoadedHandler),e.on("loadingChanged",n._loadingChangedHandler),e.on("loadError",n._loadErrorHandler),e.on("changing",n._changingHandler),e.store().on("beforePush",n._pushHandler),b(e,(i,o)=>{!n[i]&&X(o)&&(n[i]=function(){return this._dataSource[i].apply(this._dataSource,arguments)})})}dispose(e){const t=this._dataSource,n=t.store();t.off("changed",this._dataChangedHandler),t.off("customizeStoreLoadOptions",this._customizeStoreLoadOptionsHandler),t.off("customizeLoadResult",this._dataLoadedHandler),t.off("loadingChanged",this._loadingChangedHandler),t.off("loadError",this._loadErrorHandler),t.off("changing",this._changingHandler),n&&n.off("beforePush",this._pushHandler),e||t.dispose()}remoteOperations(){return this._remoteOperations}refresh(e,t){const n=this,i=n._dataSource;t.reload&&(n.resetCurrentTotalCount(),n._isLastPage=!i.paginate(),n._hasLastPage=n._isLastPage)}resetCurrentTotalCount(){this._currentTotalCount=0,this._totalCountCorrection=0}resetCache(){this._cachedStoreData=void 0,this._cachedPagingData=void 0}resetPagesCache(e){this._cachedData=Et()}_needClearStoreDataCache(){const e=this.remoteOperations(),t=ys(this._lastLoadOptions||{},{});return!Object.keys(e).every(i=>!t[i]||!e[i])}push(e,t){const n=this.store();this._needClearStoreDataCache()&&(this._cachedStoreData=void 0),this._cachedPagingData=void 0,this.resetPagesCache(!0),this._cachedStoreData&&xn({keyInfo:n,data:this._cachedStoreData,changes:e}),t||this._applyBatch(e),this.pushed.fire(e)}getDataIndexGetter(){if(!this._dataIndexGetter){let e,t;const n=this.store();this._dataIndexGetter=i=>{const o=t&&t!==this._cachedStoreData;if(!e||o){t=this._cachedStoreData||[],e={};for(let s=0;s<t.length;s++)e[$e(n.keyOf(t[s]))]=s}return e[$e(n.keyOf(i))]}}return this._dataIndexGetter}_getKeyInfo(){return this.store()}_needToCopyDataObject(){return!0}_applyBatch(e,t){const n=this._getKeyInfo(),i=this._dataSource,o=v.normalizeSortingInfo(this.group()).length,s=this.option("editing.refreshMode")==="reshape",l=this.option("scrolling.mode")==="virtual";e=e.filter(c=>!i.paginate()||c.type!=="insert"||c.index!==void 0);const a=()=>o?this.itemsCount():this.items().length,d=a();xn({keyInfo:n,data:this._items,changes:e,groupCount:o,useInsertIndex:!0,skipCopying:!this._needToCopyDataObject()}),xn({keyInfo:n,data:i.items(),changes:e,groupCount:o,useInsertIndex:!0,skipCopying:!this._needToCopyDataObject()}),(this._currentTotalCount>0||(t||!s)&&l)&&(this._totalCountCorrection+=a()-d),e.splice(0,e.length)}_handlePush(e){let{changes:t}=e;this.push(t,!0)}_handleChanging(e){this.changing.fire(e),this._applyBatch(e.changes,!0)}_needCleanCacheByOperation(e,t){const n=["filtering","sorting","paging"],i=n.indexOf(e);return(i>=0?n.slice(i):[e]).some(s=>t[s])}_customizeRemoteOperations(e,t){let n=this._cachedStoreData,i=this._cachedPagingData,o=this._cachedData;(e.storeLoadOptions.filter&&!e.remoteOperations.filtering||e.storeLoadOptions.sort&&!e.remoteOperations.sorting)&&(e.remoteOperations={filtering:e.remoteOperations.filtering,summary:e.remoteOperations.summary}),t.fullReload?(n=void 0,i=void 0,o=Et()):(t.reload?(i=void 0,o=Et()):t.groupExpanding&&(o=Et()),b(t,(s,l)=>{l&&this._needCleanCacheByOperation(s,e.remoteOperations)&&(n=void 0,i=void 0)})),i&&(e.remoteOperations.paging=!1),e.cachedStoreData=n,e.cachedPagingData=i,e.cachedData=o,e.isCustomLoading||(this._cachedStoreData=n,this._cachedPagingData=i,this._cachedData=o)}_handleCustomizeStoreLoadOptions(e){var t;this._handleDataLoading(e),((t=e.data)===null||t===void 0?void 0:t.length)!==0&&(e.data=bs(e,!0)||e.cachedStoreData)}_handleDataLoading(e){const t=this._dataSource,n=this._lastLoadOptions;this.customizeStoreLoadOptions.fire(e),e.delay=this.option("loadingTimeout"),e.originalStoreLoadOptions=e.storeLoadOptions,e.remoteOperations=y({},this.remoteOperations());const i=!this.isLoaded()&&!this._isRefreshing;this.option("integrationOptions.renderedOnServer")&&!this.isLoaded()&&(e.delay=void 0);const o=y({pageIndex:this.pageIndex(),pageSize:this.pageSize()},e.storeLoadOptions),s=ys(o,n,i);if(this._customizeRemoteOperations(e,s),!e.isCustomLoading){const l=this._isRefreshing;e.pageIndex=t.pageIndex(),e.lastLoadOptions=o,e.operationTypes=s,this._loadingOperationTypes=s,this._isRefreshing=!0,F(l||this._isRefreshed||this.refresh(e,s)).done(()=>{this._lastOperationId===e.operationId&&(this._isRefreshed=!0,this.load().always(()=>{this._isRefreshed=!1}))}).fail(()=>{t.cancel(e.operationId)}).always(()=>{this._isRefreshing=!1}),t.cancel(this._lastOperationId),this._lastOperationId=e.operationId,this._isRefreshing&&t.cancel(this._lastOperationId)}this._handleDataLoadingCore(e)}_handleDataLoadingCore(e){const{remoteOperations:t}=e;e.loadOptions={};const n=e.cachedData.extra,i={filter:!t.filtering,sort:!t.sorting,group:!t.grouping,summary:!t.summary,skip:!t.paging,take:!t.paging,requireTotalCount:n&&"totalCount"in n||!t.paging,langParams:!t.filtering||!t.sorting};b(e.storeLoadOptions,(o,s)=>{i[o]&&(e.loadOptions[o]=s,delete e.storeLoadOptions[o])}),n&&(e.extra=n)}_handleDataLoaded(e){const{loadOptions:t}=e,n=e.remoteOperations&&!e.remoteOperations.paging,{cachedData:i}=e,{storeLoadOptions:o}=e,s=this.option("cacheEnabled")!==!1&&o,l=s&&!e.isCustomLoading&&i&&(!n||o.group),a=s&&n,d=a&&!e.isCustomLoading;if(!t){this._dataSource.cancel(e.operationId);return}n&&(e.skip=t.skip,e.take=t.take,delete t.skip,delete t.take),t.group&&(t.group=e.group||t.group);const u=v.normalizeSortingInfo(e.group||o.group||t.group).length;if(e.cachedDataPartBegin&&(e.data=e.cachedDataPartBegin.concat(e.data)),e.cachedDataPartEnd&&(e.data=e.data.concat(e.cachedDataPartEnd)),!l||!bs(e)){var c;a&&e.cachedPagingData?e.data=vn(e.cachedPagingData,u):(d&&(this._cachedStoreData?e.mergeStoreLoadData&&(e.data=this._cachedStoreData=this._cachedStoreData.concat(e.data)):this._cachedStoreData=vn(e.data,v.normalizeSortingInfo(o.group).length)),new Or(e.data).load(t).done(h=>{e.data=h,d&&(this._cachedPagingData=vn(e.data,u))}).fail(h=>{e.data=new E().reject(h)})),t.requireTotalCount&&n&&(e.extra=en(e.extra)?e.extra:{},e.extra.totalCount=e.data.length),e.extra&&e.extra.totalCount>=0&&(o.requireTotalCount===!1||t.requireTotalCount===!1)&&(e.extra.totalCount=-1),!t.data&&(o.requireTotalCount||(((c=e.extra)===null||c===void 0?void 0:c.totalCount)??-1)>=0)&&(this._totalCountCorrection=0),this._handleDataLoadedCore(e),l&&(i.extra=i.extra||y({},e.extra),F(e.data).done(h=>{lc(e,h,u)}))}F(e.data).done(()=>{e.lastLoadOptions&&(this._lastLoadOptions=e.lastLoadOptions,Object.keys(e.operationTypes).forEach(h=>{this._lastOperationTypes[h]=this._lastOperationTypes[h]||e.operationTypes[h]}))}),e.storeLoadOptions=e.originalStoreLoadOptions}_handleDataLoadedCore(e){e.remoteOperations&&!e.remoteOperations.paging&&Array.isArray(e.data)&&(e.skip!==void 0&&(e.data=e.data.slice(e.skip)),e.take!==void 0&&(e.data=e.data.slice(0,e.take)))}_handleLoadingChanged(e){this.loadingChanged.fire(e)}_handleLoadError(e){this.loadError.fire(e),this.changed.fire({changeType:"loadError",error:e})}_loadPageSize(){return this.pageSize()}_handleDataChanged(e){let t;const n=this._dataSource;let i=!1;const o=!e||f(e.changeType),s=this.itemsCount();o&&(this._isLastPage=!s||!this._loadPageSize()||s<this._loadPageSize(),this._isLastPage&&(this._hasLastPage=!0)),n.totalCount()>=0?n.pageIndex()>=this.pageCount()&&(n.pageIndex(this.pageCount()-1),this.pageIndex(n.pageIndex()),this.resetPagesCache(),n.load(),i=!0):o&&(t=n.pageIndex()*this.pageSize()+s,t>this._currentTotalCount&&(this._currentTotalCount=t,(n.pageIndex()===0||!this.option("scrolling.legacyMode"))&&(this._totalCountCorrection=0)),s===0&&n.pageIndex()>=this.pageCount()&&(n.pageIndex(this.pageCount()-1),this.option("scrolling.mode")!=="infinite"&&(n.load(),i=!0))),i||(this._operationTypes=this._lastOperationTypes,this._lastOperationTypes={},this.component._optionCache={},this.changed.fire(e),this.component._optionCache=void 0)}_scheduleCustomLoadCallbacks(e){const t=this;t._isCustomLoading=!0,e.always(()=>{t._isCustomLoading=!1})}loadingOperationTypes(){return this._loadingOperationTypes}operationTypes(){return this._operationTypes}lastLoadOptions(){return this._lastLoadOptions||{}}isLastPage(){return this._isLastPage}_dataSourceTotalCount(){return this._dataSource.totalCount()}_changeRowExpandCore(e){}changeRowExpand(e){}totalCount(){return parseInt((this._currentTotalCount||this._dataSourceTotalCount())+this._totalCountCorrection)}totalCountCorrection(){return this._totalCountCorrection}items(){}itemsCount(){return this._dataSource.items().length}totalItemsCount(){return this.totalCount()}pageSize(){const e=this._dataSource;return!arguments.length&&!e.paginate()?0:e.pageSize.apply(e,arguments)}pageCount(){const e=this.totalItemsCount()-this._totalCountCorrection,t=this.pageSize();return t&&e>0?Math.max(1,Math.ceil(e/t)):1}hasKnownLastPage(){return this._hasLastPage||this._dataSource.totalCount()>=0}loadFromStore(e,t){const n=this._dataSource,i=new E;if(n)return t=t||n.store(),t.load(e).done((o,s)=>{o&&!Array.isArray(o)&&Array.isArray(o.data)&&(s=o,o=o.data),i.resolve(o,s)}).fail(i.reject),i}isCustomLoading(){return!!this._isCustomLoading}load(e){const t=this,n=t._dataSource,i=new E;if(e){const o=n.store(),s=n.loadOptions(),l={storeLoadOptions:y({},e,{langParams:s==null?void 0:s.langParams}),isCustomLoading:!0};return b(o._customLoadOptions()||[],(a,d)=>{d in l.storeLoadOptions||(l.storeLoadOptions[d]=s[d])}),this._isLoadingAll=e.isLoadingAll,t._scheduleCustomLoadCallbacks(i),n._scheduleLoadCallbacks(i),t._handleCustomizeStoreLoadOptions(l),oc(()=>{if(!n.store())return i.reject("canceled");F(l.data||t.loadFromStore(l.storeLoadOptions)).done((a,d)=>{l.data=a,l.extra=d||{},t._handleDataLoaded(l),e.requireTotalCount&&l.extra.totalCount===void 0&&(l.extra.totalCount=o.totalCount(l.storeLoadOptions)),F(l.data,l.extra.totalCount).done((u,c)=>{l.extra.totalCount=c,i.resolve(u,l.extra)}).fail(i.reject)}).fail(i.reject)},t.option("loadingTimeout")),i.fail(function(){t._eventsStrategy.fireEvent("loadError",arguments)}).always(()=>{this._isLoadingAll=!1}).promise()}return n.load()}reload(e){return e?this._dataSource.reload():this._dataSource.load()}getCachedStoreData(){return this._cachedStoreData}isLoaded(){}pageIndex(e){}}let Ci=ac;const Yn={extend(r){Ci=r(Ci)},create:r=>new Ci(r)};class dc extends nc{_getDataSourceAdapter(){return Yn}_getSpecificDataSourceOption(){const e=this.option("dataSource");return e&&!Array.isArray(e)&&this.option("keyExpr")&&oe.log("W1011"),super._getSpecificDataSourceOption()}}T.registerModule("data",{defaultOptions:ic.defaultOptions,controllers:{data:dc}});const uc=r=>class extends Wr(r){optionChanged(e){const t=this;e.name==="sorting"?(t._invalidate(),e.handled=!0):super.optionChanged(e)}_createRow(e){const t=super._createRow(e);return e.rowType==="header"&&x.on(t,H(te,"dxDataGridColumnHeadersView"),"td",this.createAction(n=>{this._processHeaderAction(n.event,t)})),t}_processHeaderAction(e,t){if(g(e.currentTarget).parent().get(0)!==t.get(0))return;const n=this;let i=null;const o=g(e.currentTarget),s=o.parent().index();let l=-1;[].slice.call(n.getCellElements(s)).some((p,m)=>{if(p===o.get(0))return l=m,!0});const d=n._columnsController.getVisibleColumns(s)[l],u=n.getController("editing"),c=n.option("editing.mode");u&&u.isEditing()&&(c==="batch"||c==="cell")||!n._isSortableElement(g(e.target))||d&&!f(d.groupIndex)&&!d.command&&(e.shiftKey?i="shift":On(e)&&(i="ctrl"),setTimeout(()=>{n._columnsController.changeSortOrder(d.index,i)}))}_renderCellContent(e,t){const n=this,{column:i}=t;!i.command&&t.rowType==="header"&&n._applyColumnState({name:"sort",rootElement:e,column:i,showColumnLines:n.option("showColumnLines")}),super._renderCellContent.apply(this,arguments)}_columnOptionChanged(e){const{changeTypes:t}=e;if(t.length===1&&t.sorting){this._updateIndicators("sort");return}super._columnOptionChanged(e)}},cc=r=>class extends Wr(r){optionChanged(e){const t=this;e.name==="sorting"?(t._invalidate(),e.handled=!0):super.optionChanged(e)}_createGroupPanelItem(e,t){const n=this,i=super._createGroupPanelItem(...arguments);return x.on(i,H(te,"dxDataGridHeaderPanel"),n.createAction(()=>{n._processGroupItemAction(t.index)})),n._applyColumnState({name:"sort",rootElement:i,column:{alignment:n.option("rtlEnabled")?"right":"left",allowSorting:t.allowSorting,sortOrder:t.sortOrder==="desc"?"desc":"asc",isGrouped:!0},showColumnLines:!0}),i}_processGroupItemAction(e){setTimeout(()=>this.getController("columns").changeSortOrder(e))}},hc={defaultOptions:()=>({sorting:{mode:"single",ascendingText:_.format("dxDataGrid-sortingAscendingText"),descendingText:_.format("dxDataGrid-sortingDescendingText"),clearText:_.format("dxDataGrid-sortingClearText"),showSortIndexes:!0}}),extenders:{views:{columnHeadersView:uc,headerPanel:cc}}};T.registerModule("sorting",hc);const un="dx-freespace-row",Is="dx-last-row-border";function Es(r){return r?Math.round(r.scrollWidth()-r.clientWidth()):0}function ji(r){let{rowType:e,column:t}=r;return e==="group"&&f(t.groupIndex)&&!t.showWhenGrouped&&!t.command}function Ss(r){let{element:e,watch:t,getter:n,callBack:i}=r;if(t){const o=t(n,i);x.on(e,xt,o)}}const pc=function(r,e){const t=Cd(e.text)&&e.rowType==="data",{text:n}=e,i=r.get(0);t?v.setEmptyText(r):e.column.encodeHtml?i.textContent=n:i.innerHTML=n},gc=function(r){const e=r.getScrollable();return e?Math.ceil(parseFloat(g(e.content()).css("paddingBottom"))):0};class mc extends sn{init(){super.init(),this._editingController=this.getController("editing"),this._resizingController=this.getController("resizing"),this._columnsResizerController=this.getController("columnsResizer"),this._focusController=this.getController("focus"),this._keyboardNavigationController=this.getController("keyboardNavigation"),this._validatingController=this.getController("validating"),this._errorHandlingController=this.getController("errorHandling"),this._columnHeadersView=this.getView("columnHeadersView"),this._rowHeight=0,this._scrollTop=0,this._scrollLeft=-1,this._scrollRight=0,this._hasHeight=void 0,this._contentChanges=[],this._dataController.loadingChanged.add((e,t)=>{this.setLoading(e,t)}),this._dataController.dataSourceChanged.add(()=>{this._scrollLeft>=0&&!this._dataController.isLoading()&&this._handleScroll({component:this.getScrollable(),forceUpdateScrollPosition:!0,scrollOffset:{top:this._scrollTop,left:this._scrollLeft}})})}_getDefaultTemplate(e){return e.command==="empty"?function(t){t.html("&nbsp;")}:pc}renderFocusState(e){}_getDefaultGroupTemplate(e){const t=this.option("summary.texts");return function(n,i){const{data:o}=i;let s=`${i.column.caption}: ${i.text}`;const l=n.get(0);i.summaryItems&&i.summaryItems.length&&(s+=` ${v.getGroupRowSummaryText(i.summaryItems,t)}`),o&&(i.groupContinuedMessage&&i.groupContinuesMessage?s+=` (${i.groupContinuedMessage}. ${i.groupContinuesMessage})`:i.groupContinuesMessage?s+=` (${i.groupContinuesMessage})`:i.groupContinuedMessage&&(s+=` (${i.groupContinuedMessage})`)),e.encodeHtml?l.textContent=s:l.innerHTML=s}}_update(e){}_updateCell(e,t){ji(t)&&(e.is(`.${this.addWidgetPrefix(z.groupRowContainer)}`)?e.parent():e).addClass("dx-group-cell"),super._updateCell.apply(this,arguments)}_getCellTemplate(e){const t=this,{column:n}=e;let i;return ji(e)?i=n.groupCellTemplate||{allowRenderToDetachedContainer:!0,render:t._getDefaultGroupTemplate(n)}:(e.rowType==="data"||n.command)&&n.cellTemplate?i=n.cellTemplate:i={allowRenderToDetachedContainer:!0,render:t._getDefaultTemplate(n)},i}_createRow(e,t){const n=super._createRow.apply(this,arguments);if(e){const i=e.rowType==="group",o=e.rowType==="data";o&&n.addClass("dx-data-row"),o&&this.option("showRowLines")&&n.addClass("dx-row-lines"),this.option("showColumnLines")&&n.addClass("dx-column-lines"),e.visible===!1&&n.hide(),i&&(n.addClass("dx-group-row"),this.setAriaExpandedAttribute(n,e))}return n}_rowPrepared(e,t,n){t.rowType==="data"&&(this.option("rowAlternationEnabled")&&(this._isAltRow(n)&&e.addClass("dx-row-alt"),Ss({element:e.get(0),watch:t.watch,getter:()=>this._isAltRow(n),callBack:i=>{e.toggleClass("dx-row-alt",i)}})),this._setAriaRowIndex(t,e),Ss({element:e.get(0),watch:t.watch,getter:()=>t.rowIndex,callBack:()=>this._setAriaRowIndex(t,e)})),super._rowPrepared.apply(this,arguments)}_setAriaRowIndex(e,t){if(!t.is("tr"))return;const{component:n}=this,i=n.option("scrolling.mode")==="standard"&&!v.isVirtualRowRendering(n);let o=e.rowIndex+1;i?o=n.pageIndex()*n.pageSize()+o:o+=this._dataController.getRowIndexOffset(),this.setAria("rowindex",o,t)}setAriaExpandedAttribute(e,t){const n=t.isExpanded?this.localize("dxDataGrid-ariaExpandedRow"):this.localize("dxDataGrid-ariaCollapsedRow");this.setAria("roledescription",n,e)}_afterRowPrepared(e){const t=e.args[0],n=this._dataController,i=n.getVisibleRows()[t.rowIndex],o=this.option("integrationOptions.watchMethod");if(!t.data||t.rowType!=="data"||t.isNewRow||!this.option("twoWayBindingEnabled")||!o||!i)return;const s=o(()=>n.generateDataValues(t.data,t.columns),()=>{n.repaintRows([i.rowIndex],this.option("repaintChangesOnly"))},{deep:!0,skipImmediate:!0});x.on(t.rowElement,xt,s)}_renderScrollable(e){const t=this,n=t.element();if(n.children().length||n.append("<div>"),(e||!t._loadPanel)&&t._renderLoadPanel(n,n.parent(),t._dataController.isLocalStore()),(e||!t.getScrollable())&&t._dataController.isLoaded()){const i=t.getColumns();let o=!0;for(let s=0;s<i.length;s++)if(!i[s].width&&!i[s].minWidth){o=!1;break}(t.option("columnAutoWidth")||t._hasHeight||o||t._columnsController._isColumnFixing())&&t._renderScrollableCore(n)}}_handleScroll(e){const t=this.option("rtlEnabled"),n=e.component.option("useNative");this._scrollTop=e.scrollOffset.top,this._scrollLeft=e.scrollOffset.left;let i=e.scrollOffset.left;t&&(this._scrollRight=Es(e.component)-this._scrollLeft,n&&(i=-this._scrollRight),this.isScrollbarVisible(!0)||(this._scrollLeft=-1)),this.scrollChanged.fire(A({},e.scrollOffset,{left:i}),this.name)}_renderScrollableCore(e){const t=this._createScrollableOptions(),n=this._handleScroll.bind(this);t.onScroll=n,this._scrollable=this._createComponent(e,gt,t),this._scrollableContainer=this._scrollable&&g(this._scrollable.container())}_renderLoadPanel(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return v.renderLoadPanel.apply(this,arguments)}_renderContent(e,t,n){return e.empty().append(t),this._findContentElement()}_updateContent(e,t,n){return this._contentChanges.push({newTableElement:e,change:t,isFixedTableRendering:n}),this.waitAsyncTemplates().done(()=>{const i=this._contentChanges;this._contentChanges=[],i.forEach(o=>{let{newTableElement:s,change:l,isFixedTableRendering:a}=o;const d=this.getTableElement(a),u=this._findContentElement(a),c=l==null?void 0:l.changeType,h=[],p=this.option("highlightChanges"),m=this.addWidgetPrefix("row-inserted-animation");c==="update"?(b(l.rowIndices,(C,w)=>{var S;const V=this._getRowElements(s).eq(C),O=(S=l.changeTypes)===null||S===void 0?void 0:S[C],P=l.items&&l.items[C];h.push(()=>{const k=this._getRowElements(d),B=k.eq(w);switch(O){case"update":if(P){var $;const re=($=l.columnIndices)===null||$===void 0?void 0:$[C];f(P.visible)&&P.visible!==B.is(":visible")?B.toggle(P.visible):re?this._updateCells(B,V,re,P):B.replaceWith(V)}break;case"insert":if(k.length)B.length?V.insertBefore(B):V.insertAfter(k.last());else if(d){const re=V.is("tbody")?d:d.children("tbody");V.prependTo(re)}p&&l.isLiveUpdate&&V.addClass(m);break;case"remove":B.remove()}})}),b(h,function(){this()}),s.remove()):(this.setTableElement(s,a),u.addClass(this.addWidgetPrefix("content")),this._setGridRole(u),this._renderContent(u,s,a))})}).fail(()=>{this._contentChanges=[]})}_getGridRoleName(){return"grid"}_setGridRole(e){var t;const n=!((t=this._dataController)!==null&&t!==void 0&&t.isEmpty()),i=this._getGridRoleName();e!=null&&e.length&&n&&this.setAria("role",i,e)}_createEmptyRow(e,t,n){const i=this;let o;const s=i._createRow(),l=t?this.getFixedColumns():this.getColumns();s.addClass(e).toggleClass("dx-column-lines",i.option("showColumnLines"));for(let a=0;a<l.length;a++)o=i._createCell({column:l[a],rowType:"freeSpace",columnIndex:a,columns:l}),Ae(n)&&o.css("height",n),s.append(o);return i.setAria("role","presentation",s),s}getFixedColumns(){throw new Error("Method not implemented.")}_appendEmptyRow(e,t,n){const i=this._getBodies(e),o=!i.length||t.is("tbody"),s=o?e:i;if(n==="top"){if(s.first().prepend(t),o){const l=s.children("colgroup");s.prepend(l)}}else s.last().append(t)}_renderFreeSpaceRow(e,t){let n=this._createEmptyRow(un);n=this._wrapRowIfNeed(e,n,(t==null?void 0:t.changeType)==="refresh"),this._appendEmptyRow(e,n)}_checkRowKeys(e){const t=this,n=t._getRows(e),i=t._dataController.store()&&t._dataController.store().key();i&&n.some(o=>{if(o.rowType==="data"&&o.key===void 0)return t._dataController.fireError("E1046",i),!0})}_needUpdateRowHeight(e){return e>0&&!this._rowHeight}_getRowsHeight(e){return e=e||this._tableElement,e.children("tbody").children().not(".dx-virtual-row").not(`.${un}`).toArray().reduce((n,i)=>n+Z(i).height,0)}_updateRowHeight(){const e=this,t=e.getTableElement(),n=e._dataController.items().length;if(t&&e._needUpdateRowHeight(n)){const i=e._getRowsHeight(t);e._rowHeight=i/n}}_findContentElement(e){let t=this.element();const n=this.getScrollable();if(t)return n&&(t=g(n.content())),t.children().first()}_getRowElements(e){const t=super._getRowElements(e);return t&&t.not(`.${un}`)}_getFreeSpaceRowElements(e){const t=e||this.getTableElements();return t&&t.children("tbody").children(`.${un}`)}_getNoDataText(){return this.option("noDataText")}_rowClick(e){const t=this._dataController.items()[e.rowIndex]||{};this.executeAction("onRowClick",y({evaluate(n){return ce(n)(t.data)}},e,t))}_rowDblClick(e){const t=this._dataController.items()[e.rowIndex]||{};this.executeAction("onRowDblClick",y({},e,t))}_getColumnsCountBeforeGroups(e){for(let t=0;t<e.length;t++)if(e[t].type==="groupExpand")return t;return 0}_getGroupCellOptions(e){const t=this._getColumnsCountBeforeGroups(e.columns),n=(e.row.groupIndex||0)+t;return{columnIndex:n,colspan:e.columns.length-n-1}}_needWrapRow(){return super._needWrapRow.apply(this,arguments)||!!this.option("dataRowTemplate")}_renderCells(e,t){t.row.rowType==="group"?this._renderGroupedCells(e,t):t.row.values&&super._renderCells(e,t)}_renderGroupedCells(e,t){const{row:n}=t;let i;const{columns:o}=t,{rowIndex:s}=n;let l;const a=this._getGroupCellOptions(t);for(let c=0;c<=a.columnIndex;c++)c===a.columnIndex&&o[c].allowCollapsing&&t.scrollingMode!=="infinite"?(l=!!n.isExpanded,i=o[c]):(l=null,i={command:"expand",cssClass:o[c].cssClass,fixed:o[c].fixed}),this._needRenderCell(c,t.columnIndices)&&this._renderCell(e,{value:l,row:n,rowIndex:s,column:i,columnIndex:c,columnIndices:t.columnIndices,change:t.change});const d=Zt(this.option("rtlEnabled")),u=y({},o[a.columnIndex],{command:null,type:null,cssClass:null,width:null,showWhenGrouped:!1,alignment:d});a.colspan>1&&(u.colspan=a.colspan),this._needRenderCell(a.columnIndex+1,t.columnIndices)&&this._renderCell(e,{value:n.values[n.groupIndex],row:n,rowIndex:s,column:u,columnIndex:a.columnIndex+1,columnIndices:t.columnIndices,change:t.change})}_renderRows(e,t){const n=this,i=n.option("scrolling.mode");super._renderRows(e,y({scrollingMode:i},t)),n._checkRowKeys(t.change),n._renderFreeSpaceRow(e,t.change),n._hasHeight||n.updateFreeSpaceRowHeight(e)}_renderDataRowByTemplate(e,t,n){const{row:i}=t,o=y({columns:t.columns},i),s=this._createRow(i,"tbody");s.appendTo(e),this.renderTemplate(s,n,o,!0,t.change),this._rowPrepared(s,o,t.row)}_renderRow(e,t){const{row:n}=t,{rowTemplate:i}=this.option(),o=this.option("dataRowTemplate");n.rowType==="data"&&o?this._renderDataRowByTemplate(e,t,o):(n.rowType==="data"||n.rowType==="group")&&!f(n.groupIndex)&&i?this.renderTemplate(e,i,y({columns:t.columns},n),!0):super._renderRow(e,t)}_renderTable(e){const t=this,n=super._renderTable(e),i=function(){const o=t.getScrollable();o&&t.element().closest(ve().document).length&&(t.resizeCompleted.remove(i),o._visibilityChanged(!0))};return f(t.getTableElement())?t._renderScrollable():(t.setTableElement(n),t._renderScrollable(!0),t.resizeCompleted.add(i)),n}_createTable(){const e=super._createTable.apply(this,arguments);return(this.option().rowTemplate||this.option().dataRowTemplate)&&e.appendTo(this.component.$element()),e}_renderCore(e){const t=this.element();t.addClass(this.addWidgetPrefix("rowsview")).toggleClass(this.addWidgetPrefix("nowrap"),!this.option("wordWrapEnabled")),t.toggleClass("dx-empty",this._dataController.isEmpty()),this.setAria("role","presentation",t);const n=this._renderTable({change:e}),i=this._updateContent(n,e);return super._renderCore(e),this._lastColumnWidths=null,i}_getRows(e){return e&&e.items||this._dataController.items()}_getCellOptions(e){const t=this,{column:n}=e,{row:i}=e,{data:o}=i,s=i&&i.summaryCells,{value:l}=e,a=v.getDisplayValue(n,l,o,i.rowType),d=super._getCellOptions(e);if(d.value=l,d.oldValue=e.oldValue,d.displayValue=a,d.row=i,d.key=i.key,d.data=o,d.rowType=i.rowType,d.values=i.values,d.text=n.command?"":v.formatValue(a,n),d.rowIndex=i.rowIndex,d.summaryItems=s&&s[e.columnIndex],d.resized=n.resizedCallbacks,f(n.groupIndex)&&!n.command){const u=t.option("grouping.texts"),c=t.option("scrolling.mode");c!=="virtual"&&c!=="infinite"&&(d.groupContinuesMessage=o&&o.isContinuationOnNextPage&&u&&u.groupContinuesMessage,d.groupContinuedMessage=o&&o.isContinuation&&u&&u.groupContinuedMessage)}return d}_toggleDraggableSourceColumnClass(e,t,n,i){const o=this._columnsController,s=o.getColumns(),l=s&&s[n],a=l&&l.isBand&&l.index;b(e,(d,u)=>{if(!g(u).hasClass("dx-group-row"))for(let c=0;c<t.length&&!((Ae(a)&&o.isParentBandColumn(t[c].index,a)||t[c].index===n)&&(e.eq(d).children().eq(c).toggleClass(this.addWidgetPrefix(Pn.draggableColumn),i),!Ae(a)));c++);})}_getDevicePixelRatio(){return ve().devicePixelRatio}renderNoDataText(){return v.renderNoDataText.apply(this,arguments)}getCellOptions(e,t){const n=this._dataController.items()[e];let i,o;return n&&(U(t)?o=this._columnsController.columnOption(t):o=this._columnsController.getVisibleColumns()[t],o&&(i=this._getCellOptions({value:o.calculateCellValue(n.data),rowIndex:n.rowIndex,row:n,column:o}))),i}getRow(e){if(e>=0){const t=this._getRowElements();if(t.length>e)return g(t[e])}}updateFreeSpaceRowHeight(e){const t=this._dataController,n=t.items(!0).length,i=this._findContentElement(),o=this._getFreeSpaceRowElements(e);if(o&&i&&t.totalCount()>=0){let s=!1;if(n>0)if(this._hasHeight)o.hide(),_e(()=>{const l=this.getScrollbarWidth(!0),a=J(this.element())-l,d=se(i),u=a-d>0,c=this._getRowsHeight(i.children().first()),h=e||this.getTableElements(),p=Math.ceil(parseFloat(h.css("borderTopWidth"))),m=this._getHeightCorrection(),C=a-c-p-m;u&&pe(()=>{o.css("height",C),s=!0,o.show()}),pe(()=>this._updateLastRowBorder(s))});else{const l=t.pageSize()-n,a=this.option("scrolling.mode");l>0&&t.pageCount()>1&&a!=="virtual"&&a!=="infinite"&&(li(o,l*this._rowHeight),s=!0),!s&&e?li(o,0):o.toggle(s),this._updateLastRowBorder(s)}else o.css("height",0),o.show(),this._updateLastRowBorder(!0)}}_getHeightCorrection(){const e=ee.webkit&&this._getDevicePixelRatio()>=2,t=ee.chrome&&ee.version>=91,n=ee.mozilla&&ee.version>=70&&!this.option("showRowLines");return e||n||t?1:0}_columnOptionChanged(e){const{optionNames:t}=e;e.changeTypes.grouping||(t.width||t.visibleWidth)&&(super._columnOptionChanged(e),this._fireColumnResizedCallbacks())}getScrollable(){return this._scrollable}_handleDataChanged(e){const t=this;switch(e.changeType){case"refresh":case"prepend":case"append":case"update":t.render(null,e);break;default:t._update(e)}}publicMethods(){return["isScrollbarVisible","getTopVisibleRowData","getScrollbarWidth","getCellElement","getRowElement","getScrollable"]}contentWidth(){return K(this.element())-this.getScrollbarWidth()}getScrollbarWidth(e){const t=this._scrollableContainer&&this._scrollableContainer.get(0);let n=0;return t&&(e?(n=t.clientHeight?t.offsetHeight-t.clientHeight:0,n+=gc(this)):n=t.clientWidth?t.offsetWidth-t.clientWidth:0),n>0?n:0}_fireColumnResizedCallbacks(){const e=this._lastColumnWidths||[],t=[],n=this.getColumns();for(let i=0;i<n.length;i++)t[i]=n[i].visibleWidth,n[i].resizedCallbacks&&!f(n[i].groupIndex)&&e[i]!==t[i]&&n[i].resizedCallbacks.fire(t[i]);this._lastColumnWidths=t}_updateLastRowBorder(e){this.option("showBorders")&&!e?this.element().addClass(Is):this.element().removeClass(Is)}_updateScrollable(){const e=gt.getInstance(this.element());e&&(e.update(),(e.option("useNative")||!(e!=null&&e.isRenovated()))&&this._updateHorizontalScrollPosition())}_updateHorizontalScrollPosition(){const e=this.getScrollable(),t=e&&e.scrollOffset().left;if(this.option("rtlEnabled")){const i=Es(e);i-t!==this._scrollRight&&(this._scrollLeft=i-this._scrollRight)}this._scrollLeft>=0&&t!==this._scrollLeft&&e.scrollTo({x:this._scrollLeft})}_resizeCore(){const e=this;e._fireColumnResizedCallbacks(),e._updateRowHeight(),pe(()=>{e._renderScrollable(),e.renderNoDataText(),e.updateFreeSpaceRowHeight(),_e(()=>{e._updateScrollable()})})}scrollTo(e){const t=this.element(),n=t&&gt.getInstance(t);n&&n.scrollTo(e)}height(e){const t=this,n=this.element();if(arguments.length===0)return n?se(n,!0):0;f(e)&&n&&(t.hasHeight(e!=="auto"),li(n,e))}hasHeight(e){if(arguments.length===0)return!!this._hasHeight;this._hasHeight=e}setLoading(e,t){const n=this;let i=n._loadPanel;const o=n._dataController,s=n.option("loadPanel")||{},l=o.isLoaded()?s.animation:null,a=n.element();if(ft()&&(!i&&t!==void 0&&o.isLocalStore()&&s.enabled==="auto"&&a&&(n._renderLoadPanel(a,a.parent()),i=n._loadPanel),i)){const d={message:t||s.text,animation:l,visible:e};e&&(d.position=v.calculateLoadPanelPosition(a)),clearTimeout(n._hideLoadingTimeoutID),i.option("visible")&&!e?n._hideLoadingTimeoutID=setTimeout(()=>{i.option(d)},200):i.option(d)}}toggleDraggableColumnClass(e,t){const n=this._getRowElements().not(".dx-group-row")||[];this._toggleDraggableSourceColumnClass(n,this.getColumns(),e,t)}_getCellElementsCore(e){const t=super._getCellElementsCore.apply(this,arguments);if(t){const n=t.filter(".dx-group-cell").index();if(n>=0&&t.length>n+1)return t.slice(0,n+1)}return t}_getBoundaryVisibleItemIndex(e,t){const n=this;let i=0,o=0,s=0,l=n._scrollTop;const a=n._findContentElement(),d=a&&a.offset().top,u=this._dataController.items(),c=n.getTableElement();if(u.length&&c){const h=n._getRowElements(c).filter(":visible");if(!e){const p=se(this._hasHeight?this.element():ve());l+=p}for(i=0;i<u.length;i++){o=s;const p=g(h).eq(i);if(p.length&&(s=p.offset(),s=(e?s.top:s.top+se(p))-d,s>l)){i&&(t||2*l<Math.round(s+o))&&i--;break}}i&&i===u.length&&i--}return i}getTopVisibleItemIndex(e){return this._getBoundaryVisibleItemIndex(!0,e)}getBottomVisibleItemIndex(e){return this._getBoundaryVisibleItemIndex(!1,e)}getTopVisibleRowData(){const e=this.getTopVisibleItemIndex(),t=this._dataController.items();if(t[e])return t[e].data}_scrollToElement(e,t){const n=this.getScrollable();n&&n.scrollToElement(e,t)}optionChanged(e){const t=this;switch(super.optionChanged(e),e.name){case"wordWrapEnabled":case"showColumnLines":case"showRowLines":case"rowAlternationEnabled":case"rowTemplate":case"dataRowTemplate":case"twoWayBindingEnabled":t._invalidate(!0,!0),e.handled=!0;break;case"scrolling":t._rowHeight=null,t._tableElement=null,e.handled=!0;break;case"rtlEnabled":t._rowHeight=null,t._tableElement=null;break;case"loadPanel":t._tableElement=null,t._invalidate(!0,e.fullName!=="loadPanel.enabled"),e.handled=!0;break;case"noDataText":t.renderNoDataText(),e.handled=!0}}setAriaOwns(e,t,n){const i=this._findContentElement(),o=this.getTableElement();o!=null&&o.length&&this.setAria("owns",`${e??""} ${o.attr("id")??""} ${t??""}`.trim(),i)}dispose(){super.dispose(),clearTimeout(this._hideLoadingTimeoutID),this._scrollable&&this._scrollable.dispose()}setScrollerSpacing(e,t){}getFixedContentElement(){var e;const t=this.addWidgetPrefix("content-fixed");return(e=this.element())===null||e===void 0?void 0:e.children(`.${t}`)}_restoreErrorRow(e){}isElementInside(e){return e.closest(`.${this.addWidgetPrefix("rowsview")}`).is(this.element())}}const Cl={defaultOptions:()=>({hoverStateEnabled:!1,scrolling:{useNative:"auto"},loadPanel:{enabled:"auto",text:_.format("Loading"),width:200,height:90,showIndicator:!0,indicatorSrc:"",showPane:!0},dataRowTemplate:null,columnAutoWidth:!1,noDataText:_.format("dxDataGrid-noDataText"),wordWrapEnabled:!1,showColumnLines:!0,showRowLines:!1,rowAlternationEnabled:!1,activeStateEnabled:!1,twoWayBindingEnabled:!0}),views:{rowsView:mc}};Cl.views.rowsView;T.registerModule("rows",Cl);const fc="dx-context-menu",Cc={columnHeadersView:"header",rowsView:"content",footerView:"footer",headerPanel:"headerPanel"},_c=["columnHeadersView","rowsView","footerView","headerPanel"];class wc extends L.ViewController{init(){this.createAction("onContextMenuPreparing")}getContextMenuItems(e){if(!e)return!1;const t=this,n=g(e.target);let i,o,s,l;return b(_c,function(){const a=t.getView(this);if(i=a&&a.element(),i&&(i.is(n)||i.find(n).length)){var d;s=n.closest(".dx-row > td, .dx-row > tr"),o=s.parent();const u=a.getRowIndex(o),c=s[0]&&s[0].cellIndex,h=o.data("options"),p={event:e,targetElement:ie(n),target:Cc[this],rowIndex:u,row:a._getRows()[u],columnIndex:c,column:h==null||(d=h.cells)===null||d===void 0||(d=d[c])===null||d===void 0?void 0:d.column};if(p.items=a.getContextMenuItems&&a.getContextMenuItems(p),t.executeAction("onContextMenuPreparing",p),t._contextMenuPrepared(p),l=p.items,l)return!1}}),l}_contextMenuPrepared(e){}}class xc extends L.View{init(){super.init(),this._contextMenuController=this.getController("contextMenu")}_renderCore(){const e=this.element().addClass(fc);this.setAria("role","presentation",e),this._createComponent(e,$r,{onPositioning:t=>{const{event:n}=t,i=t.component,o=this._contextMenuController.getContextMenuItems(n);o?(i.option("items",o),n.stopPropagation()):t.cancel=!0},onItemClick(t){var n,i;(n=t.itemData)===null||n===void 0||(i=n.onItemClick)===null||i===void 0||i.call(n,t)},cssClass:this.getWidgetContainerClass(),target:this.component.$element()})}}const vc={defaultOptions:()=>({onContextMenuPreparing:null}),controllers:{contextMenu:wc},views:{contextMenuView:xc}};T.registerModule("contextMenu",vc);class yc extends L.ViewController{init(){this._resizingController=this.getController("resizing"),this._columnsController=this.getController("columns"),this._columnHeadersView=this.getView("columnHeadersView"),this._rowsView=this.getView("rowsView")}_createErrorRow(e,t){let n,i;const o=this._renderErrorMessage(e);return t?(n=g("<tr>").attr("role","row").addClass("dx-error-row"),i=g("<div>").addClass("dx-closebutton").addClass(this.addWidgetPrefix("action")),x.on(i,te,this.createAction(s=>{var l,a;const d=s.event;let u;const c=g(d.currentTarget).closest(".dx-error-row").index();d.stopPropagation(),b(t,(h,p)=>{u=g(p).children("tbody").children("tr").eq(c),this.removeErrorRow(u)}),(l=this._resizingController)===null||l===void 0||(a=l.fireContentReadyAction)===null||a===void 0||a.call(l)})),g("<td>").attr({colSpan:this._columnsController.getVisibleColumns().length,role:"gridcell"}).prepend(i).append(o).appendTo(n),n):o}_renderErrorMessage(e){const t=e.url?e.message.replace(e.url,""):e.message||e,n=g("<div>").attr("role","alert").attr("aria-roledescription",_.format("dxDataGrid-ariaError")).addClass("dx-error-message").text(t);return e.url&&g("<a>").attr("href",e.url).text(e.url).appendTo(n),n}renderErrorRow(e,t,n){var i,o;const s=this;let l,a;if(n)return n.find(".dx-error-message").remove(),l=s._createErrorRow(e),n.prepend(l),l;const d=t>=0||!s._columnHeadersView.isVisible()?s._rowsView:s._columnHeadersView,u=d.getTableElements();return b(u,(c,h)=>{if(l=s._createErrorRow(e,u),a=a||l,t>=0){const p=d._getRowElements(g(h)).eq(t);s.removeErrorRow(p.next()),l.insertAfter(p)}else{const p=g(h).children("tbody"),m=p.children("tr");s._columnHeadersView.isVisible()?(s.removeErrorRow(m.last()),g(h).append(l)):(s.removeErrorRow(m.first()),p.first().prepend(l))}}),(i=this._resizingController)===null||i===void 0||(o=i.fireContentReadyAction)===null||o===void 0||o.call(i),a}removeErrorRow(e){if(!e){const t=this._columnHeadersView&&this._columnHeadersView.element();if(e=t&&t.find(".dx-error-row"),!e||!e.length){const n=this._rowsView.element();e=n&&n.find(".dx-error-row")}}e&&e.hasClass("dx-error-row")&&e.remove()}optionChanged(e){e.name==="errorRowEnabled"?e.handled=!0:super.optionChanged(e)}}const bc=r=>class extends r{init(){super.init(),this.dataErrorOccurred.add((e,t)=>{this.option("errorRowEnabled")&&this._errorHandlingController.renderErrorRow(e,void 0,t)}),this.changed.add(e=>{if(!(e&&e.changeType==="loadError")&&this._editingController&&!this._editingController.hasChanges()){var t,n;(t=this._errorHandlingController)===null||t===void 0||(n=t.removeErrorRow)===null||n===void 0||n.call(t)}})}},Ic={defaultOptions:()=>({errorRowEnabled:!0}),controllers:{errorHandling:yc},extenders:{controllers:{data:bc}}};T.registerModule("errorHandling",Ic);const Ec={container:"dx-gridbase-a11y-status-container"},Sc=r=>{let{statusText:e}=r;return g("<div>").text(e??"").addClass(Ec.container).attr("role","status")},vo=["columnsSeparatorView","blockSeparatorView","trackerView","headerPanel","columnHeadersView","rowsView","footerView","columnChooserView","filterPanelView","pagerView","draggingHeaderView","contextMenuView","errorView","headerFilterView","filterBuilderView"],Rc={a11yStatusContainer:"e2e-a11y-general-status-container"},St=function(r){return U(r)&&r.endsWith("%")},Tc=function(r){return U(r)&&r.endsWith("px")},_l=function(r,e){const t=r._rowsView.contentWidth(),n=r._getTotalWidth(e,t);return t-n},Vc=function(r,e,t,n){return _l(r,n.map((i,o)=>o===e?t:i))},Fc=function(r,e){gu(r,!0),v.setSelectionRange(r,e)};class Oc extends L.ViewController{init(){this._prevContentMinHeight=null,this._dataController=this.getController("data"),this._columnsController=this.getController("columns"),this._columnHeadersView=this.getView("columnHeadersView"),this._adaptiveColumnsController=this.getController("adaptiveColumns"),this._editorFactoryController=this.getController("editorFactory"),this._footerView=this.getView("footerView"),this._rowsView=this.getView("rowsView"),this._gridView=this.getView("gridView")}_initPostRenderHandlers(){this._refreshSizesHandler||(this._refreshSizesHandler=e=>{let t=new E().resolve(null);const n=e==null?void 0:e.changeType,i=e==null?void 0:e.isDelayed,o=n&&n!=="updateSelection"&&n!=="updateFocusedRow"&&n!=="pageIndex"&&!i;this._dataController.changed.remove(this._refreshSizesHandler),this._checkSize()&&(t=this._refreshSizes(e)),o&&F(t).done(()=>{this._setAriaLabel(),this.fireContentReadyAction()})},this._dataController.changed.add(()=>{this._dataController.changed.add(this._refreshSizesHandler)}))}_refreshSizes(e){let t=new E().resolve(null);const n=e==null?void 0:e.changeType,i=e==null?void 0:e.isDelayed,o=this._dataController.items();if(!e||n==="refresh"||n==="prepend"||n==="append")i||(t=this.resize());else if(n==="update"){var s;if(((s=e.changeTypes)===null||s===void 0?void 0:s.length)===0)return t;(o.length>1||e.changeTypes[0]!=="insert")&&!(o.length===0&&e.changeTypes[0]==="remove")&&!e.needUpdateDimensions?(t=new E,this._waitAsyncTemplates().done(()=>{_e(()=>pe(()=>_e(()=>{this._setScrollerSpacing(),this._rowsView.resize(),t.resolve()})))}).fail(t.reject)):t=this.resize()}return t}fireContentReadyAction(){this.component._fireContentReadyAction()}_getWidgetAriaLabel(){return"dxDataGrid-ariaDataGrid"}_setAriaLabel(){var e;const t=((e=this._columnsController)===null||e===void 0||(e=e._columns)===null||e===void 0?void 0:e.filter(d=>{let{visible:u}=d;return!!u}).length)??0,n=Math.max(0,this._dataController.totalItemsCount()),i=this._getWidgetAriaLabel(),o=_.format(i,n,t),s=this.component.$element().children(".dx-gridbase-container"),l=_.format(this._expandableWidgetAriaId),a=[o];l&&a.push(l),this.component.setAria("label",a.join(". "),s),this._gridView.setWidgetA11yStatusText(o)}_getBestFitWidths(){var e;const t=this._rowsView,n=this._columnHeadersView;let i=t.getColumnWidths();if(!((e=i)!==null&&e!==void 0&&e.length)){var o;const s=n.getTableElement();n.setTableElement((o=t.getTableElement())===null||o===void 0?void 0:o.children(".dx-header")),i=n.getColumnWidths(),n.setTableElement(s)}return i}_setVisibleWidths(e,t){const n=this._columnsController;n.beginUpdate(),b(e,(i,o)=>{const s=n.getColumnId(o);n.columnOption(s,"visibleWidth",t[i])}),n.endUpdate()}_toggleBestFitModeForView(e,t,n){if(!e||!e.isVisible())return;const i=this._rowsView.getTableElements(),o=e.getTableElements();b(i,(s,l)=>{let a;const d=g(l),u=o.eq(s);u&&u.length&&(n?a=u.children("tbody").appendTo(d):a=d.children(`.${t}`).appendTo(u),a.toggleClass(t,n),a.toggleClass(this.addWidgetPrefix("best-fit"),n))})}_toggleBestFitMode(e){const t=this._rowsView.getTableElement(),n=this._rowsView.getTableElements().eq(1);t&&(t.css("tableLayout",e?"auto":"fixed"),t.children("colgroup").css("display",e?"none":""),b(n.find("tr.dx-group-row"),(i,o)=>{g(o).css("display",e?"none":"")}),n.toggleClass(this.addWidgetPrefix("table-fixed"),!e),this._toggleBestFitModeForView(this._columnHeadersView,"dx-header",e),this._toggleBestFitModeForView(this._footerView,"dx-footer",e),this._needStretch()&&(t.get(0).style.width=e?"auto":""))}_toggleContentMinHeight(e){const t=this._rowsView.getScrollable(),n=this._rowsView._findContentElement();(t==null?void 0:t.option("useNative"))===!1&&(e===!0&&(this._prevContentMinHeight=n.get(0).style.minHeight),f(this._prevContentMinHeight)&&n.css({minHeight:e?v.getContentHeightLimit(ee):this._prevContentMinHeight}))}_synchronizeColumns(){const e=this._columnsController,t=e.getVisibleColumns(),n=this.option("columnAutoWidth"),i=this.option("wordWrapEnabled"),o=t.some(m=>!f(m.width));let s=this._needBestFit(),l=!1,a,d=!1,u=[],c,h;!s&&b(t,(m,C)=>{if(C.width==="auto")return s=!0,!1}),b(t,(m,C)=>{if(C.minWidth)return l=!0,!1}),this._setVisibleWidths(t,[]);const p=this.component.$element();s&&(c=M.getActiveElement(p.get(0)),h=v.getSelectionRange(c),this._toggleBestFitMode(!0),a=!0),this._toggleContentMinHeight(i),p&&p.get(0)&&this._maxWidth&&(delete this._maxWidth,p[0].style.maxWidth=""),_e(()=>{s?(u=this._getBestFitWidths(),b(t,(m,C)=>{const w=e.getColumnId(C);e.columnOption(w,"bestFitWidth",u[m],!0)})):l&&(u=this._getBestFitWidths()),b(t,function(m){const{width:C}=this;C!=="auto"&&(f(C)?u[m]=Ae(C)||Tc(C)?parseFloat(C):C:n||(u[m]=void 0))}),a&&(this._toggleBestFitMode(!1),a=!1,c&&c!==M.getActiveElement()&&(Z(c).bottom<0||Fc(c,h))),d=this._correctColumnWidths(u,t),n&&(function(){let m;b(t,(C,w)=>{w.type==="groupExpand"&&(m=u[C])}),b(t,(C,w)=>{w.type==="groupExpand"&&m&&(u[C]=m)})}(),this._needStretch()&&this._processStretch(u,t)),pe(()=>{(s||d||o)&&this._setVisibleWidths(t,u),i&&this._toggleContentMinHeight(!1)})})}_needBestFit(){return this.option("columnAutoWidth")}_needStretch(){return this._columnsController.getVisibleColumns().some(e=>e.width==="auto"&&!e.command)}_getAverageColumnsWidth(e){const t=_l(this,e),n=e.filter(i=>i===void 0).length;return t/n}_correctColumnWidths(e,t){const n=this;let i,o=!1,s=!1,l=!1;const a=n.component.$element(),d=n._hasWidth;for(i=0;i<t.length;i++){const u=i,c=t[u],h=e[u]==="adaptiveHidden";let p=e[u];const{minWidth:m}=c;m&&(p===void 0?p=n._getAverageColumnsWidth(e):St(p)&&Vc(n,u,m,e)<0&&(p=-1));const C=n._getRealColumnWidth(u,e.map((w,S)=>u===S?p:w));m&&!h&&C<m&&(e[u]=m,l=!0,i=-1),f(c.width)||(s=!0),St(c.width)&&(o=!0)}if(!s&&e.length){const u=n._rowsView.element(),c=n._rowsView.contentWidth(),h=n._rowsView.getScrollbarWidth(),p=n._getTotalWidth(e,c);if(p<c){const m=v.getLastResizableColumnIndex(t,e);if(m>=0&&(e[m]="auto",l=!0,d===!1&&!o)){const C=v.getComponentBorderWidth(this,u);n._maxWidth=p+h+C,a.css("maxWidth",n._maxWidth)}}}return l}_processStretch(e,t){const n=this._rowsView.contentWidth(),i=this._getTotalWidth(e,n),o={length:0};if(!e.length)return;b(t,function(d){(this.width||e[d]==="adaptiveHidden")&&(o[d]=!0,o.length++)});const s=n-i,l=Math.floor(s/(e.length-o.length));let a=s-l*(e.length-o.length);if(s>=0)for(let d=0;d<e.length;d++)o[d]||(e[d]+=l,a>0&&(a<1?(e[d]+=a,a=0):(e[d]++,a--)))}_getRealColumnWidth(e,t,n){let i=1;const o=t[e];if(!St(o))return parseFloat(o);const s=t.reduce((u,c,h)=>St(c)?u+parseFloat(c):u,0),l=t.reduce((u,c)=>!c||c==="adaptiveHidden"||St(c)?u:u+parseFloat(c),0);n=n||this._rowsView.contentWidth();const a=n-l,d=s*n/100;return l>0&&d+l>=n&&(i=d>a?a/d:1),parseFloat(o)*n*i/100}_getTotalWidth(e,t){let n=0;for(let i=0;i<e.length;i++){const o=e[i];o&&o!=="adaptiveHidden"&&(n+=this._getRealColumnWidth(i,e,t))}return Math.ceil(n)}_getGroupElement(){return this.component.$element().children().get(0)}updateSize(e){const t=this,n=g(e),i=t.addWidgetPrefix("important-margin");if(t._hasHeight===void 0&&n&&n.is(":visible")&&K(n)){const o=n.children(`.${t.getWidgetContainerClass()}`);o.length&&o.detach(),t._hasHeight=!!J(n);const s=K(n);n.addClass(i),t._hasWidth=K(n)===s,n.removeClass(i),o.length&&o.appendTo(n)}}publicMethods(){return["resize","updateDimensions"]}_waitAsyncTemplates(){var e,t,n;return F((e=this._columnHeadersView)===null||e===void 0?void 0:e.waitAsyncTemplates(!0),(t=this._rowsView)===null||t===void 0?void 0:t.waitAsyncTemplates(!0),(n=this._footerView)===null||n===void 0?void 0:n.waitAsyncTemplates(!0))}resize(){if(this.component._requireResize)return new E().resolve();const e=new E;return this._waitAsyncTemplates().done(()=>{F(this.updateDimensions()).done(e.resolve).fail(e.reject)}).fail(e.reject),e.promise()}updateDimensions(e){const t=this;if(t._initPostRenderHandlers(),!t._checkSize(e))return;const n=t._resizeDeferred,i=t._resizeDeferred=new E;return F(n).always(()=>{pe(()=>{t._dataController.isLoaded()&&t._synchronizeColumns(),t._resetGroupElementHeight(),_e(()=>{pe(()=>{_e(()=>{t._updateDimensionsCore()})})})}).done(i.resolve).fail(i.reject)}),i.promise()}_resetGroupElementHeight(){const e=this._getGroupElement(),t=this._rowsView.getScrollable();e&&e.style.height&&(!t||!t.scrollTop())&&(e.style.height="")}_checkSize(e){const t=this.component.$element(),n=t.is(":visible"),i=this._lastWidth!==K(t)||this._lastHeight!==J(t)||this._devicePixelRatio!==ve().devicePixelRatio;return n&&(!e||i)}_setScrollerSpacingCore(){const e=this,t=e._rowsView.getScrollbarWidth(),n=e._rowsView.getScrollbarWidth(!0);pe(()=>{e._columnHeadersView&&e._columnHeadersView.setScrollerSpacing(t),e._footerView&&e._footerView.setScrollerSpacing(t),e._rowsView.setScrollerSpacing(t,n)})}_setScrollerSpacing(){const e=this._rowsView.getScrollable(),t=this.option("scrolling.useNative")===!0;!e||t?pe(()=>{_e(()=>{this._setScrollerSpacingCore()})}):this._setScrollerSpacingCore()}_setAriaOwns(){var e,t,n;const i=(e=this._columnHeadersView)===null||e===void 0?void 0:e.getTableElement(),o=(t=this._footerView)===null||t===void 0?void 0:t.getTableElement();(n=this._rowsView)===null||n===void 0||n.setAriaOwns(i==null?void 0:i.attr("id"),o==null?void 0:o.attr("id"))}_updateDimensionsCore(){const e=this,t=e._dataController,n=e._rowsView,i=e.component.$element(),o=this._getGroupElement(),s=J(i),l=e.option("height")??i.get(0).style.height,a=!!l&&l!=="auto",d=parseInt(i.css("maxHeight")),u=d&&s>=d,c=o&&o.scrollHeight===o.offsetHeight;e.updateSize(i),pe(()=>{const h=e._hasHeight||!!d||a;if(n.hasHeight(h),this._setAriaOwns(),u&&!c&&g(o).css("height",d),!t.isLoaded()){n.setLoading(t.isLoading());return}_e(()=>{e._updateLastSizes(i),e._setScrollerSpacing(),b(vo,(p,m)=>{const C=e.getView(m);C&&C.resize()}),this._editorFactoryController&&this._editorFactoryController.resize()})})}_updateLastSizes(e){this._lastWidth=K(e),this._lastHeight=J(e),this._devicePixelRatio=ve().devicePixelRatio}optionChanged(e){switch(e.name){case"width":case"height":this.component._renderDimensions(),this.resize();case"renderAsync":e.handled=!0;return;default:super.optionChanged(e)}}}class Dc extends L.ViewController{_scrollChangedHandler(e,t,n){for(let i=0;i<e.length;i++)e[i]&&e[i].name!==n&&e[i].scrollTo({left:t.left,top:t.top})}init(){const e=[this.getView("columnHeadersView"),this.getView("footerView"),this.getView("rowsView")];for(let t=0;t<e.length;t++){const n=e[t];n&&n.scrollChanged.add(this._scrollChangedHandler.bind(this,e))}}}class Pc extends L.View{init(){this._resizingController=this.getController("resizing"),this._dataController=this.getController("data")}_endUpdateCore(){this.component._requireResize&&(this.component._requireResize=!1,this._resizingController.resize())}getView(e){return this.component._views[e]}element(){return this._groupElement}optionChanged(e){const t=this;f(t._groupElement)&&e.name==="showBorders"?(t._groupElement.toggleClass(t.addWidgetPrefix("borders"),!!e.value),e.handled=!0):super.optionChanged(e)}_renderViews(e){const t=this;b(vo,(n,i)=>{const o=t.getView(i);o&&o.render(e)})}_getTableRoleName(){return"group"}render(e){const t=!this._groupElement,n=this._groupElement||g("<div>").addClass(this.getWidgetContainerClass());n.addClass("dx-gridbase-container"),n.toggleClass(this.addWidgetPrefix("borders"),!!this.option("showBorders")),this.setAria("role","presentation",e),this.component.setAria("role",this._getTableRoleName(),n),this._rootElement=e||this._rootElement,t&&(this._groupElement=n,ft()&&this._resizingController.updateSize(e),n.appendTo(e)),this._a11yGeneralStatusElement||(this._a11yGeneralStatusElement=Sc({}),this._a11yGeneralStatusElement.attr(Rc.a11yStatusContainer,"true"),n.append(this._a11yGeneralStatusElement)),this._renderViews(n)}update(){const e=this,t=e._rootElement,n=e._groupElement;t&&n&&(this._resizingController.resize(),e._dataController.isLoaded()&&e._resizingController.fireContentReadyAction())}setWidgetA11yStatusText(e){var t;(t=this._a11yGeneralStatusElement)===null||t===void 0||t.text(e)}}const Ac={defaultOptions:()=>({showBorders:!1,renderAsync:!1}),controllers:{resizing:Oc,synchronizeScrolling:Dc},views:{gridView:Pc},VIEW_NAMES:vo};T.registerModule("gridView",Ac);const Rs=["addRowButton","applyFilterButton","columnChooserButton","exportButton","groupPanel","revertButton","saveButton","searchPanel"];class kc extends sn{init(){super.init(),this._editingController=this.getController("editing"),this._headerFilterController=this.getController("headerFilter"),this.createAction("onToolbarPreparing",{excludeValidators:["disabled","readOnly"]})}_getToolbarItems(){return[]}_getButtonContainer(){return g("<div>").addClass(this.addWidgetPrefix("toolbar-button"))}_getToolbarButtonClass(e){const t=e?` ${e}`:"";return this.addWidgetPrefix("toolbar-button")+t}_getToolbarOptions(){const e=this.option("toolbar"),t={toolbarOptions:{items:this._getToolbarItems(),visible:e==null?void 0:e.visible,disabled:e==null?void 0:e.disabled,onItemRendered(i){const o=i.itemData.onItemRendered;o&&o(i)}}},n=e==null?void 0:e.items;if(t.toolbarOptions.items=this._normalizeToolbarItems(t.toolbarOptions.items,n),this.executeAction("onToolbarPreparing",t),t.toolbarOptions&&!f(t.toolbarOptions.visible)){const i=t.toolbarOptions.items;t.toolbarOptions.visible=!!(i!=null&&i.length)}return t.toolbarOptions}_normalizeToolbarItems(e,t){e.forEach(l=>{if(!Rs.includes(l.name))throw new Error(`Default toolbar item '${l.name}' is not added to DEFAULT_TOOLBAR_ITEM_NAMES`)});const n={location:"after"},i=Array.isArray(t);if(!f(t))return e;i||(t=[t]);const o={};e.forEach(l=>{o[l.name]=l});const s=t.map(l=>(U(l)&&(l={name:l}),f(l.name)&&(f(o[l.name])?l=y(!0,{},o[l.name],l):Rs.includes(l.name)&&(l=A({},l,{visible:!1}))),y(!0,{},n,l)));return i?s:s[0]}_renderCore(){if(this._toolbar)this._toolbar.option(this._toolbarOptions);else{const e=this.element();e.addClass(this.addWidgetPrefix("header-panel"));const t=_.format(this.component.NAME+"-ariaToolbar"),n=g("<div>").attr("aria-label",t).appendTo(e);this._toolbar=this._createComponent(n,_d,this._toolbarOptions)}}_columnOptionChanged(){}_handleDataChanged(){this._requireReady&&this.render()}_isDisabledDefinedByUser(e){var t;const n=(t=this.option("toolbar"))===null||t===void 0?void 0:t.items,i=n==null?void 0:n.find(o=>(o==null?void 0:o.name)===e);return f(i==null?void 0:i.disabled)}render(){this._toolbarOptions=this._getToolbarOptions(),super.render.apply(this,arguments)}setToolbarItemDisabled(e,t){const n=this._toolbar,i=this._isDisabledDefinedByUser(e);if(!n||i)return;const s=(n.option("items")??[]).findIndex(a=>a.name===e);if(s<0)return;const l=n.option(`items[${s}]`);n.option(`items[${s}].disabled`,t),l.options&&n.option(`items[${s}].options.disabled`,t)}updateToolbarDimensions(){var e;(e=this._toolbar)===null||e===void 0||e.updateDimensions()}getHeaderPanel(){return this.element()}getHeight(){return this.getElementHeight()}optionChanged(e){if(e.name==="onToolbarPreparing"&&(this._invalidate(),e.handled=!0),e.name==="toolbar"){const s=wd(e.fullName),l=e.fullName.replace(/^toolbar\./,"");if(s.length===1||s[1]==="visible")this._invalidate();else if(s[1]==="items"){if(s.length===2){var t;const a=this._getToolbarOptions();(t=this._toolbar)===null||t===void 0||t.option("items",a.items)}else if(s.length===3){var n;const a=this._normalizeToolbarItems(this._getToolbarItems(),e.value);(n=this._toolbar)===null||n===void 0||n.option(l,a)}else if(s.length>=4){var i;(i=this._toolbar)===null||i===void 0||i.option(l,e.value)}}else{var o;(o=this._toolbar)===null||o===void 0||o.option(l,e.value)}e.handled=!0}super.optionChanged(e)}isVisible(){return!!(this._toolbarOptions&&this._toolbarOptions.visible)}allowDragging(){}hasGroupedColumns(){}}const Bc=r=>class extends r{_updateDimensionsCore(){super._updateDimensionsCore.apply(this,arguments),this.getView("headerPanel").updateToolbarDimensions()}},wl={defaultOptions:()=>({}),views:{headerPanel:kc},extenders:{controllers:{resizing:Bc}}};wl.views.headerPanel;T.registerModule("headerPanel",wl);class Mc extends Dr{_getDefaultOptions(){const e=super._getDefaultOptions();return b(this.getGridCoreHelper().modules,function(){X(this.defaultOptions)&&y(!0,e,this.defaultOptions())}),e}_init(){this._activeStateUnit=".dx-row",super._init()}_setDeprecatedOptions(){super._setDeprecatedOptions(),y(this._deprecatedOptions,{"columnChooser.allowSearch":{since:"23.1",message:'Use the "columnChooser.search.enabled" option instead'},"columnChooser.searchTimeout":{since:"23.1",message:'Use the "columnChooser.search.timeout" option instead'}})}_clean(){}_optionChanged(e){this.getGridCoreHelper().callModuleItemsMethod(this,"optionChanged",[e]),e.handled||super._optionChanged(e)}_dimensionChanged(){this.updateDimensions(!0)}_visibilityChanged(e){e&&this.updateDimensions()}_renderContentImpl(){this.getView("gridView").update()}_renderContent(){const e=this;pe(()=>{e._renderContentImpl()})}_dispose(){super._dispose(),this.getGridCoreHelper().callModuleItemsMethod(this,"dispose")}isReady(){return this.getController("data").isReady()}getController(e){return this._controllers[e]}getView(e){return this._views[e]}getGridCoreHelper(){}beginUpdate(){super.beginUpdate(),this.getGridCoreHelper().callModuleItemsMethod(this,"beginUpdate")}endUpdate(){this.getGridCoreHelper().callModuleItemsMethod(this,"endUpdate"),super.endUpdate()}}const Nc="Specifying grid templates with the jQuery selector name is now deprecated. Use the DOM Node or the jQuery object that references this selector instead.";T.registerModulesOrder(["stateStoring","columns","selection","editorFactory","columnChooser","grouping","editing","editingRowBased","editingFormBased","editingCellBased","masterDetail","validating","adaptivity","data","virtualScrolling","columnHeaders","filterRow","headerPanel","headerFilter","sorting","search","rows","pager","columnsResizingReordering","contextMenu","keyboardNavigation","errorHandling","summary","columnFixing","export","gridView"]);let xl=class extends Mc{_defaultOptionsRules(){return super._defaultOptionsRules().concat([{device:{platform:"ios"},options:{showRowLines:!0}},{device:()=>xd(),options:{showRowLines:!0,showColumnLines:!1,headerFilter:{height:315},editing:{useIcons:!0},selection:{showCheckBoxesMode:"always"}}},{device:()=>ee.webkit,options:{loadingTimeout:30,loadPanel:{animation:{show:{easing:"cubic-bezier(1, 0, 1, 0)",duration:500,from:{opacity:0},to:{opacity:1}}}}}},{device:e=>e.deviceType!=="desktop",options:{grouping:{expandMode:"rowClick"}}}])}_init(){super._init(),v.logHeaderFilterDeprecatedWarningIfNeed(this),T.processModules(this,T),T.callModuleItemsMethod(this,"init")}_initMarkup(){super._initMarkup.apply(this,arguments),this.getView("gridView").render(this.$element())}_setDeprecatedOptions(){super._setDeprecatedOptions(),y(this._deprecatedOptions,{useKeyboard:{since:"19.2",alias:"keyboardNavigation.enabled"},rowTemplate:{since:"21.2",message:'Use the "dataRowTemplate" option instead'}})}static registerModule(e,t){T.registerModule(e,t)}getGridCoreHelper(){return T}_getTemplate(e){let t=e;return U(t)&&t.startsWith("#")&&(t=g(e),vd.warn(Nc)),super._getTemplate(t)}focus(e){this.getController("keyboardNavigation").focus(e)}};uo("dxDataGrid",xl);const Lc=r=>{const e=r.getView("pagerView"),t=r.getController("data"),n={allowedPageSizes:e?e.getPageSizes():void 0,filterPanel:{filterEnabled:r.option("filterPanel.filterEnabled")},filterValue:r.option("filterValue"),focusedRowKey:r.option("focusedRowEnabled")?r.option("focusedRowKey"):void 0};return y(n,t.getUserState())},Hc=r=>{const e=r.getController("columns"),t=r.getController("selection"),n=r.getController("export"),i=r.getController("data");e&&e.columnsChanged.add(()=>{r.updateState({columns:e.getUserState()})}),t&&t.selectionChanged.add(o=>{r.updateState({selectedRowKeys:o.selectedRowKeys,selectionFilter:o.selectionFilter})}),i&&(r._initialPageSize=r.option("paging.pageSize"),r._initialFilterValue=r.option("filterValue"),i.changed.add(()=>{const o=Lc(r);r.updateState(o)})),n&&n.selectionOnlyChanged.add(()=>{r.updateState({exportSelectionOnly:n.selectionOnly()})})},zc=(r,e)=>{const t=r.getController("filterSync"),n=r.getController("columns"),i=e.columns||e.filterValue!==void 0;return t?i?e.filterValue||t.getFilterValueFromColumns(e.columns):r._initialFilterValue||t.getFilterValueFromColumns(n.getColumns()):null},Wc=r=>class extends r{init(){super.init(),this._dataController.stateLoaded.add(()=>{if(this._dataController.isLoaded()&&!this._dataController.getDataSource()){this.setLoading(!1),this.renderNoDataText();const e=this.component.getView("columnHeadersView");e&&e.render(),this.component._fireContentReadyAction()}})}},$c=r=>class extends r{init(){return super.init.apply(this,arguments),Hc(this),this}isLoading(){return super.isLoading()||this.getDataController().isStateLoading()}state(e){const t=super.state.apply(this,arguments);return e!==void 0&&this.applyState(y(!0,{},e)),t}updateState(e){if(this.isEnabled()){const t=this.state(),n=y({},t,e),i=$e(t),o=$e(n);G(i,o)||(e=y(!0,{},e),y(this._state,e),this.save())}else y(this._state,e)}applyState(e){var t;const{allowedPageSizes:n}=e,{searchText:i}=e,{selectedRowKeys:o}=e,{selectionFilter:s}=e,l=this.option("scrolling.mode"),a=l==="virtual"||l==="infinite",d=this.option("pager.visible")===!0&&this.option("pager.showPageSizeSelector"),u=(t=this.getView("rowsView"))===null||t===void 0?void 0:t.hasHeight();this.component.beginUpdate(),this.getColumnsController()&&this.getColumnsController().setUserState(e.columns),this.getExportController()&&this.getExportController().selectionOnly(e.exportSelectionOnly),this.option("selection.deferred")||this.option("selectedRowKeys",o||[]),this.option("selectionFilter",s),n&&this.option("pager.allowedPageSizes")==="auto"&&(this.option("pager").allowedPageSizes=n),this.option("focusedRowEnabled")&&(this.option("focusedRowIndex",-1),this.option("focusedRowKey",e.focusedRowKey??null)),this.component.endUpdate(),this.option("searchPanel.text",i||""),this.option("filterValue",zc(this,e)),this.option("filterPanel.filterEnabled",e.filterPanel?e.filterPanel.filterEnabled:!0),this.option("paging.pageIndex",(!a||u)&&e.pageIndex||0),this.option("paging.pageSize",(!a||d)&&f(e.pageSize)?e.pageSize:this._initialPageSize),this.getDataController()&&this.getDataController().reset()}},Gc=r=>class extends r{_shouldReturnVisibleColumns(){return super._shouldReturnVisibleColumns.apply(this,arguments)&&(!this._stateStoringController.isEnabled()||this._stateStoringController.isLoaded())}},Kc=r=>class extends r{dispose(){clearTimeout(this._restoreStateTimeoutID),super.dispose()}callbackNames(){return super.callbackNames().concat(["stateLoaded"])}_refreshDataSource(){if(this._stateStoringController.isEnabled()&&!this._stateStoringController.isLoaded()){clearTimeout(this._restoreStateTimeoutID);const e=new E;return this._restoreStateTimeoutID=setTimeout(()=>{this._stateStoringController.load().always(()=>{this._restoreStateTimeoutID=null}).done(()=>{super._refreshDataSource(),this.stateLoaded.fire(),e.resolve()}).fail(t=>{this.stateLoaded.fire(),this._handleLoadError(t||"Unknown error"),e.reject()})}),e.promise()}this.isStateLoading()||super._refreshDataSource()}isLoading(){return super.isLoading()||this._stateStoringController.isLoading()}isStateLoading(){return f(this._restoreStateTimeoutID)}isLoaded(){return super.isLoaded()&&!this.isStateLoading()}},Uc=r=>class extends r{_fireSelectionChanged(e){const t=this.option("selection.deferred");this._stateStoringController.isLoading()&&t||super._fireSelectionChanged.apply(this,arguments)}},jc={defaultOptions:()=>({stateStoring:{enabled:!1,storageKey:null,type:"localStorage",customLoad:null,customSave:null,savingTimeout:2e3}}),controllers:{stateStoring:nu},extenders:{views:{rowsView:Wc},controllers:{stateStoring:$c,columns:Gc,data:Kc,selection:Uc}}};T.registerModule("stateStoring",jc);const qc="dx-select-checkboxes-hidden",Se="selection.showCheckBoxesMode",Lt="selection.mode",vl=function(r,e){const t=r.getView("rowsView"),n=r.getController("selection"),i=g(e.target).closest(".dx-data-row"),o=t.getRowIndex(i);o<0||(r.option(Se)==="onLongTap"?n.isSelectionWithCheckboxes()?n.stopSelectionWithCheckboxes():n.startSelectionWithCheckboxes():(r.option(Se)==="onClick"&&n.startSelectionWithCheckboxes(),r.option(Se)!=="always"&&n.changeItemSelection(o,{control:!0})))},Xc=function(r,e){let t=0;const n=r._dataController.store(),i=n&&n.key(),o=Array.isArray(i);if(!e.length)return!1;if(o&&Array.isArray(e[0])&&e[1]==="and"){for(let s=0;s<e.length;s++)if(Array.isArray(e[s])){if(e[s][0]!==i[t]||e[s][1]!=="=")return!0;t++}return!1}return i!==e[0]},Yc=(r,e)=>{const{component:t}=e,n=t.getView("rowsView");t.option("renderAsync")&&!t.option("selection.deferred")&&(e.value=t.isRowSelected(e.row.key)),n.renderSelectCheckBoxContainer(g(r),e)},Qc=(r,e)=>{const{column:t}=e,n=g(r),i=e.component.getView("columnHeadersView");n.addClass("dx-editor-cell"),i._renderSelectAllCheckBox(n,t),i._attachSelectAllCheckBoxClickEvent(n)};class Jc extends L.Controller{init(){const{deferred:e,selectAllMode:t,mode:n}=this.option("selection")??{};this.option("scrolling.mode")==="infinite"&&!e&&n==="multiple"&&t==="allPages"&&oe.log("W1018"),this._dataController=this.getController("data"),this._columnsController=this.getController("columns"),this._stateStoringController=this.getController("stateStoring"),this._selectionMode=n,this._isSelectionWithCheckboxes=!1,this._selection=this._createSelection(),this._updateSelectColumn(),this.createAction("onSelectionChanged",{excludeValidators:["disabled","readOnly"]}),this._dataPushedHandler||(this._dataPushedHandler=this._handleDataPushed.bind(this),this._dataController.pushed.add(this._dataPushedHandler))}_handleDataPushed(e){this._deselectRemovedOnPush(e),this._updateSelectedOnPush(e)}_deselectRemovedOnPush(e){const t=this.option("selection.deferred");let n=e.filter(i=>i.type==="remove").map(i=>i.key);if(t){const i=this._dataController.items().filter(o=>o.isSelected).map(o=>o.key);n=n.filter(o=>i.find(s=>G(s,o)))}n.length&&this.deselectRows(n)}_updateSelectedOnPush(e){if(this.option("selection.deferred"))return;const n=e.filter(o=>o.type==="update"),i=this.getSelectedRowsData();xn({keyInfo:this._selection.options,data:i,changes:n})}_getSelectionConfig(){const e=this._dataController,t=this._columnsController,n=this.option("selection")??{},{deferred:i}=n,o=this.option("scrolling.mode"),s=o==="virtual"||o==="infinite",l=this.option("selection.allowSelectAll"),a=this.option("scrolling.legacyMode");return{selectedKeys:this.option("selectedRowKeys"),mode:this._selectionMode,deferred:i,alwaysSelectByShift:n.alwaysSelectByShift,maxFilterLengthInRequest:n.maxFilterLengthInRequest,selectionFilter:this.option("selectionFilter"),ignoreDisabledItems:!0,isVirtualPaging:s,sensitivity:this.option("selection.sensitivity"),allowLoadByRange(){const d=t.getGroupColumns().length>0;return s&&!a&&!d&&l&&!i},key:()=>e==null?void 0:e.key(),keyOf:d=>e==null?void 0:e.keyOf(d),dataFields(){var d;return(d=e.dataSource())===null||d===void 0?void 0:d.select()},load(d){var u;return((u=e.dataSource())===null||u===void 0?void 0:u.load(d))||new E().resolve([])},plainItems:d=>e.items(!0),isItemSelected:d=>d.selected,isSelectableItem:d=>(d==null?void 0:d.rowType)==="data"&&!d.isNewRow,getItemData:d=>f(d==null?void 0:d.rowType)?(d==null?void 0:d.oldData)||(d==null?void 0:d.data):d,filter:()=>e.getCombinedFilter(i),totalCount:()=>e.totalCount(),getLoadOptions(d,u,c){var h;const{sort:p,filter:m}=((h=e.dataSource())===null||h===void 0?void 0:h.lastLoadOptions())??{};let C=Math.min(d,u),w=Math.max(d,u);f(c)&&(C=Math.min(c,C),w=Math.max(c,w));const S=w-C+1;return{skip:C,take:S,filter:m,sort:p}},onSelectionChanged:this._updateSelectedItems.bind(this)}}_updateSelectColumn(){const e=this._columnsController,t=this.isSelectColumnVisible();e.addCommandColumn({type:"selection",command:"select",visible:t,visibleIndex:-1,dataType:"boolean",alignment:"center",cssClass:"dx-command-select",width:"auto",cellTemplate:Yc,headerCellTemplate:Qc}),e.columnOption("command:select","visible",t)}_createSelection(){const e=this._getSelectionConfig();return new yd(e)}_fireSelectionChanged(e){const t=this.option("selection.deferred")?{selectionFilter:this.option("selectionFilter")}:{selectedRowKeys:this.option("selectedRowKeys")};this.selectionChanged.fire(t),e&&this.executeAction("onSelectionChanged",e)}_updateCheckboxesState(e){const{isDeferredMode:t}=e,{selectionFilter:n}=e,{selectedItemKeys:i}=e,{removedItemKeys:o}=e;this.option(Se)==="onClick"&&((t?n&&Xc(this,n):i.length>1)?this.startSelectionWithCheckboxes():(t?n&&!n.length:i.length===0&&o.length)&&this.stopSelectionWithCheckboxes())}_updateSelectedItems(e){const t=this;let n;const i=t.option("selection.deferred"),o=t._selection.selectionFilter(),s=t._dataController,l=s.items(!0),a=s.items();if(!l)return;const d=t.isSelectionWithCheckboxes(),u=t.getChangedItemIndexes(l),c=t.getChangedItemIndexes(a);t._updateCheckboxesState({selectedItemKeys:e.selectedItemKeys,removedItemKeys:e.removedItemKeys,selectionFilter:o,isDeferredMode:i}),(u.length||d!==t.isSelectionWithCheckboxes())&&s.updateItems({changeType:"updateSelection",itemIndexes:c}),i?(t.option("selectionFilter",o),n={}):(e.addedItemKeys.length||e.removedItemKeys.length)&&(t._selectedItemsInternalChange=!0,t.option("selectedRowKeys",e.selectedItemKeys.slice(0)),t._selectedItemsInternalChange=!1,n={selectedRowsData:e.selectedItems.slice(0),selectedRowKeys:e.selectedItemKeys.slice(0),currentSelectedRowKeys:e.addedItemKeys.slice(0),currentDeselectedRowKeys:e.removedItemKeys.slice(0)}),t._fireSelectionChanged(n)}getChangedItemIndexes(e){const t=this,n=[],i=this.option("selection.deferred");for(let o=0,{length:s}=e;o<s;o++){const l=e[o],a=t.isRowSelected(i?l.data:l.key);t._selection.isDataItem(l)&&l.isSelected!==a&&n.push(o)}return n}callbackNames(){return["selectionChanged"]}optionChanged(e){var t;super.optionChanged(e);const n=!!((t=this._selection)!==null&&t!==void 0&&t.options);switch(e.name){case"selection":{const i=this._selectionMode;if(this.init(),n&&e.fullName==="selection.sensitivity"&&(this._selection.options.sensitivity=e.value),e.fullName!=="selection.showCheckBoxesMode"){const o=this._selectionMode;let s=this.option("selectedRowKeys");i!==o&&(o==="single"?s.length>1&&(s=[s[0]]):o!=="multiple"&&(s=[])),this.selectRows(s).always(()=>{this._fireSelectionChanged()})}this._columnsController.updateColumns(),e.handled=!0;break}case"selectionFilter":this._selection.selectionFilter(e.value),e.handled=!0;break;case"selectedRowKeys":{const i=e.value||[];Array.isArray(i)&&!this._selectedItemsInternalChange&&(this.component.getDataSource()||!i.length)&&this.selectRows(i),e.handled=!0;break}}}publicMethods(){return["selectRows","deselectRows","selectRowsByIndexes","getSelectedRowKeys","getSelectedRowsData","clearSelection","selectAll","deselectAll","startSelectionWithCheckboxes","stopSelectionWithCheckboxes","isRowSelected"]}isRowSelected(e){return this._selection.isItemSelected(e)}isSelectColumnVisible(){return this.option(Lt)==="multiple"&&(this.option(Se)==="always"||this.option(Se)==="onClick"||this._isSelectionWithCheckboxes)}_isOnePageSelectAll(){return this.option("selection.selectAllMode")==="page"}isSelectAll(){return this._selection.getSelectAllState(this._isOnePageSelectAll())}selectAll(){return this.option(Se)==="onClick"&&this.startSelectionWithCheckboxes(),this._selection.selectAll(this._isOnePageSelectAll())}deselectAll(){return this._selection.deselectAll(this._isOnePageSelectAll())}clearSelection(){return this.selectedItemKeys([])}refresh(){const e=this.option("selectedRowKeys")??[];return!this.option("selection.deferred")&&e.length?this.selectedItemKeys(e):new E().resolve().promise()}selectedItemKeys(e,t,n,i){return this._selection.selectedItemKeys(e,t,n,i)}getSelectedRowKeys(e){return this._selection.getSelectedItemKeys()}selectRows(e,t){return this.selectedItemKeys(e,t)}deselectRows(e){return this.selectedItemKeys(e,!0,!0)}selectRowsByIndexes(e){const t=this._dataController.items(),n=[];return Array.isArray(e)||(e=Array.prototype.slice.call(arguments,0)),b(e,function(){const i=t[this];i&&i.rowType==="data"&&n.push(i.key)}),this.selectRows(n)}getSelectedRowsData(e){return this._selection.getSelectedItems()}loadSelectedItemsWithFilter(){return this._selection.loadSelectedItemsWithFilter()}changeItemSelection(e,t,n){t=t||{},this.isSelectionWithCheckboxes()&&(t.control=!0);const i=e+this._dataController.getRowIndexOffset()-this._dataController.getRowIndexOffset(!0);return this._selection.changeItemSelection(i,t,n)}focusedItemIndex(e){const t=this;if(f(e))t._selection._focusedItemIndex=e;else return t._selection._focusedItemIndex}isSelectionWithCheckboxes(){return this.option(Lt)==="multiple"&&(this.option(Se)==="always"||this._isSelectionWithCheckboxes)}startSelectionWithCheckboxes(){const e=this;return e.option(Lt)==="multiple"&&!e.isSelectionWithCheckboxes()?(e._isSelectionWithCheckboxes=!0,e._updateSelectColumn(),!0):!1}stopSelectionWithCheckboxes(){const e=this;return e._isSelectionWithCheckboxes?(e._isSelectionWithCheckboxes=!1,e._updateSelectColumn(),!0):!1}}const Zc=r=>class extends r{init(){const e=this.option("selection.deferred");super.init.apply(this,arguments),e&&this._selectionController._updateCheckboxesState({isDeferredMode:!0,selectionFilter:this.option("selectionFilter")})}_loadDataSource(){const e=this;return super._loadDataSource().always(()=>{e._selectionController.refresh()})}_processDataItem(e,t){const n=this._selectionController.isSelectColumnVisible(),i=t.isDeferredSelection=t.isDeferredSelection===void 0?this.option("selection.deferred"):t.isDeferredSelection,o=super._processDataItem.apply(this,arguments);if(o.isSelected=this._selectionController.isRowSelected(i?o.data:o.key),n&&o.values){for(let s=0;s<t.visibleColumns.length;s++)if(t.visibleColumns[s].command==="select"){o.values[s]=o.isSelected;break}}return o}refresh(e){const t=this,n=new E;return super.refresh.apply(this,arguments).done(()=>{!e||e.selection?t._selectionController.refresh().done(n.resolve).fail(n.reject):n.resolve()}).fail(n.reject),n.promise()}_handleDataChanged(e){const t=this.hasLoadOperation();super._handleDataChanged.apply(this,arguments),t&&!this._repaintChangesOnly&&this._selectionController.focusedItemIndex(-1)}_applyChange(e){if(e&&e.changeType==="updateSelection"){e.items.forEach((t,n)=>{const i=this._items[n];i&&(i.isSelected=t.isSelected,i.values=t.values)});return}return super._applyChange.apply(this,arguments)}_endUpdateCore(){const e=this._changes;if(e.length>1&&e.every(n=>n.changeType==="updateSelection")){const n=e.map(i=>i.itemIndexes||[]).reduce((i,o)=>i.concat(o));this._changes=[{changeType:"updateSelection",itemIndexes:n}]}super._endUpdateCore.apply(this,arguments)}},eh=r=>class extends r{_contextMenuPrepared(e){const t=e.event;t.originalEvent&&t.originalEvent.type!=="dxhold"||e.items&&e.items.length>0||vl(this,t)}},th=r=>class extends r{init(){super.init(),this._selectionController.selectionChanged.add(this._updateSelectAllValue.bind(this))}_updateSelectAllValue(){const e=this,t=e.element(),n=t&&t.find(".dx-select-checkbox");if(t&&n.length&&e.option("selection.mode")==="multiple"){const i=e._selectionController.isSelectAll(),o=i!==!1,s=e.option("selection.allowSelectAll")?!e._dataController.isEmpty():o;n.dxCheckBox("instance").option({visible:s,value:i})}}_handleDataChanged(e){super._handleDataChanged(e),(!e||e.changeType==="refresh"||e.repaintChangesOnly&&e.changeType==="update")&&this.waitAsyncTemplates().done(()=>{this._updateSelectAllValue()})}_renderSelectAllCheckBox(e,t){const n=this,i=n._dataController.isEmpty(),o=g("<div>").appendTo(e).addClass("dx-select-checkbox");return n.setAria("label",_.format("dxDataGrid-ariaSelectAll"),o),n._editorFactoryController.createEditor(o,y({},t,{parentType:"headerRow",dataType:"boolean",value:this._selectionController.isSelectAll(),editorOptions:{visible:!i&&(n.option("selection.allowSelectAll")||this._selectionController.isSelectAll()!==!1)},tabIndex:n.option("useLegacyKeyboardNavigation")?-1:n.option("tabIndex")||0,setValue:(s,l)=>{const a=n.option("selection.allowSelectAll");l.component.option("visible",a||l.component.option("value")!==!1),!(!l.event||this._selectionController.isSelectAll()===s)&&(l.value&&!a?l.component.option("value",!1):l.value?this._selectionController.selectAll():this._selectionController.deselectAll(),l.event.preventDefault())}})),o}_attachSelectAllCheckBoxClickEvent(e){x.on(e,te,this.createAction(t=>{const{event:n}=t;g(n.target).closest(".dx-select-checkbox").length||x.trigger(g(n.currentTarget).children(".dx-select-checkbox"),te),n.preventDefault()}))}},nh=r=>class extends r{renderSelectCheckBoxContainer(e,t){t.rowType==="data"&&!t.row.isNewRow?(e.addClass("dx-editor-cell"),this._attachCheckBoxClickEvent(e),this._renderSelectCheckBox(e,t)):v.setEmptyText(e)}_renderSelectCheckBox(e,t){const n=g("<div>").addClass("dx-select-checkbox").appendTo(e);return this.setAria("label",_.format("dxDataGrid-ariaSelectRow"),n),this._editorFactoryController.createEditor(n,y({},t.column,{parentType:"dataRow",dataType:"boolean",lookup:null,value:t.value,setValue(i,o){var s;(o==null||(s=o.event)===null||s===void 0?void 0:s.type)==="keydown"&&x.trigger(o.element,te,o)},row:t.row})),n}_attachCheckBoxClickEvent(e){x.on(e,te,this.createAction(function(t){const{event:n}=t,i=this.getRowIndex(g(n.currentTarget).closest(".dx-row"));i>=0&&(this._selectionController.startSelectionWithCheckboxes(),this._selectionController.changeItemSelection(i,{shift:n.shiftKey}),g(n.target).closest(".dx-select-checkbox").length&&this._dataController.updateItems({changeType:"updateSelection",itemIndexes:[i]}))}))}_update(e){const t=this,n=t.getTableElements();e.changeType==="updateSelection"?n.length>0&&(b(n,(i,o)=>{b(e.itemIndexes||[],(s,l)=>{let a;if(e.items[l]&&(a=t._getRowElements(g(o)).eq(l),a.length)){const{isSelected:d}=e.items[l];a.toggleClass("dx-selection",d===void 0?!1:d).find(".dx-select-checkbox").dxCheckBox("option","value",d),t.setAria("selected",d,a)}})}),t._updateCheckboxesClass()):super._update(e)}_createTable(){const e=this,t=e.option("selection.mode"),n=super._createTable.apply(e,arguments);return t!=="none"&&((e.option(Se)==="onLongTap"||!Tr.touch)&&x.on(n,H(Pr.name,"dxDataGridRowsView"),".dx-data-row",e.createAction(i=>{vl(e.component,i.event),i.event.stopPropagation()})),x.on(n,"mousedown selectstart",e.createAction(i=>{const{event:o}=i;o.shiftKey&&o.preventDefault()}))),n}_createRow(e){const t=super._createRow.apply(this,arguments);if(e){const{isSelected:n}=e;n&&t.addClass("dx-selection"),this.option(Lt)!=="none"&&this.setAria("selected",n,t)}return t}_rowClickForTreeList(e){super._rowClick(e)}_rowClick(e){const t=this,n=e.event,i=g(n.target).closest(".dx-selection-disabled").length;t.isClickableElement(g(n.target))||(!i&&(t.option(Lt)!=="multiple"||t.option(Se)!=="always")&&t._selectionController.changeItemSelection(e.rowIndex,{control:On(n),shift:n.shiftKey})&&(n.preventDefault(),e.handled=!0),super._rowClick(e))}isClickableElement(e){return!!e.closest(".dx-command-select").length}_renderCore(e){const t=super._renderCore(e);return this._updateCheckboxesClass(),t}_updateCheckboxesClass(){const e=this.getTableElements(),t=this._selectionController.isSelectColumnVisible()&&!this._selectionController.isSelectionWithCheckboxes();b(e,(n,i)=>{g(i).toggleClass(qc,t)})}},ih={defaultOptions:()=>({selection:{mode:"none",showCheckBoxesMode:"onClick",allowSelectAll:!0,selectAllMode:"allPages",deferred:!1,maxFilterLengthInRequest:1500,alwaysSelectByShift:!1},selectionFilter:[],selectedRowKeys:[]}),controllers:{selection:Jc},extenders:{controllers:{data:Zc,contextMenu:eh},views:{columnHeadersView:th,rowsView:nh}}};T.registerModule("selection",ih);const oh="column-chooser-mode-drag",sh="column-chooser-mode-select",rh=["showInColumnChooser","caption","allowHiding","visible","cssClass","ownerBand"],lh=function(r,e){const t=[],n=r.isSelectMode(),i=r.option("columnChooser.selection.recursive");return e.length&&b(e,(o,s)=>{const l={text:s.caption,cssClass:s.cssClass,allowHiding:s.allowHiding,expanded:!0,id:s.index,disabled:s.allowHiding===!1,parentId:f(s.ownerBand)?s.ownerBand:null},a=i&&s.hasColumns;n&&!a&&(l.selected=s.visible),t.push(l)}),t};class ah extends L.ViewController{init(){super.init(),this._rowsView=this.getView("rowsView")}renderShowColumnChooserButton(e){const t=this,n=t.addWidgetPrefix("column-chooser-button"),i=t.option("columnChooser.enabled"),o=e.find(`.${n}`);let s;i?o.length?o.show():(s=g("<div>").addClass(n).appendTo(e),t._createComponent(s,Ut,{icon:"column-chooser",onClick(){t.getView("columnChooserView").showColumnChooser()},hint:t.option("columnChooser.title"),integrationOptions:{}})):o.hide()}getPosition(){const e=this.option("columnChooser.position");return f(e)?e:{my:"right bottom",at:"right bottom",of:this._rowsView&&this._rowsView.element(),collision:"fit",offset:"-2 -2",boundaryOffset:"2 2"}}}class dh extends sn{optionChanged(e){e.name==="columnChooser"?(this._initializePopupContainer(),this.render(null,"full")):super.optionChanged(e)}publicMethods(){return["showColumnChooser","hideColumnChooser"]}_resizeCore(){}_isWinDevice(){return!!me.real().win}_initializePopupContainer(){const e=this,t=e.addWidgetPrefix("column-chooser"),n=e.element().addClass(t),i=e.option("columnChooser"),o=this._columnChooserController.getPosition(),s=jt(),l=bd(s),a=co(s),d={visible:!1,shading:!1,showCloseButton:!1,dragEnabled:!0,resizeEnabled:!0,wrapperAttr:{class:t},toolbarItems:[{text:i.title,toolbar:"top",location:l||a?"before":"center"}],position:o,width:i.width,height:i.height,rtlEnabled:e.option("rtlEnabled"),onHidden(){e._isWinDevice()&&g("body").removeClass(e.addWidgetPrefix("notouch-action"))},container:i.container,_loopFocus:!0};l||a?y(d,{showCloseButton:!0}):d.toolbarItems[d.toolbarItems.length]={shortcut:"cancel"},f(this._popupContainer)?this._popupContainer.option(d):(e._popupContainer=e._createComponent(n,tn,d),e._popupContainer.on("optionChanged",u=>{u.name==="visible"&&e.renderCompleted.fire()})),this.setPopupAttributes()}setPopupAttributes(){const e=this.isSelectMode(),t=this._columnsController.isBandColumnsUsed();this._popupContainer.setAria({role:"dialog",label:_.format("dxDataGrid-columnChooserTitle")}),this._popupContainer.$wrapper().toggleClass(this.addWidgetPrefix(oh),!e).toggleClass(this.addWidgetPrefix(sh),e),this._popupContainer.$content().addClass(this.addWidgetPrefix("column-chooser-list")),e&&!t&&this._popupContainer.$content().addClass(this.addWidgetPrefix("column-chooser-plain"))}_renderCore(e){if(this._popupContainer){const t=!this.isSelectMode();!this._columnChooserList||e==="full"?this._renderTreeView():t&&this._updateItems()}}_renderTreeView(){var e,t,n;const i=this,o=this._popupContainer.$content(),s=this.option("columnChooser"),l=this.isSelectMode(),a=f(s.allowSearch)?s.allowSearch:(e=s.search)===null||e===void 0?void 0:e.enabled,d=f(s.searchTimeout)?s.searchTimeout:(t=s.search)===null||t===void 0?void 0:t.timeout,u={dataStructure:"plain",activeStateEnabled:!0,focusStateEnabled:!0,hoverStateEnabled:!0,itemTemplate:"item",showCheckBoxesMode:"none",rootValue:null,searchEnabled:a,searchTimeout:d,searchEditorOptions:(n=s.search)===null||n===void 0?void 0:n.editorOptions};if(this._isWinDevice()&&(u.useNativeScrolling=!1),y(u,l?this._prepareSelectModeConfig():this._prepareDragModeConfig()),this._columnChooserList)u.searchEnabled||(u.searchValue=""),this._columnChooserList.option(u),this._updateItems();else{this._columnChooserList=this._createComponent(o,ho,u),this._updateItems();let c=0;this._columnChooserList.on("optionChanged",h=>{c=h.component.getScrollable().scrollTop()}),this._columnChooserList.on("contentReady",h=>{_e(()=>{h.component.getScrollable().scrollTo({y:c}),i.renderCompleted.fire()})})}}_prepareDragModeConfig(){return{noDataText:this.option("columnChooser").emptyPanelText,activeStateEnabled:!1,hoverStateEnabled:!1,itemTemplate(t,n,i){g(i).text(t.text).parent().addClass(t.cssClass).addClass("dx-column-chooser-item")}}}_prepareSelectModeConfig(){const e=this,t=this.option("columnChooser.selection")??{};let n=!1;return{selectByClick:t.selectByClick,selectNodesRecursive:t.recursive,showCheckBoxesMode:t.allowSelectAll?"selectAll":"normal",onSelectionChanged:i=>{if(n)return;const o=(s=>{const l=(a,d)=>a.reduce((u,c)=>(u.push(c),c.children.length&&l(c.children,u),u),d);return l(s,[])})(i.component.getNodes());i.component.beginUpdate(),n=!0,((s,l)=>{l.filter(a=>a.itemData.allowHiding===!1).forEach(a=>s.component.selectItem(a.key))})(i,o),i.component.endUpdate(),n=!1,e.component.beginUpdate(),this._isUpdatingColumnVisibility=!0,(s=>{s.forEach(l=>{const a=l.itemData.id,d=l.selected!==!1;e._columnsController.columnOption(a,"visible",d)})})(o),e.component.endUpdate(),this._isUpdatingColumnVisibility=!1}}}_updateItems(){const e=this.isSelectMode(),t=this._columnsController.getChooserColumns(e),n=lh(this,t);this._columnChooserList.option("items",n)}_updateItemsSelection(e){const t=e==null?void 0:e.map(n=>this._columnsController.columnOption(n));this._columnChooserList.beginUpdate(),t==null||t.forEach(n=>{let{visible:i,index:o}=n;i?this._columnChooserList.selectItem(o):this._columnChooserList.unselectItem(o)}),this._columnChooserList.endUpdate()}_columnOptionChanged(e){if(super._columnOptionChanged(e),this.isSelectMode()&&this._columnChooserList&&!this._isUpdatingColumnVisibility){const{optionNames:n}=e,i=n.visible&&n.length===1,o=f(e.columnIndex)?[e.columnIndex]:e.columnIndices;(rh.some(l=>n[l])||e.changeTypes.columns&&n.all)&&(this._updateItemsSelection(o),i||this._updateItems())}}getColumnElements(){const e=[],t=this.isSelectMode(),n=this._columnsController.getChooserColumns(t),i=this._popupContainer&&this._popupContainer.$content(),o=i&&i.find(".dx-treeview-node");return o&&n.forEach(s=>{const l=o.filter(`[data-item-id = '${s.index}']`),a=l.length?l.children(".dx-column-chooser-item").get(0):null;e.push(a)}),g(e)}getName(){return"columnChooser"}getColumns(){return this._columnsController.getChooserColumns()}allowDragging(e){const t=this._columnsController.isParentColumnVisible(e.index),n=!e.visible&&e.allowHiding;return this.isColumnChooserVisible()&&t&&n}allowColumnHeaderDragging(e){return!this.isSelectMode()&&this.isColumnChooserVisible()&&e.allowHiding}getBoundingRect(){const e=this._popupContainer&&this._popupContainer.$overlayContent();if(e&&e.is(":visible")){const t=e.offset();return{left:t.left,top:t.top,right:t.left+ye(e),bottom:t.top+se(e)}}return null}showColumnChooser(){this._popupContainer||(this._initializePopupContainer(),this.render()),this._popupContainer.show(),this._isWinDevice()&&g("body").addClass(this.addWidgetPrefix("notouch-action"))}hideColumnChooser(){this._popupContainer&&this._popupContainer.hide()}isColumnChooserVisible(){const e=this._popupContainer;return e&&e.option("visible")}isSelectMode(){return this.option("columnChooser.mode")==="select"}hasHiddenColumns(){const e=this.option("columnChooser.enabled"),t=this.getColumns().filter(n=>!n.visible);return e&&t.length}}const uh=r=>class extends r{_getToolbarItems(){const e=super._getToolbarItems();return this._appendColumnChooserItem(e)}_appendColumnChooserItem(e){const t=this;if(t.option("columnChooser.enabled")){const i=function(){t.component.getView("columnChooserView").showColumnChooser()},o=function(a){g(a.element).addClass(t._getToolbarButtonClass(t.addWidgetPrefix("column-chooser-button")))},s=t.option("columnChooser.title"),l={widget:"dxButton",options:{icon:"column-chooser",onClick:i,hint:s,text:s,onInitialized:o,elementAttr:{"aria-haspopup":"dialog"}},showText:"inMenu",location:"after",name:"columnChooserButton",locateInMenu:"auto",sortIndex:40};e.push(l)}return e}optionChanged(e){e.name==="columnChooser"?(this._invalidate(),e.handled=!0):super.optionChanged(e)}isVisible(){const e=this.option("columnChooser.enabled");return super.isVisible()||e}},ch=r=>class extends r{allowMoveColumn(e,t,n,i){return this.option("columnChooser.mode")==="select"&&i==="columnChooser"?!1:super.allowMoveColumn(e,t,n,i)}},hh=r=>class extends r{allowDragging(e){const t=!this._columnChooserView.isSelectMode(),n=this._columnChooserView.isColumnChooserVisible();return t&&n&&e.allowHiding||super.allowDragging(e)}},yo={defaultOptions:()=>({columnChooser:{enabled:!1,search:{enabled:!1,timeout:500,editorOptions:{}},selection:{allowSelectAll:!1,selectByClick:!1,recursive:!1},position:void 0,mode:"dragAndDrop",width:250,height:260,title:_.format("dxDataGrid-columnChooserTitle"),emptyPanelText:_.format("dxDataGrid-columnChooserEmptyText"),container:void 0}}),controllers:{columnChooser:ah},views:{columnChooserView:dh},extenders:{views:{headerPanel:uh,columnHeadersView:hh},controllers:{columns:ch}}};yo.controllers.columnChooser;yo.views.columnChooserView;T.registerModule("columnChooser",yo);function nt(r,e){const t=qt(e.group),n=[];for(let i=0;i<r.length;i++)n.push([t[i].selector,"=",r[i]]);return e.filter&&n.push(e.filter),v.combineFilters(n)}function yl(r,e,t){const n=qt(e.group);let i=[];for(let o=t?r.length-1:0;o<r.length;o++){const s=[];for(let l=0;l<=o;l++){const{selector:a}=n[l];if(o===l&&(r[l]===null||r[l]===!1||r[l]===!0))r[l]===!1?s.push([a,"=",n[l].desc?!0:null]):(r[l]?!n[l].desc:n[l].desc)?s.push([a,"<>",r[l]]):(s.push([a,"<>",null]),s.push([a,"=",null]));else{const d=[a,o===l?n[l].desc?">":"<":"=",r[l]];d[1]==="<"?s.push([d,"or",[a,"=",null]]):s.push(d)}}i.push(T.combineFilters(s))}return i=T.combineFilters(i,"or"),T.combineFilters([i,e.filter])}const Ts=function(r,e){const{hash:t}=r;return t&&t[JSON.stringify(e)]},ph=function(r,e){let t=0,n=r.length-1;if(!r.length)return 0;do{const o=n+t>>1;r[o].offset>e?n=o:t=o}while(n-t>1);let i;for(i=t;i<=n&&!(r[i].offset>e);i++);return i},bl=function(r,e,t){for(let n=0;n<r.length;n++)e+1>=t?r[n].children=[]:bl(r[n].children,e+1,t)},Il=function(r,e,t){let n=0;if(e)if(!t)n=e.length;else for(let i=0;i<e.length;i++)r.isGroupItemCountable(e[i])&&n++,n+=Il(r,e[i].items,t-1);return n};let El=class{constructor(e){this._dataSource=e,this.reset()}reset(){this._groupsInfo=[],this._totalCountCorrection=0}totalCountCorrection(){return this._totalCountCorrection}updateTotalItemsCount(e){this._totalCountCorrection=e||0}isGroupItemCountable(e){return!this._isVirtualPaging()||!e.isContinuation}_isVirtualPaging(){const e=this._dataSource.option("scrolling.mode");return e==="virtual"||e==="infinite"}itemsCount(){const t=this._dataSource._dataSource,n=T.normalizeSortingInfo(t.group()||[]).length;return Il(this,t.items(),n)}foreachGroups(e,t,n,i,o){const s=this;return function l(a,d,u,c){const h=[];function p(C,w,S,V){const O=w&&C(w,S);return O&&V.push(O),O}for(let C=0;C<a.length;C++){if(c.push(a[C].data),!u&&p(d,a[C].data,c,h)===!1)return!1;if(!a[C].data||a[C].data.isExpanded||n){const{children:w}=a[C],S=w.length&&l(w,d,u,c);if(S&&h.push(S),S===!1)return!1}if(u&&p(d,a[C].data,c,h)===!1)return!1;(!a[C].data||a[C].data.offset!==a[C].offset)&&(i=!0),c.pop()}const m=o&&c.slice(0);return i&&F.apply(g,h).always(()=>{s._updateGroupInfoOffsets(a,m)})}(s._groupsInfo,e,t,[])}_updateGroupInfoOffsets(e,t){t=t||[];for(let n=0;n<e.length;n++){const i=e[n];if(i.data&&i.data.offset!==i.offset){i.offset=i.data.offset;for(let o=0;o<t.length;o++)t[o].offset=i.offset}}e.sort((n,i)=>n.offset-i.offset)}findGroupInfo(e){let t,n=this._groupsInfo;for(let i=0;n&&i<e.length;i++)t=Ts(n,e[i]),n=t&&t.children;return t&&t.data}addGroupInfo(e){const t=this;let n;const{path:i}=e;let o=t._groupsInfo;for(let s=0;s<i.length;s++){if(n=Ts(o,i[s]),!n){n={key:i[s],offset:e.offset,data:{offset:e.offset,isExpanded:!0,path:i.slice(0,s+1)},children:[]};const l=ph(o,e.offset);o.splice(l,0,n),o.hash=o.hash||{},o.hash[JSON.stringify(n.key)]=n}s===i.length-1&&(n.data=e,n.offset!==e.offset&&t._updateGroupInfoOffsets(o)),o=n.children}}allowCollapseAll(){return!0}refresh(e){const t=this,{storeLoadOptions:n}=e,i=qt(n.group||[]),o="_group"in t?qt(t._group||[]):i;let s=Math.min(o.length,i.length);t._group=n.group;for(let l=0;l<s;l++)if(o[l].selector!==i[l].selector){s=l;break}s?bl(t._groupsInfo,0,s):t.reset()}handleDataLoading(){}handleDataLoaded(e,t){t(e)}handleDataLoadedCore(e,t){t(e)}};function qi(r,e,t,n){if(n=n||0,e>1&&t>0){let i=r-Math.floor(r/e)*e||e;return i+=t-n-2,i<0&&(i+=e),Math.floor(i/(e-n-1))}return 0}const Rt=function(r,e,t){return r.foreachGroups((n,i)=>{if(n.isExpanded)return e(n,i)},!0,!1,t,t)},bo=function(r,e,t,n,i,o,s){let l;if(n.items=n.items||[],n.paths=n.paths||[],n.count=n.count||0,n.lastCount=n.lastCount||0,!!t)for(let a=0;a<e.length;a++){const d=e[a];if(d.items!==void 0){if(i.push(d.key),o)l=!0;else{const u=r.findGroupInfo(i);l=u&&u.isExpanded}l?d.items?bo(r,d.items,t-1,n,i,o,s):t===1&&d.count&&(!o||s)&&(n.items.push(d),n.paths.push(i.slice(0)),n.count+=n.lastCount,n.lastCount=d.count):(d.collapsedItems=d.items,d.items=null),i.pop()}}},gh=function(r,e,t,n,i){const o=r.findGroupInfo(n);let s;o?(t?o.count=e.count>0?e.count:e.items&&e.items.length||0:e.count=o.count||e.count,o.offset=i):(t&&(s=e.count>0?e.count:e.items.length),r.addGroupInfo({isExpanded:r._isGroupExpanded(n.length-1),path:n.slice(0),offset:i,count:s||0}))},Io=function(r,e,t,n,i,o,s){const a=(e.group?e.group.length:0)===n,d=e.remoteOperations.paging;let u=0,c=0,h;if(i=i||0,o=o||[],d&&!s&&(u=i===0?e.skip||0:e.skips[i-1]||0),i>=n)return t.length;for(let p=0;p<t.length;p++){const m=t[p];if(m){if(o.push(m.key),!m.count&&!m.items||m.items===void 0||(gh(r,m,a,o,u+p),h=m.items?Io(r,e,m.items,n,i+1,o,p):m.count||-1,h<0))return-1;c+=h,o.pop()}}return c},_i=function(r,e){return r&&r.length&&r[e]&&!!r[e].isExpanded},Vs=function(r,e,t){let n,i=t;for(let o=0;o<r.length;o++)n=r[o].offset+1,o>0&&(n+=r[o-1].childrenTotalCount,e&&(n+=qi(i,e,n,o-1)*o)),i+=n;return i};function Sl(r,e,t,n){const i=e.items[n],o=r.skips&&r.skips[t],s=r.takes&&r.takes[t],l=n===e.items.length-1,a=n===0,d=a&&o||0,u=i.count>s+d;a&&o!==void 0&&(i.isContinuation=!0),l&&s!==void 0&&u&&(i.isContinuationOnNextPage=!0)}function mh(r,e,t){const n=t-1,i=r.group?r.group.length:0;e.skip=r.skips&&r.skips[n],r.takes&&r.takes[n]!==void 0&&(i===t?e.take=e.count?e.count-(e.skip||0):0:e.take=0,e.take+=r.takes[n])}function Rl(r){return!Array.isArray(r)}function Fs(r){Rl(r.data)||(r.data=new E)}function Tl(r,e,t,n,i,o){e.isCustomLoading||(n={},bo(r,o,t,n,[]),mh(e,n,t));const s=e.group?e.group.length:0;n.paths.length&&s-t>0?(Fs(e),fh(r,e,n,t,i,o)):n.paths.length&&e.storeLoadOptions.group?(Fs(e),Ch(r,e,n,o)):Rl(e.data)&&e.data.resolve(o)}function fh(r,e,t,n,i,o){const s=e.group||[],l=s[i+1],a=[];b(t.paths,d=>{var u;const c={requireTotalCount:!1,requireGroupCount:!0,group:[l],groupSummary:e.storeLoadOptions.groupSummary,filter:nt(t.paths[d],{filter:e.storeLoadOptions.filter,group:s}),select:e.storeLoadOptions.select,langParams:(u=e.storeLoadOptions)===null||u===void 0?void 0:u.langParams};d===0&&(c.skip=t.skip||0),d===t.paths.length-1&&(c.take=t.take);const h=c.take===0?[]:r._dataSource.loadFromStore(c);F(h).done(p=>{const m=t.items[d];Sl(e,t,i,d),m.items=p}),a.push(h)}),F.apply(null,a).done(()=>{Io(r,e,o,n+1),Tl(r,e,n+1,t,i+1,o)})}function Ch(r,e,t,n){const i=[],o=e.group||[];b(t.paths,(d,u)=>{i.push(nt(u,{group:e.isCustomLoading?e.storeLoadOptions.group:o}))});let{filter:s}=e.storeLoadOptions;e.storeLoadOptions.isLoadingAll||(s=T.combineFilters([s,T.combineFilters(i,"or")]));const l=y({},e.storeLoadOptions,{requireTotalCount:!1,requireGroupCount:!1,group:null,sort:o.concat(T.normalizeSortingInfo(e.storeLoadOptions.sort||[])),filter:s}),a=r._dataSource.isLastLevelGroupItemsPagingLocal();a||(l.skip=t.skip,l.take=t.take),F(t.take===0?[]:r._dataSource.loadFromStore(l)).done(d=>{a&&(d=r._dataSource.sortLastLevelGroupItems(d,o,t.paths),d=t.skip?d.slice(t.skip):d,d=t.take?d.slice(0,t.take):d),b(t.items,(u,c)=>{const h=c.count-(u===0&&t.skip||0),p=d.splice(0,h);Sl(e,t,o.length-1,u),c.items=p}),e.data.resolve(n)}).fail(e.data.reject)}const wi=function(r,e){const t=new E,n=!!(e.group&&e.group.length),i=y({skip:0,take:1,requireGroupCount:n,requireTotalCount:!n},e,{group:n?e.group:null});return r.load(i).done((o,s)=>{const l=s&&(n?s.groupCount:s.totalCount);if(!isFinite(l)){t.reject($n.Error(n?"E4022":"E4021"));return}t.resolve(l)}).fail(t.reject.bind(t)),t};let Os=class extends El{updateTotalItemsCount(e){let t=0;const n=e.extra&&e.extra.totalCount||0,i=e.extra&&e.extra.groupCount||0,o=this._dataSource.pageSize(),s=this._isVirtualPaging();Rt(this,l=>{l.childrenTotalCount=0}),Rt(this,(l,a)=>{const d=Vs(a,s?0:o,t);let u=l.count+l.childrenTotalCount;s||(u+=qi(d,o,u,a.length-1)),a[a.length-2]?a[a.length-2].childrenTotalCount+=u:t+=u}),super.updateTotalItemsCount(t-n+i)}_isGroupExpanded(e){const t=this._dataSource.group();return _i(t,e)}_updatePagingOptions(e,t){const n=this,i=n._isVirtualPaging(),o=n._dataSource.pageSize(),s=[],l=[];let a=0,d=0;e.take&&(Rt(this,u=>{u.childrenTotalCount=0,u.skipChildrenTotalCount=0}),Rt(n,(u,c)=>{let h,p=0,m=0;const C=Vs(c,i?0:o,d);let w=0,S=0,V=u.count+u.childrenTotalCount,O=V;t&&t(u,C);const P=e.skip-C;C<=e.skip+e.take&&V&&(h=e.take,i||(w=qi(C,o,V,c.length-1),V+=w*c.length,O+=w,o&&P>=0&&(p=c.length,m=c.length-1,S=Math.floor(P/o))),P>=0?(C+V>e.skip&&s.unshift(P-S*p-u.skipChildrenTotalCount),C+V>=e.skip+h&&l.unshift(h-p-u.childrenTotalCount+u.skipChildrenTotalCount)):C+V>=e.skip+h&&l.unshift(h+P-u.childrenTotalCount)),C<=e.skip&&(c[c.length-2]?c[c.length-2].skipChildrenTotalCount+=Math.min(O,P+1-S*m):a+=Math.min(O,P+1)),C<=e.skip+h&&(V=Math.min(O,P+h-(S+1)*m),c[c.length-2]?c[c.length-2].childrenTotalCount+=V:d+=V)}),e.skip-=a,e.take-=d-a),e.skips=s,e.takes=l}changeRowExpand(e){const t=this.findGroupInfo(e),n=this._dataSource,i=n.remoteOperations().groupPaging,o=T.normalizeSortingInfo(n.group());return t?(t.isExpanded=!t.isExpanded,i&&t.isExpanded&&e.length<o.length?wi(n,{filter:nt(e,{filter:n.lastLoadOptions().filter,group:n.group()}),group:[o[e.length]],select:n.select()}).done(s=>{t.count=s}):new E().resolve()):new E().reject()}handleDataLoading(e){const t=this,{storeLoadOptions:n}=e,i=T.normalizeSortingInfo(n.group||e.loadOptions.group);if(!(e.isCustomLoading||!i.length)){if(e.remoteOperations.grouping){const o=t._dataSource.remoteOperations().paging;n.group=T.normalizeSortingInfo(n.group),n.group.forEach((s,l)=>{const a=l===n.group.length-1;s.isExpanded=!o||!a})}e.group=e.group||i,e.remoteOperations.paging?(e.skip=n.skip,e.take=n.take,n.requireGroupCount=!0,n.group=i.slice(0,1),t._updatePagingOptions(e),n.skip=e.skip,n.take=e.take):(e.skip=e.loadOptions.skip,e.take=e.loadOptions.take,t._updatePagingOptions(e))}}handleDataLoadedCore(e,t){const n=this,i=T.normalizeSortingInfo(e.storeLoadOptions.group||e.loadOptions.group).length,o=e.group?e.group.length:0;let s;const l={};if(e.isCustomLoading)t(e),bo(n,e.data,i,l,[],e.isCustomLoading,e.storeLoadOptions.isLoadingAll);else{if(e.remoteOperations.paging||n.foreachGroups(a=>{a.count=0}),s=Io(n,e,e.data,i),s<0){e.data=new E().reject(oe.Error("E1037"));return}if(e.remoteOperations.paging||i&&e.extra&&e.loadOptions.requireTotalCount&&(e.extra.totalCount=s,e.extra.groupCount=e.data.length),o&&e.storeLoadOptions.requireGroupCount&&!isFinite(e.extra.groupCount)){e.data=new E().reject($n.Error("E4022"));return}n.updateTotalItemsCount(e),e.remoteOperations.paging||(n._updatePagingOptions(e),e.lastLoadOptions.skips=e.skips,e.lastLoadOptions.takes=e.takes),t(e),e.remoteOperations.paging||n._processPaging(e,i)}Tl(n,e,i,l,0,e.data)}_processSkips(e,t,n){if(!n)return;const i=e[0],o=t[0],s=i&&i.items;o!==void 0&&(i.isContinuation=!0,s&&(i.items=s.slice(o),this._processSkips(i.items,t.slice(1),n-1)))}_processTakes(e,t,n,i,o){if(!i||!e)return;o=o||[];const s=e[e.length-1];let l=s&&s.items;const a=n[0],d=t[0];if(s){const u=s.count-(s.isContinuation&&d||0)||l.length;a!==void 0&&u>a&&(s.isContinuationOnNextPage=!0,o.forEach(c=>{c.isContinuationOnNextPage=!0}),l&&(l=l.slice(0,a),s.items=l)),o.push(s),this._processTakes(l,t.slice(1),n.slice(1),i-1,o)}}_processPaging(e,t){this._processSkips(e.data,e.skips,t),this._processTakes(e.data,e.skips,e.takes,t)}isLastLevelGroupItemsPagingLocal(){return!1}sortLastLevelGroupItems(e){return e}refresh(e,t){const n=this,i=n._dataSource,{storeLoadOptions:o}=e,s=e.group||e.storeLoadOptions.group,l=T.normalizeSortingInfo(n._group);let a,d;function u(c,h){h.length===d+1&&(c.isExpanded=a)}for(d=0;d<l.length;d++)a=_i(s,d),_i(n._group,d)!==a&&n.foreachGroups(u);if(super.refresh.apply(this,arguments),s&&e.remoteOperations.paging&&t.reload)return Rt(n,c=>{const h=wi(i,{filter:nt(c.path,{filter:o.filter,group:s}),group:s.slice(c.path.length),select:o.select}),p=wi(i,{filter:yl(c.path,{filter:o.filter,group:s},!0),group:s.slice(c.path.length-1,c.path.length),select:o.select});return F(p,h).done((m,C)=>{m=parseInt(m.length?m[0]:m),C=parseInt(C.length?C[0]:C),c.offset=m,c.count!==C&&(c.count=C,n.updateTotalItemsCount(e))})},!0)}};const xi=function(r,e){const t=new E,n=y({skip:0,take:1,requireTotalCount:!0},e);return r.load(n).done((i,o)=>{t.resolve(o&&o.totalCount)}).fail(t.reject.bind(t)),t},yn=function(r,e,t){return r.foreachGroups(n=>{if(!n.isExpanded)return e(n)},!1,!1,t,!0)},Ds=function(r,e){let t=0,n=e||0;return e&&(yn(r,i=>{if(i.offset-t>=e)return!1;t+=i.count-1}),n+=t),n},Vl=function(r,e,t,n,i,o){let s=0,l=!1;for(let a=0;a<e.length;a++){const d=e[a];if(d.items!==void 0){t.push(d.key);const u=r.findGroupInfo(t);if(u&&!u.isExpanded)d.collapsedItems=d.items,d.items=null,n+=u.count,o--,o<0&&s++,i&&(l=!0);else if(d.items){const c=Vl(r,d.items,t,n,i,o);i&&(c.offset-n>1?d.isContinuation=!0:l=!0),n=c.offset,o=c.take,o<0&&(d.items.length?d.isContinuationOnNextPage=!0:s++)}t.pop()}else i&&(l=!0),n++,o--,o<0&&s++;i=!1}return l&&e.splice(0,1),s&&e.splice(-s,s),{offset:n,take:o}},_h=function(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;t++)if(!Id(null,r[t],e[t]))return!1;return!0},Xi=function(r,e,t,n,i){if(e){for(let o=0;o<e.length;o++){const s=e[o];if("key"in s&&s.items!==void 0){t.push(s.key),i&&_h(i.path,t)&&!s.isContinuation&&(i.offset=n);const l=r.findGroupInfo(t);l&&!s.isContinuation&&(l.offset=n),l&&!l.isExpanded?n+=l.count:n=Xi(r,s.items,t,n,i),t.pop()}else n++}return n}},wh=function(r,e){if(e.group){const t=T.normalizeSortingInfo(e.group),n=T.normalizeSortingInfo(r.sort);r.sort=Gn.arrangeSortingInfo(t,n),delete e.group}},xh=function(r,e,t){const n=T.normalizeSortingInfo(t||e.group);let i=[];for(let o=0;o<r.length;o++){const s=[];for(let l=0;l<=o;l++)s.push([n[l].selector,o===l?"<>":"=",r[l]]);i.push(T.combineFilters(s))}return i=T.combineFilters(i,"or"),T.combineFilters([i,e.filter])},Fl=function(r,e){let t=r.count||r.items.length;if(!r.count&&e>1){t=0;for(let n=0;n<r.items.length;n++)t+=Fl(r.items[n],e-1)}return t};class Ps extends El{handleDataLoading(e){const{storeLoadOptions:t}=e,n=[];let i=0,o=!1,s;const{group:l}=e.loadOptions;let a=0;if(wh(t,e.loadOptions),e.group=e.group||l,e.isCustomLoading)return;const d=y({},t);d.skip=Ds(this,t.skip),d.skip&&d.take&&l&&(d.skip--,d.take++,o=!0),d.take&&l&&(s=d.take,d.take++),yn(this,u=>{if(u.offset>=d.skip+d.take+a)return!1;u.offset>=d.skip+a&&u.count&&(a+=u.count-1,n.push(u),i+=u.count)}),b(n,function(){d.filter=xh(this.path,d,l)}),e.storeLoadOptions=d,e.collapsedGroups=n,e.collapsedItemsCount=i,e.skip=d.skip||0,e.skipFirstItem=o,e.take=s}handleDataLoaded(e,t){const n=this,{collapsedGroups:i}=e,o=T.normalizeSortingInfo(e.group),s=o.length;function l(a,d,u,c,h){if(!a||!d.length||!u.length)return;let p,m;const C=Wi(d[0],!0);for(m=0;m<a.length&&(p=Wi(a[m].key,!0),!(h>=c.offset||C===p));m++)h+=Fl(a[m],u.length);(!a.length||C!==p)&&a.splice(m,0,{key:d[0],items:[],count:d.length===1?c.count:void 0}),l(a[m].items,d.slice(1),u.slice(1),c,h)}if(e.collapsedItemsCount&&e.extra&&e.extra.totalCount>=0&&(e.extra._totalCountWasIncreasedByCollapsedItems||(e.extra.totalCount+=e.collapsedItemsCount,e.extra._totalCountWasIncreasedByCollapsedItems=!0)),t(e),s){let{data:a}=e;const d=nn(a);if(Gn.multiLevelGroup(d,o).enumerate().done(u=>{a=u}),i)for(let u=0;u<i.length;u++)l(a,i[u].path,o,i[u],e.skip);e.isCustomLoading||Vl(n,a,[],e.skip,e.skipFirstItem,e.take),e.data=a}}isGroupItemCountable(e){return e.items===null}updateTotalItemsCount(){let e=0;yn(this,t=>{t.count&&(e-=t.count-1)}),super.updateTotalItemsCount(e)}changeRowExpand(e){const t=this,n=t._dataSource,i=n.beginPageIndex?n.beginPageIndex():n.pageIndex(),o=n.items(),s=Ds(t,i*n.pageSize());let l=t.findGroupInfo(e),a;return l&&!l.isExpanded?a=new E().resolve(l.count):a=xi(n,{filter:nt(e,{filter:n.filter(),group:n.group()})}),F(a).done(d=>{d=parseInt(d.length?d[0]:d),l?(Xi(t,o,[],s),l.isExpanded=!l.isExpanded,l.count=d):(l={offset:-1,count:d,path:e,isExpanded:!1},Xi(t,o,[],s,l),l.offset>=0&&t.addGroupInfo(l)),t.updateTotalItemsCount()}).fail(function(){n._eventsStrategy.fireEvent("loadError",arguments)})}allowCollapseAll(){return!1}refresh(e,t){const n=this,{storeLoadOptions:i}=e,o=n._dataSource;if(super.refresh.apply(this,arguments),t.reload)return yn(n,s=>{const l=xi(o,{filter:nt(s.path,i)}),a=xi(o,{filter:yl(s.path,i)});return F(a,l).done((d,u)=>{d=parseInt(d.length?d[0]:d),u=parseInt(u.length?u[0]:u),s.offset=d,s.count!==u&&(s.count=u,n.updateTotalItemsCount())})},!0)}}const vh=r=>class extends r{init(){super.init.apply(this,arguments),this._initGroupingHelper()}_initGroupingHelper(e){const t=this._grouping,n=this.option("grouping.autoExpandAll"),i=this.option("focusedRowEnabled"),o=e?e.remoteOperations:this.remoteOperations();o.filtering&&o.sorting&&o.paging&&!o.grouping&&(n||!i)?(!t||t instanceof Os)&&(this._grouping=new Ps(this)):(!t||t instanceof Ps)&&(this._grouping=new Os(this))}totalItemsCount(){const e=super.totalItemsCount();return e>0&&this._dataSource.group()&&this._dataSource.requireTotalCount()?e+this._grouping.totalCountCorrection():e}itemsCount(){return this._dataSource.group()?this._grouping.itemsCount()||0:super.itemsCount.apply(this,arguments)}allowCollapseAll(){return this._grouping.allowCollapseAll()}isGroupItemCountable(e){return this._grouping.isGroupItemCountable(e)}isRowExpanded(e){const t=this._grouping.findGroupInfo(e);return t?t.isExpanded:!this._grouping.allowCollapseAll()}collapseAll(e){return this._collapseExpandAll(e,!1)}expandAll(e){return this._collapseExpandAll(e,!0)}_collapseExpandAll(e,t){const n=this,i=n._dataSource,o=i.group(),s=T.normalizeSortingInfo(o||[]);if(s.length){for(let l=0;l<s.length;l++)e===void 0||e===l?s[l].isExpanded=t:o&&o[l]&&(s[l].isExpanded=o[l].isExpanded);i.group(s),n._grouping.foreachGroups((l,a)=>{(e===void 0||e===a.length-1)&&(l.isExpanded=t)},!1,!0),n.resetPagesCache()}return!0}refresh(){return super.refresh.apply(this,arguments),this._grouping.refresh.apply(this._grouping,arguments)}changeRowExpand(e){const t=this,n=t._dataSource;if(n.group())return n.beginLoading(),t._lastLoadOptions&&(t._lastLoadOptions.groupExpand=!0),t._changeRowExpandCore(e).always(()=>{n.endLoading()})}_changeRowExpandCore(e){return this._grouping.changeRowExpand(e)}_hasGroupLevelsExpandState(e,t){if(e&&Array.isArray(e)){for(let n=0;n<e.length;n++)if(e[n].isExpanded===t)return!0}}_customizeRemoteOperations(e,t){const{remoteOperations:n}=e;e.storeLoadOptions.group?(n.grouping&&!e.isCustomLoading&&(!n.groupPaging||this._hasGroupLevelsExpandState(e.storeLoadOptions.group,!0))&&(n.paging=!1),!n.grouping&&(!n.sorting||!n.filtering||e.isCustomLoading||this._hasGroupLevelsExpandState(e.storeLoadOptions.group,!1))&&(n.paging=!1)):!e.isCustomLoading&&n.paging&&t.grouping&&this.resetCache(),super._customizeRemoteOperations.apply(this,arguments)}_handleDataLoading(e){return super._handleDataLoading(e),this._initGroupingHelper(e),this._grouping.handleDataLoading(e)}_handleDataLoaded(e){return this._grouping.handleDataLoaded(e,super._handleDataLoaded.bind(this))}_handleDataLoadedCore(e){return this._grouping.handleDataLoadedCore(e,super._handleDataLoadedCore.bind(this))}};Yn.extend(vh);const yh=r=>class extends r{init(){super.init(),this.createAction("onRowExpanding"),this.createAction("onRowExpanded"),this.createAction("onRowCollapsing"),this.createAction("onRowCollapsed")}_beforeProcessItems(e){const t=this._columnsController.getGroupColumns();return e=super._beforeProcessItems(e),e.length&&t.length&&(e=this._processGroupItems(e,t.length)),e}_processItem(e,t){return f(e.groupIndex)&&U(e.rowType)&&e.rowType.indexOf("group")===0?(e=this._processGroupItem(e,t),t.dataIndex=0):e=super._processItem.apply(this,arguments),e}_processGroupItem(e,t){return e}_processGroupItems(e,t,n){const i=this,o=i._columnsController.getGroupColumns(),s=o[o.length-t];if(!n){const a=i.option("scrolling.mode");n={collectContinuationItems:a!=="virtual"&&a!=="infinite",resultItems:[],path:[],values:[]}}const{resultItems:l}=n;if(n.data&&(n.collectContinuationItems||!n.data.isContinuation)&&l.push({rowType:"group",data:n.data,groupIndex:n.path.length-1,isExpanded:!!n.data.items,key:n.path.slice(0),values:n.values.slice(0)}),e)if(t===0)l.push.apply(l,e);else for(let a=0;a<e.length;a++){const d=e[a];d&&"items"in d?(n.data=d,n.path.push(d.key),n.values.push(s&&s.deserializeValue&&!s.calculateDisplayValue?s.deserializeValue(d.key):d.key),i._processGroupItems(d.items,t-1,n),n.data=void 0,n.path.pop(),n.values.pop()):l.push(d)}return l}publicMethods(){return super.publicMethods().concat(["collapseAll","expandAll","isRowExpanded","expandRow","collapseRow"])}collapseAll(e){const t=this._dataSource;t&&t.collapseAll(e)&&(t.pageIndex(0),t.reload())}expandAll(e){const t=this._dataSource;t&&t.expandAll(e)&&(t.pageIndex(0),t.reload())}changeRowExpand(e){const t=this,n=t.isRowExpanded(e),i={key:e,expanded:n};return t.executeAction(n?"onRowCollapsing":"onRowExpanding",i),i.cancel?new E().resolve():F(t._changeRowExpandCore(e)).done(()=>{i.expanded=!n,t.executeAction(n?"onRowCollapsed":"onRowExpanded",i)})}_changeRowExpandCore(e){const t=this,n=this._dataSource,i=new E;return n?F(n.changeRowExpand(e)).done(()=>{t.load().done(i.resolve).fail(i.reject)}).fail(i.reject):i.resolve(),i}isRowExpanded(e){const t=this._dataSource;return t&&t.isRowExpanded(e)}expandRow(e){return this.isRowExpanded(e)?new E().resolve():this.changeRowExpand(e)}collapseRow(e){return this.isRowExpanded(e)?this.changeRowExpand(e):new E().resolve()}optionChanged(e){e.name==="grouping"&&(e.name="dataSource"),super.optionChanged(e)}},Eo=function(r,e){const t=this._columnsController;switch(e.itemData.value){case"group":{const n=t._dataSource.group()||[];t.columnOption(r.dataField,"groupIndex",n.length);break}case"ungroup":t.columnOption(r.dataField,"groupIndex",-1);break;case"ungroupAll":this.component.clearGrouping()}},Ol=r=>{const e=r==null?void 0:r.visible;return e==="auto"?me.current().deviceType==="desktop":!!e},Dl=(r,e)=>{const t=Ol(r),n=(r==null?void 0:r.allowColumnDragging)&&e.allowGrouping;return t&&!!n},bh=r=>class extends r{_getToolbarItems(){const e=super._getToolbarItems();return this._appendGroupingItem(e)}_appendGroupingItem(e){if(this._isGroupPanelVisible()){let t=!1;const n={template:()=>{const i=g("<div>").addClass("dx-datagrid-group-panel");return this._updateGroupPanelContent(i),Nt("groupPanel",this,i,void 0,this._handleActionKeyDown.bind(this)),i},name:"groupPanel",onItemRendered:()=>{t&&this.renderCompleted.fire(),t=!0},location:"before",locateInMenu:"never",sortIndex:1};e.push(n),this.updateToolbarDimensions()}return e}_handleActionKeyDown(e){const{event:t}=e,n=g(t.target),i=n.closest(".dx-group-panel-item").index(),o=this._columnsController.getGroupColumns()[i],s=o&&o.index;n.is(".dx-header-filter")?this._headerFilterController.showHeaderFilterMenu(s,!0):this._processGroupItemAction(s),t.preventDefault()}_isGroupPanelVisible(){return Ol(this.option("groupPanel"))}_renderGroupPanelItems(e,t){const n=this;e.empty(),b(t,(i,o)=>{n._createGroupPanelItem(e,o)}),mo(this)}_createGroupPanelItem(e,t){const n=g("<div>").addClass(t.cssClass).addClass("dx-group-panel-item").data("columnData",t).appendTo(e).text(t.caption);return mu(this,n),n}_columnOptionChanged(e){if(!this._requireReady&&!T.checkChanges(e.optionNames,["width","visibleWidth"])){const t=this.element(),n=t&&t.find(".dx-datagrid-group-panel");n&&n.length&&(this._updateGroupPanelContent(n),this.updateToolbarDimensions(),this.renderCompleted.fire())}super._columnOptionChanged()}_updateGroupPanelContent(e){const t=this.getColumns(),n=this.option("groupPanel");this._renderGroupPanelItems(e,t),n.allowColumnDragging&&!t.length&&(g("<div>").addClass("dx-group-panel-message").text(n.emptyPanelText).appendTo(e),e.closest(".dx-toolbar-item").addClass("dx-toolbar-label"),e.closest(".dx-toolbar-label").css("maxWidth","none"))}allowDragging(e){const t=this.option("groupPanel");return Dl(t,e)}getColumnElements(){const e=this.element();return e&&e.find(".dx-group-panel-item")}getColumns(){return this._columnsController.getGroupColumns()}getBoundingRect(){const e=this.element();if(e&&e.find(".dx-datagrid-group-panel").length){const t=e.offset();return{top:t.top,bottom:t.top+J(e)}}return null}getName(){return"group"}getContextMenuItems(e){const t=this,n=t.option("grouping.contextMenuEnabled"),i=g(e.targetElement).closest(".dx-group-panel-item");let o;if(i.length&&(e.column=i.data("columnData")),n&&e.column){const{column:s}=e;if(f(s.allowGrouping)?s.allowGrouping:!0){const a=f(s.groupIndex)&&s.groupIndex>-1,d=t.option("grouping.texts"),u=Eo.bind(t,s);o=[{text:d.ungroup,value:"ungroup",disabled:!a,onItemClick:u},{text:d.ungroupAll,value:"ungroupAll",onItemClick:u}]}}return o}isVisible(){return super.isVisible()||this._isGroupPanelVisible()}hasGroupedColumns(){return this._isGroupPanelVisible()&&!!this.getColumns().length}optionChanged(e){e.name==="groupPanel"?(this._invalidate(),e.handled=!0):super.optionChanged(e)}},Ih=r=>class extends r{getContextMenuItems(e){const t=this,n=t.option("grouping.contextMenuEnabled");let i;if(n&&e.row&&e.row.rowType==="group"){const s=t._columnsController.columnOption(`groupIndex:${e.row.groupIndex}`);if(s&&s.allowGrouping){const l=t.option("grouping.texts"),a=Eo.bind(t,s);i=[],i.push({text:l.ungroup,value:"ungroup",onItemClick:a},{text:l.ungroupAll,value:"ungroupAll",onItemClick:a})}}return i}_rowClick(e){const t=this,n=t.option("grouping.expandMode"),o=t.option("scrolling.mode")!=="infinite"&&n==="rowClick"&&g(e.event.target).closest(".dx-group-row").length,s=g(e.event.target).closest(".dx-datagrid-expand").length;(o||s)&&t._changeGroupRowState(e),super._rowClick(e)}_changeGroupRowState(e){const t=this._dataController.items()[e.rowIndex],n=this._columnsController.columnOption(`groupIndex:${t.groupIndex}`,"allowCollapsing");(t.rowType==="data"||t.rowType==="group"&&n!==!1)&&(this._dataController.changeRowExpand(t.key,!0),e.event.preventDefault(),e.handled=!0)}},Eh=r=>class extends r{getContextMenuItems(e){const t=this,n=t.option("grouping.contextMenuEnabled");let i=super.getContextMenuItems(e);if(n&&e.row&&(e.row.rowType==="header"||e.row.rowType==="detailAdaptive")){const{column:o}=e;if(!o.command&&(!f(o.allowGrouping)||o.allowGrouping)){const s=t.option("grouping.texts"),l=f(o.groupIndex)&&o.groupIndex>-1,a=Eo.bind(t,o);i=i||[],i.push({text:s.groupByThisColumn,value:"group",beginGroup:!0,disabled:l,onItemClick:a}),o.showWhenGrouped&&i.push({text:s.ungroup,value:"ungroup",disabled:!l,onItemClick:a}),i.push({text:s.ungroupAll,value:"ungroupAll",onItemClick:a})}}return i}allowDragging(e){const t=this.option("groupPanel");return Dl(t,e)||super.allowDragging(e)}};T.registerModule("grouping",{defaultOptions:()=>({grouping:{autoExpandAll:!0,allowCollapsing:!0,contextMenuEnabled:!1,expandMode:"buttonClick",texts:{groupContinuesMessage:_.format("dxDataGrid-groupContinuesMessage"),groupContinuedMessage:_.format("dxDataGrid-groupContinuedMessage"),groupByThisColumn:_.format("dxDataGrid-groupHeaderText"),ungroup:_.format("dxDataGrid-ungroupHeaderText"),ungroupAll:_.format("dxDataGrid-ungroupAllText")}},groupPanel:{visible:!1,emptyPanelText:_.format("dxDataGrid-groupPanelEmptyText"),allowColumnDragging:!0}}),extenders:{controllers:{data:yh,columns:r=>class extends r{_getExpandColumnOptions(){const e=super._getExpandColumnOptions.apply(this,arguments);return e.cellTemplate=T.getExpandCellTemplate(),e}},editing:r=>class extends r{_isProcessedItem(e){return f(e.groupIndex)&&U(e.rowType)&&e.rowType.indexOf("group")===0}}},views:{headerPanel:bh,rowsView:Ih,columnHeadersView:Eh}}});const Sh=r=>class extends r{_getExpandColumnsCore(){const e=super._getExpandColumnsCore();return this.option("masterDetail.enabled")&&e.push({type:"detailExpand",cellTemplate:v.getExpandCellTemplate()}),e}},vi=function(r){r._expandedItems=[],r._isExpandAll=r.option("masterDetail.autoExpandAll")},Rh=r=>class extends r{init(){vi(this),super.init()}expandAll(e){const t=this;e<0?(t._isExpandAll=!0,t._expandedItems=[],t.updateItems()):super.expandAll.apply(t,arguments)}collapseAll(e){const t=this;e<0?(t._isExpandAll=!1,t._expandedItems=[],t.updateItems()):super.collapseAll.apply(t,arguments)}isRowExpandedHack(){return super.isRowExpanded.apply(this,arguments)}isRowExpanded(e){const t=this,n=v.getIndexByKey(e,t._expandedItems);return Array.isArray(e)?super.isRowExpanded.apply(t,arguments):!!(t._isExpandAll^(n>=0&&t._expandedItems[n].visible))}_getRowIndicesForExpand(e){const t=this.getRowIndexByKey(e);return[t,t+1]}_changeRowExpandCore(e){const t=this;let n;if(Array.isArray(e))n=super._changeRowExpandCore.apply(t,arguments);else{const i=v.getIndexByKey(e,t._expandedItems);if(i>=0){const{visible:o}=t._expandedItems[i];t._expandedItems[i].visible=!o}else t._expandedItems.push({key:e,visible:!0});t.updateItems({changeType:"update",rowIndices:t._getRowIndicesForExpand(e)}),n=new E().resolve()}return n}_processDataItemHack(){return super._processDataItem.apply(this,arguments)}_processDataItem(e,t){const n=super._processDataItem.apply(this,arguments);return n.isExpanded=this.isRowExpanded(n.key),t.detailColumnIndex===void 0&&(t.detailColumnIndex=-1,b(t.visibleColumns,(i,o)=>{if(o.command==="expand"&&!f(o.groupIndex))return t.detailColumnIndex=i,!1})),t.detailColumnIndex>=0&&(n.values[t.detailColumnIndex]=n.isExpanded),n}_processItemsHack(){return super._processItems.apply(this,arguments)}_processItems(e,t){const n=this,{changeType:i}=t,o=[];return e=super._processItems.apply(n,arguments),i==="loadingAll"?e:(i==="refresh"&&(n._expandedItems=Ed(n._expandedItems,s=>s.visible)),b(e,(s,l)=>{o.push(l);const a=v.getIndexByKey(l.key,n._expandedItems);l.rowType==="data"&&(l.isExpanded||a>=0)&&!l.isNewRow&&o.push({visible:l.isExpanded,rowType:"detail",key:l.key,data:l.data,values:[]})}),o)}optionChanged(e){const t=this;let n,i;if(e.name==="masterDetail"){switch(e.name="dataSource",e.fullName){case"masterDetail":{const o=e.value||{},s=e.previousValue||{};n=o.enabled!==s.enabled,i=o.autoExpandAll!==s.autoExpandAll;break}case"masterDetail.template":vi(t);break;case"masterDetail.enabled":n=!0;break;case"masterDetail.autoExpandAll":i=!0}(n||i)&&vi(t)}super.optionChanged(e)}},Th=r=>class extends r{fireContentReadyAction(){super.fireContentReadyAction.apply(this,arguments),this._updateParentDataGrids(this.component.$element())}_updateParentDataGrids(e){const t=e.closest(".dx-master-detail-row");t.length&&F(this._updateMasterDataGrid(t,e)).done(()=>{this._updateParentDataGrids(t.parent())})}_updateMasterDataGrid(e,t){const n=g(e).data("options"),i=g(e).closest(`.${this.getWidgetContainerClass()}`).parent().data("dxDataGrid");if(n&&i)return this._updateMasterDataGridCore(i,n)}_updateMasterDataGridCore(e,t){var n,i;const o=E();if((n=e.getView("rowsView"))!==null&&n!==void 0&&(i=n.isFixedColumns)!==null&&i!==void 0&&i.call(n))this._updateFixedMasterDetailGrids(e,t.rowIndex,g(t.rowElement)).done(o.resolve);else{if(e.option("scrolling.useNative")===!0){e.updateDimensions().done(()=>o.resolve(!0));return}const s=e.getScrollable();s?s==null||s.update().done(()=>o.resolve()):o.resolve()}return o.promise()}_updateFixedMasterDetailGrids(e,t,n){const i=E(),o=g(e.getRowElement(t)),s=g(e.getView("rowsView").getTableElements()),l=(o==null?void 0:o.length)===2&&J(o.eq(0))!==J(o.eq(1)),a=(s==null?void 0:s.length)===2&&J(s.eq(0))!==J(s.eq(1));if(l||a){const d=K(n);return e.updateDimensions().done(()=>{const u=this.option("columnAutoWidth")&&e.option("scrolling.useNative")===!0,c=u&&d!==K(n);u&&c?this.updateDimensions().done(()=>i.resolve(!0)):i.resolve(!0)}),i.promise()}return E().resolve()}_toggleBestFitMode(e){if(super._toggleBestFitMode.apply(this,arguments),this.option("masterDetail.template")){const t=this._rowsView.getTableElement();t&&t.find(".dx-master-detail-cell").css("maxWidth",e?0:"")}}},Vh=r=>class extends r{_getCellTemplate(e){const t=this,{column:n}=e,i=this._editingController,o=i&&i.isEditRow(e.rowIndex);let s;return n.command==="detail"&&!o?s=t.option("masterDetail.template")||{allowRenderToDetachedContainer:!1,render:t._getDefaultTemplate(n)}:s=super._getCellTemplate.apply(t,arguments),s}_isDetailRow(e){return e&&e.rowType&&e.rowType.indexOf("detail")===0}_createRow(e){const t=super._createRow.apply(this,arguments);return e&&this._isDetailRow(e)&&(this.option("showRowLines")&&t.addClass("dx-row-lines"),t.addClass("dx-master-detail-row"),f(e.visible)&&t.toggle(e.visible)),t}_renderCells(e,t){const{row:n}=t;n.rowType&&this._isDetailRow(n)?this._needRenderCell(0,t.columnIndices)&&this._renderMasterDetailCell(e,n,t):super._renderCells.apply(this,arguments)}_renderMasterDetailCell(e,t,n){const i=this._columnsController.getVisibleColumns(),o=this._renderCell(e,{value:null,row:t,rowIndex:t.rowIndex,column:{command:"detail"},columnIndex:0,change:n.change});return o.addClass("dx-cell-focus-disabled").addClass("dx-master-detail-cell").attr("colSpan",i.length),t.isEditing||o.attr("aria-roledescription",_.format("dxDataGrid-masterDetail")),o}},Fh={defaultOptions:()=>({masterDetail:{enabled:!1,autoExpandAll:!1,template:null}}),extenders:{controllers:{columns:Sh,data:Rh,resizing:Th},views:{rowsView:Vh}}};T.registerModule("masterDetail",Fh);const{isWrapped:Oh}=ao,Dh="dx-editor-inline-block",rn=function(r,e){return y(r,{readOnly:e.readOnly,placeholder:e.placeholder,inputAttr:{id:e.id,"aria-labelledby":e["aria-labelledby"]},tabIndex:e.tabIndex},e.editorOptions)},Pl=function(){return ee.mozilla||me.real().ios},Al=function(r){const e={},t=Pl(),n=r.sharedData||e;return rn({placeholder:r.placeholder,width:r.width,value:r.value,onValueChanged:function(i){const o=r.parentType==="filterRow"||r.parentType==="searchPanel",s=i.event&&(i.event.type==="input"||i.event.type==="keyup"),l=function(a,d){r&&r.setValue(a.value,d)};clearTimeout(e.valueChangeTimeout),s&&o?n.valueChangeTimeout=e.valueChangeTimeout=setTimeout(function(){l(i,e.valueChangeTimeout!==n.valueChangeTimeout)},f(r.updateValueTimeout)?r.updateValueTimeout:0):l(i)},onKeyDown:function(i){t&&xe(i.event)==="enter"&&x.trigger(g(i.component._input()),"change")},valueChangeEvent:"change"+(r.parentType==="filterRow"?" keyup input":"")},r)},As=function(r){r.editorName="dxDateBox",r.editorOptions=rn({value:r.value,onValueChanged:function(e){r.setValue(e.value)},onKeyDown:function(e){let{component:t,event:n}=e;const i=t.option("useMaskBehavior");(Pl()||i)&&xe(n)==="enter"&&(t.blur(),t.focus())},displayFormat:r.format,type:r.dataType,dateSerializationFormat:null,width:r.parentType==="filterBuilder"?void 0:"auto"},r)},ks=function(r){const e=Al(r),t=r.parentType==="searchPanel";r.editorType&&r.editorType!=="dxTextBox"?e.value=r.value:e.value=(n=r.value,f(n)?n.toString():"");var n;e.valueChangeEvent+=t?" keyup input search":"",e.mode=e.mode||(t?"search":"text"),r.editorName="dxTextBox",r.editorOptions=e},Bs=function(r){const e=Al(r);e.value=f(r.value)?r.value:null,r.editorName="dxNumberBox",r.editorOptions=e},Ph=function(r){r.parentType==="filterRow"||r.parentType==="filterBuilder"?kl(y(r,{lookup:{displayExpr:function(e){if(e===!0)return r.trueText||"true";if(e===!1)return r.falseText||"false"},dataSource:[!0,!1]}})):Bl(r)};function Ah(r){if(r.row&&r.row.watch&&r.parentType==="dataRow"){const e=r.editorOptions||{};r.editorOptions=e;let t;const n=e.onInitialized;e.onInitialized=function(s){n&&n.apply(this,arguments),t=s.component,t.on("disposing",o)};let i;const o=r.row.watch(()=>(i=r.lookup.dataSource(r.row),i&&i.filter),()=>{t.option("dataSource",i)},s=>{r.row=s})}}function kl(r){const e=r.lookup;let t,n,i;const o=r.parentType==="filterRow";if(e){t=ce(e.displayExpr),n=e.dataSource,X(n)&&!Oh(n)&&(n=n(r.row||{}),Ah(r)),(Y(n)||Array.isArray(n))&&(n=Wn(n),o&&(i=n.postProcess,n.postProcess=function(l){return this.pageIndex()===0&&(l=l.slice(0),l.unshift(null)),i?i.call(this,l):l}));const s=!!(e.allowClearing&&!o);r.editorName=r.editorType??"dxSelectBox",r.editorOptions=rn({searchEnabled:!0,value:r.value,valueExpr:r.lookup.valueExpr,searchExpr:r.lookup.searchExpr||r.lookup.displayExpr,allowClearing:s,showClearButton:s,displayExpr:function(l){return l===null?r.showAllText:t(l)},dataSource:n,onValueChanged:function(l){const a=[l.value];!o&&a.push(l.component.option("text")),r.setValue.apply(this,a)}},r)}}function Bl(r){r.editorName="dxCheckBox",r.editorOptions=rn({elementAttr:{id:r.id},value:f(r.value)?r.value:void 0,hoverStateEnabled:!r.readOnly,focusStateEnabled:!r.readOnly,activeStateEnabled:!1,onValueChanged:function(e){r.setValue&&r.setValue(e.value,e)}},r)}const kh=function(r,e){const t=g(e.editorElement);if(e.editorName&&e.editorOptions&&t[e.editorName]){if((e.editorName==="dxCheckBox"||e.editorName==="dxSwitch")&&(e.isOnForm||(t.addClass(r.addWidgetPrefix("checkbox-size")),t.parent().addClass(Dh))),r._createComponent(t,e.editorName,e.editorOptions),e.editorName==="dxDateBox"){const n=t.dxDateBox("instance"),i=n._supportedKeys().enter;n.registerKeyHandler("enter",o=>(n.option("opened")&&i(o),!0))}e.editorName==="dxTextArea"&&t.dxTextArea("instance").registerKeyHandler("enter",function(n){xe(n)==="enter"&&!n.ctrlKey&&!n.shiftKey&&n.stopPropagation()})}},Bh=r=>{r.editorName=r.editorType,r.editorOptions=rn({value:r.value,onValueChanged:function(e){r.setValue(e.value)}},r)},Mh=r=>{const e={dxDateBox:As,dxCheckBox:Bl,dxNumberBox:Bs,dxTextBox:ks};if(r.lookup)kl(r);else if(r.editorType)(e[r.editorType]??Bh)(r);else switch(r.dataType){case"date":case"datetime":As(r);break;case"boolean":Ph(r);break;case"number":Bs(r);break;default:ks(r)}},Ml=r=>class extends r{createEditor(e,t){t.cancel=!1,t.editorElement=ie(e),f(t.tabIndex)||(t.tabIndex=this.option("tabIndex")),Mh(t),this.executeAction("onEditorPreparing",t),!t.cancel&&(t.parentType==="dataRow"&&!t.isOnForm&&!f(t.editorOptions.showValidationMark)&&(t.editorOptions.showValidationMark=!1),kh(this,t),this.executeAction("onEditorPrepared",t))}},Nh="dx-editor-inline-block",Nl="dxDataGridEditorFactory",Ms=H([q.down,"focusin",te].join(" "),Nl),cn="dx-hidden",Lh=Ml(L.ViewController);let Hh=class extends Lh{init(){this.createAction("onEditorPreparing",{excludeValidators:["disabled","readOnly"],category:"rendering"}),this.createAction("onEditorPrepared",{excludeValidators:["disabled","readOnly"],category:"rendering"}),this._columnsResizerController=this.getController("columnsResizer"),this._editingController=this.getController("editing"),this._keyboardNavigationController=this.getController("keyboardNavigation"),this._columnsController=this.getController("columns"),this._validatingController=this.getController("validating"),this._rowsView=this.getView("rowsView"),this._updateFocusHandler=this._updateFocusHandler||this.createAction(this._updateFocus.bind(this)),this._subscribedContainerRoot=this._getContainerRoot(),x.on(this._subscribedContainerRoot,Ms,this._updateFocusHandler),this._attachContainerEventHandlers()}dispose(){clearTimeout(this._focusTimeoutID),clearTimeout(this._updateFocusTimeoutID),x.off(this._subscribedContainerRoot,Ms,this._updateFocusHandler)}_getFocusedElement(e){const n=["td[tabindex]:focus",`${this.option("focusedRowEnabled")?"tr[tabindex]:focus":"tr[tabindex]:not(.dx-data-row):focus"}`,"input:focus","button:focus","textarea:focus","div[tabindex]:focus",".dx-lookup-field:focus",".dx-checkbox:focus",".dx-switch:focus",".dx-dropdownbutton .dx-buttongroup:focus",".dx-adaptive-item-text:focus"].join(","),i=e.find(n);return this.elementIsInsideGrid(i)&&i}_getFocusCellSelector(){return".dx-row > td"}_updateFocusCore(){const e=this.component&&this.component.$element();if(e){let t=this._getFocusedElement(e);if(t&&t.length){let n;if(!t.hasClass("dx-cell-focus-disabled")&&!t.hasClass("dx-row")){const i=t.closest(`${this._getFocusCellSelector()}, .dx-cell-focus-disabled`);i.get(0)!==t.get(0)&&(n=this._needHideBorder(i),t=i)}if(t.length&&!t.hasClass("dx-cell-focus-disabled")){this.focus(t,n);return}}}this.loseFocus()}_needHideBorder(e){const t=this._rowsView.element(),n=e.closest(t).length>0,i=this._editingController.isEditing();return e.hasClass(Nh)||n&&!i}_updateFocus(e){const t=this,n=e&&e.event&&g(e.event.target).hasClass(t.addWidgetPrefix("focus-overlay"));t._isFocusOverlay=t._isFocusOverlay||n,clearTimeout(t._updateFocusTimeoutID),t._updateFocusTimeoutID=setTimeout(()=>{delete t._updateFocusTimeoutID,t._isFocusOverlay||t._updateFocusCore(),t._isFocusOverlay=!1})}updateFocusOverlaySize(e,t){e.hide();const n=$i.calculate(e,y({collision:"fit"},t));n.h.oversize>0&&Wo(e,ye(e)-n.h.oversize),n.v.oversize>0&&$o(e,se(e)-n.v.oversize),e.show()}callbackNames(){return["focused"]}getFocusOverlayContainer(e){return e.closest(`.${this.addWidgetPrefix("content")}`)}getFocusOverlaySize(e){const t=Z(e.get(0));return{width:t.right-t.left+1,height:t.bottom-t.top+1}}updateFocusOverlay(e){if(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)this._$focusOverlay.addClass(cn);else if(e.length){const n=ee.mozilla?"right bottom":"left top",i=e.hasClass(this.addWidgetPrefix("invalid")),o=e.hasClass("dx-cell-modified")&&!i,s=this.getFocusOverlayContainer(e),l=this.getFocusOverlaySize(e);this._$focusOverlay.removeClass(cn).toggleClass("dx-focused-cell-invalid",i).toggleClass("dx-focused-cell-modified",o).appendTo(s),$o(this._$focusOverlay,l.height),Wo(this._$focusOverlay,l.width);const a={precise:!0,my:n,at:n,of:e,boundary:s.length&&s};this.updateFocusOverlaySize(this._$focusOverlay,a),$i.setup(this._$focusOverlay,a),this._$focusOverlay.css("visibility","visible")}}renderFocusOverlay(e,t){v.isElementInCurrentGrid(this,e)&&(this._$focusOverlay||(this._$focusOverlay=g("<div>").addClass(this.addWidgetPrefix("focus-overlay"))),this.updateFocusOverlay(e,t))}focus(e,t){const n=this;if(e===void 0)return n._$focusedElement;e&&(e.is(n._$focusedElement)||n._$focusedElement&&n._$focusedElement.removeClass("dx-focused"),n._$focusedElement=e,clearTimeout(n._focusTimeoutID),n._focusTimeoutID=setTimeout(()=>{delete n._focusTimeoutID,n.renderFocusOverlay(e,t),e.addClass("dx-focused"),n.focused.fire(e)}))}refocus(){const e=this.focus();this.focus(e)}resize(){const e=this._$focusedElement;e&&this.focus(e)}loseFocus(e){this._$focusedElement&&this._$focusedElement.removeClass("dx-focused"),this._$focusedElement=null,this._$focusOverlay&&this._$focusOverlay.addClass(cn)}_getContainerRoot(){var e;const t=(e=this.component)===null||e===void 0?void 0:e.$element(),n=M.getRootNode(t==null?void 0:t.get(0));return n.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&!n.host?M.getDocument():n}_attachContainerEventHandlers(){const e=this,t=e.component&&e.component.$element();t&&x.on(t,H("keydown",Nl),n=>{xe(n)==="tab"&&e._updateFocusHandler(n)})}getFocusOverlay(){return this._$focusOverlay}hasOverlayElements(){var e;return!!((e=this._$focusOverlay)!==null&&e!==void 0&&e.length)&&!this._$focusOverlay.hasClass(cn)}};const zh={defaultOptions:()=>({}),controllers:{editorFactory:Hh}};T.registerModule("editorFactory",zh);const hn=ve(),Wh={text:"OK",onClick:()=>!0},$h=()=>Xt()?{stylingMode:"contained",type:"default"}:{},Gh=()=>Xt()?{stylingMode:"outlined",type:"default"}:{},Kh=function(r){const e=E();r=r||{};const t=g("<div>").addClass("dx-dialog").appendTo(Sd()),n="message"in r,i="messageHtml"in r;n&&oe.log("W1013");const o=String(i?r.messageHtml:r.message),s=r.title?null:new ot,l=g("<div>").addClass("dx-dialog-message").html(o).attr("id",s),a=[],d=new tn(t,y({title:r.title??"",showTitle:Go(r.showTitle,!0),dragEnabled:Go(r.dragEnabled,!0),height:"auto",width:r.width,showCloseButton:r.showCloseButton||!1,ignoreChildEvents:!1,container:t,visualContainer:hn,dragAndResizeArea:hn,onContentReady(h){h.component.$content().addClass("dx-dialog-content").append(l),s&&h.component.$overlayContent().attr("aria-labelledby",s)},onShowing(h){h.component.bottomToolbar().addClass("dx-dialog-buttons").find(".dx-button").addClass("dx-dialog-button"),Ar.resetActiveElement()},onShown(h){const p=h.component.bottomToolbar().find(".dx-button").first();x.trigger(p,"focus")},onHiding(){e.reject()},onHidden(h){let{element:p}=h;g(p).remove()},animation:{show:{type:"pop",duration:400},hide:{type:"pop",duration:400,to:{opacity:0,scale:0},from:{opacity:1,scale:1}}},rtlEnabled:Vr().rtlEnabled,position:{boundaryOffset:{h:10,v:0}}},r.popupOptions));(r.buttons||[Wh]).forEach(h=>{const p=new Rd(h.onClick,{context:d});a.push({toolbar:"bottom",location:me.current().android?"after":"center",widget:"dxButton",options:A({},h,{onClick(){const m=p.execute(...arguments);c(m)}})})}),d.option("toolbarItems",a),d.$wrapper().addClass("dx-dialog-wrapper"),r.position&&d.option("position",r.position),d.$wrapper().addClass("dx-dialog-root");function c(h){e.resolve(h),d.hide()}return{show:function(){if(me.real().deviceType==="phone"){const p=J(hn)>K(hn)?"90%":"60%";d.option({width:p})}return d.show(),e.promise()},hide:c}},Uh=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",t=arguments.length>2?arguments[2]:void 0;const n=en(r)?r:{title:e,messageHtml:r,showTitle:t,buttons:[A({text:_.format("Yes"),onClick:()=>!0},$h()),A({text:_.format("No"),onClick:()=>!1},Gh())],dragEnabled:t};return Kh(n).show()},Qn="dx-editor-cell",He="dx-row",jh="dx-cell-modified",Ns="dx-selection",So="edit-form",Ie="insert",Fe="remove",bn="editing.popup",yi="editing.form",he="editing.editRowKey",et="editing.editColumnName",Ll="targetComponent",Ro="input:not([type='hidden'])",To=`[tabindex]:not([disabled]), ${Ro}:not([disabled])`,Mn="batch",Ht="row",Yi="cell",Vo="form",qh="popup",Ls="first",pn="last",Hs="pageBottom",bi="pageTop",zs="viewportBottom",Hl="viewportTop",Xh=["batch","row","cell","form","popup"],Yh=["row","form","popup"],Qh=["batch","cell"],Jh=["batch","row","cell"],Zh=["row","form"],ep="readonly",tp="dx-link",np="dx-link-icon",ip="dx-selection",op="dx-edit-button",sp="dx-command-edit",Ws="dx-command-edit-with-icons",Me="__DX_INSERT_INDEX__",rp="dx-row-inserted",lp="dx-row-modified",$s="dx-cell-modified",ap="dxDataGridEditing",dp="dx-cell-focus-disabled",Tt="update",up="click",cp={save:"dx-link-save",cancel:"dx-link-cancel",edit:"dx-link-edit",undelete:"dx-link-undelete",delete:"dx-link-delete",add:"dx-link-add"},hp={save:"save",cancel:"revert",edit:"edit",undelete:"revert",delete:"trash",add:"add"},pp={edit:"editRow",delete:"deleteRow",undelete:"undeleteRow",save:"saveEditData",cancel:"cancelEditData",add:"addRowByRowIndex"},gp={add:"allowAdding",edit:"allowUpdating",delete:"allowDeleting"},mp=["edit","save","cancel","delete","undelete"],Oe="editing.changes",fp="focus-overlay",Cp="addrow-button",_p="dx-dropdowneditor-overlay",wp="dx-data-row",xp="dx-row-removed",vp="filter-row",yp=!!gt.IS_RENOVATED_WIDGET,zl="edit-form-item",bp="edit-popup",Ip="edit-popup-form",Ep=yp?"dx-scrollable":"dx-scrollable-container",Sp="dx-button",Rp="form-buttons-container",Gs="dx-edit-row",gn=function(r){return function(e){const t=e instanceof Error?e:new Error(e&&String(e)||"Unknown error");r.reject(t)}},Wl=function(r,e){return e.isEditing||r&&e.column.allowEditing},Ks=function(r,e){const t=!!e.column.command,n=Wl(r,e),i=!t&&(n||e.column.showEditorAlways);return e.rowType==="data"&&i},Tp=r=>{const e=r.component.option("editing.texts")||{};return{save:e.saveRowChanges,cancel:e.cancelRowChanges,edit:e.editRow,undelete:e.undeleteRow,delete:e.deleteRow,add:e.addRowToNode}},Vp=()=>`_DX_KEY_${new ot}`,Fp=r=>typeof r=="string"&&r.startsWith("_DX_KEY_")&&r.length===44,at=(r,e)=>{let t=-1;return r.some((n,i)=>{if($l(n)===e)return t=i,!0}),t};function $l(r){return Y(r)?r.name:r}function Op(r){return r&&(r.is("input")||r.is("textarea"))}const Dp=r=>{var e;const{column:t}=r;return r.isCustomEditorType?r.editorType:(e=t.formItem)===null||e===void 0?void 0:e.editorType},Gl=(r,e)=>{r.forEach(t=>{t.items||t.tabs?Gl(t.items||t.tabs,e):e(t)})};class Pp extends L.ViewController{init(){this._columnsController=this.getController("columns"),this._dataController=this.getController("data"),this._adaptiveColumnsController=this.getController("adaptiveColumns"),this._validatingController=this.getController("validating"),this._editorFactoryController=this.getController("editorFactory"),this._focusController=this.getController("focus"),this._keyboardNavigationController=this.getController("keyboardNavigation"),this._columnsResizerController=this.getController("columnsResizer"),this._errorHandlingController=this.getController("errorHandling"),this._rowsView=this.getView("rowsView"),this._headerPanelView=this.getView("headerPanel"),this._lastOperation=null,this._changes=[],this._deferreds&&this._deferreds.forEach(e=>{e.reject("cancel")}),this._deferreds=[],this._dataChangedHandler||(this._dataChangedHandler=this._handleDataChanged.bind(this),this._dataController.changed.add(this._dataChangedHandler)),this._saveEditorHandler||(this.createAction("onInitNewRow",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowInserting",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowInserted",{excludeValidators:["disabled","readOnly"]}),this.createAction("onEditingStart",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowUpdating",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowUpdated",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowRemoving",{excludeValidators:["disabled","readOnly"]}),this.createAction("onRowRemoved",{excludeValidators:["disabled","readOnly"]}),this.createAction("onSaved",{excludeValidators:["disabled","readOnly"]}),this.createAction("onSaving",{excludeValidators:["disabled","readOnly"]}),this.createAction("onEditCanceling",{excludeValidators:["disabled","readOnly"]}),this.createAction("onEditCanceled",{excludeValidators:["disabled","readOnly"]})),this._updateEditColumn(),this._updateEditButtons(),this._internalState||(this._internalState=new Map),this.component._optionsByReference[he]=!0,this.component._optionsByReference[Oe]=!0}getEditMode(){const e=this.option("editing.mode")??Ht;return Xh.includes(e)?e:Ht}isCellBasedEditMode(){const e=this.getEditMode();return Qh.includes(e)}_getDefaultEditorTemplate(){return(e,t)=>{const n=g("<div>").appendTo(e),i=y({},t.column,{value:t.value,setValue:t.setValue,row:t.row,parentType:"dataRow",width:null,readOnly:!t.setValue,isOnForm:t.isOnForm,id:t.id});Jh.includes(this.getEditMode())&&(i["aria-labelledby"]=t.column.headerId),this._editorFactoryController.createEditor(n,i)}}_getNewRowPosition(){const e=this.option("editing.newRowPosition");if(this.option("scrolling.mode")==="virtual")switch(e){case bi:return Hl;case Hs:return zs;default:return e}return e}getChanges(){return this.option(Oe)}getInsertRowCount(){return this.option(Oe).filter(t=>t.type==="insert").length}resetChanges(){const e=this.getChanges();(e==null?void 0:e.length)&&this._silentOption(Oe,[])}_getInternalData(e){return this._internalState.get($e(e))}_addInternalData(e){const t=this._getInternalData(e.key);return t?y(t,e):(this._internalState.set($e(e.key),e),e)}_getOldData(e){var t;return(t=this._getInternalData(e))===null||t===void 0?void 0:t.oldData}getUpdatedData(e){const t=this._dataController.keyOf(e),n=this.getChanges(),i=v.getIndexByKey(t,n);return n[i]?Ze(e,n[i].data):e}getInsertedData(){return this.getChanges().filter(e=>e.data&&e.type===Ie).map(e=>e.data)}getRemovedData(){return this.getChanges().filter(e=>this._getOldData(e.key)&&e.type===Fe).map(e=>this._getOldData(e.key))}_fireDataErrorOccurred(e){if(e==="cancel")return;const t=this.getPopupContent();this._dataController.dataErrorOccurred.fire(e,t)}_needToCloseEditableCell(e){}_closeEditItem(e){}_handleDataChanged(e){}_isDefaultButtonVisible(e,t){let n=!0;switch(e.name){case"delete":n=this.allowDeleting(t);break;case"undelete":n=!1}return n}isPopupEditMode(){return this.option("editing.mode")===qh}_isButtonVisible(e,t){const{visible:n}=e;return f(n)?X(n)?n.call(e,{component:t.component,row:t.row,column:t.column}):n:this._isDefaultButtonVisible(e,t)}_isButtonDisabled(e,t){const{disabled:n}=e;return X(n)?n.call(e,{component:t.component,row:t.row,column:t.column}):!!n}_getButtonConfig(e,t){const n=Y(e)?e:{},i=$l(e),o=Tp(t),s=pp[i],l=this.option("editing"),a=gp[i],d=a?l[a]:!0;return y({name:i,text:o[i],cssClass:cp[i]},{onClick:s&&(u=>{const{event:c}=u;c.stopPropagation(),c.preventDefault(),setTimeout(()=>{t.row&&d&&this[s]&&this[s](t.row.rowIndex)})})},n)}_getEditingButtons(e){let t;const n=!!e.column.buttons;let i=(e.column.buttons||[]).slice();return n?(t=at(i,"edit"),t>=0&&(at(i,"save")<0&&i.splice(t+1,0,"save"),at(i,"cancel")<0&&i.splice(at(i,"save")+1,0,"cancel")),t=at(i,"delete"),t>=0&&at(i,"undelete")<0&&i.splice(t+1,0,"undelete")):i=mp.slice(),i.map(o=>this._getButtonConfig(o,e))}_renderEditingButtons(e,t,n,i){t.forEach(o=>{this._isButtonVisible(o,n)&&this._createButton(e,o,n,i)})}_getEditCommandCellTemplate(){return(e,t,n)=>{const i=g(e);if(t.rowType==="data"){const o=this._getEditingButtons(t);if(this._renderEditingButtons(i,o,t,n),t.watch){const s=t.watch(()=>o.map(l=>({visible:this._isButtonVisible(l,t),disabled:this._isButtonDisabled(l,t)})),()=>{i.empty(),this._renderEditingButtons(i,o,t)});x.on(i,xt,s)}}else v.setEmptyText(i)}}isRowBasedEditMode(){const e=this.getEditMode();return Yh.includes(e)}getFirstEditableColumnIndex(){let e;const t=this._columnsController.getVisibleColumns();return b(t,(n,i)=>{if(i.allowEditing)return e=n,!1}),e}getFirstEditableCellInRow(e){var t;const n=this.getFirstEditableColumnIndex();return(t=this._rowsView)===null||t===void 0?void 0:t._getCellElement(e||0,n)}getFocusedCellInRow(e){return this.getFirstEditableCellInRow(e)}getIndexByKey(e,t){return v.getIndexByKey(e,t)}hasChanges(e){const t=this.getChanges();let n=!1;for(let i=0;i<(t==null?void 0:t.length);i++)if(t[i].type&&(!f(e)||this._dataController.getRowIndexByKey(t[i].key)===e)){n=!0;break}return n}dispose(){super.dispose(),clearTimeout(this._inputFocusTimeoutID),x.off(M.getDocument(),q.up,this._pointerUpEditorHandler),x.off(M.getDocument(),q.down,this._pointerDownEditorHandler),x.off(M.getDocument(),te,this._saveEditorHandler)}_silentOption(e,t){e==="editing.changes"&&(this._changes=Ne([],t)),super._silentOption(e,t)}optionChanged(e){if(e.name==="editing"){const{fullName:t}=e;t===he?this._handleEditRowKeyChange(e):t===Oe?G(e.value,this._changes,{maxDepth:4})||(this._changes=Ne([],e.value),this._handleChangesChange(e)):e.handled||(this._columnsController.reinit(),this.init(),this.resetChanges(),this._resetEditColumnName(),this._resetEditRowKey()),e.handled=!0}else super.optionChanged(e)}_handleEditRowKeyChange(e){const t=this._dataController.getRowIndexByKey(e.value),n=this._getEditRowIndexCorrection(),i=this._dataController.getRowIndexByKey(e.previousValue)+n;f(e.value)?e.value!==e.previousValue&&this._editRowFromOptionChanged(t,i):this.cancelEditData()}_handleChangesChange(e){const t=this._dataController,n=e.value;!e.value.length&&!e.previousValue.length||(n.forEach(i=>{if(i.type==="insert")this._addInsertInfo(i);else{var o;const s=t.getCachedStoreData()||((o=t.items())===null||o===void 0?void 0:o.map(a=>a.data)),l=v.getIndexByKey(i.key,s,t.key());this._addInternalData({key:i.key,oldData:s[l]})}}),t.updateItems({repaintChangesOnly:!0,isLiveUpdate:!1,isOptionChanged:!0}))}publicMethods(){return["addRow","deleteRow","undeleteRow","editRow","saveEditData","cancelEditData","hasEditData"]}refresh(){f(this._pageIndex)&&this._refreshCore.apply(this,arguments)}_refreshCore(e){}isEditing(){return f(this.option(he))}isEditRow(e){return!1}_setEditRowKey(e,t){t?this._silentOption(he,e):this.option(he,e),this._refocusEditCell&&(this._refocusEditCell=!1,this._focusEditingCell())}_setEditRowKeyByIndex(e,t){const n=this._dataController.getKeyByRowIndex(e);if(n===void 0){this._dataController.fireError("E1043");return}this._setEditRowKey(n,t)}getEditRowIndex(){return this._getVisibleEditRowIndex()}getEditFormRowIndex(){return-1}isEditRowByIndex(e){const t=this._dataController.getKeyByRowIndex(e),n=f(t)&&G(this.option(he),t);return n&&this._getVisibleEditRowIndex()===e}isEditCell(e,t){return this.isEditRowByIndex(e)&&this._getVisibleEditColumnIndex()===t}getPopupContent(){}_isProcessedItem(e){return!1}_getInsertRowIndex(e,t,n){let i=-1;const o=this._dataController,s=this._getInsertAfterOrBeforeKey(t);return!f(s)&&e.length===0?i=0:f(s)&&e.some((l,a)=>{const d=n||this._isProcessedItem(l);if(Y(l)&&(d||f(l[Me])?G(l.key,s)&&(i=a):G(o.keyOf(l),s)&&(i=a)),i>=0){const u=e[i+1];return u&&(u.rowType==="detail"||u.rowType==="detailAdaptive")&&f(t.insertAfterKey)?void 0:(f(t.insertAfterKey)&&(i+=1),!0)}}),i}_generateNewItem(e){var t;const n={key:e},i=(t=this._getInternalData(e))===null||t===void 0?void 0:t.insertInfo;return i!=null&&i[Me]&&(n[Me]=i[Me]),n}_getLoadedRowIndex(e,t,n){let i=this._getInsertRowIndex(e,t,n);const o=this._dataController;if(i<0){const s=this._getNewRowPosition(),l=o.pageIndex(),a=this._getInsertAfterOrBeforeKey(t);s!==pn&&l===0&&!f(a)?i=0:s===pn&&o.isLastPageLoaded()&&(i=e.length)}return i}processItems(e,t){const{changeType:n}=t;return this.update(n),this.getChanges().forEach(o=>{var s;if(!(o.type===Ie))return;let{key:a}=o,d=(s=this._getInternalData(a))===null||s===void 0?void 0:s.insertInfo;(!f(a)||!f(d))&&(d=this._addInsertInfo(o),a=d.key);const u=this._getLoadedRowIndex(e,o),c=this._generateNewItem(a);u>=0&&e.splice(u,0,c)}),e}processDataItem(e,t,n){const i=t.visibleColumns,o=e.data[Me]?e.data.key:e.key,s=this.getChanges(),l=v.getIndexByKey(o,s);e.isEditing=!1,l>=0&&this._processDataItemCore(e,s[l],o,i,n)}_processDataItemCore(e,t,n,i,o){const{data:s,type:l}=t;switch(l){case Ie:e.isNewRow=!0,e.key=n,e.data=s;break;case Tt:e.modified=!0,e.oldData=e.data,e.data=Ze(e.data,s),e.modifiedValues=o(s,i,!0);break;case Fe:e.removed=!0}}_initNewRow(e){if(this.executeAction("onInitNewRow",e),e.promise){const t=new E;return F(Pt(e.promise)).done(t.resolve).fail(gn(t)).fail(n=>this._fireDataErrorOccurred(n)),t}}_createInsertInfo(){const e={};return e[Me]=this._getInsertIndex(),e}_addInsertInfo(e,t){var n;let i;e.key=this.getChangeKeyValue(e);const{key:o}=e;if(i=(n=this._getInternalData(o))===null||n===void 0?void 0:n.insertInfo,!f(i)){const s=this._getInsertAfterOrBeforeKey(e);i=this._createInsertInfo(),f(s)||this._setInsertAfterOrBeforeKey(e,t)}return this._addInternalData({insertInfo:i,key:o}),{insertInfo:i,key:o}}getChangeKeyValue(e){if(f(e.key))return e.key;const t=this._dataController.key();let n;return e.data&&t&&!Array.isArray(t)&&(n=e.data[t]),f(n)||(n=Vp()),n}_setInsertAfterOrBeforeKey(e,t){const n=this.getView("rowsView"),i=this._dataController,o=i.items(!0),s=this._getNewRowPosition();switch(s){case Ls:case pn:break;case bi:case Hs:if(o.length){const l=s===bi?0:o.length-1;e[l===0?"insertBeforeKey":"insertAfterKey"]=o[l].key}break;default:{let a=s===zs?n==null?void 0:n.getBottomVisibleItemIndex():n==null?void 0:n.getTopVisibleItemIndex();const d=i.getVisibleRows()[a];d&&(!d.isEditing&&d.rowType==="detail"||d.rowType==="detailAdaptive")&&a++;const u=i.getKeyByRowIndex(a);f(u)&&(e.insertBeforeKey=u)}}}_getInsertIndex(){let e=0;return this.getChanges().forEach(t=>{var n;const i=(n=this._getInternalData(t.key))===null||n===void 0?void 0:n.insertInfo;f(i)&&t.type===Ie&&i[Me]>e&&(e=i[Me])}),e+1}_getInsertAfterOrBeforeKey(e){return e.insertAfterKey??e.insertBeforeKey}_getPageIndexToInsertRow(){const e=this._getNewRowPosition(),t=this._dataController,n=t.pageIndex(),i=t.pageCount()-1;return e===Ls&&n!==0?0:e===pn&&n!==i?i:-1}addRow(e){const t=this._dataController;return t.store()?this._addRow(e):(t.fireError("E1052",this.component.NAME),new E().reject())}_addRow(e){const n=this._dataController.store(),i=n&&n.key(),o={data:{}},s=this._getVisibleEditRowIndex(),l=new E;return this.refresh({allowCancelEditing:!0}),this._allowRowAdding()?(i||(o.data.__KEY__=String(new ot)),F(this._initNewRow(o,e)).done(()=>{this._allowRowAdding()?F(this._addRowCore(o.data,e,s)).done(l.resolve).fail(l.reject):l.reject("cancel")}).fail(l.reject),l.promise()):(F(this._navigateToNewRow(s)).done(l.resolve).fail(l.reject),l.promise())}_allowRowAdding(e){return!(this._getInsertIndex()>1)}_addRowCore(e,t,n){const i={data:e,type:Ie},o=this._getVisibleEditRowIndex(),s=this._addInsertInfo(i,t),{key:l}=s;return this._setEditRowKey(l,!0),this._addChange(i),this._navigateToNewRow(n,i,o)}_navigateToNewRow(e,t,n){const i=new E,o=this._dataController;if(n=n??-1,t=t??this.getChanges().filter(u=>u.type===Ie)[0],!t)return i.reject("cancel").promise();const s=this._getPageIndexToInsertRow();let l=this._getLoadedRowIndex(o.items(),t,!0);const a=u=>{var c;F((c=this._focusController)===null||c===void 0?void 0:c.navigateToRow(u)).done(()=>{l=o.getRowIndexByKey(t.key),i.resolve()})},d=this._getInsertAfterOrBeforeKey(t);return s>=0?o.pageIndex(s).done(()=>{a(t.key)}).fail(i.reject):l<0&&f(d)?a(d):(o.updateItems({changeType:"update",rowIndices:[e,n,l]}),l=o.getRowIndexByKey(t.key),l<0?a(t.key):i.resolve()),i.done(()=>{var u;(u=this._rowsView)===null||u===void 0||u.waitAsyncTemplates(!0).done(()=>{this._showAddedRow(l),this._afterInsertRow(t.key)})}),i.promise()}_showAddedRow(e){this._focusFirstEditableCellInRow(e)}_beforeFocusElementInRow(e){}_focusFirstEditableCellInRow(e){var t;const n=this._dataController,i=n.getKeyByRowIndex(e),o=this.getFirstEditableCellInRow(e);(t=this._keyboardNavigationController)===null||t===void 0||t.focus(o),this.option("focusedRowKey",i),this._editCellInProgress=!0,this._delayedInputFocus(o,()=>{e=n.getRowIndexByKey(i),this._editCellInProgress=!1,this._beforeFocusElementInRow(e)})}_isEditingStart(e){return this.executeAction("onEditingStart",e),e.cancel}_beforeUpdateItems(e,t){}_getVisibleEditColumnIndex(){const e=this.option(et);return f(e)?this._columnsController.getVisibleColumnIndex(e):-1}_setEditColumnNameByIndex(e,t){var n;const i=this._columnsController.getVisibleColumns();this._setEditColumnName((n=i[e])===null||n===void 0?void 0:n.name,t)}_setEditColumnName(e,t){t?this._silentOption(et,e):this.option(et,e)}_resetEditColumnName(){this._setEditColumnName(null,!0)}_getEditColumn(){const e=this.option(et);return this._getColumnByName(e)}_getColumnByName(e){const t=this._columnsController.getVisibleColumns();let n;return f(e)&&t.some(i=>{if(i.name===e)return n=i,!0}),n}_getVisibleEditRowIndex(e){const t=this._dataController,n=this.option(he),i=t.getRowIndexByKey(n);return i===-1?i:i+this._getEditRowIndexCorrection(e)}_getEditRowIndexCorrection(e){const t=e?this._getColumnByName(e):this._getEditColumn();return(t==null?void 0:t.visibleWidth)==="adaptiveHidden"?1:0}_resetEditRowKey(){this._refocusEditCell=!1,this._setEditRowKey(null,!0)}_resetEditIndices(){this._resetEditColumnName(),this._resetEditRowKey()}editRow(e){const t=this._dataController,i=t.items()[e],o={data:i&&i.data,cancel:!1},s=this._getVisibleEditRowIndex();if(i){if(e===s)return!0;if(i.key===void 0){this._dataController.fireError("E1043");return}i.isNewRow||(o.key=i.key),!this._isEditingStart(o)&&(this.resetChanges(),this.init(),this._resetEditColumnName(),this._pageIndex=t.pageIndex(),this._addInternalData({key:i.key,oldData:i.oldData??i.data}),this._setEditRowKey(i.key))}}_editRowFromOptionChanged(e,t){const n=[t,e];this._beforeUpdateItems(n,e,t),this._editRowFromOptionChangedCore(n,e)}_editRowFromOptionChangedCore(e,t,n){this._needFocusEditor=!0,this._dataController.updateItems({changeType:"update",rowIndices:e,cancel:n})}_focusEditorIfNeed(){}_showEditPopup(e,t){}_repaintEditPopup(){}_getEditPopupHiddenHandler(){return e=>{this.isEditing()&&this.cancelEditData()}}_getPopupEditFormTemplate(e){}_getSaveButtonConfig(){const e={text:this.option("editing.texts.saveRowChanges"),onClick:this.saveEditData.bind(this)};return Xt(jt())&&(e.stylingMode="contained",e.type="default"),e}_getCancelButtonConfig(){const e={text:this.option("editing.texts.cancelRowChanges"),onClick:this.cancelEditData.bind(this)};return Xt(jt())&&(e.stylingMode="outlined"),e}_removeInternalData(e){this._internalState.delete($e(e))}_updateInsertAfterOrBeforeKeys(e,t){const n=e[t];e.forEach(i=>{const o=this._getInsertAfterOrBeforeKey(i);G(o,n.key)&&(i[f(i.insertAfterKey)?"insertAfterKey":"insertBeforeKey"]=this._getInsertAfterOrBeforeKey(n))})}_removeChange(e){if(e>=0){const t=[...this.getChanges()],{key:n}=t[e];this._removeInternalData(n),this._updateInsertAfterOrBeforeKeys(t,e),t.splice(e,1),this._silentOption(Oe,t),G(this.option(he),n)&&this._resetEditIndices()}}executeOperation(e,t){this._lastOperation&&this._lastOperation.reject(),this._lastOperation=e,this.waitForDeferredOperations().done(()=>{e.state()!=="rejected"&&(t(),this._lastOperation=null)}).fail(()=>{e.reject(),this._lastOperation=null})}waitForDeferredOperations(){return F(...this._deferreds)}_processCanceledEditingCell(){}_repaintEditCell(e,t,n){!e||!e.showEditorAlways||t&&!t.showEditorAlways?(this._editCellInProgress=!0,this._needFocusEditor=!0,this._editorFactoryController.loseFocus(),this._dataController.updateItems({changeType:"update",rowIndices:[n,this._getVisibleEditRowIndex()]})):e!==t&&(this._needFocusEditor=!0,this._dataController.updateItems({changeType:"update",rowIndices:[]}))}_delayedInputFocus(e,t,n){const i=()=>{if(t&&t(),e){const o=e.find(To).first();v.focusAndSelectElement(this,o)}this._beforeFocusCallback=null};me.real().ios||me.real().android?i():(this._beforeFocusCallback&&this._beforeFocusCallback(),clearTimeout(this._inputFocusTimeoutID),n&&(this._beforeFocusCallback=t),this._inputFocusTimeoutID=setTimeout(i))}_focusEditingCell(e,t,n){const i=this._getVisibleEditColumnIndex();t=t||this._rowsView&&this._rowsView._getCellElement(this._getVisibleEditRowIndex(),i),t&&this._delayedInputFocus(t,e,n)}deleteRow(e){this._checkAndDeleteRow(e)}_checkAndDeleteRow(e){const t=this.option("editing"),n=t==null?void 0:t.texts,i=t==null?void 0:t.confirmDelete,o=n==null?void 0:n.confirmDeleteMessage,s=this._dataController.items()[e],l=!this.isEditing()||s.isNewRow;if(s&&l)if(!i||!o)this._deleteRowCore(e);else{const a=n&&n.confirmDeleteTitle,d=f(a)&&a.length>0;Uh(o,a,d).done(u=>{u&&this._deleteRowCore(e)})}}_deleteRowCore(e){const n=this._dataController.items()[e],i=n&&n.key,o=this._getVisibleEditRowIndex();this.refresh();const s=this.getChanges(),l=v.getIndexByKey(i,s);return l>=0?s[l].type===Ie?this._removeChange(l):this._addChange({key:i,type:Fe}):this._addChange({key:i,oldData:n.data,type:Fe}),this._afterDeleteRow(e,o)}_afterDeleteRow(e,t){return this.saveEditData()}undeleteRow(e){const t=this._dataController,n=t.items()[e],i=this._getVisibleEditRowIndex(),o=n&&n.key,s=this.getChanges();if(n){const l=v.getIndexByKey(o,s);if(l>=0){const{data:a}=s[l];on(a)?this._removeChange(l):this._addChange({key:o,type:Tt}),t.updateItems({changeType:"update",rowIndices:[i,e]})}}}_fireOnSaving(){const e={cancel:!1,promise:null,changes:[...this.getChanges()]};this.executeAction("onSaving",e);const t=new E;return F(Pt(e.promise)).done(()=>{t.resolve(e)}).fail(n=>{this._fireDataErrorOccurred(n),t.resolve({cancel:!0})}),t}_executeEditingAction(e,t,n){if(this.component._disposed)return null;const i=new E;return this.executeAction(e,t),F(Pt(t.cancel)).done(o=>{o?setTimeout(()=>{i.resolve("cancel")}):n(t).done(i.resolve).fail(gn(i))}).fail(gn(i)),i}_processChanges(e,t,n,i){const o=this._dataController.store();b(i,(s,l)=>{const a=this._getOldData(l.key),{data:d,type:u}=l,c=A({},l);let h,p;if(!this._beforeSaveEditData(l,s)){switch(u){case Fe:p={data:a,key:l.key,cancel:!1},h=this._executeEditingAction("onRowRemoving",p,()=>o.remove(l.key).done(m=>{n.push({type:"remove",key:m})}));break;case Ie:p={data:d,cancel:!1},h=this._executeEditingAction("onRowInserting",p,()=>o.insert(p.data).done((m,C)=>{f(C)&&(c.key=C),m&&Y(m)&&m!==p.data&&(c.data=m),n.push({type:"insert",data:m,index:0})}));break;case Tt:p={newData:d,oldData:a,key:l.key,cancel:!1},h=this._executeEditingAction("onRowUpdating",p,()=>o.update(l.key,p.newData).done((m,C)=>{m&&Y(m)&&m!==p.newData&&(c.data=m),n.push({type:"update",key:C,data:m})}))}if(i[s]=c,h){const m=new E;h.always(C=>{t.push({key:l.key,result:C})}).always(m.resolve),e.push(m.promise())}}})}_processRemoveIfError(e,t){const n=e[t];return(n==null?void 0:n.type)===Fe&&t>=0&&e.splice(t,1),!0}_processRemove(e,t,n){const i=e[t];if(!n||!i||i.type===Fe)return this._processRemoveCore(e,t,!n||!i)}_processRemoveCore(e,t,n){return t>=0&&e.splice(t,1),!0}_processSaveEditDataResult(e){let t=!1;const n=[...this.getChanges()],i=n.length;for(let o=0;o<e.length;o++){const s=e[o].result,l=s==="cancel",a=v.getIndexByKey(e[o].key,n),d=n[a];if(s&&s instanceof Error){if(d&&this._addInternalData({key:d.key,error:s}),this._fireDataErrorOccurred(s),this._processRemoveIfError(n,a))break}else this._processRemove(n,a,l)&&(t=!l)}return n.length<i&&this._silentOption(Oe,n),t}_fireSaveEditDataEvents(e){b(e,(t,n)=>{let{data:i,key:o,type:s}=n;const l=this._addInternalData({key:o}),a={key:o,data:i};switch(l.error&&(a.error=l.error),s){case Fe:this.executeAction("onRowRemoved",y({},a,{data:l.oldData}));break;case Ie:this.executeAction("onRowInserted",a);break;case Tt:this.executeAction("onRowUpdated",a)}}),this.executeAction("onSaved",{changes:e})}saveEditData(){const e=new E;return this.waitForDeferredOperations().done(()=>{if(this.isSaving()){this._resolveAfterSave(e);return}F(this._beforeSaveEditData()).done(t=>{if(t){this._resolveAfterSave(e,{cancel:t});return}this._saving=!0,this._saveEditDataInner().always(()=>{this._saving=!1,this._refocusEditCell&&this._focusEditingCell()}).done(e.resolve).fail(e.reject)}).fail(e.reject)}).fail(e.reject),e.promise()}_resolveAfterSave(e){let{cancel:t,error:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};F(this._afterSaveEditData(t)).done(()=>{e.resolve(n)}).fail(e.reject)}_saveEditDataInner(){const e=new E,t=[],n=[],i=[],o=this._dataController.dataSource();return F(this._fireOnSaving()).done(s=>{let{cancel:l,changes:a}=s;if(l)return e.resolve().promise();if(this._processChanges(n,t,i,a),n.length)return this._refocusEditCell=!0,o==null||o.beginLoading(),F(...n).done(()=>{this._processSaveEditDataResult(t)?this._endSaving(i,a,e):(o==null||o.endLoading(),e.resolve())}).fail(d=>{o==null||o.endLoading(),e.resolve(d)}),e.always(()=>{this._refocusEditCell=!0}).promise();this._cancelSaving(e)}).fail(e.reject),e.promise()}_beforeEndSaving(e){this._resetEditIndices()}_endSaving(e,t,n){const i=this._dataController.dataSource();this._beforeEndSaving(t),i==null||i.endLoading(),this._refreshDataAfterSave(e,t,n)}_cancelSaving(e){this.executeAction("onSaved",{changes:[]}),this._resolveAfterSave(e)}_refreshDataAfterSave(e,t,n){const i=this._dataController,o=this.option("editing.refreshMode"),s=o!=="reshape"&&o!=="repaint";s||i.push(e),F(i.refresh({selection:s,reload:s,load:o==="reshape",changesOnly:this.option("repaintChangesOnly")})).always(()=>{this._fireSaveEditDataEvents(t)}).done(()=>{this._resolveAfterSave(n)}).fail(l=>{this._resolveAfterSave(n,{error:l})})}isSaving(){return this._saving}_updateEditColumn(){const e=this._isEditColumnVisible(),t=this.option("editing.useIcons"),n=sp+(t?` ${Ws}`:"");this._columnsController.addCommandColumn({type:"buttons",command:"edit",visible:e,cssClass:n,width:"auto",alignment:"center",cellTemplate:this._getEditCommandCellTemplate(),fixedPosition:"right"}),this._columnsController.columnOption("command:edit",{visible:e,cssClass:n})}_isEditColumnVisible(){return this.option("editing").allowDeleting}_isEditButtonDisabled(){const e=this.hasChanges();return!(f(this.option("editing.editRowKey"))||e)}_updateEditButtons(){const e=this._isEditButtonDisabled();this._headerPanelView&&(this._headerPanelView.setToolbarItemDisabled("saveButton",e),this._headerPanelView.setToolbarItemDisabled("revertButton",e))}_applyModified(e,t){e&&e.addClass($s)}_beforeCloseEditCellInBatchMode(e){}cancelEditData(){const e=this.getChanges(),t={cancel:!1,changes:e};this.executeAction("onEditCanceling",t),t.cancel||(this._cancelEditDataCore(),this.executeAction("onEditCanceled",{changes:e}))}_cancelEditDataCore(){const e=this._getVisibleEditRowIndex();this._beforeCancelEditData(),this.init(),this.resetChanges(),this._resetEditColumnName(),this._resetEditRowKey(),this._afterCancelEditData(e)}_afterCancelEditData(e){this._dataController.updateItems({repaintChangesOnly:this.option("repaintChangesOnly")})}_hideEditPopup(){}hasEditData(){return this.hasChanges()}update(e){const t=this._dataController;t&&this._pageIndex!==t.pageIndex()&&(e==="refresh"&&this.refresh({isPageChanged:!0}),this._pageIndex=t.pageIndex()),this._updateEditButtons()}_getRowIndicesForCascadeUpdating(e,t){return t?[]:[e.rowIndex]}addDeferred(e){this._deferreds.includes(e)||(this._deferreds.push(e),e.always(()=>{const t=this._deferreds.indexOf(e);t>=0&&this._deferreds.splice(t,1)}))}_prepareChange(e,t,n){var i;const o={},s=(i=e.row)===null||i===void 0?void 0:i.data,l=e.key,a=new E;return l!==void 0&&(e.value=t,Pt(e.column.setCellValue(o,t,y(!0,{},s),n)).done(()=>{a.resolve({data:o,key:l,oldData:s,type:Tt})}).fail(gn(a)).fail(u=>this._fireDataErrorOccurred(u)),f(n)&&e.column.displayValueMap&&(e.column.displayValueMap[t]=n),this._updateRowValues(e),this.addDeferred(a)),a}_updateRowValues(e){if(e.values){const t=this._dataController,n=t.getRowIndexByKey(e.key),i=t.getVisibleRows()[n];i&&(e.row.values=i.values,e.values=i.values),e.values[e.columnIndex]=e.value}}updateFieldValue(e,t,n,i){const o=e.key,s=new E;return o===void 0&&this._dataController.fireError("E1043"),e.column.setCellValue?this._prepareChange(e,t,n).done(l=>{F(this._applyChange(e,l,i)).always(()=>{s.resolve()})}):s.resolve(),s.promise()}_focusPreviousEditingCellIfNeed(e){if(this.hasEditData()&&!this.isEditCell(e.rowIndex,e.columnIndex))return this._focusEditingCell(),this._updateEditRow(e.row,!0),!0}_needUpdateRow(e){const t=this._columnsController.getVisibleColumns();e||(e=this._getEditColumn());const n=e&&e.setCellValue!==e.defaultSetCellValue,i=t.some(o=>o.calculateCellValue!==o.defaultCalculateCellValue);return n||i}_applyChange(e,t,n){const i=A({},e,{forceUpdateRow:n});return this._addChange(t,i),this._updateEditButtons(),this._applyChangeCore(e,i.forceUpdateRow)}_applyChangeCore(e,t){const n=e.column.setCellValue!==e.column.defaultSetCellValue,{row:i}=e;i&&(t||n?this._updateEditRow(i,t,n):i.update&&i.update())}_updateEditRowCore(e,t,n){this._dataController.updateItems({changeType:"update",rowIndices:this._getRowIndicesForCascadeUpdating(e,t)})}_updateEditRow(e,t,n){t?this._updateRowImmediately(e,t,n):this._updateRowWithDelay(e,n)}_updateRowImmediately(e,t,n){this._updateEditRowCore(e,!t,n),this._validateEditFormAfterUpdate(e,n),t||this._focusEditingCell()}_updateRowWithDelay(e,t){const n=new E;this.addDeferred(n),setTimeout(()=>{var i;const o=((i=this._editForm)===null||i===void 0?void 0:i.element())||this.component.$element().get(0),s=g(M.getActiveElement(o)),l=this._rowsView.getCellIndex(s,e.rowIndex);let a=s.get(0);const d=v.getSelectionRange(a);if(this._updateEditRowCore(e,!1,t),this._validateEditFormAfterUpdate(e,t),l>=0){const u=this._rowsView._getCellElement(e.rowIndex,l);this._delayedInputFocus(u,()=>{setTimeout(()=>{var c;a=M.getActiveElement((c=this.component.$element())===null||c===void 0?void 0:c.get(0)),d.selectionStart>=0&&v.setSelectionRange(a,d)})})}n.resolve()})}_validateEditFormAfterUpdate(){}_addChange(e,t){var n;const i=t==null?void 0:t.row,o=[...this.getChanges()];let s=v.getIndexByKey(e.key,o);s<0&&(s=o.length,this._addInternalData({key:e.key,oldData:e.oldData}),delete e.oldData,o.push(e));const l=A({},o[s]);return l&&(e.data&&(l.data=Ze(l.data,e.data)),(!l.type||!e.data)&&e.type&&(l.type=e.type),i&&(i.oldData=this._getOldData(i.key),i.data=Ze(i.data,e.data))),o[s]=l,this._silentOption(Oe,o),t&&l!==((n=this.getChanges())===null||n===void 0?void 0:n[s])&&(t.forceUpdateRow=!0),l}_getFormEditItemTemplate(e,t){return t.editCellTemplate||this._getDefaultEditorTemplate()}getColumnTemplate(e){const{column:t}=e,n=e.row&&e.row.rowIndex;let i;const o=this.isRowBasedEditMode(),s=this.isEditRow(n),l=this.isEditCell(n,e.columnIndex);let a;return(t.showEditorAlways||t.setCellValue&&(s&&t.allowEditing||l))&&(e.rowType==="data"||e.rowType==="detailAdaptive")&&!t.command?(((this.allowUpdating(e)||s)&&t.allowEditing||l)&&(s||!o)&&(t.showEditorAlways&&!o&&(a={cancel:!1,key:e.row.isNewRow?void 0:e.row.key,data:e.row.data,column:t},this._isEditingStart(a)),(!a||!a.cancel)&&(e.setValue=(u,c)=>{this.updateFieldValue(e,u,c)})),i=t.editCellTemplate||this._getDefaultEditorTemplate()):t.command==="detail"&&e.rowType==="detail"&&s&&(i=this===null||this===void 0?void 0:this.getEditFormTemplate(e)),i}_createButton(e,t,n,i){let o=hp[t.name];const s=this.option("editing.useIcons"),l=this.option("useLegacyColumnButtonTemplate");let a=g("<a>").attr("href","#").addClass(tp).addClass(t.cssClass);if(t.template&&l)this._rowsView.renderTemplate(e,t.template,n,!0);else{if(t.template)a=g("<span>").addClass(t.cssClass);else if(s&&o||t.icon){o=t.icon||o;const d=Vd(o);d==="image"||d==="svg"?a=Td(o).addClass(t.cssClass):a.addClass(`dx-icon${d==="dxIcon"?"-":" "}${o}`).attr("title",t.text),a.addClass(np),e.addClass(Ws);const u=this.getButtonLocalizationNames()[t.name];u&&a.attr("aria-label",_.format(u))}else a.text(t.text);f(t.hint)&&a.attr("title",t.hint),this._isButtonDisabled(t,n)?a.addClass("dx-state-disabled"):(!t.template||t.onClick)&&x.on(a,H("click",ap),this.createAction(d=>{var u;(u=t.onClick)===null||u===void 0||u.call(t,y({},d,{row:n.row,column:n.column})),d.event.preventDefault(),d.event.stopPropagation()})),e.append(a),t.template&&(n.renderAsync=!1,this._rowsView.renderTemplate(a,t.template,n,!0,i))}}getButtonLocalizationNames(){return{edit:"dxDataGrid-editingEditRow",save:"dxDataGrid-editingSaveRowChanges",delete:"dxDataGrid-editingDeleteRow",undelete:"dxDataGrid-editingUndeleteRow",cancel:"dxDataGrid-editingCancelRowChanges"}}prepareButtonItem(e,t,n,i){const o=this.option("editing.texts")??{},s={revert:o.cancelAllChanges,save:o.saveAllChanges,addRow:o.addRow},l={revert:"cancel",save:"save",addRow:"addrow"}[t],a=s[t],d=(l==="save"||l==="cancel")&&this._isEditButtonDisabled();return{widget:"dxButton",options:{onInitialized:u=>{g(u.element).addClass(e._getToolbarButtonClass(`${op} ${this.addWidgetPrefix(l)}-button`))},icon:`edit-button-${l}`,disabled:d,onClick:()=>{setTimeout(()=>{this[n]()})},text:a,hint:a},showText:"inMenu",name:`${t}Button`,location:"after",locateInMenu:"auto",sortIndex:i}}prepareEditButtons(e){const t=this.option("editing")??{},n=[];return t.allowAdding&&n.push(this.prepareButtonItem(e,"addRow","addRow",20)),n}highlightDataCell(e,t){this.shouldHighlightCell(t)&&e.addClass($s)}_afterInsertRow(e){}_beforeSaveEditData(e){if(e&&!f(e.key)&&f(e.type))return!0}_afterSaveEditData(){}_beforeCancelEditData(){}_allowEditAction(e,t){let n=this.option(`editing.${e}`);return X(n)&&(n=n({component:this.component,row:t.row})),n}allowUpdating(e,t){const n=this.option("editing.startEditAction")??up;return(arguments.length>1?n===t||t==="down":!0)&&this._allowEditAction("allowUpdating",e)}allowDeleting(e){return this._allowEditAction("allowDeleting",e)}isCellModified(e){var t,n;const{columnIndex:i}=e;let o=e==null||(t=e.row)===null||t===void 0||(t=t.modifiedValues)===null||t===void 0?void 0:t[i];return e!=null&&(n=e.row)!==null&&n!==void 0&&n.isNewRow&&(o=e.value),o!==void 0}isNewRowInEditMode(){const e=this._getVisibleEditRowIndex(),t=this._dataController.items();return e>=0?t[e].isNewRow:!1}_isRowDeleteAllowed(){}shouldHighlightCell(e){return this.isCellModified(e)&&e.column.setCellValue&&(this.getEditMode()!==Ht||!e.row.isEditing)}}const Kl=r=>class extends r{reload(e,t){return!t&&this._editingController.refresh(),super.reload.apply(this,arguments)}repaintRows(){if(!this._editingController.isSaving())return super.repaintRows.apply(this,arguments)}_updateEditRow(e){const t=this.option(he),n=v.getIndexByKey(t,e),i=e[n];if(i){var o;i.isEditing=!0,(o=this._updateEditItem)===null||o===void 0||o.call(this,i)}}_updateItemsCore(e){super._updateItemsCore(e),this._updateEditRow(this.items(!0))}_applyChangeUpdate(e){this._updateEditRow(e.items),super._applyChangeUpdate(e)}_applyChangesOnly(e){this._updateEditRow(e.items),super._applyChangesOnly(e)}_processItems(e,t){return e=this._editingController.processItems(e,t),super._processItems(e,t)}_processDataItem(e,t){return this._editingController.processDataItem(e,t,this.generateDataValues),super._processDataItem(e,t)}_processItem(e,t){return e=super._processItem(e,t),e.isNewRow&&(t.dataIndex--,delete e.dataIndex),e}_getChangedColumnIndices(e,t,n,i){if(!(e.isNewRow!==t.isNewRow||e.removed!==t.removed))return super._getChangedColumnIndices.apply(this,arguments)}_isCellChanged(e,t,n,i,o){const s=e.cells&&e.cells[i],l=this._editingController&&this._editingController.isEditCell(n,i);return o&&l?!1:s&&s.column&&!s.column.showEditorAlways&&s.isEditing!==l?!0:super._isCellChanged.apply(this,arguments)}needToRefreshOnDataSourceChange(e){return!(Array.isArray(e.value)&&e.value===e.previousValue&&this._editingController.isSaving())}_handleDataSourceChange(e){const t=super._handleDataSourceChange(e),n=this.option("editing.changes"),i=e.value;if(Array.isArray(i)&&n.length){const o=i.map(d=>this.keyOf(d)),s=n.filter(d=>d.type==="insert"||o.some(u=>G(d.key,u)));s.length!==n.length&&this.option("editing.changes",s);const l=this.option("editing.editRowKey");!s.some(d=>d.type==="insert"&&G(l,d.key))&&o.every(d=>!G(l,d))&&this.option("editing.editRowKey",null)}return t}},Ap=r=>class extends r{getCellIndex(e,t){if(!e.is("td")&&t>=0){const n=this.getCellElements(t);let i=-1;return b(n,(o,s)=>{g(s).find(e).length&&(i=o)}),i}return super.getCellIndex.apply(this,arguments)}publicMethods(){return super.publicMethods().concat(["cellValue"])}_getCellTemplate(e){return this._editingController.getColumnTemplate(e)||super._getCellTemplate(e)}_createRow(e){const t=super._createRow.apply(this,arguments);if(e){const n=!!e.removed,i=!!e.isNewRow,o=!!e.modified;i&&t.addClass(rp),o&&t.addClass(lp),(i||n)&&t.removeClass(ip)}return t}_getColumnIndexByElement(e){let t=e.closest("table");const n=this.getTableElements();for(;t.length&&!n.filter(t).length;)e=t.closest("td"),t=e.closest("table");return this._getColumnIndexByElementCore(e)}_getColumnIndexByElementCore(e){const t=e.closest(`.${He}> td:not(.dx-master-detail-cell)`);return this.getCellIndex(t)}_editCellByClick(e,t){const n=this._editingController,i=g(e.event.target),o=this._getColumnIndexByElement(i),s=this._dataController.items()[e.rowIndex],l=n.allowUpdating({row:s},t)||s&&s.isNewRow,a=this._columnsController.getVisibleColumns()[o],d=n.isEditCell(e.rowIndex,o),u=l&&a&&(a.allowEditing||d),c=this.option("editing.startEditAction")||"click",h=a&&a.showEditorAlways;if(d)return!0;if(t==="down")return(me.real().ios||me.real().android)&&Ar.resetActiveElement(),h&&u&&n.editCell(e.rowIndex,o);if(t==="click"&&c==="dblClick"&&this._pointerDownTarget===i.get(0)){const m=s==null?void 0:s.isNewRow;n.closeEditCell(!1,m)}if(u&&t===c)return n.editCell(e.rowIndex,o)||n.isEditRow(e.rowIndex)}_rowPointerDown(e){this._pointerDownTarget=e.event.target,this._pointerDownTimeout=setTimeout(()=>{this._editCellByClick(e,"down")})}_rowClickTreeListHack(e){super._rowClick.apply(this,arguments)}_rowClick(e){const t=g(e.rowElement).hasClass(this.addWidgetPrefix(So));e.event[Ll]=this.component,!this._editCellByClick(e,"click")&&!t&&super._rowClick.apply(this,arguments)}_rowDblClickTreeListHack(e){super._rowDblClick.apply(this,arguments)}_rowDblClick(e){this._editCellByClick(e,"dblClick")||super._rowDblClick.apply(this,arguments)}_cellPrepared(e,t){var n;const i=this._editingController,o=!!t.column.command,s=t.setValue,l=i.isEditRow(t.rowIndex),a=Wl(l,t);if(Ks(l,t)){const{alignment:u}=t.column;e.toggleClass(this.addWidgetPrefix(ep),!s).toggleClass(dp,!s),u&&e.find(Ro).first().css("textAlign",u)}a&&this._editCellPrepared(e);const d=!!((n=t.column)!==null&&n!==void 0&&n.cellTemplate);t.column&&!o&&(!d||i.shouldHighlightCell(t))&&i.highlightDataCell(e,t),super._cellPrepared.apply(this,arguments)}_getCellOptions(e){const t=super._getCellOptions(e),{columnIndex:n,row:i}=e;return t.isEditing=this._editingController.isEditCell(t.rowIndex,t.columnIndex),t.removed=i.removed,i.modified&&(t.modified=i.modifiedValues[n]!==void 0),t}_setCellAriaAttributes(e,t,n){super._setCellAriaAttributes(e,t,n),t.removed&&this.setAria("roledescription",_.format("dxDataGrid-ariaDeletedCell"),e),t.modified&&this.setAria("roledescription",_.format("dxDataGrid-ariaModifiedCell"),e),t.column.allowEditing&&!t.removed&&!t.modified&&t.rowType==="data"&&t.column.calculateCellValue===t.column.defaultCalculateCellValue&&this._editingController.isCellBasedEditMode()&&this.setAria("roledescription",_.format("dxDataGrid-ariaEditableCell"),e)}_createCell(e){const t=super._createCell(e),n=this._editingController.isEditRow(e.rowIndex);return Ks(n,e)&&t.addClass(Qn),t}cellValue(e,t,n,i){const o=this.getCellOptions(e,t);if(o){if(n===void 0)return o.value;this._editingController.updateFieldValue(o,n,i,!0)}}dispose(){super.dispose.apply(this,arguments),clearTimeout(this._pointerDownTimeout)}_renderCore(){return super._renderCore.apply(this,arguments),this.waitAsyncTemplates(!0).done(()=>{this._editingController._focusEditorIfNeed()})}_editCellPrepared(){}_formItemPrepared(){}},kp=r=>class extends r{optionChanged(e){const{fullName:t}=e;switch(e.name){case"editing":{t&&![bn,Oe,et,he].some(o=>o===t)&&this._invalidate(),super.optionChanged(e);break}case"useLegacyColumnButtonTemplate":e.handled=!0;break;default:super.optionChanged(e)}}_getToolbarItems(){const e=super._getToolbarItems();return this._editingController.prepareEditButtons(this).concat(e)}isVisible(){const e=this._editingController.option("editing");return super.isVisible()||(e==null?void 0:e.allowAdding)}},Ii={defaultOptions:()=>({editing:{mode:"row",refreshMode:"full",newRowPosition:Hl,allowAdding:!1,allowUpdating:!1,allowDeleting:!1,useIcons:!1,selectTextOnEditStart:!1,confirmDelete:!0,texts:{editRow:_.format("dxDataGrid-editingEditRow"),saveAllChanges:_.format("dxDataGrid-editingSaveAllChanges"),saveRowChanges:_.format("dxDataGrid-editingSaveRowChanges"),cancelAllChanges:_.format("dxDataGrid-editingCancelAllChanges"),cancelRowChanges:_.format("dxDataGrid-editingCancelRowChanges"),addRow:_.format("dxDataGrid-editingAddRow"),deleteRow:_.format("dxDataGrid-editingDeleteRow"),undeleteRow:_.format("dxDataGrid-editingUndeleteRow"),confirmDeleteMessage:_.format("dxDataGrid-editingConfirmDeleteMessage"),confirmDeleteTitle:""},form:{colCount:2},popup:{},startEditAction:"click",editRowKey:null,editColumnName:null,changes:[]},useLegacyColumnButtonTemplate:!1}),controllers:{editing:Pp},extenders:{controllers:{data:Kl},views:{rowsView:Ap,headerPanel:kp}}},Bp=r=>class extends Kl(r){_changeRowExpandCore(e){const t=this._editingController;return Array.isArray(e)&&t&&t.refresh(),super._changeRowExpandCore.apply(this,arguments)}};T.registerModule("editing",A({},Ii,{extenders:A({},Ii.extenders,{controllers:A({},Ii.extenders.controllers,{data:Bp})})}));const Mp=r=>class extends r{isRowEditMode(){return this.getEditMode()===Ht}_afterCancelEditData(e){const t=this._dataController;this.isRowBasedEditMode()&&e>=0?t.updateItems({changeType:"update",rowIndices:[e,e+1]}):super._afterCancelEditData(e)}_isDefaultButtonVisible(e,t){const n=this.isRowBasedEditMode(),o=!this.isPopupEditMode()&&t.row&&G(t.row.key,this.option(he));if(n)switch(e.name){case"edit":return!o&&this.allowUpdating(t);case"delete":return super._isDefaultButtonVisible(e,t)&&!o;case"save":case"cancel":return o;default:return super._isDefaultButtonVisible(e,t)}return super._isDefaultButtonVisible(e,t)}isEditRow(e){return this.isRowBasedEditMode()&&this.isEditRowByIndex(e)}_cancelSaving(e){this.isRowBasedEditMode()&&(this.hasChanges()||this._cancelEditDataCore()),super._cancelSaving(e)}_refreshCore(e){const{allowCancelEditing:t}=e??{};if(this.isRowBasedEditMode()){const n=this.getChanges().filter(i=>i.type==="update").length>0;this.init(),t&&n&&this._cancelEditDataCore()}super._refreshCore(e)}_isEditColumnVisible(){const e=super._isEditColumnVisible(),t=this.option("editing"),n=this.isRowEditMode(),i=t.allowUpdating||t.allowAdding;return e||n&&i}_focusEditorIfNeed(){const e=this.getEditMode();if(this._needFocusEditor){if(Zh.includes(e)){const t=this.getFocusedCellInRow(this._getVisibleEditRowIndex());this._delayedInputFocus(t,()=>{t&&this.component.focus(t)})}this._needFocusEditor=!1}}},Np=r=>class extends r{_getChangedColumnIndices(e,t,n,i){if(!(this._editingController.isRowBasedEditMode()&&e.isEditing!==t.isEditing))return super._getChangedColumnIndices.apply(this,arguments)}},Lp=r=>class extends r{_createRow(e){const t=super._createRow.apply(this,arguments);return e&&this._editingController.isEditRow(e.rowIndex)&&(t.addClass(Gs),t.removeClass(Ns),e.rowType==="detail"&&t.addClass(this.addWidgetPrefix(So))),t}_update(e){super._update(e),e.changeType==="updateSelection"&&this.getTableElements().children("tbody").children(`.${Gs}`).removeClass(Ns)}},Hp={extenders:{controllers:{editing:Mp,data:Np},views:{rowsView:Lp}}};T.registerModule("editingRowBased",Hp);const zp=r=>class extends r{init(){this._editForm=null,this._updateEditFormDeferred=null,super.init()}isEditRow(e){return!this.isPopupEditMode()&&super.isEditRow(e)}isFormOrPopupEditMode(){return this.isPopupEditMode()||this.isFormEditMode()}isFormEditMode(){return this.option("editing.mode")===Vo}getFirstEditableColumnIndex(){const e=this._firstFormItem;if(this.isFormEditMode()&&e){const t=this.option(he),n=this._dataController.getRowIndexByKey(t),i=this._rowsView.getCellElements(n);return this._rowsView._getEditFormEditorVisibleIndex(i,e.column)}return super.getFirstEditableColumnIndex()}getEditFormRowIndex(){return this.isFormOrPopupEditMode()?this._getVisibleEditRowIndex():super.getEditFormRowIndex()}_isEditColumnVisible(){const e=super._isEditColumnVisible(),t=this.option("editing");return this.isFormOrPopupEditMode()&&t.allowUpdating||e}_handleDataChanged(e){if(this.isPopupEditMode()){var t,n;const i=this.option("editing.editRowKey"),o=e==null||(t=e.items)===null||t===void 0?void 0:t.some(l=>G(l.key,i)),s=((n=e.changeTypes)===null||n===void 0?void 0:n.length)&&e.changeTypes.every(l=>l==="insert");(e.changeType==="refresh"||o&&e.isOptionChanged)&&!s&&this._repaintEditPopup()}super._handleDataChanged(e)}getPopupContent(){var e;const t=(e=this._editPopup)===null||e===void 0?void 0:e.option("visible");if(this.isPopupEditMode()&&t)return this._$popupContent}_showAddedRow(e){this.isPopupEditMode()?this._showEditPopup(e):super._showAddedRow(e)}_cancelEditDataCore(){super._cancelEditDataCore(),this.isPopupEditMode()&&this._hideEditPopup()}_updateEditRowCore(e,t,n){const i=this._editForm;if(this.isPopupEditMode())if(this.option("repaintChangesOnly")){var o;(o=e.update)===null||o===void 0||o.call(e,e),this._rowsView.renderDelayedTemplates()}else i&&(this._updateEditFormDeferred=new E().done(()=>i.repaint()),this._updateLockCount||this._updateEditFormDeferred.resolve());else super._updateEditRowCore(e,t,n)}_showEditPopup(e,t){const n=me.current().deviceType!=="desktop",i=this.addWidgetPrefix(bp),o=y({showTitle:!1,fullScreen:n,wrapperAttr:{class:i},toolbarItems:[{toolbar:"bottom",location:"after",widget:"dxButton",options:this._getSaveButtonConfig()},{toolbar:"bottom",location:"after",widget:"dxButton",options:this._getCancelButtonConfig()}],contentTemplate:this._getPopupEditFormTemplate(e)},this.option(bn));if(!this._editPopup){const s=g("<div>").appendTo(this.component.$element()).addClass(i);this._editPopup=this._createComponent(s,tn),this._editPopup.on("hiding",this._getEditPopupHiddenHandler()),this._editPopup.on("shown",l=>{if(x.trigger(l.component.$content().find(To).not(`.${Ep}`).first(),"focus"),t){var a;(a=this._editForm)===null||a===void 0||a.repaint()}})}this._editPopup.option(o),this._editPopup.show(),super._showEditPopup(e,t)}_getPopupEditFormTemplate(e){const t=this.component.getVisibleRows()[e],n={row:t,values:t.values,rowType:t.rowType,key:t.key,rowIndex:e};return this._rowsView._addWatchMethod(n,t),i=>{const o=this.getEditFormTemplate(),s=this._createComponent(g("<div>").appendTo(i),gt);this._$popupContent=g(s.content()),o(this._$popupContent,n,{isPopupForm:!0}),this._rowsView.renderDelayedTemplates(),g(i).parent().attr("aria-label",this.localize("dxDataGrid-ariaEditForm"))}}_repaintEditPopup(){const e=this._getVisibleEditRowIndex();if(e>=0){var t,n;const i=(t=this._editPopup)===null||t===void 0?void 0:t.option("animation");(n=this._editPopup)===null||n===void 0||n.option("animation",null),this._showEditPopup(e,!0),i!==void 0&&this._editPopup.option("animation",i)}}_hideEditPopup(){var e;(e=this._editPopup)===null||e===void 0||e.option("visible",!1)}optionChanged(e){if(e.name==="editing"&&this.isFormOrPopupEditMode()){const{fullName:t}=e;t.indexOf(yi)===0?(this._handleFormOptionChange(e),e.handled=!0):t.indexOf(bn)===0&&(this._handlePopupOptionChange(e),e.handled=!0)}super.optionChanged(e)}_handleFormOptionChange(e){var t;if(this.isFormEditMode()){const n=this._getVisibleEditRowIndex();n>=0&&this._dataController.updateItems({changeType:"update",rowIndices:[n]})}else(t=this._editPopup)!==null&&t!==void 0&&t.option("visible")&&e.fullName.indexOf(yi)===0&&this._repaintEditPopup()}_handlePopupOptionChange(e){const t=this._editPopup;if(t){const n=e.fullName.slice(bn.length+1);n?t.option(n,e.value):t.option(e.value)}}renderFormEditorTemplate(e,t,n,i,o){const s=this,l=g(i),{column:a}=t,d=Dp(t),u=e==null?void 0:e.row,c=u==null?void 0:u.data,h=n.component,p=a.calculateCellValue(c),m=v.getDisplayValue(a,p,c,u==null?void 0:u.rowType),{label:C,labelMark:w,labelMode:S}=n.editorOptions||{},V=y({},e,{data:c,cellElement:null,isOnForm:!0,item:t,id:h.getItemID(t.name||t.dataField),column:y({},a,{editorType:d,editorOptions:y({label:C,labelMark:w,labelMode:S},a.editorOptions,t.editorOptions)}),columnIndex:a.index,setValue:!o&&a.allowEditing&&function(P,k){s.updateFieldValue(V,P,k)}});V.value=p,V.displayValue=m,V.text=a.command?"":v.formatValue(m,a);const O=this._getFormEditItemTemplate.bind(this)(V,a);return this._rowsView.renderTemplate(l,O,V,!!Kn(l)).done(()=>{this._rowsView._updateCell(l,V)}),V}getFormEditorTemplate(e,t){const n=this.component.columnOption(t.name||t.dataField);return(i,o)=>{const s=g(o),{row:l}=e;if(l!=null&&l.watch){const a=l.watch(()=>n.selector(l.data),()=>{var d;let u=s.find(".dx-widget").first(),c=u.data("dxValidator");const h=(d=c)===null||d===void 0?void 0:d.option();s.contents().remove(),e=this.renderFormEditorTemplate.bind(this)(e,t,i,s),u=s.find(".dx-widget").first(),c=u.data("dxValidator"),h&&!c&&u.dxValidator({validationRules:h.validationRules,validationGroup:h.validationGroup,dataGetter:h.dataGetter})});x.on(s,xt,a)}e=this.renderFormEditorTemplate.bind(this)(e,t,i,s)}}getEditFormOptions(e){var t;const n=(t=this._getValidationGroupsInForm)===null||t===void 0?void 0:t.call(this,e),i=this.option("editing.form.customizeItem"),o=this.addWidgetPrefix(zl);let s=this.option("editing.form.items");const l={};if(s)Gl(s,a=>{const d=(a==null?void 0:a.name)||(a==null?void 0:a.dataField);d&&(l[d]=!!a.editorType)});else{const a=this._columnsController.getColumns();s=[],b(a,(d,u)=>{!u.isBand&&!u.type&&s.push({column:u,name:u.name,dataField:u.dataField})})}return y({},n,{items:s,formID:`dx-${new ot}`,customizeItem:a=>{let d;const u=a.name||a.dataField;if((a.column||u)&&(d=a.column||this._columnsController.columnOption(a.name?`name:${a.name}`:`dataField:${a.dataField}`)),d){if(a.label=a.label||{},a.label.text=a.label.text||d.caption,d.dataType==="boolean"&&a.label.visible===void 0){const h=this.option("editing.form.labelMode");(h==="floating"||h==="static")&&(a.label.visible=!0)}a.template=a.template||this.getFormEditorTemplate(e,a),a.column=d,a.isCustomEditorType=l[u],d.formItem&&y(a,d.formItem),a.isRequired===void 0&&d.validationRules&&(a.isRequired=d.validationRules.some(h=>h.type==="required"),a.validationRules=[]);const c=f(a.visible)?a.visible:!0;!this._firstFormItem&&c&&(this._firstFormItem=a)}i==null||i.call(this,a),a.cssClass=U(a.cssClass)?`${a.cssClass} ${o}`:o}})}getEditFormTemplate(){return(e,t,n)=>{const i=this.option(yi),o=this.getEditFormOptions(t),s=g("<div>").appendTo(e),l=n==null?void 0:n.isPopupForm;if(this._firstFormItem=void 0,l&&s.addClass(this.addWidgetPrefix(Ip)),this._editForm=this._createComponent(s,kr,y({},i,o)),!l){const a=g("<div>").addClass(this.addWidgetPrefix(Rp)).appendTo(e);this._createComponent(g("<div>").appendTo(a),Ut,this._getSaveButtonConfig()),this._createComponent(g("<div>").appendTo(a),Ut,this._getCancelButtonConfig())}this._editForm.on("contentReady",()=>{var a;this._rowsView.renderDelayedTemplates(),(a=this._editPopup)===null||a===void 0||a.repaint()})}}getEditForm(){return this._editForm}_endUpdateCore(){var e;(e=this._updateEditFormDeferred)===null||e===void 0||e.resolve()}_beforeEndSaving(e){if(super._beforeEndSaving(e),this.isPopupEditMode()){var t;(t=this._editPopup)===null||t===void 0||t.hide()}}_processDataItemCore(e,t,n,i,o){const{type:s}=t;this.isPopupEditMode()&&s===Ie&&(e.visible=!1),super._processDataItemCore(e,t,n,i,o)}_editRowFromOptionChangedCore(e,t){const n=this.isPopupEditMode();super._editRowFromOptionChangedCore(e,t,n),n&&this._showEditPopup(t)}},Wp=r=>class extends r{_updateEditItem(e){this._editingController.isFormEditMode()&&(e.rowType="detail")}_getChangedColumnIndices(e,t,n,i){if(!(i===!1&&t.isEditing&&this._editingController.isFormEditMode()))return super._getChangedColumnIndices.apply(this,arguments)}},$p=r=>class extends r{_renderCellContent(e,t){t.rowType==="data"&&this._editingController.isPopupEditMode()&&t.row.visible===!1||super._renderCellContent.apply(this,arguments)}getCellElements(e){const t=super.getCellElements(e),n=this._editingController,i=n.getEditForm();return n.getEditFormRowIndex()===e&&t&&i?i.$element().find(`.${this.addWidgetPrefix(zl)}, .${Sp}`):t}_getVisibleColumnIndex(e,t,n){if(this._editingController.getEditFormRowIndex()===t&&U(n)){const o=this._columnsController.columnOption(n);return this._getEditFormEditorVisibleIndex(e,o)}return super._getVisibleColumnIndex.apply(this,arguments)}_getEditFormEditorVisibleIndex(e,t){let n=-1;return b(e,(i,o)=>{const s=g(o).find(".dx-field-item-content").data("dx-form-item");if(s!=null&&s.column&&t&&s.column.index===t.index)return n=i,!1}),n}_isFormItem(e){const t=e.rowType==="detail"||e.rowType==="detailAdaptive",n=e.rowType==="data"&&this._editingController.isPopupEditMode();return(t||n)&&e.item}_updateCell(e,t){this._isFormItem(t)?this._formItemPrepared(t,e):super._updateCell(e,t)}_updateContent(){const e=this._editingController,t=e.getEditForm(),n=t==null?void 0:t.option("validationGroup");return super._updateContent.apply(this,arguments).done(()=>{const o=e.getEditForm();n&&o&&o!==t&&o.option("validationGroup",n)})}},Gp={extenders:{controllers:{editing:zp,data:Wp},views:{rowsView:$p}}};T.registerModule("editingFormBased",Gp);const Kp=r=>class extends r{init(){const e=!this._saveEditorHandler;if(super.init(),e){let t,n;this._pointerUpEditorHandler=()=>{var i;n=(i=this._columnsResizerController)===null||i===void 0?void 0:i.isResizing()},this._pointerDownEditorHandler=i=>t=g(i.target),this._saveEditorHandler=this.createAction(function(i){const{event:o}=i,s=g(o.target),l=o[Ll],{component:a}=this;if(Op(t)&&!t.is(s))return;function d(u){if(!u)return!1;const c=u.closest(`.${_p}`),h=a.$element();return c.length>0&&h.closest(c).length===0}if(this.isCellOrBatchEditMode()&&!this._editCellInProgress){const u=d(s)||d(l==null?void 0:l.$element()),c=l&&!l._disposed&&l!==this.component,h=!!s.closest(`.${this.addWidgetPrefix(Cp)}`).length,p=s.hasClass(this.addWidgetPrefix(fp)),m=this.isCellEditMode();!n&&!u&&!p&&!(h&&m&&this.isEditing())&&(Kn(s)||c)&&this._closeEditItem.bind(this)(s)}}),x.on(M.getDocument(),q.up,this._pointerUpEditorHandler),x.on(M.getDocument(),q.down,this._pointerDownEditorHandler),x.on(M.getDocument(),te,this._saveEditorHandler)}}isCellEditMode(){return this.option("editing.mode")===Yi}isBatchEditMode(){return this.option("editing.mode")===Mn}isCellOrBatchEditMode(){return this.isCellEditMode()||this.isBatchEditMode()}_needToCloseEditableCell(e){const t=this.component.$element();let n=this.isEditing();if((!t||!!e.closest(t).length)&&e.closest(`.${wp}`).length){const l=e.closest(`.${He}> td`),a=this._rowsView.getRowIndex(l.parent()),d=this._rowsView.getCellElements(a);if(d!=null&&d.length){var o;const u=d.index(l),h=(o=this._columnsController.getVisibleColumns()[u])===null||o===void 0?void 0:o.allowEditing,p=this.isEditCell(a,u);n=n&&!h&&!p}}return n||super._needToCloseEditableCell(e)}_closeEditItem(e){this._needToCloseEditableCell(e)&&this.closeEditCell()}_focusEditorIfNeed(){if(this._needFocusEditor&&this.isCellOrBatchEditMode()){var e;const t=this._getVisibleEditColumnIndex(),n=(e=this._rowsView)===null||e===void 0?void 0:e._getCellElement(this._getVisibleEditRowIndex(),t);this._refocusEditCell=!1,clearTimeout(this._inputFocusTimeoutID),n&&!n.find(":focus").length?this._focusEditingCell(()=>{this._editCellInProgress=!1},n,!0):this._editCellInProgress=!1,this._needFocusEditor=!1}else super._focusEditorIfNeed()}isEditing(){if(this.isCellOrBatchEditMode()){const e=f(this.option(he)),t=f(this.option(et));return e&&t}return super.isEditing()}_handleEditColumnNameChange(e){const t=this._getVisibleEditRowIndex(e.previousValue);if(this.isCellOrBatchEditMode()&&t!==-1&&f(e.value)&&e.value!==e.previousValue){const n=this._columnsController.getVisibleColumnIndex(e.value),i=this._columnsController.getVisibleColumnIndex(e.previousValue);this._editCellFromOptionChanged(n,i,t)}}_addRow(e){if(this.isCellEditMode()&&this.hasChanges()){const t=new E;return this.saveEditData().done(()=>{this.hasChanges()?t.reject("cancel"):this.addRow(e).done(t.resolve).fail(t.reject)}),t.promise()}return super._addRow(e)}editCell(e,t){return this._editCell({rowIndex:e,columnIndex:t})}_editCell(e){const t=new E;let n;return this.executeOperation(t,()=>{n=this._editCellCore(e),F(n).done(t.resolve).fail(t.reject)}),n!==void 0?n:t.promise()}_editCellCore(e){const t=this._dataController,n=f(e.oldColumnIndex)||f(e.oldRowIndex),{columnIndex:i,rowIndex:o,column:s,item:l}=this._getNormalizedEditCellOptions(e),a={data:l==null?void 0:l.data,cancel:!1,column:s};if(l.key===void 0){this._dataController.fireError("E1043");return}if(s&&(l.rowType==="data"||l.rowType==="detailAdaptive")&&!l.removed&&this.isCellOrBatchEditMode()){if(!n&&this.isEditCell(o,i))return!0;const d=o+t.getRowIndexOffset();return F(this._beforeEditCell(o,i,l)).done(u=>{u||this._prepareEditCell(a,l,i,d)||this._processCanceledEditingCell()})}return!1}_beforeEditCell(e,t,n){if(this.isCellEditMode()&&!n.isNewRow&&this.hasChanges()){const i=new E;return this.saveEditData().always(()=>{i.resolve(this.hasChanges())}),this.addDeferred(i),i}return!1}publicMethods(){return super.publicMethods().concat(["editCell","closeEditCell"])}_getNormalizedEditCellOptions(e){let{oldColumnIndex:t,oldRowIndex:n,columnIndex:i,rowIndex:o}=e;const s=this._columnsController,l=s.getVisibleColumns(),d=this._dataController.items()[o];let u;f(t)?u=l[t]:u=this._getEditColumn(),f(n)||(n=this._getVisibleEditRowIndex()),U(i)&&(i=s.columnOption(i,"index"),i=s.getVisibleIndex(i));const c=l[i];return{oldColumn:u,columnIndex:i,oldRowIndex:n,rowIndex:o,column:c,item:d}}_prepareEditCell(e,t,n,i){return t.isNewRow||(e.key=t.key),this._isEditingStart(e)?!1:(this._pageIndex=this._dataController.pageIndex(),this._setEditRowKey(t.key),this._setEditColumnNameByIndex(n),e.column.showEditorAlways||this._addInternalData({key:t.key,oldData:t.oldData??t.data}),!0)}closeEditCell(e,t){let n=F();const i=this._getVisibleEditRowIndex();if(this.isCellOrBatchEditMode()){const o=new E;n=new E,this.executeOperation(o,()=>{this._closeEditCellCore(e,i,t).always(n.resolve)})}return n.promise()}_closeEditCellCore(e,t,n){const i=this._dataController,o=new E,s=o.promise();if(this.isCellEditMode()&&this.hasChanges()){if(!n)return this.saveEditData().done(l=>{if(!this.hasChanges()){this.closeEditCell(!!l).always(o.resolve);return}o.resolve()}),s}else if(this._resetEditRowKey(),this._resetEditColumnName(),t>=0){const l=[t];this._beforeCloseEditCellInBatchMode(l),e||i.updateItems({changeType:"update",rowIndices:l})}return o.resolve(),s}_resetModifiedClassCells(e){if(this.isBatchEditMode()){const t=this._columnsController.getVisibleColumns().length;e.forEach(n=>{let{key:i}=n;const o=this._dataController.getRowIndexByKey(i);for(let s=0;s<t;s++){const l=this._rowsView._getCellElement(o,s);l==null||l.removeClass(jh)}})}}_prepareChange(e,t,n){const i=g(e.cellElement);return this.isBatchEditMode()&&e.key!==void 0&&this._applyModified(i,e),super._prepareChange(e,t,n)}_cancelSaving(e){const t=this._dataController;this.isCellOrBatchEditMode()&&(this.isBatchEditMode()&&this._resetEditIndices(),t.updateItems()),super._cancelSaving(e)}optionChanged(e){const{fullName:t}=e;e.name==="editing"&&t===et?(this._handleEditColumnNameChange(e),e.handled=!0):super.optionChanged(e)}_editCellFromOptionChanged(e,t,n){const i=this._columnsController.getVisibleColumns();e>-1&&pe(()=>{this._repaintEditCell(i[e],i[t],n)})}_handleEditRowKeyChange(e){if(this.isCellOrBatchEditMode()){const n=this._getVisibleEditColumnIndex(),i=this._getEditRowIndexCorrection(),o=this._dataController.getRowIndexByKey(e.previousValue)+i;if(f(e.value)&&e.value!==e.previousValue){var t;(t=this._editCellFromOptionChanged)===null||t===void 0||t.call(this,n,n,o)}}else super._handleEditRowKeyChange(e)}deleteRow(e){if(this.isCellEditMode()&&this.isEditing()){const{isNewRow:t}=this._dataController.items()[e],n=this._dataController.getKeyByRowIndex(e);this.closeEditCell(null,t).always(()=>{e=this._dataController.getRowIndexByKey(n),this._checkAndDeleteRow(e)})}else super.deleteRow(e)}_checkAndDeleteRow(e){this.isBatchEditMode()?this._deleteRowCore(e):super._checkAndDeleteRow(e)}_refreshCore(e){const{isPageChanged:t}=e??{},n=this.isBatchEditMode()||t&&this.option("scrolling.mode")!=="virtual";this.isCellOrBatchEditMode()?n&&(this._resetEditColumnName(),this._resetEditRowKey()):super._refreshCore(e)}_allowRowAdding(e){return this.isBatchEditMode()?!0:super._allowRowAdding(e)}_afterDeleteRow(e,t){const n=this._dataController;return this.isBatchEditMode()?(n.updateItems({changeType:"update",rowIndices:[t,e]}),new E().resolve()):super._afterDeleteRow(e,t)}_updateEditRow(e,t,n){this.isCellOrBatchEditMode()?this._updateRowImmediately(e,t,n):super._updateEditRow(e,t,n)}_isDefaultButtonVisible(e,t){if(this.isCellOrBatchEditMode()){const n=this.isBatchEditMode();switch(e.name){case"save":case"cancel":case"edit":return!1;case"delete":return super._isDefaultButtonVisible(e,t)&&(!n||!t.row.removed);case"undelete":return n&&this.allowDeleting(t)&&t.row.removed;default:return super._isDefaultButtonVisible(e,t)}}return super._isDefaultButtonVisible(e,t)}_isRowDeleteAllowed(){return super._isRowDeleteAllowed()||this.isBatchEditMode()}_beforeEndSaving(e){if(this.isCellEditMode()){var t;((t=e[0])===null||t===void 0?void 0:t.type)!=="update"&&super._beforeEndSaving(e)}else this.isBatchEditMode()&&this._resetModifiedClassCells(e),super._beforeEndSaving(e)}prepareEditButtons(e){const t=this.option("editing")??{},n=super.prepareEditButtons(e);return(t.allowUpdating||t.allowAdding||t.allowDeleting)&&this.isBatchEditMode()&&(n.push(this.prepareButtonItem(e,"save","saveEditData",21)),n.push(this.prepareButtonItem(e,"revert","cancelEditData",22))),n}_saveEditDataInner(){var e;const t=this._dataController.getVisibleRows()[this.getEditRowIndex()],n=this._getEditColumn(),i=n==null?void 0:n.showEditorAlways,o=this.isCellEditMode()&&!(t!=null&&t.isNewRow);let s;return o&&i&&(s=new E,this.addDeferred(s)),super._saveEditDataInner().always((e=s)===null||e===void 0?void 0:e.resolve)}_applyChange(e,t,n){const i=this.isCellEditMode()&&e.row&&!e.row.isNewRow,{showEditorAlways:o}=e.column,s=e.column.setCellValue!==e.column.defaultSetCellValue;if(o&&!n&&i&&this.hasEditData()&&!this.isEditCell(e.rowIndex,e.columnIndex)){this._focusEditingCell(),this._updateEditRow(e.row,!0,s);return}return super._applyChange(e,t,n)}_applyChangeCore(e,t){const{showEditorAlways:n}=e.column,i=this.isCellEditMode()&&e.row&&!e.row.isNewRow;if(n&&!t){if(i)return this._setEditRowKey(e.row.key,!0),this._setEditColumnNameByIndex(e.columnIndex,!0),this.saveEditData();if(this.isBatchEditMode())return t=this._needUpdateRow(e.column),super._applyChangeCore(e,t)}return super._applyChangeCore(e,t)}_processDataItemCore(e,t,n,i,o){const{data:s,type:l}=t;this.isBatchEditMode()&&l===Fe&&(e.data=Ze(e.data,s)),super._processDataItemCore(e,t,n,i,o)}_processRemoveCore(e,t,n){if(!(this.isBatchEditMode()&&!n))return super._processRemoveCore(e,t,n)}_processRemoveIfError(e,t){if(!this.isBatchEditMode())return super._processRemoveIfError(e,t)}_beforeFocusElementInRow(e){super._beforeFocusElementInRow(e);const t=e>=0?e:0,n=this.getFirstEditableColumnIndex();n>=0&&this.editCell(t,n)}},Up=r=>class extends r{_createTable(){const e=super._createTable.apply(this,arguments),t=this._editingController;return t.isCellOrBatchEditMode()&&this.option("editing.allowUpdating")&&x.on(e,H(Pr.name,"dxDataGridRowsView"),`td:not(.${Qn})`,this.createAction(()=>{t.isEditing()&&t.closeEditCell()})),e}_createRow(e){const t=super._createRow.apply(this,arguments);if(e){const n=this._editingController,i=!!e.removed;n.isBatchEditMode()&&i&&t.addClass(xp)}return t}},jp=r=>class extends r{isVisible(){const e=this._editingController.option("editing");return super.isVisible()||e&&(e.allowUpdating||e.allowDeleting)&&e.mode===Mn}},qp={extenders:{controllers:{editing:Kp},views:{rowsView:Up,headerPanel:jp}}};T.registerModule("editingCellBased",qp);const Us="__DX_INSERT_INDEX__",Ul="row",In="batch",mt="cell",jl=["popup","form"],de={valid:"valid",invalid:"invalid",pending:"pending"},kt=function(r){return f(r)&&r!=="cancel"},ql=function(r,e){return r!==void 0||r===void 0&&e&&!e.isNewRow};class Xp extends L.Controller{constructor(){super(...arguments),this._isValidationInProgress=!1,this._disableApplyValidationResults=!1}init(){this._editingController=this.getController("editing"),this._editorFactoryController=this.getController("editorFactory"),this._columnsController=this.getController("columns"),this.createAction("onRowValidating"),this._validationState||this.initValidationState()}initValidationState(){this._validationState=[],this._validationStateCache={}}_rowIsValidated(e){const t=this._getValidationData(e==null?void 0:e.key);return!!t&&!!t.validated}_getValidationData(e,t){const n=$e(e),i=Y(n);let o;return i?o=this._validationState.filter(s=>G(s.key,e))[0]:o=this._validationStateCache[n],!o&&t&&(o={key:e,isValid:!0},this._validationState.push(o),i||(this._validationStateCache[n]=o)),o}_getBrokenRules(e,t){let n;return t?n=t.brokenRules||t.brokenRule&&[t.brokenRule]:n=e.brokenRules||[],n}_rowValidating(e,t){const n=new E,i=this._editingController.getChangeByKey(e==null?void 0:e.key),o=this._getBrokenRules(e,t),s=t?t.isValid:e.isValid,l={brokenRules:o,isValid:s,key:i.key,newData:i.data,oldData:this._editingController._getOldData(i.key),promise:null,errorText:this.getHiddenValidatorsErrorText(o)};return this.executeAction("onRowValidating",l),F(Pt(l.promise)).always(()=>{e.isValid=l.isValid,e.errorText=l.errorText,n.resolve(l)}),n.promise()}getHiddenValidatorsErrorText(e){const t=[];return b(e,(n,i)=>{const{column:o}=i,s=o&&o.groupIndex!==void 0&&!o.showWhenGrouped,l=o&&o.visible;!i.validator.$element().parent().length&&(!l||s)&&t.push(i.message)}),t.join(", ")}validate(e){let t=!0;const n=this._editingController,i=new E,o=[],s=n.getEditMode();if(e=e||s===Ul,this._isValidationInProgress)return i.resolve(!1).promise();if(this._isValidationInProgress=!0,e){n.addDeferred(i);const l=n.getChanges();b(l,(a,d)=>{let{type:u,key:c}=d;if(u!=="remove"){const h=this._getValidationData(c,!0),p=this.validateGroup(h);o.push(p),p.done(m=>{h.validated=!0,t=t&&m.isValid})}})}else if(this._currentCellValidator){const l=this.validateGroup(this._currentCellValidator._findGroup());o.push(l),l.done(a=>{t=a.isValid})}return F(...o).done(()=>{this._isValidationInProgress=!1,i.resolve(t)}),i.promise()}validateGroup(e){var t;const n=new E,i=e&&bt.getGroupConfig(e);let o;return i!=null&&i.validators.length&&(this.resetRowValidationResults(e),o=bt.validateGroup(e)),F(((t=o)===null||t===void 0?void 0:t.complete)||o).done(s=>{F(this._rowValidating(e,s)).done(n.resolve)}),n.promise()}isRowDataModified(e){return!on(e.data)}updateValidationState(e){const t=this._editingController.getEditMode(),{key:n}=e,i=this._getValidationData(n,!0);if(jl.includes(t))i.isValid=!0;else{if(e.type==="insert"&&!this.isRowDataModified(e)){i.isValid=!0;return}if(this.setDisableApplyValidationResults(!0),bt.getGroupConfig(i)){const s=bt.validateGroup(i);F(s.complete||s).done(l=>{i.isValid=l.isValid,i.brokenRules=l.brokenRules})}else(!i.brokenRules||!i.brokenRules.length)&&(i.isValid=!0);this.setDisableApplyValidationResults(!1)}}setValidator(e){this._currentCellValidator=e}renderCellPendingIndicator(e){let t=e.find(".dx-pending-indicator");if(!t.length){const n=e;t=g("<div>").appendTo(n).addClass("dx-pending-indicator"),this._createComponent(t,Gi),e.addClass("dx-validation-pending")}}disposeCellPendingIndicator(e){const t=e.find(".dx-pending-indicator");if(t.length){const n=Gi.getInstance(t);n&&(n.dispose(),n.$element().remove()),e.removeClass("dx-validation-pending")}}validationStatusChanged(e){const{validator:t}=e,n=t.option("validationGroup"),{column:i}=t.option("dataGetter")();this.updateCellValidationResult({rowKey:n.key,columnIndex:i.index,validationResult:e})}validatorInitialized(e){e.component.on("validating",this.validationStatusChanged.bind(this)),e.component.on("validated",this.validationStatusChanged.bind(this))}validatorDisposing(e){const t=e.component,n=t.option("validationGroup"),{column:i}=t.option("dataGetter")(),o=this.getCellValidationResult({rowKey:n==null?void 0:n.key,columnIndex:i.index});kt(o)&&o.status===de.pending&&this.cancelCellValidationResult({change:n,columnIndex:i.index})}applyValidationResult(e,t){const{validator:n}=t,i=n.option("validationGroup"),{column:o}=n.option("dataGetter")();if(t.brokenRules&&t.brokenRules.forEach(s=>{s.columnIndex=o.index,s.column=o}),e){const s=this.getCellValidationResult({rowKey:i.key,columnIndex:o.index}),l=kt(s)&&s.disabledPendingId===t.id;if(this._disableApplyValidationResults||l)return;if(t.status===de.invalid){const d=e.find(":focus");Br(d)||(x.trigger(d,"focus"),x.trigger(d,q.down))}const a=!o.editCellTemplate&&this._editorFactoryController.getEditorInstance(e);t.status===de.pending?a?a.option("validationStatus",de.pending):this.renderCellPendingIndicator(e):a?a.option("validationStatus",de.valid):this.disposeCellPendingIndicator(e),e.toggleClass(this.addWidgetPrefix("invalid"),t.status===de.invalid)}}_syncInternalEditingData(e){var t;const n=this._editingController,i=n.getChangeByKey(e.key),o=n._getOldData(e.key),s=(t=e.row)===null||t===void 0?void 0:t.oldData;i&&s&&!o&&n._addInternalData({key:e.key,oldData:s})}createValidator(e,t){const n=this._editingController,{column:i}=e;let{showEditorAlways:o}=i;if(f(i.command)||!i.validationRules||!Array.isArray(i.validationRules)||!i.validationRules.length)return;let l=n.getIndexByKey(e.key,n.getChanges())>-1;if(!l){if(!o){var a;o=(((a=this._columnsController)===null||a===void 0?void 0:a.getVisibleColumns())||[]).some(p=>p.showEditorAlways)}const u=G(this.option("editing.editRowKey"),e.key),c=n.isCellOrBatchEditMode()&&n.allowUpdating({row:e.row});if(l=u||c&&o,c&&o){var d;n._addInternalData({key:e.key,oldData:((d=e.row)===null||d===void 0?void 0:d.oldData)??e.data})}}if(l){if(t&&!t.length){oe.log("E1050");return}this._syncInternalEditingData(e);const u=this._getValidationData(e.key,!0),c=()=>{const m=n.getChangeByKey(u==null?void 0:u.key),C=i.calculateCellValue((m==null?void 0:m.data)||{});return C!==void 0?C:e.value},h=t&&t.hasClass("dx-widget");t&&t.addClass(this.addWidgetPrefix("validator"));const p=new Fd(t||g("<div>"),{name:i.caption,validationRules:y(!0,[],i.validationRules),validationGroup:u,adapter:h?null:{getValue:c,applyValidationResults:m=>{this.applyValidationResult(t,m)}},dataGetter(){const m=u==null?void 0:u.key,C=n.getChangeByKey(m),w=n._getOldData(m);return{data:Ze(w,C==null?void 0:C.data),column:i}},onInitialized:this.validatorInitialized.bind(this),onDisposing:this.validatorDisposing.bind(this)});if(h){const m=p.option("adapter");if(m){const C=m.bypass,w=()=>e.row.isNewRow&&!this._isValidationInProgress&&!n.isCellModified(e);m.getValue=c,m.validationRequestsCallbacks=[],m.bypass=()=>C.call(m)||w()}}return p}}setDisableApplyValidationResults(e){this._disableApplyValidationResults=e}getDisableApplyValidationResults(){return this._disableApplyValidationResults}isCurrentValidatorProcessing(e){let{rowKey:t,columnIndex:n}=e;return this._currentCellValidator&&G(this._currentCellValidator.option("validationGroup").key,t)&&this._currentCellValidator.option("dataGetter")().column.index===n}validateCell(e){const t={rowKey:e.option("validationGroup").key,columnIndex:e.option("dataGetter")().column.index,validationResult:null};let n=this.getCellValidationResult(t);const i=kt(n),o=e.option("adapter");if(!i)n=e.validate();else{const l=o.getValue();G(l,n.value)||(n=e.validate())}const s=new E;return i&&n.status===de.pending&&(this.updateCellValidationResult(t),o.applyValidationResults(n)),F(n.complete||n).done(l=>{i&&o.applyValidationResults(l),s.resolve(l)}),s.promise()}updateCellValidationResult(e){let{rowKey:t,columnIndex:n,validationResult:i}=e;const o=this._getValidationData(t);if(!o)return;o.validationResults||(o.validationResults={});let s;if(i){if(s=y({},i),o.validationResults[n]=s,i.status===de.pending&&(this._editingController.getEditMode()===mt&&(s.deferred=new E,s.complete.always(()=>{s.deferred.resolve()}),this._editingController.addDeferred(s.deferred)),this._disableApplyValidationResults)){s.disabledPendingId=i.id;return}}else s=o.validationResults[n];s&&s.disabledPendingId&&delete s.disabledPendingId}getCellValidationResult(e){var t;let{rowKey:n,columnIndex:i}=e;const o=this._getValidationData(n,!0);return o==null||(t=o.validationResults)===null||t===void 0?void 0:t[i]}removeCellValidationResult(e){let{change:t,columnIndex:n}=e;const i=this._getValidationData(t==null?void 0:t.key);i&&i.validationResults&&(this.cancelCellValidationResult({change:t,columnIndex:n}),delete i.validationResults[n])}cancelCellValidationResult(e){let{change:t,columnIndex:n}=e;const i=this._getValidationData(t.key);if(t&&i.validationResults){const o=i.validationResults[n];o&&(o.deferred&&o.deferred.reject("cancel"),i.validationResults[n]="cancel")}}resetRowValidationResults(e){e&&(e.validationResults&&delete e.validationResults,delete e.validated)}isInvalidCell(e){let{rowKey:t,columnIndex:n}=e;const i=this.getCellValidationResult({rowKey:t,columnIndex:n});return kt(i)&&i.status===de.invalid}getCellValidator(e){let{rowKey:t,columnIndex:n}=e;const i=this._getValidationData(t),o=i&&bt.getGroupConfig(i),s=o&&o.validators;return s&&s.filter(l=>{const{column:a}=l.option("dataGetter")();return a?a.index===n:!1})[0]}setCellValidationStatus(e){const t=this.getCellValidationResult({rowKey:e.key,columnIndex:e.column.index});f(t)?e.validationStatus=t!=="cancel"?t.status:"cancel":delete e.validationStatus}}const Yp=r=>class extends r{processDataItemTreeListHack(e){super.processDataItem.apply(this,arguments)}processItemsTreeListHack(e,t){return super.processItems.apply(this,arguments)}_addChange(e){const t=super._addChange.apply(this,arguments);return t&&e.type!=="remove"&&this._validatingController.updateValidationState(t),t}_handleChangesChange(e){super._handleChangesChange.apply(this,arguments),e.value.forEach(t=>{this._validatingController._getValidationData(t.key)===void 0&&this._validatingController.updateValidationState(t)})}_updateRowAndPageIndices(){const e=this,t=e.getView("rowsView").getTopVisibleItemIndex();let n=t;b(e.getChanges(),(i,o)=>{let{key:s,type:l}=o;const a=this._validatingController._getValidationData(s);a&&!a.isValid&&a.pageIndex!==e._pageIndex&&(a.pageIndex=e._pageIndex,l==="insert"?a.rowIndex=t:a.rowIndex=n,n++)})}_getValidationGroupsInForm(e){return{validationGroup:this._validatingController._getValidationData(e.key,!0)}}_validateEditFormAfterUpdate(e,t){t&&this._editForm&&this._editForm.validate(),super._validateEditFormAfterUpdate.apply(this,arguments)}_prepareEditCell(e){const t=super._prepareEditCell.apply(this,arguments);return t&&e.column.showEditorAlways&&this._validatingController.updateValidationState({key:e.key}),t}processItems(e,t){const n=this.getChanges(),i=(s,l)=>{let a=-1;const d=s.type==="insert",{key:u}=s;return b(l,(c,h)=>{if(G(u,d?h.key:this._dataController.keyOf(h)))return a=c,!1}),a};e=super.processItems(e,t);const o=e.length;return this.getEditMode()===In&&t!=="prepend"&&t!=="append"&&n.forEach(s=>{const{key:l}=s,a=this._validatingController._getValidationData(l);a&&s.type&&a.pageIndex===this._pageIndex&&(s==null?void 0:s.pageIndex)!==this._pageIndex&&function(d,u){const c={key:d.key};if(i(d,e)>=0)return;u.rowIndex=u.rowIndex>o?u.rowIndex%o:u.rowIndex;const{rowIndex:p}=u;c[Us]=1,e.splice(p,0,c)}(s,a)}),e}processDataItem(e){const t=e.data[Us],n=t?e.data.key:e.key;if(this.getEditMode()===In&&t&&n){const o=this.getChanges(),s=v.getIndexByKey(n,o);if(s>=0){const l=o[s];if(l.type!=="insert"){const a=this._getOldData(l.key);e.data=y(!0,{},a,l.data),e.key=n}}}super.processDataItem.apply(this,arguments)}_createInvisibleColumnValidators(e){const t=this,n=this._columnsController.getColumns(),i=this._columnsController.getInvisibleColumns().filter(a=>!a.isBand),o=this._columnsController.getGroupColumns().filter(a=>!a.showWhenGrouped&&i.indexOf(a)===-1),s=[],l=(a,d)=>this._dataController.getRowIndexByKey(d)>=0&&i.indexOf(a)<0;return i.push(...o),jl.includes(this.getEditMode())||b(n,(a,d)=>{e.forEach(u=>{let c;if(!l(d,u.key)){if(u.type==="insert")c=u.data;else if(u.type==="update"){const h=t._getOldData(u.key);if(!f(h))return;c=Ze(h,u.data)}if(c){const h=this._validatingController.createValidator({column:d,key:u.key,value:d.calculateCellValue(c)});h&&s.push(h)}}})}),function(){s.forEach(a=>{a.dispose()})}}_beforeSaveEditData(e,t){let n=super._beforeSaveEditData.apply(this,arguments);const i=this._validatingController._getValidationData(e==null?void 0:e.key);if(e){const o=e.type==="remove"||i.isValid;n=n||!o}else{const o=this._createInvisibleColumnValidators(this.getChanges());n=new E,this.executeOperation(n,()=>{this._validatingController.validate(!0).done(s=>{switch(o(),this._updateRowAndPageIndices(),this.getEditMode()){case mt:s||this._focusEditingCell();break;case In:s||(this._resetEditRowKey(),this._resetEditColumnName(),this._dataController.updateItems())}n.resolve(!s)})})}return n.promise?n.promise():n}_beforeEditCell(e,t,n){const i=super._beforeEditCell(e,t,n);if(this.getEditMode()===mt){const o=this._rowsView._getCellElement(e,t),s=o&&o.data("dxValidator"),l=o&&o.closest(".dx-row").data("options"),a=s&&s.option("adapter").getValue();if(s&&ql(a,l)){const d=new E;return F(this._validatingController.validateCell(s),i).done((u,c)=>{d.resolve(u.status===de.valid&&c)}),d.promise()}if(!s)return i}return!1}_afterSaveEditData(e){let t;const n=this.getEditMode()===mt;if(b(this.getChanges(),(i,o)=>{const s=this._showErrorRow(o);t=t||s}),t){const i=this._rowsView.getScrollable();i&&(i.update(),i.scrollToElement(t))}if(e&&n&&this._needUpdateRow()){const i=this.getEditRowIndex();this._dataController.updateItems({changeType:"update",rowIndices:[i]}),this._focusEditingCell()}else if(!e){let i=!0;n&&(i=!(this._columnsController.getColumns().filter(l=>{var a;return l.showEditorAlways&&((a=l.validationRules)===null||a===void 0?void 0:a.length)>0}).length>0)),i&&this._validatingController.initValidationState()}}_handleDataChanged(e){const t=this._validatingController._validationState;this.option("scrolling.mode")==="standard"&&this.resetRowAndPageIndices(),e.changeType==="prepend"&&b(t,(n,i)=>{i.rowIndex+=e.items.length}),super._handleDataChanged(e)}resetRowAndPageIndices(){const e=this._validatingController._validationState;b(e,(t,n)=>{n.pageIndex!==this._pageIndex&&(delete n.pageIndex,delete n.rowIndex)})}_beforeCancelEditData(){this._validatingController.initValidationState(),super._beforeCancelEditData()}_showErrorRow(e){let t;const n=this._dataController.items(),i=this.getIndexByKey(e.key,n),o=this._validatingController._getValidationData(e.key);if(!(o!=null&&o.isValid)&&o!==null&&o!==void 0&&o.errorText&&i>=0)return t=this.getPopupContent(),this._errorHandlingController&&this._errorHandlingController.renderErrorRow(o==null?void 0:o.errorText,i,t)}updateFieldValue(e){const t=new E;return this._validatingController.removeCellValidationResult({change:this.getChangeByKey(e.key),columnIndex:e.column.index}),super.updateFieldValue.apply(this,arguments).done(()=>{const n=this._validatingController.getCellValidator({rowKey:e.key,columnIndex:e.column.index});F(n&&this._validatingController.validateCell(n)).done(i=>{this._editorFactoryController.refocus(),t.resolve(i)})}),t.promise()}highlightDataCell(e,t){super.highlightDataCell.apply(this,arguments),this._validatingController.setCellValidationStatus(t);const n=!!t.setValue,i=this.isCellModified(t),o=f(t.validationStatus);if(i&&t.column.setCellValue||n&&!i&&!(t.row.isNewRow||!o)){const l=e.data("dxValidator");l&&F(this._validatingController.validateCell(l)).done(()=>{this._validatingController.setCellValidationStatus(t)})}}getChangeByKey(e){const t=this.getChanges();return t[v.getIndexByKey(e,t)]}isCellModified(e){const t=super.isCellModified(e),n=this.getChangeByKey(e.key),i=!!e.row&&this._validatingController.isInvalidCell({rowKey:e.key,columnIndex:e.column.index});return t||this._validatingController._rowIsValidated(n)&&i}},Qp=function(r,e){const t=g(e).closest("tr").index(),n=g(r._rowsView.getRowElement(t)).first().children().filter(":not(.dx-hidden-cell)");return r._rowsView._getWidths(n).reduce((i,o)=>i+o,0)},Jp=function(r){let e,t;return r.some((n,i)=>{if(n.command==="transparent")return e=i===0?-1:i,t=i===r.length-1?-1:i+n.colspan-1,!0}),{startColumnIndex:e,endColumnIndex:t}},Zp=r=>class extends r{_showRevertButton(e){var t,n;let i=(t=this._revertTooltip)===null||t===void 0?void 0:t.$element();if(!e||!e.length){var o;(o=i)===null||o===void 0||o.remove(),this._revertTooltip=void 0;return}if(e.find(i).length){var s;(s=this._revertTooltip)===null||s===void 0||s.repaint();return}const l=this.getRevertButtonContainer(e),a=this.addWidgetPrefix("revert-tooltip");(n=i)===null||n===void 0||n.remove(),i=g("<div>").addClass(a).appendTo(e);const d={animation:null,visible:!0,width:"auto",height:"auto",shading:!1,container:l,propagateOutsideClick:!0,hideOnOutsideClick:!1,wrapperAttr:{class:a},contentTemplate:()=>{const u=g("<div>").addClass("dx-revert-button"),c={icon:"revert",hint:this.option("editing.texts.validationCancelChanges"),elementAttr:{id:"dxRevertButton","aria-label":_.format("dxDataGrid-ariaRevertButton")},onClick:()=>{this._editingController.cancelEditData()}};return new Ut(u,c).$element()},position:{my:"left top",at:"right top",offset:"1 0",collision:"flip",boundaryOffset:"0 0",boundary:this._rowsView.element(),of:e},onPositioned:this.overlayPositionedHandler.bind(this)};this._revertTooltip=new Mt(i,d)}_hideFixedGroupCell(e,t){var n,i;let o,s;const l=(n=this._rowsView)===null||n===void 0||(i=n.isFixedColumns)===null||i===void 0?void 0:i.call(n),a=this._editingController.isFormOrPopupEditMode();if(l&&!a){const d=e.closest(".dx-row").next().data("options");d&&d.rowType==="group"&&(o=g(this._rowsView.getRowElement(d.rowIndex)).last(),s=o.find(".dx-group-cell"),s.length&&s.get(0).style.visibility!=="hidden"&&(s.css("visibility","hidden"),t.onDisposing=function(){s.css("visibility","")}))}}_showValidationMessage(e,t,n){const i=e.find(".dx-dropdowneditor-overlay").data("dxPopup"),o=i&&i.option("visible"),s=o?"top right":`top ${n}`,l=o?"top left":`bottom ${n}`,a=this.getValidationMessageContainer(e);let d="";t&&t.forEach(p=>{d+=(d.length?"<br/>":"")+Od(p)});const u=this.addWidgetPrefix("invalid-message");this._rowsView.element().find(`.${u}`).remove();const c=g("<div>").addClass("dx-invalid-message").addClass("dx-invalid-message-always").addClass(u).html(d).appendTo(e),h={container:a,shading:!1,width:"auto",height:"auto",visible:!0,animation:!1,propagateOutsideClick:!0,hideOnOutsideClick:!1,wrapperAttr:{id:"dxInvalidMessage",class:`dx-invalid-message dx-invalid-message-always ${u}`},position:{collision:"flip",boundary:this._rowsView.element(),boundaryOffset:"0 0",offset:{x:0,y:!o&&ee.mozilla?-1:0},my:s,at:l,of:e},onPositioned:p=>{this.overlayPositionedHandler(p,o),this._shiftValidationMessageIfNeed(p.component.$content(),e)}};this._hideFixedGroupCell(e,h),new Mt(c,h)}getValidationMessages(){var e;return(e=this._rowsView.element())===null||e===void 0?void 0:e.find(this._getValidationMessagesSelector())}getRevertButton(){var e;return g((e=this._revertTooltip)===null||e===void 0?void 0:e.element())}_hideValidationMessage(){var e;const t=(e=this._rowsView.element())===null||e===void 0?void 0:e.find(this._getValidationMessagesSelector());t==null||t.remove()}_normalizeValidationMessagePositionAndMaxWidth(e,t,n){const i=this._columnsController.getFixedColumns();if(!i||!i.length)return;let o;const s=!t&&Qp(this,e.element),l=e.component.$content(),a=ye(l,!0),d=!t&&a>s,u=this._rowsView.getCellIndex(g(e.element).closest("td")),c=Jp(i);return!t&&(u===c.startColumnIndex||d)?o={collision:"none flip",my:"top left",at:n?"top right":"bottom left"}:u===c.endColumnIndex&&(o={collision:"none flip",my:"top right",at:t||n?"top left":"bottom right"},t&&(o.offset="-1 0")),o&&{position:o,maxWidth:d?s-2:void 0}}_shiftValidationMessageIfNeed(e,t){const n=this._revertTooltip&&this._revertTooltip.$content();if(!n)return;const i=e.offset(),o=n.offset();if(i.top===o.top&&i.left+K(e)>o.left){const s=K(n)+2;e.css("left",o.left<t.offset().left?-s:s)}}getOverlayBaseZIndex(){return Mt.baseZIndex()}overlayPositionedHandler(e,t){if(!e.component.__skipPositionProcessing){const n=g(e.element).hasClass(this.addWidgetPrefix("revert-tooltip")),i=!n&&this._rowsView.updateFreeSpaceRowHeight(),o=this._normalizeValidationMessagePositionAndMaxWidth(e,n,t);e.component.__skipPositionProcessing=!!(i||o),o?e.component.option(o):i&&e.component.repaint()}}_getRevertTooltipsSelector(){return`.dx-editor-cell .${this.addWidgetPrefix("revert-tooltip")}`}_getValidationMessagesSelector(){const e=this.addWidgetPrefix("invalid-message");return`.dx-editor-cell .${e}, .dx-cell-modified .${e}`}loseFocus(e){e||this._validatingController.setValidator(null),super.loseFocus()}updateCellState(e,t,n){var i;const o=e==null?void 0:e.closest(this._getFocusCellSelector()),s=o!=null&&o.is("td")?o:null,l=o==null?void 0:o.closest(".dx-row").data("options"),a=l?this._editingController.getChangeByKey(l.key):null,d=s&&this._columnsController.getVisibleColumns()[s.index()],u=(a==null||(i=a.data)===null||i===void 0?void 0:i[d==null?void 0:d.name])!==void 0&&!this._editingController.isSaving(),c=[];if(this._editingController.getEditMode()===mt&&((t==null?void 0:t.status)===de.invalid||u?(this._showRevertButton(o),c.push("dxRevertButton")):this._revertTooltip&&this._revertTooltip.$element().remove()),t&&t.status===de.invalid&&s&&d&&t&&t.brokenRules){const p=[];t.brokenRules.forEach(m=>{m.message&&p.push(m.message)}),p.length&&(this._showValidationMessage(o,p,d.alignment||"left"),c.push("dxInvalidMessage"))}this._updateAriaValidationAttributes(o,c),!n&&this._rowsView.element()&&this._rowsView.updateFreeSpaceRowHeight()}_updateAriaValidationAttributes(e,t){if(t.length===0)return;const n=this._editingController.getEditMode();if([mt,In,Ul].includes(n)){const o=this._getCurrentFocusElement(e);o.attr("aria-labelledby",t.join(" ")),o.attr("aria-invalid",!0)}}_getCurrentFocusElement(e){return this._editingController.isEditing()?e.find(Ro).first():e}focus(e,t){if(!arguments.length)return super.focus();if(this._hideValidationMessage(),e!=null&&e.hasClass("dx-row")||e!=null&&e.hasClass("dx-master-detail-cell"))return super.focus(e,t);const n=e==null?void 0:e.closest(this._getFocusCellSelector()),i=n&&(n.data("dxValidator")||e.find(`.${this.addWidgetPrefix("validator")}`).eq(0).data("dxValidator")),o=n&&n.closest(".dx-row").data("options"),s=o?this._editingController.getChangeByKey(o.key):null;let l;if(i){this._validatingController.setValidator(i);const a=i.option("adapter").getValue();if(ql(a,o)||this._validatingController._rowIsValidated(s))return this._editingController.waitForDeferredOperations().done(()=>{this._rowsView.isElementInside(e)&&F(this._validatingController.validateCell(i)).done(u=>{l=u;const{column:c}=l.validator.option("dataGetter")();s&&c&&!this._validatingController.isCurrentValidatorProcessing({rowKey:s.key,columnIndex:c.index})||(!Xt(jt())&&l.status===de.invalid&&(t=!0),this.updateCellState(e,l,t),super.focus.call(this,e,t))})}),super.focus(e,t)}return this.updateCellState(e,l,t),super.focus(e,t)}getEditorInstance(e){const t=e.find(".dx-texteditor").eq(0);return v.getWidgetInstance(t)}getValidationMessageContainer(e){return e.closest(`.${this.addWidgetPrefix("content")}`)}getRevertButtonContainer(e){return e.closest(`.${this.addWidgetPrefix("content")}`).parent()}hasOverlayElements(){const e=this.getValidationMessages(),t=this.getRevertButton();return super.hasOverlayElements()||!!(e!=null&&e.length)||!!(t!=null&&t.length)}},eg=r=>class extends r{_getValidationStatus(e){return(kt(e)?e.status:e)||de.valid}_isCellChanged(e,t,n,i,o){var s,l;const a=(s=e.cells)===null||s===void 0?void 0:s[i],d=this._getValidationStatus({status:a==null?void 0:a.validationStatus}),u=this._validatingController.getCellValidationResult({rowKey:e.key,columnIndex:i}),c=this._validatingController._getValidationData(e.key),h=this._getValidationStatus(u),p=JSON.stringify(t.modifiedValues)!==JSON.stringify(e.modifiedValues),m=d!==h&&p,C=g(a==null?void 0:a.cellElement).hasClass(this.addWidgetPrefix("invalid")),w=a==null||(l=a.column.validationRules)===null||l===void 0?void 0:l.length,S=e.isEditing!==t.isEditing&&w,V=m||c.isValid&&C;return S||V?!0:super._isCellChanged.apply(this,arguments)}},tg=r=>class extends r{updateFreeSpaceRowHeight(e){const t=this;let n,i,o;const s=t.element(),l=s&&s.find(`.${t.addWidgetPrefix("invalid-message")} .dx-overlay-content`);if(super.updateFreeSpaceRowHeight(e),l&&l.length&&(n=t._getRowElements(),o=t._getFreeSpaceRowElements(e),i=o.first(),i&&n.length===1&&(!i.is(":visible")||se(l)>se(i))))return o.show(),tt(o,se(l)),!0}_formItemPrepared(e,t){super._formItemPrepared.apply(this,arguments),_e(()=>{const n=t.find(".dx-widget").first();n.length&&!n.children().length||this._validatingController.createValidator(e,n)})}_cellPrepared(e,t){this._editingController.isFormOrPopupEditMode()||this._validatingController.createValidator(t,e),super._cellPrepared.apply(this,arguments)}_restoreErrorRow(e){this._editingController&&this._editingController.hasChanges()&&this._getRowElements(e).each((t,n)=>{const i=g(n).data("options");if(i){const o=this._editingController.getChangeByKey(i.key);o&&this._editingController._showErrorRow(o)}})}},ng={defaultOptions:()=>({editing:{texts:{validationCancelChanges:_.format("dxDataGrid-validationCancelChanges")}}}),controllers:{validating:Xp},extenders:{controllers:{editing:Yp,editorFactory:Zp,data:eg},views:{rowsView:tg}}};T.registerModule("validating",ng);const Xl="dx-freespace-row",ig="dx-row-inserted",D="scrolling.legacyMode",og=["beginPageIndex","endPageIndex","pageIndex"],ae=function(r){return r.option("scrolling.mode")==="virtual"},Re=function(r){return r.option("scrolling.mode")==="infinite"},we=function(r){return ae(r)||Re(r)},js=function(r,e,t,n){for(let i=0;i<e+1;i++){const o=r[t?r.length-1-i:i];o&&!n(o,i===e,t)&&e++}return e},En=function(r,e){return r.rowType==="data"&&!r.isNewRow||r.rowType==="group"&&e.isGroupItemCountable(r.data)},sg=function(r){return r.forEach((e,t)=>{e.rowIndex=t}),r},Ei=function(r){const e=r._virtualScrollController.beginPageIndex(-1);ae(r)&&(e<0||r.viewportSize()>=0&&r.getViewportItemIndex()>=0&&(e*r.pageSize()>r.getViewportItemIndex()||e*r.pageSize()+r.itemsCount()<r.getViewportItemIndex()+r.viewportSize())&&r._dataSource.isLoading()?r._isLoading||(r._isLoading=!0,r.loadingChanged.fire(!0)):r._isLoading&&(r._isLoading=!1,r.loadingChanged.fire(!1)))},le=function(r,e,t){if(r.option(D)===!1&&og.includes(e)){const i=r._dataSource;return i.pageIndex.apply(i,t)}const n=r._virtualScrollController;return n[e].apply(n,t)},qs=function(r,e){const t=r.toArray().map(i=>g(i).parent(`.${e}`).get(0)).filter(i=>i);t.length&&(r=g(t));const n=e===Xl?r.length-1:r.length;for(let i=0;i<n;i++)r.eq(i).remove()},rg=r=>class extends r{init(){super.init.apply(this,arguments),this._items=[],this._totalCount=-1,this._isLoaded=!0,this._loadPageCount=1,this._virtualScrollController=new Gr(this.component,this._getVirtualScrollDataOptions())}dispose(){this._virtualScrollController.dispose(),super.dispose.apply(this,arguments)}_getVirtualScrollDataOptions(){const e=this;return{pageSize:()=>e.pageSize(),totalItemsCount:()=>e.totalItemsCount(),hasKnownLastPage:()=>e.hasKnownLastPage(),pageIndex:t=>e._dataSource.pageIndex(t),isLoading:()=>e._dataSource.isLoading()&&!e.isCustomLoading(),pageCount:()=>e.pageCount(),load:()=>e._dataSource.load(),updateLoading(){Ei(e)},itemsCount:()=>e.itemsCount(!0),items:()=>e._dataSource.items(),viewportItems(t){return t&&(e._items=t),e._items},onChanged(t){e.changed.fire(t)},changingDuration(){return e.isLoading()?300:e._renderTime||0}}}_handleLoadingChanged(e){if(this.option(D)===!1){super._handleLoadingChanged.apply(this,arguments);return}(!ae(this)||this._isLoadingAll)&&(this._isLoading=e,super._handleLoadingChanged.apply(this,arguments)),e?this._startLoadTime=new Date:this._startLoadTime=void 0}_handleLoadError(){this.option(D)!==!1&&(this._isLoading=!1,this.loadingChanged.fire(!1)),super._handleLoadError.apply(this,arguments)}_handleDataChanged(e){if(this.option(D)===!1){this._items=this._dataSource.items().slice(),this._totalCount=this._dataSourceTotalCount(!0),super._handleDataChanged.apply(this,arguments);return}const t=super._handleDataChanged.bind(this);this._virtualScrollController.handleDataChanged(t,e)}_customizeRemoteOperations(e,t){const n=this.option(D)===!1;let i=this.option("scrolling.renderAsync");f(i)||(i=this._renderTime>=this.option("scrolling.renderingThreshold")),(ae(this)||Re(this)&&n)&&!t.reload&&(t.skip||n)&&!i&&(e.delay=void 0),super._customizeRemoteOperations.apply(this,arguments)}items(){return this._items}_dataSourceTotalCount(e){return this.option(D)===!1&&ae(this)&&!e?this._totalCount:super._dataSourceTotalCount()}itemsCount(e){return e||this.option(D)===!1?super.itemsCount():this._virtualScrollController.itemsCount()}load(e){return this.option(D)===!1||e?super.load(e):this._virtualScrollController.load()}isLoading(){return this.option(D)===!1?this._dataSource.isLoading():this._isLoading}isLoaded(){return this._dataSource.isLoaded()&&this._isLoaded}resetPagesCache(e){e||this._virtualScrollController.reset(!0),super.resetPagesCache.apply(this,arguments)}_changeRowExpandCore(){const e=super._changeRowExpandCore.apply(this,arguments);return this.option(D)===!1||(this.resetPagesCache(),Ei(this)),e}reload(){this._dataSource.pageIndex(this.pageIndex());const e=this._virtualScrollController;if(this.option(D)!==!1&&e){const t=new E;return super.reload.apply(this,arguments).done(n=>{const i=e.getDelayDeferred();i?i.done(t.resolve).fail(t.reject):t.resolve(n)}).fail(t.reject),t}return super.reload.apply(this,arguments)}refresh(e,t){if(this.option(D)!==!1){const{storeLoadOptions:n}=e,i=this._dataSource;t.reload?(this._virtualScrollController.reset(),i.items().length=0,this._isLoaded=!1,Ei(this),this._isLoaded=!0,Re(this)?(this.pageIndex(0),i.pageIndex(0),n.pageIndex=0,e.pageIndex=0,n.skip=0):(i.pageIndex(this.pageIndex()),i.paginate()&&(e.pageIndex=this.pageIndex(),n.skip=this.pageIndex()*this.pageSize()))):Re(this)&&n.skip&&this._totalCountCorrection<0&&(n.skip+=this._totalCountCorrection)}return super.refresh.apply(this,arguments)}loadPageCount(e){if(!f(e))return this._loadPageCount;this._loadPageCount=e}_handleDataLoading(e){const t=this.loadPageCount(),n=this.pageSize(),i=this.option(D)===!1,{storeLoadOptions:o}=e,s=f(o.take);e.loadPageCount=t,!e.isCustomLoading&&i&&s&&t>1&&n>0&&(o.take=t*n),super._handleDataLoading.apply(this,arguments)}_loadPageSize(){return super._loadPageSize.apply(this,arguments)*this.loadPageCount()}beginPageIndex(){return le(this,"beginPageIndex",[...arguments])}endPageIndex(){return le(this,"endPageIndex",[...arguments])}pageIndex(e){return le(this,"pageIndex",[...arguments])}virtualItemsCount(){return le(this,"virtualItemsCount",[...arguments])}getContentOffset(){return le(this,"getContentOffset",[...arguments])}getVirtualContentSize(){return le(this,"getVirtualContentSize",[...arguments])}setContentItemSizes(){return le(this,"setContentItemSizes",[...arguments])}setViewportPosition(){return le(this,"setViewportPosition",[...arguments])}getViewportItemIndex(){return le(this,"getViewportItemIndex",[...arguments])}setViewportItemIndex(e){return le(this,"setViewportItemIndex",[...arguments])}getItemIndexByPosition(){return le(this,"getItemIndexByPosition",[...arguments])}viewportSize(){return le(this,"viewportSize",[...arguments])}viewportItemSize(){return le(this,"viewportItemSize",[...arguments])}getItemSize(){return le(this,"getItemSize",[...arguments])}getItemSizes(){return le(this,"getItemSizes",[...arguments])}loadIfNeed(){return le(this,"loadIfNeed",[...arguments])}},lg=r=>class extends r{dispose(){const e=this._rowsScrollController;e&&e.dispose(),super.dispose.apply(this,arguments)}_refreshDataSource(){const e=super._refreshDataSource.apply(this,arguments)||new E().resolve().promise();return e.done(this.initVirtualRows.bind(this)),e}_loadDataSource(){if(this._rowsScrollController&&we(this)){var e;const{loadPageCount:t}=f(this._loadViewportParams)?this.getLoadPageParams():{loadPageCount:0};t>=1&&((e=this._dataSource)===null||e===void 0||e.loadPageCount(t))}return super._loadDataSource.apply(this,arguments)}getRowPageSize(){const e=this.option("scrolling.rowPageSize"),t=this.pageSize();return t&&t<e?t:e}reload(){const e=this._rowsScrollController||this._dataSource,t=e&&e.getItemIndexByPosition(),n=super.reload.apply(this,arguments);return n&&n.done(()=>{if(ae(this)||v.isVirtualRowRendering(this)){const o=this.getRowIndexOffset(),s=Math.floor(t)-o,{component:l}=this,a=l.getScrollable&&l.getScrollable(),d=this.dataSource().operationTypes().sorting;if(a&&!d&&s>=0){var i;const u=l.getRowElement(s),c=u&&u[0]&&g(u[0]);let h=c&&((i=c.position())===null||i===void 0?void 0:i.top);const p=ee.chrome&&Number(ee.version??0)>=91,m=ee.mozilla||p?1:0;h&&h>m&&(h=Math.round(h+se(c)*(t%1)),a.scrollTo({y:h}))}}})}initVirtualRows(){const e=v.isVirtualRowRendering(this);if(this._allItems=null,this._loadViewportParams=null,this.option("scrolling.mode")!=="virtual"&&!e||!e||this.option(D)!==!1&&!this.option("scrolling.rowPageSize")){this._visibleItems=null,this._rowsScrollController=null;return}const t=!ae(this)&&this.pageIndex()>=this.pageCount()?this.pageCount()-1:this.pageIndex();this._rowPageIndex=Math.ceil(t*this.pageSize()/this.getRowPageSize()),this._visibleItems=this.option(D)===!1?null:[],this._viewportChanging=!1,this._needUpdateViewportAfterLoading=!1,this._rowsScrollController||(this._rowsScrollController=new Gr(this.component,this._getRowsScrollDataOptions(),!0),this._rowsScrollController.positionChanged.add(()=>{var n;if(this.option(D)===!1){this._viewportChanging=!0,this.loadViewport(),this._viewportChanging=!1;return}(n=this._dataSource)===null||n===void 0||n.setViewportItemIndex(this._rowsScrollController.getViewportItemIndex())})),this.option(D)===!1&&this._updateLoadViewportParams(),this.isLoaded()&&this.option(D)!==!1&&this._rowsScrollController.load()}isViewportChanging(){return this._viewportChanging}_getRowsScrollDataOptions(){const e=this,t=function(n){return En(n,e._dataSource)};return{pageSize:()=>e.getRowPageSize(),loadedOffset(){var n;return ae(e)&&((n=e._dataSource)===null||n===void 0?void 0:n.lastLoadOptions().skip)||0},loadedItemCount:()=>e._itemCount,totalItemsCount(){return we(e)?e.totalItemsCount():e.option(D)===!1?e._itemCount:e._items.filter(t).length},hasKnownLastPage:()=>e.option(D)===!1?e.hasKnownLastPage():!0,pageIndex(n){return n!==void 0&&(e._rowPageIndex=n),e._rowPageIndex},isLoading:()=>e.isLoading(),pageCount(){return Math.ceil(this.totalItemsCount()/this.pageSize())||1},load(){e._rowsScrollController.pageIndex()>=this.pageCount()&&(e._rowPageIndex=this.pageCount()-1,e._rowsScrollController.pageIndex(e._rowPageIndex)),!(!this.items().length&&this.totalItemsCount())&&e._rowsScrollController.handleDataChanged(n=>{n=n||{},n.changeType=n.changeType||"refresh",n.items=n.items||e._visibleItems,e._visibleItems.forEach((i,o)=>{i.rowIndex=o}),e._fireChanged(n)})},updateLoading(){},itemsCount(){return this.items(!0).length},correctCount:(n,i,o)=>js(n,i,o,(s,l,a)=>s.isNewRow?l&&!a:l&&a?!s.isNewRow:t(s)),items(n){let i=e._items;if(e.option(D)){const o=e.dataSource(),s=o==null?void 0:o.virtualItemsCount(),l=s?s.begin:0,a=e.getRowPageSize();let d=e._rowPageIndex*a-l,u=a;if(d<0)return[];d&&(d=this.correctCount(i,d),i=i.slice(d)),u&&(u=this.correctCount(i,u),i=i.slice(0,u))}return n?i.filter(t):i},viewportItems(n){return n&&e.option(D)!==!1&&(e._visibleItems=n),e._visibleItems},onChanged(){},changingDuration(){const n=e.dataSource();return n!=null&&n.isLoading()&&e.option(D)!==!1?300:(n==null?void 0:n._renderTime)||0}}}_updateItemsCore(e){const t=this.getRowIndexDelta();if(super._updateItemsCore.apply(this,arguments),this.option(D)===!1&&v.isVirtualRowRendering(this)){e.changeType==="update"&&e.rowIndices.length===0&&e.cancelEmptyChanges&&(e.cancel=!0);return}const n=this._rowsScrollController;if(n){const i=this._visibleItems,o=e.changeType==="refresh"||e.isLiveUpdate;if(e.changeType==="append"&&e.items&&!e.items.length)return;o||e.changeType==="append"||e.changeType==="prepend"?(e.cancel=!0,o&&n.reset(!0),n.load()):(e.changeType==="update"?e.rowIndices.forEach((s,l)=>{const a=e.changeTypes[l],d=e.items[l];a==="update"?i[s]=d:a==="insert"?i.splice(s,0,d):a==="remove"&&i.splice(s,1)}):(i.forEach((s,l)=>{i[l]=this._items[l+t]||i[l]}),e.items=i),sg(i))}}_updateLoadViewportParams(){const e=this._rowsScrollController.getViewportParams(),t=this.pageSize();if(e&&!we(this)&&t>0){const n=this.pageIndex()*t;e.skip+=n}this._loadViewportParams=e}_processItems(){const e=super._processItems.apply(this,arguments);if(this.option(D)===!1){const t=this._dataSource;let n=(t==null?void 0:t.lastLoadOptions().skip)??0,i,o,s,l=!1,a=[];e.forEach(d=>{const{rowType:u}=d,c=En(d,t),h=u==="group"&&(i||c||o!=="group"&&n>0),p=u==="data"&&c&&(i||o!=="group");!d.isNewRow&&f(i)&&(h||p)&&!(s&&!l)&&n++,(h||p)&&(l=!0),d.isNewRow?a.push(d):(a.forEach(m=>{m.loadIndex=n}),a=[]),d.loadIndex=n,i=c,o=u,s=d.isNewRow}),a.forEach(d=>{d.loadIndex=n})}return e}_afterProcessItems(e){if(this._itemCount=e.filter(t=>En(t,this._dataSource)).length,f(this._loadViewportParams)){this._updateLoadViewportParams();let t=e;if(this._allItems=e,e.length){const{skipForCurrentPage:n}=this.getLoadPageParams(!0),i=e[0].loadIndex+n,{take:o}=this._loadViewportParams;t=e.filter(s=>{const l=s.isNewRow&&s.loadIndex===i&&o===0,a=s.loadIndex>=i,d=s.loadIndex<i+o||l;return a&&d})}return t}return super._afterProcessItems.apply(this,arguments)}_applyChange(e){const t=this,{items:n}=e,{changeType:i}=e;let{removeCount:o}=e;if(o){const s=i==="prepend";o=js(t._items,o,s,(l,a)=>l.rowType==="data"&&!l.isNewRow||l.rowType==="group"&&(t._dataSource.isGroupItemCountable(l.data)||a)),e.removeCount=o}switch(i){case"prepend":t._items.unshift.apply(t._items,n),o&&t._items.splice(-o);break;case"append":t._items.push.apply(t._items,n),o&&t._items.splice(0,o);break;default:super._applyChange(e)}}items(e){return e?this._allItems||this._items:this._visibleItems||this._items}getRowIndexDelta(){let e=0;if(this.option(D)){const t=this._visibleItems;t&&t[0]&&(e=this._items.indexOf(t[0]))}return e<0?0:e}getRowIndexOffset(e,t){let n=0;const i=this.dataSource(),o=this._rowsScrollController,s=this.option(D)===!1,l=we(this);if(o&&!e)if(s&&f(this._loadViewportParams)){const{skipForCurrentPage:d,pageIndex:u}=this.getLoadPageParams(!0),c=this.items(!0);if(n=l?u*this.pageSize():0,c.length){const h=c[0].loadIndex;n+=c.filter(p=>p.loadIndex<h+d).length}}else n=o.beginPageIndex()*o.pageSize();else if(l&&s&&i){var a;const d=i.lastLoadOptions();t&&(a=d.skips)!==null&&a!==void 0&&a.length?n=d.skips.reduce((u,c)=>u+c,0):n=d.skip??0}else ae(this)&&i&&(n=i.beginPageIndex()*i.pageSize());return n}getDataIndex(){return this.option(D)===!1?this.getRowIndexOffset(!0,!0):super.getDataIndex.apply(this,arguments)}viewportSize(){const e=this._rowsScrollController,t=this._dataSource,n=e==null?void 0:e.viewportSize.apply(e,arguments);return this.option(D)===!1?n:t==null?void 0:t.viewportSize.apply(t,arguments)}viewportHeight(e,t){var n;(n=this._rowsScrollController)===null||n===void 0||n.viewportHeight(e,t)}viewportItemSize(){const e=this._rowsScrollController,t=this._dataSource,n=e==null?void 0:e.viewportItemSize.apply(e,arguments);return this.option(D)===!1?n:t==null?void 0:t.viewportItemSize.apply(t,arguments)}setViewportPosition(){const e=this._rowsScrollController,t=this._dataSource;this._isPaging=!1,e?e.setViewportPosition.apply(e,arguments):t==null||t.setViewportPosition.apply(t,arguments)}setContentItemSizes(e){const t=this._rowsScrollController,n=this._dataSource,i=t==null?void 0:t.setContentItemSizes(e);return this.option(D)===!1?i:n==null?void 0:n.setContentItemSizes(e)}getPreloadedRowCount(){const e=this.option("scrolling.preloadedRowCount"),t=this.option("scrolling.preloadEnabled");if(f(e))return e;const n=this.viewportSize();return t?2*n:n}getLoadPageParams(e){var t,n;const i=this.pageSize(),o=this._loadViewportParams,s=(t=this._dataSource)===null||t===void 0?void 0:t.lastLoadOptions(),l=(s==null?void 0:s.pageIndex)||0,a=(s==null?void 0:s.take)||0,d=this._rowsScrollController.isScrollingBack(),u=d?this.getPreloadedRowCount():0,c=d?0:this.getPreloadedRowCount(),h=((n=this._dataSource)===null||n===void 0?void 0:n.totalCountCorrection())||0,p=Math.max(0,o.skip-u),m=e?l:Math.floor(i?p/i:0),C=m*i,w=o.skip-C,S=o.take+w+c-h,O=Math.ceil(i?(e?a:S)/i:0);return{pageIndex:m,loadPageCount:Math.max(1,O),skipForCurrentPage:Math.max(0,w)}}_updateVisiblePageIndex(e){if(!this._rowsScrollController)return;if(f(e)){this._silentOption("paging.pageIndex",e),this.pageChanged.fire();return}const t=this._rowsScrollController.getViewportItemIndex(),n=Math.floor(t/this.pageSize());this.pageIndex()!==n&&(this._silentOption("paging.pageIndex",n),this.updateItems({changeType:"pageIndex"}))}_getChangedLoadParams(){const e=this.getLoadPageParams(!0),{pageIndex:t,loadPageCount:n}=this.getLoadPageParams(),i=this._pageIndexIsValid(t);let o=null;return!this._isLoading&&i&&(t!==e.pageIndex||n!==e.loadPageCount)&&(o={pageIndex:t,loadPageCount:n}),o}_pageIndexIsValid(e){let t=!0;return(Re(this)&&this.hasKnownLastPage()||ae(this))&&(t=e*this.pageSize()<this.totalItemsCount()),t}_loadItems(e,t){const n=we(this),i=this._dataSource,o=this._getChangedLoadParams(),s=(i==null?void 0:i.loadPageCount())??0,l=this.pageSize()*s,a=(i==null?void 0:i.pageIndex())??0,d=(o==null?void 0:o.pageIndex)===a,u=Re(this)&&this.totalItemsCount()<l,c=this.option("editing.refreshMode")==="repaint",h=(o==null?void 0:o.pageIndex)>a;let p=!1;if(!i||n&&e&&(c&&t||h||d&&u))return p;if(n&&this._isLoading&&(this._needUpdateViewportAfterLoading=!0),n&&o){p=!0,i.pageIndex(o.pageIndex),i.loadPageCount(o.loadPageCount),this._repaintChangesOnly=!0,this._needUpdateDimensions=!0;const m=this._viewportChanging;this.load().always(()=>{this._repaintChangesOnly=void 0,this._needUpdateDimensions=void 0}).done(()=>{const C=this.pageCount()>0&&this.pageIndex()===this.pageCount()-1;(m||C)&&this._updateVisiblePageIndex(),this._needUpdateViewportAfterLoading&&(this._needUpdateViewportAfterLoading=!1,this.loadViewport({checkLoadedParamsOnly:!0}))})}return p}loadViewport(e){const{checkLoadedParamsOnly:t,checkLoading:n,viewportIsNotFilled:i}=e??{};if(we(this)||v.isVirtualRowRendering(this)){var s;this._updateLoadViewportParams();const a=this._loadItems(n,!i),d=(s=this._dataSource)===null||s===void 0?void 0:s.isCustomLoading(),u=n&&!d&&this._isLoading;if(!(a||u||t)){var l;const h=!((l=this._editingController)!==null&&l!==void 0&&(l=l.getChanges())!==null&&l!==void 0&&l.length);this.updateItems({repaintChangesOnly:!0,needUpdateDimensions:!0,useProcessedItemsCache:h,cancelEmptyChanges:!0})}}}updateViewport(){var e;const t=this.viewportSize(),n=this.items().length,i=t>n,o=((e=this._loadViewportParams)===null||e===void 0?void 0:e.take)??0,s=this._rowsScrollController,l=s==null?void 0:s.getViewportParams().take;(i||o<l)&&!this._isPaging&&n&&this.loadViewport({checkLoading:!0,viewportIsNotFilled:i})}loadIfNeed(){if(this.option(D)===!1)return;const e=this._rowsScrollController;e&&e.loadIfNeed();const t=this._dataSource;return t&&t.loadIfNeed()}getItemSize(){const e=this._rowsScrollController;if(e)return e.getItemSize.apply(e,arguments);const t=this._dataSource;return t&&t.getItemSize.apply(t,arguments)}getItemSizes(){const e=this._rowsScrollController;if(e)return e.getItemSizes.apply(e,arguments);const t=this._dataSource;return t&&t.getItemSizes.apply(t,arguments)}getContentOffset(){const e=this._rowsScrollController;if(e)return e.getContentOffset.apply(e,arguments);const t=this._dataSource;return t&&t.getContentOffset.apply(t,arguments)}refresh(e){const t=this._dataSource;return t&&e&&e.load&&Re(this)&&t.resetCurrentTotalCount(),super.refresh.apply(this,arguments)}topItemIndex(){var e;return(e=this._loadViewportParams)===null||e===void 0?void 0:e.skip}bottomItemIndex(){const e=this._loadViewportParams;return e&&e.skip+e.take}virtualItemsCount(){const e=this._rowsScrollController;if(e)return e.virtualItemsCount.apply(e,arguments);const t=this._dataSource;return t==null?void 0:t.virtualItemsCount.apply(t,arguments)}pageIndex(e){const t=we(this),n=this._rowsScrollController;return this.option(D)===!1&&t&&n&&e===void 0?this.option("paging.pageIndex")??0:super.pageIndex.apply(this,arguments)}_fireChanged(e){super._fireChanged.apply(this,arguments);const{operationTypes:t}=e;if(this.option(D)===!1&&we(this)&&t){const{fullReload:n,pageIndex:i}=t;e.isDataChanged&&!n&&i&&this._updateVisiblePageIndex(this._dataSource.pageIndex())}}_getPagingOptionValue(e){let t=super._getPagingOptionValue.apply(this,arguments);return this.option(D)===!1&&we(this)&&(t=this[e]()),t}isEmpty(){return this.option(D)===!1?!this.items(!0).length:super.isEmpty.apply(this,arguments)}isLastPageLoaded(){let e=!1;if(this.option(D)===!1&&we(this)){const{pageIndex:t,loadPageCount:n}=this.getLoadPageParams(!0),i=this.pageCount();e=t+n>=i}else e=super.isLastPageLoaded.apply(this,arguments);return e}reset(){this._itemCount=0,this._allItems=null,super.reset.apply(this,arguments)}_applyFilter(){var e;return(e=this._dataSource)===null||e===void 0||e.loadPageCount(1),super._applyFilter.apply(this,arguments)}getVirtualContentSize(){var e;return(e=this._dataSource)===null||e===void 0?void 0:e.getVirtualContentSize.apply(this._dataSource,arguments)}setViewportItemIndex(){var e;return(e=this._dataSource)===null||e===void 0?void 0:e.setViewportItemIndex.apply(this._dataSource,arguments)}},ag=r=>class extends r{dispose(){super.dispose.apply(this,arguments),clearTimeout(this._resizeTimeout)}_updateMasterDataGridCore(e){return F(super._updateMasterDataGridCore.apply(this,arguments)).done(t=>{const n=ae(e)&&e.option(D)===!1;!t&&n&&e.getScrollable()&&e.updateDimensions()})}hasResizeTimeout(){return f(this._resizeTimeout)}resize(){let e;if(ae(this)||v.isVirtualRowRendering(this)){clearTimeout(this._resizeTimeout),this._resizeTimeout=null;const t=new Date-this._lastTime,n=this.option("scrolling.updateTimeout");this._lastTime&&t<n?(e=new E,this._resizeTimeout=setTimeout(()=>{this._resizeTimeout=null,super.resize.apply(this).done(e.resolve).fail(e.reject),this._lastTime=new Date},n),this._lastTime=new Date):(e=super.resize.apply(this),this._dataController.isLoaded()&&(this._lastTime=new Date))}else e=super.resize.apply(this);return e}},dg=r=>class extends r{init(){var e;super.init(),this._dataController.pageChanged.add(t=>{const n=this._scrollTop;this.scrollToPage(t??this._dataController.pageIndex()),this.option(D)===!1&&this._scrollTop===n&&this._dataController.updateViewport()}),this._dataController.dataSourceChanged.add(()=>{!this._scrollTop&&this._scrollToCurrentPageOnResize()}),(e=this._dataController.stateLoaded)===null||e===void 0||e.add(()=>{this._scrollToCurrentPageOnResize()}),this._scrollToCurrentPageOnResize()}dispose(){clearTimeout(this._scrollTimeoutID),super.dispose()}_scrollToCurrentPageOnResize(){if(this._dataController.pageIndex()>0){const e=()=>{this.resizeCompleted.remove(e),this.scrollToPage(this._dataController.pageIndex())};this.resizeCompleted.add(e)}}scrollToPage(e){const t=this._dataController?this._dataController.pageSize():0;let n;if(ae(this)||Re(this)){const i=this._dataController.getItemSize(),o=this._dataController.getItemSizes(),s=e*t;n=s*i;for(const l in o)parseInt(l)<s&&(n+=o[l]-i)}else n=0;this.scrollTo({y:n,x:this._scrollLeft})}renderDelayedTemplates(){this.waitAsyncTemplates().done(()=>{this._updateContentPosition(!0)}),super.renderDelayedTemplates.apply(this,arguments)}_renderCore(e){const t=new Date,n=super._renderCore.apply(this,arguments),i=this._dataController._dataSource;if(i&&e){const o=e.items?e.items.length:20,s=this._dataController.viewportSize()||20;v.isVirtualRowRendering(this)&&o>0&&this.option(D)!==!1?i._renderTime=(new Date-t)*s/o:i._renderTime=new Date-t}return n}_getRowElements(e){const t=super._getRowElements(e);return t&&t.not(".dx-virtual-row")}_removeRowsElements(e,t,n){let i=this._getRowElements(e).toArray();n==="append"?i=i.slice(0,t):i=i.slice(-t),i.map(o=>{const s=g(o);this._errorHandlingController&&this._errorHandlingController.removeErrorRow(s.next()),s.remove()})}_updateContent(e,t){let n;const i=this._findContentElement(),o=t&&t.changeType,s=E(),l=i.children().first();return o==="append"||o==="prepend"?this.waitAsyncTemplates().done(()=>{const a=this._getBodies(e);a.length===1?this._getBodies(l)[o==="append"?"append":"prepend"](a.children()):a[o==="append"?"appendTo":"prependTo"](l),e.remove(),n=this._getFreeSpaceRowElements(l),qs(n,Xl),t.removeCount&&this._removeRowsElements(l,t.removeCount,o),this._restoreErrorRow(l),s.resolve()}).fail(s.reject):super._updateContent.apply(this,arguments).done(()=>{o==="update"&&this._restoreErrorRow(l),s.resolve()}).fail(s.reject),s.promise().done(()=>{this._updateBottomLoading()})}_addVirtualRow(e,t,n,i){if(!i)return;let o=this._createEmptyRow("dx-virtual-row",t,i);o=this._wrapRowIfNeed(e,o),this._appendEmptyRow(e,o,n)}_updateContentItemSizes(){const e=this._getRowHeights(),t=this._correctRowHeights(e);this._dataController.setContentItemSizes(t)}_updateViewportSize(e,t){f(e)||(e=this._hasHeight?se(this.element()):se(ve())),this._dataController.viewportHeight(e,t)}_getRowHeights(){var e,t;const n=(e=this._editingController)===null||e===void 0||(t=e.isPopupEditMode)===null||t===void 0?void 0:t.call(e);let i=this._getRowElements(this._tableElement).toArray();return n&&(i=i.filter(o=>!g(o).hasClass(ig))),i.map(o=>Z(o).height)}_correctRowHeights(e){const t=this._dataController,n=t._dataSource,i=[],o=t.getVisibleRows();let s=0,l=!0,a=-1;for(let d=0;d<e.length;d++){const u=o[d];f(u)&&(this.option(D)===!1?(a>=0&&a!==u.loadIndex&&(i.push(s),s=0),a=u.loadIndex):En(u,n)&&(l?l=!1:(i.push(s),s=0)),s+=e[d])}return s>0&&i.push(s),i}_updateContentPosition(e){const t=this._rowHeight||20;if(this._dataController.viewportItemSize(t),ae(this)||v.isVirtualRowRendering(this)){e||this._updateContentItemSizes();const n=this._dataController.getContentOffset("begin"),i=this._dataController.getContentOffset("end"),o=this.getTableElements(),s=o.children("tbody").children(".dx-virtual-row");qs(s,"dx-virtual-row"),o.each((l,a)=>{const d=l>0,u=this._isFixedTableRendering;this._isFixedTableRendering=d,this._addVirtualRow(g(a),d,"top",n),this._addVirtualRow(g(a),d,"bottom",i),this._isFixedTableRendering=u})}}_isTableLinesDisplaysCorrect(e){return e.find(".dx-column-lines").length>0===this.option("showColumnLines")}_isColumnElementsEqual(e,t){let n=e.length===t.length;return n&&b(e,(i,o)=>{if(o.style.width!==t[i].style.width)return n=!1,n}),n}_getCellClasses(e){const t=[],{cssClass:n}=e,i=e.command==="expand";return n&&t.push(n),i&&t.push(this.addWidgetPrefix("group-space")),t}_findBottomLoadPanel(e){const t=e||this.element(),n=t&&t.find(`.${this.addWidgetPrefix("bottom-load-panel")}`);if(n&&n.length)return n}_updateBottomLoading(){const e=this,t=ae(this),n=Re(this),i=!e._dataController.hasKnownLastPage()&&e._dataController.isLoaded()&&(t||n),o=e._findContentElement(),s=e._findBottomLoadPanel(o);i?s||g("<div>").addClass(e.addWidgetPrefix("bottom-load-panel")).append(e._createComponent(g("<div>"),Gi,{elementAttr:{role:null,"aria-label":null}}).$element()).appendTo(o):s&&s.remove()}_handleScroll(e){const t=this.option(D)===!0,n=e.scrollOffset.top===0,o=this._scrollTop!==e.scrollOffset.top||e.forceUpdateScrollPosition,s=this._hasHeight||!t&&n;o&&s&&this._rowHeight&&(this._scrollTop=e.scrollOffset.top,(ae(this)||this.option("scrolling.rowRenderingMode")!=="standard")&&this.option(D)===!1&&(this._updateContentItemSizes(),this._updateViewportSize(null,this._scrollTop)),this._dataController.setViewportPosition(e.scrollOffset.top)),super._handleScroll.apply(this,arguments)}_needUpdateRowHeight(e){return super._needUpdateRowHeight.apply(this,arguments)||e>0&&Re(this)&&!v.isVirtualRowRendering(this)}_updateRowHeight(){if(super._updateRowHeight.apply(this,arguments),this._rowHeight){this._updateContentPosition();const e=this._hasHeight?se(this.element()):se(ve());this.option(D)===!1?(this._updateViewportSize(e),this._dataController.updateViewport()):this._dataController.viewportSize(Math.ceil(e/this._rowHeight))}}updateFreeSpaceRowHeight(){const e=super.updateFreeSpaceRowHeight.apply(this,arguments);return e&&this._updateContentPosition(),e}setLoading(e,t){const n=this._dataController,i=n.pageIndex()>0&&n.isLoaded()&&!!this._findBottomLoadPanel();this.option(D)===!1&&e&&n.isViewportChanging()||(i&&(e=!1),super.setLoading.call(this,e,t))}throwHeightWarningIfNeed(){if(this._hasHeight===void 0)return;!this._hasHeight&&we(this)&&!this._heightWarningIsThrown&&(this._heightWarningIsThrown=!0,oe.log("W1025"))}_resizeCore(){const e=this,t=e.element();super._resizeCore(),this.throwHeightWarningIfNeed(),e.component.$element()&&!e._windowScroll&&Kn(t)&&(e._windowScroll=iu(t,n=>{!e._hasHeight&&e._rowHeight&&e._dataController.setViewportPosition(n)},e.component.$element()),e.on("disposing",()=>{e._windowScroll.dispose()})),this.option(D)!==!1&&e.loadIfNeed()}loadIfNeed(){var e,t;(e=this._dataController)===null||e===void 0||(t=e.loadIfNeed)===null||t===void 0||t.call(e)}_restoreErrorRow(e){if(this.option(D)===!1){var t;(t=this._errorHandlingController)===null||t===void 0||t.removeErrorRow()}super._restoreErrorRow.apply(this,arguments)}},ug={defaultOptions:()=>({scrolling:{timeout:300,updateTimeout:300,minTimeout:0,renderingThreshold:100,removeInvisiblePages:!0,rowPageSize:5,prerenderedRowChunkSize:1,mode:"standard",preloadEnabled:!1,rowRenderingMode:"standard",loadTwoPagesOnStart:!1,legacyMode:!1,prerenderedRowCount:1}}),extenders:{controllers:{data:lg,resizing:ag},views:{rowsView:dg}}};T.registerModule("virtualScrolling",ug);Yn.extend(rg);const Yl=(r,e)=>{const t=g(Dd.getWindow()),{top:n}=r.offset();let i;if(Ae(e)){if(e<n)return n-e;i=Ko(t)-e+t.scrollTop()}else{const o=n-t.scrollTop(),s=Ko(t)-o-se(r);i=Math.max(o,s)}return .9*i};class Si extends $r{_getDefaultOptions(){return y(super._getDefaultOptions(),{orientation:"horizontal",tabIndex:null,onHoverStart:We})}_initDataAdapter(){this._dataAdapter=this.option("_dataAdapter"),this._dataAdapter||super._initDataAdapter()}_renderContentImpl(){this._renderContextMenuOverlay(),super._renderContentImpl();const e=this._dataAdapter.getNodeByKey(this.option("_parentKey"));e&&this._renderItems(this._getChildNodes(e)),this._renderDelimiter()}_renderDelimiter(){this.$contentDelimiter=g("<div>").appendTo(this._itemContainer()).addClass("dx-context-menu-content-delimiter")}_getOverlayOptions(){return y(!0,super._getOverlayOptions(),{onPositioned:this._overlayPositionedActionHandler.bind(this),position:{precise:!0}})}_overlayPositionedActionHandler(e){this._showDelimiter(e)}_hoverEndHandler(e){super._hoverEndHandler(e),this._toggleFocusClass(!1,e.currentTarget)}_isMenuHorizontal(){return this.option("orientation")==="horizontal"}_hoverStartHandler(e){this.option("onHoverStart")(e),super._hoverStartHandler(e),this._toggleFocusClass(!0,e.currentTarget)}_drawSubmenu(e){this._actions.onShowing({rootItem:ie(e),submenu:this}),super._drawSubmenu(e),this._actions.onShown({rootItem:ie(e),submenu:this})}_hideSubmenu(e){this._actions.onHiding({cancel:!0,rootItem:ie(e),submenu:this}),super._hideSubmenu(e),this._actions.onHidden({rootItem:ie(e),submenu:this})}_showDelimiter(e){if(!this.$contentDelimiter)return;const t=this._itemContainer().children(".dx-submenu").eq(0),n=this.option("position").of.find(".dx-context-menu-container-border"),i={of:t,precise:!0},o=e.position,s=o.v.location,l=o.h.location,a=n.offset(),d=Math.round(a.left),u=Math.round(a.top),c=K(n),h=J(n),p=K(t),m=J(t);this.$contentDelimiter.css("display","block"),Un(this.$contentDelimiter,this._isMenuHorizontal()?c<p?c:p:3),tt(this.$contentDelimiter,this._isMenuHorizontal()?3:h<m?h:m),this._isMenuHorizontal()?s>u?Math.round(l)===d?(i.offset="0 -2.5",i.at=i.my="left top"):(i.offset="0 -2.5",i.at=i.my="right top"):(tt(this.$contentDelimiter,5),Math.round(l)===d?(i.offset="0 5",i.at=i.my="left bottom"):(i.offset="0 5",i.at=i.my="right bottom")):l>d?Math.round(s)===u?(i.offset="-2.5 0",i.at=i.my="left top"):(i.offset="-2.5 0",i.at=i.my="left bottom"):Math.round(s)===u?(i.offset="2.5 0",i.at=i.my="right top"):(i.offset="2.5 0",i.at=i.my="right bottom"),$i.setup(this.$contentDelimiter,i)}_getContextMenuPosition(){return this.option("position")}isOverlayVisible(){return this._overlay.option("visible")}getOverlayContent(){return this._overlay.$content()}}const Sn="dx-menu-adaptive-mode",cg=`${Sn}-overlay-wrapper`,hg={show:50,hide:300},Xs=["onSubmenuShowing","onSubmenuShown","onSubmenuHiding","onSubmenuHidden","onItemContextMenu","onItemClick","onSelectionChanged","onItemRendered"];class Qi extends ou{_getDefaultOptions(){return y(super._getDefaultOptions(),{orientation:"horizontal",submenuDirection:"auto",showFirstSubmenuMode:{name:"onClick",delay:{show:50,hide:300}},hideSubmenuOnMouseLeave:!1,onSubmenuShowing:null,onSubmenuShown:null,onSubmenuHiding:null,onSubmenuHidden:null,adaptivityEnabled:!1})}_setOptionsByReference(){super._setOptionsByReference(),y(this._optionsByReference,{animation:!0,selectedItem:!0})}_itemElements(){const e=super._itemElements(),t=this._submenuItemElements();return e.add(t)}_submenuItemElements(){let e=[];const t=this._submenus.length&&this._submenus[0];return t&&t.itemsContainer()&&(e=t.itemsContainer().find(".dx-menu-item")),e}_focusTarget(){return this.$element()}_isMenuHorizontal(){return this.option("orientation")==="horizontal"}_moveFocus(e){const t=this._getAvailableItems(),n=this._isMenuHorizontal(),i=this._getActiveItem(!0);let o,s,l,a;switch(e){case"up":s=n?"showSubmenu":this._getItemsNavigationOperation("prevItem"),o=n?i:t,l=this._getKeyboardNavigationAction(s,o),a=l();break;case"down":s=n?"showSubmenu":this._getItemsNavigationOperation("nextItem"),o=n?i:t,l=this._getKeyboardNavigationAction(s,o),a=l();break;case"right":s=n?this._getItemsNavigationOperation("nextItem"):"showSubmenu",o=n?t:i,l=this._getKeyboardNavigationAction(s,o),a=l();break;case"left":s=n?this._getItemsNavigationOperation("prevItem"):"showSubmenu",o=n?t:i,l=this._getKeyboardNavigationAction(s,o),a=l();break;default:return super._moveFocus(e)}a&&a.length!==0&&this.option("focusedElement",ie(a))}_getItemsNavigationOperation(e){let t=e;return this.option("rtlEnabled")&&(t=e==="prevItem"?"nextItem":"prevItem"),t}_getKeyboardNavigationAction(e,t){let n=We;switch(e){case"showSubmenu":t.hasClass("dx-state-disabled")||(n=this._showSubmenu.bind(this,t));break;case"nextItem":n=this._nextItem.bind(this,t);break;case"prevItem":n=this._prevItem.bind(this,t)}return n}_clean(){super._clean(),this.option("templatesRenderAsynchronously")&&clearTimeout(this._resizeEventTimer)}_visibilityChanged(e){e&&(this._menuItemsWidth||this._updateItemsWidthCache(),this._dimensionChanged())}_isAdaptivityEnabled(){return this.option("adaptivityEnabled")&&this.option("orientation")==="horizontal"}_updateItemsWidthCache(){const e=this.$element().find("ul").first().children("li").children(".dx-menu-item");this._menuItemsWidth=this._getSummaryItemsSize("width",e,!0)}_dimensionChanged(){if(!this._isAdaptivityEnabled())return;const e=ye(this.$element());this._toggleAdaptiveMode(this._menuItemsWidth>e)}_init(){super._init(),this._submenus=[]}_initActions(){this._actions={},b(Xs,(e,t)=>{this._actions[t]=this._createActionByOption(t)})}_initMarkup(){this._visibleSubmenu=null,this.$element().addClass("dx-menu"),super._initMarkup(),this._addCustomCssClass(this.$element()),this.setAria("role","menubar")}_setAriaRole(e){const t=this._isAdaptivityEnabled()&&e?void 0:"menubar";this.setAria({role:t})}_render(){super._render(),this._initAdaptivity()}_isTargetOutOfComponent(e){const t=g(e).closest(".dx-menu").length!==0,n=g(e).closest(".dx-context-menu").length!==0;return!(t||n)}_focusOutHandler(e){const{relatedTarget:t}=e;t&&this._isTargetOutOfComponent(t)&&this._hideVisibleSubmenu(),super._focusOutHandler(e)}_renderHamburgerButton(){return this._hamburger=new Ut(g("<div>").addClass("dx-menu-hamburger-button"),{icon:"menu",activeStateEnabled:!1,onClick:this._toggleTreeView.bind(this)}),this._hamburger.$element()}_toggleTreeView(e){en(e)&&(e=!this._overlay.option("visible")),this._overlay.option("visible",e),e&&this._treeView.focus(),this._toggleHamburgerActiveState(e)}_toggleHamburgerActiveState(e){this._hamburger&&this._hamburger.$element().toggleClass("dx-state-active",e)}_toggleAdaptiveMode(e){const t=this.$element().find(".dx-menu-horizontal"),n=this.$element().find(`.${Sn}`);e?this._hideVisibleSubmenu():(this._treeView&&this._treeView.collapseAll(),this._overlay&&this._toggleTreeView(e)),this._setAriaRole(e),t.toggle(!e),n.toggle(e)}_removeAdaptivity(){this._$adaptiveContainer&&(this._toggleAdaptiveMode(!1),this._$adaptiveContainer.remove(),this._$adaptiveContainer=null,this._treeView=null,this._hamburger=null,this._overlay=null)}_treeviewItemClickHandler(e){this._actions.onItemClick(e),e.node.children.length||this._toggleTreeView(!1)}_getAdaptiveOverlayOptions(){const t=this.option("rtlEnabled")?"right":"left";return{_ignoreFunctionValueDeprecation:!0,maxHeight:()=>Yl(this.$element()),deferRendering:!1,shading:!1,animation:!1,hideOnParentScroll:!0,onHidden:()=>{this._toggleHamburgerActiveState(!1)},height:"auto",hideOnOutsideClick:n=>!g(n.target).closest(".dx-menu-hamburger-button").length,position:{collision:"flipfit",at:`bottom ${t}`,my:`top ${t}`,of:this._hamburger.$element()}}}_getTreeViewOptions(){const e={};return b(["rtlEnabled","width","accessKey","activeStateEnabled","animation","dataSource","disabled","displayExpr","displayExpr","focusStateEnabled","hint","hoverStateEnabled","itemsExpr","items","itemTemplate","selectedExpr","selectionMode","tabIndex","visible"],(t,n)=>{e[n]=this.option(n)}),b(["onItemContextMenu","onSelectionChanged","onItemRendered"],(t,n)=>{e[n]=i=>{this._actions[n](i)}}),y(e,{dataSource:this.getDataSource(),animationEnabled:!!this.option("animation"),onItemClick:this._treeviewItemClickHandler.bind(this),onItemExpanded:t=>{this._overlay.repaint(),this._actions.onSubmenuShown(t)},onItemCollapsed:t=>{this._overlay.repaint(),this._actions.onSubmenuHidden(t)},selectNodesRecursive:!1,selectByClick:this.option("selectByClick"),expandEvent:"click",_supportItemUrl:!0})}_initAdaptivity(){if(!this._isAdaptivityEnabled())return;this._$adaptiveContainer=g("<div>").addClass(Sn);const e=this._renderHamburgerButton();this._treeView=this._createComponent(g("<div>"),ho,this._getTreeViewOptions()),this._overlay=this._createComponent(g("<div>"),Mt,this._getAdaptiveOverlayOptions()),this._overlay.$content().append(this._treeView.$element()).addClass(Sn).addClass(this.option("cssClass")),this._overlay.$wrapper().addClass(cg),this._$adaptiveContainer.append(e),this._$adaptiveContainer.append(this._overlay.$element()),this.$element().append(this._$adaptiveContainer),this._updateItemsWidthCache(),this._dimensionChanged()}_getDelay(e){const{delay:t}=this.option("showFirstSubmenuMode");return f(t)?Y(t)?t[e]:t:hg[e]}_keyboardHandler(e){return super._keyboardHandler(e,!!this._visibleSubmenu)}_renderContainer(){const e=g("<div>");return e.appendTo(this.$element()).addClass(this._isMenuHorizontal()?"dx-menu-horizontal":"dx-menu-vertical"),super._renderContainer(e)}_renderSubmenuItems(e,t){const n=this._createSubmenu(e,t);return this._submenus.push(n),this._renderBorderElement(t),n}_getKeyboardListeners(){return super._getKeyboardListeners().concat(this._visibleSubmenu)}_createSubmenu(e,t){const n=g("<div>").addClass("dx-context-menu").appendTo(t),i=this._getChildNodes(e),o=this._createComponent(n,Si,y(this._getSubmenuOptions(),{_dataAdapter:this._dataAdapter,_parentKey:e.internalFields.key,items:i,onHoverStart:this._clearTimeouts.bind(this),position:this.getSubmenuPosition(t)}));return this._attachSubmenuHandlers(t,o),o}_getSubmenuOptions(){const e=g("<div>"),t=this._isMenuHorizontal();return{itemTemplate:this.option("itemTemplate"),target:e,orientation:this.option("orientation"),selectionMode:this.option("selectionMode"),cssClass:this.option("cssClass"),selectByClick:this.option("selectByClick"),hoverStateEnabled:this.option("hoverStateEnabled"),activeStateEnabled:this.option("activeStateEnabled"),focusStateEnabled:this.option("focusStateEnabled"),animation:this.option("animation"),showSubmenuMode:this.option("showSubmenuMode"),displayExpr:this.option("displayExpr"),disabledExpr:this.option("disabledExpr"),selectedExpr:this.option("selectedExpr"),itemsExpr:this.option("itemsExpr"),onFocusedItemChanged:n=>{n.component.option("visible")&&this.option("focusedElement",n.component.option("focusedElement"))},onSelectionChanged:this._nestedItemOnSelectionChangedHandler.bind(this),onItemClick:this._nestedItemOnItemClickHandler.bind(this),onItemRendered:this._nestedItemOnItemRenderedHandler.bind(this),onLeftFirstItem:t?null:this._moveMainMenuFocus.bind(this,"prevItem"),onLeftLastItem:t?null:this._moveMainMenuFocus.bind(this,"nextItem"),onCloseRootSubmenu:this._moveMainMenuFocus.bind(this,t?"prevItem":null),onExpandLastSubmenu:t?this._moveMainMenuFocus.bind(this,"nextItem"):null}}_getShowFirstSubmenuMode(){if(!this._isDesktopDevice())return"onClick";const e=this.option("showFirstSubmenuMode");return Y(e)?e.name:e}_moveMainMenuFocus(e){const t=this._getAvailableItems(),n=t.length,i=t.filter(".dx-menu-item-expanded").eq(0);let o=t.index(i);this._hideSubmenu(this._visibleSubmenu),o+=e==="prevItem"?-1:1,o>=n?o=0:o<0&&(o=n-1);const s=t.eq(o);this.option("focusedElement",ie(s))}_nestedItemOnSelectionChangedHandler(e){const t=e.addedItems.length&&e.addedItems[0],n=Si.getInstance(e.element),{onSelectionChanged:i}=this._actions;i(e),t&&this._clearSelectionInSubmenus(t[0],n),this._clearRootSelection(),this._setOptionWithoutOptionChange("selectedItem",t)}_clearSelectionInSubmenus(e,t){const n=!arguments.length;b(this._submenus,(i,o)=>{const s=o._itemContainer(),l=!s.is(t&&t._itemContainer()),a=s.find(`.${this._selectedItemClass()}`);if(l&&a.length||n){a.removeClass(this._selectedItemClass());const d=this._getItemData(a);d&&(d.selected=!1),o._clearSelectedItems()}})}_clearRootSelection(){const e=this.$element().find(".dx-menu-items-container").first().children().children().filter(`.${this._selectedItemClass()}`);if(e.length){const t=this._getItemData(e);t.selected=!1,e.removeClass(this._selectedItemClass())}}_nestedItemOnItemClickHandler(e){this._actions.onItemClick(e)}_nestedItemOnItemRenderedHandler(e){this._actions.onItemRendered(e)}_attachSubmenuHandlers(e,t){const i=t.getOverlayContent().find(".dx-submenu"),o=H(Pd,`${this.NAME}_submenu`);t.option({onShowing:this._submenuOnShowingHandler.bind(this,e,t),onShown:this._submenuOnShownHandler.bind(this,e,t),onHiding:this._submenuOnHidingHandler.bind(this,e,t),onHidden:this._submenuOnHiddenHandler.bind(this,e,t)}),b(i,(s,l)=>{x.off(l,o),x.on(l,o,null,this._submenuMouseLeaveHandler.bind(this,e))})}_submenuOnShowingHandler(e,t,n){let{rootItem:i}=n;const o=e.children(".dx-context-menu-container-border"),s=this._getVisibilityChangeEventParams(i,t,e);this._actions.onSubmenuShowing(s),o.show(),e.addClass("dx-menu-item-expanded")}_submenuOnShownHandler(e,t,n){let{rootItem:i}=n;const o=this._getVisibilityChangeEventParams(i,t,e);this._actions.onSubmenuShown(o)}_submenuOnHidingHandler(e,t,n){const i=e.children(".dx-context-menu-container-border"),o=this._getVisibilityChangeEventParams(n.rootItem,t,e,!0);n.itemData=o.itemData,n.rootItem=o.rootItem,n.submenuContainer=o.submenuContainer,n.submenu=o.submenu,this._actions.onSubmenuHiding(n),n.cancel||(this._visibleSubmenu===t&&(this._visibleSubmenu=null),i.hide(),e.removeClass("dx-menu-item-expanded"))}_submenuOnHiddenHandler(e,t,n){let{rootItem:i}=n;const o=this._getVisibilityChangeEventParams(i,t,e,!0);this._actions.onSubmenuHidden(o)}_getVisibilityChangeEventParams(e,t,n,i){let o,s;if(e){const l=i?g(e).closest(".dx-menu-item")[0]:e;o=this._getItemData(l),s=g(l).find(".dx-submenu").first()}else{const l=g(t._overlay.content());o=this._getItemData(n),s=l.find(".dx-submenu").first()}return{itemData:o,rootItem:ie(n),submenuContainer:ie(s),submenu:t}}_submenuMouseLeaveHandler(e,t){const n=g(t.relatedTarget).parents(".dx-context-menu")[0],i=this._getSubmenuByRootElement(e).getOverlayContent()[0];this.option("hideSubmenuOnMouseLeave")&&n!==i&&(this._clearTimeouts(),setTimeout(this._hideSubmenuAfterTimeout.bind(this),this._getDelay("hide")))}_hideSubmenuAfterTimeout(){if(!this._visibleSubmenu)return;const e=g(this._visibleSubmenu.$element().context).hasClass("dx-state-hover"),t=this._visibleSubmenu.getOverlayContent().find(".dx-state-hover").length;!this._visibleSubmenu.getOverlayContent().get(0).querySelector(":hover")&&!t&&!e&&this._visibleSubmenu.hide()}_getSubmenuByRootElement(e){if(!e)return!1;const t=e.children(".dx-context-menu");return t.length&&Si.getInstance(t)}getSubmenuPosition(e){const t=this._isMenuHorizontal(),n=this.option("submenuDirection").toLowerCase(),i=this.option("rtlEnabled"),o={collision:"flip",of:e,precise:!0};switch(n){case"leftortop":o.at="left top",o.my=t?"left bottom":"right top";break;case"rightorbottom":o.at=t?"left bottom":"right top",o.my="left top";break;default:t?(o.at=i?"right bottom":"left bottom",o.my=i?"right top":"left top"):(o.at=i?"left top":"right top",o.my=i?"right top":"left top")}return o}_renderBorderElement(e){g("<div>").appendTo(e).addClass("dx-context-menu-container-border").hide()}_itemPointerDownHandler(e){if(g(e.target).closest(this._itemElements()).hasClass("dx-menu-item-has-submenu")){this.option("focusedElement",null);return}super._itemPointerDownHandler(e)}_hoverStartHandler(e){const t=H(q.move,this.NAME),n=this._getItemElementByEventArgs(e),i=this._dataAdapter.getNodeByItem(this._getItemData(n)),o=f(e.buttons)&&e.buttons===1||!f(e.buttons)&&e.which===1;if(!this._isItemDisabled(n)){if(x.off(n,t),!this._hasChildren(i)){this._showSubmenuTimer=setTimeout(this._hideSubmenuAfterTimeout.bind(this),this._getDelay("hide"));return}if(this._getShowFirstSubmenuMode()==="onHover"&&!o){const s=this._getSubmenuByElement(n);this._clearTimeouts(),s.isOverlayVisible()||(x.on(n,t,this._itemMouseMoveHandler.bind(this)),this._showSubmenuTimer=this._getDelay("hide"))}}}_hoverEndHandler(e){const t=this._getItemElementByEventArgs(e),n=g(e.relatedTarget);super._hoverEndHandler(e),this._clearTimeouts(),!this._isItemDisabled(t)&&(n.hasClass("dx-context-menu-content-delimiter")||this.option("hideSubmenuOnMouseLeave")&&!n.hasClass("dx-menu-items-container")&&(this._hideSubmenuTimer=setTimeout(()=>{this._hideSubmenuAfterTimeout()},this._getDelay("hide"))))}_hideVisibleSubmenu(){return this._visibleSubmenu?(this._hideSubmenu(this._visibleSubmenu),!0):!1}_showSubmenu(e){const t=this._getSubmenuByElement(e);this._visibleSubmenu!==t&&this._hideVisibleSubmenu(),t&&(this._clearTimeouts(),this.focus(),t.show(),this.option("focusedElement",t.option("focusedElement"))),this._visibleSubmenu=t,this._hoveredRootItem=e}_hideSubmenu(e){e&&e.hide(),this._visibleSubmenu===e&&(this._visibleSubmenu=null),this._hoveredRootItem=null}_itemMouseMoveHandler(e){if(e.pointers&&e.pointers.length)return;const t=g(e.currentTarget);f(this._showSubmenuTimer)&&(this._clearTimeouts(),this._showSubmenuTimer=setTimeout(()=>{const n=this._getSubmenuByElement(t);n&&!n.isOverlayVisible()&&this._showSubmenu(t)},this._getDelay("show")))}_clearTimeouts(){clearTimeout(this._hideSubmenuTimer),clearTimeout(this._showSubmenuTimer)}_getSubmenuByElement(e,t){const n=this._getSubmenuByRootElement(e);if(n)return n;t=t??this._getItemData(e);const i=this._dataAdapter.getNodeByItem(t);return this._hasChildren(i)&&this._renderSubmenuItems(i,e)}_updateSubmenuVisibilityOnClick(e){const t=e.args.length&&e.args[0];if(!t||this._disabledGetter(t.itemData))return;const n=g(t.itemElement),i=this._getSubmenuByElement(n,t.itemData);if(this._updateSelectedItemOnClick(e),this._visibleSubmenu){if(this._visibleSubmenu===i){this.option("showFirstSubmenuMode")==="onClick"&&this._hideSubmenu(this._visibleSubmenu);return}this._hideSubmenu(this._visibleSubmenu)}i&&(i.isOverlayVisible()||this._showSubmenu(n))}_optionChanged(e){if(Xs.includes(e.name)){this._initActions();return}switch(e.name){case"orientation":case"submenuDirection":this._invalidate();break;case"showFirstSubmenuMode":case"hideSubmenuOnMouseLeave":break;case"showSubmenuMode":this._changeSubmenusOption(e.name,e.value);break;case"adaptivityEnabled":e.value?this._initAdaptivity():this._removeAdaptivity();break;case"width":this._isAdaptivityEnabled()&&(this._treeView.option(e.name,e.value),this._overlay.option(e.name,e.value)),super._optionChanged(e),this._dimensionChanged();break;case"animation":this._isAdaptivityEnabled()&&this._treeView.option("animationEnabled",!!e.value),super._optionChanged(e);break;default:this._isAdaptivityEnabled()&&(e.name===e.fullName||e.name==="items")&&this._treeView.option(e.fullName,e.value),super._optionChanged(e)}}_changeSubmenusOption(e,t){b(this._submenus,(n,i)=>{i.option(e,t)})}selectItem(e){this._hideSubmenu(this._visibleSubmenu),super.selectItem(e)}unselectItem(e){this._hideSubmenu(this._visibleSubmenu),super.unselectItem(e)}}uo("dxMenu",Qi);const Ri={"=":"filter-operation-equals","<>":"filter-operation-not-equals","<":"filter-operation-less","<=":"filter-operation-less-equal",">":"filter-operation-greater",">=":"filter-operation-greater-equal",default:"filter-operation-default",notcontains:"filter-operation-not-contains",contains:"filter-operation-contains",startswith:"filter-operation-starts-with",endswith:"filter-operation-ends-with",between:"filter-operation-between"},Ys={"=":"equal","<>":"notEqual","<":"lessThan","<=":"lessThanOrEqual",">":"greaterThan",">=":"greaterThanOrEqual",startswith:"startsWith",contains:"contains",notcontains:"notContains",endswith:"endsWith",between:"between"},pg="dx-filter-menu",Vt="input:not([type='hidden'])",gg=["date","datetime","number"],mg=_.format("dxDataGrid-ariaSearchBox");function _t(r){return r.option("filterRow.applyFilter")==="onClick"}const Ti=function(r){const e=r&&r.children(),t=e&&e.data("dxComponents"),n=t&&t.length&&e.data(t[0]);return n instanceof Ad?n:null},Vi=function(r,e){let t="",n="";const i=Fo(r,e),o=v.getFormatOptionsByColumn(e,"filterRow");return Array.isArray(i)?(t=v.formatValue(i[0],o),n=v.formatValue(i[1],o),n!==""&&(t+=` - ${n}`)):f(i)&&(t=v.formatValue(i,o)),t};function Fo(r,e){if(e)return _t(r)&&e.bufferedFilterValue!==void 0?e.bufferedFilterValue:e.filterValue}const Ee=function(r,e){if(e)return _t(r)&&e.bufferedSelectedFilterOperation!==void 0?e.bufferedSelectedFilterOperation:e.selectedFilterOperation},fg=function(r,e){return e&&gg.includes(e.dataType)&&Array.isArray(r)?!1:r!==void 0},Ji=function(r,e,t){const n=r._columnsController.columnOption(e),i=Fo(r,n),o=t.closest(`.${r.addWidgetPrefix("filter-range-overlay")}`).length,s=t.hasClass(r.addWidgetPrefix("filter-range-start"));return i&&Array.isArray(i)&&Ee(r,n)==="between"?s?i[0]:i[1]:!o&&fg(i,n)?i:null},Cg=function(r,e,t,n){if(Ee(r,t)==="between"){const i=Fo(r,t);return n.hasClass(r.addWidgetPrefix("filter-range-start"))?[e,Array.isArray(i)?i[1]:void 0]:[Array.isArray(i)?i[0]:i,e]}return e},_g=function(r,e){const t=e.value===""?null:e.value,n=e.container,i=r._columnsController.columnOption(e.column.index),o=Ji(r,i.index,n);if(!f(o)&&!f(t))return;r._applyFilterViewController.setHighLight(n,o!==t);const s=_t(r)?"bufferedFilterValue":"filterValue",l=Cg(r,t,i,n),a=Ee(r,i)==="between",d=e.notFireEvent||a&&Array.isArray(l)&&l.includes(void 0);r._columnsController.columnOption(i.index,s,l,d)},wg=r=>class extends r{init(){super.init(),this._applyFilterViewController=this.getController("applyFilter")}optionChanged(e){switch(e.name){case"filterRow":case"showColumnLines":this._invalidate(!0,!0),e.handled=!0;break;case"syncLookupFilterValues":e.value?this.updateLookupDataSource():this.render(),e.handled=!0;break;default:super.optionChanged(e)}}_updateEditorValue(e,t){const n=Ti(t);n&&n.option("value",Ji(this,e.index,t))}_columnOptionChanged(e){const t=this,{optionNames:n}=e;let i,o,s,l;if(v.checkChanges(n,["filterValue","bufferedFilterValue","selectedFilterOperation","bufferedSelectedFilterOperation","filterValues","filterType"])&&e.columnIndex!==void 0){const a=t._columnsController.getVisibleIndex(e.columnIndex),d=t._columnsController.columnOption(e.columnIndex);if(i=t._getCellElement(t.element().find(`.${t.addWidgetPrefix("filter-row")}`).index(),a)??g(),o=i.find(".dx-editor-container").first(),n.filterValue||n.bufferedFilterValue){t._updateEditorValue(d,o);const u=i.find(`.${t.addWidgetPrefix("filter-range-overlay")}`).data("dxOverlay");u&&(s=u.$content().find(".dx-editor-container"),t._updateEditorValue(d,s.first()),t._updateEditorValue(d,s.last())),(!u||!u.option("visible"))&&t._updateFilterRangeContent(i,Vi(t,d))}(n.selectedFilterOperation||n.bufferedSelectedFilterOperation)&&a>=0&&d&&(l=i.find(".dx-menu"),l.length&&(t._updateFilterOperationChooser(l,d,o),Ee(t,d)==="between"?t._renderFilterRangeContent(i,d):o.find(".dx-filter-range-content").length&&(t._renderEditor(o,t._getEditorOptions(o,d)),t._hideFilterRange())));return}super._columnOptionChanged(e)}_renderCore(){return this._filterRangeOverlayInstance=null,super._renderCore.apply(this,arguments)}_resizeCore(){var e;super._resizeCore.apply(this,arguments),(e=this._filterRangeOverlayInstance)===null||e===void 0||e.repaint()}isFilterRowVisible(){return this._isElementVisible(this.option("filterRow"))}isVisible(){return super.isVisible()||this.isFilterRowVisible()}_initFilterRangeOverlay(e,t){const n=this,i={},o=e.find(".dx-editor-container"),s=n.addWidgetPrefix("filter-range-overlay"),l=g("<div>").addClass(s).appendTo(e);return n._createComponent(l,Mt,{height:"auto",shading:!1,showTitle:!1,focusStateEnabled:!1,hideOnOutsideClick:!0,wrapperAttr:{class:s},animation:!1,position:{my:"top",at:"top",of:o.length&&o||e,offset:"0 -1"},contentTemplate(a){let d,u=g("<div>").addClass(`dx-editor-container ${n.addWidgetPrefix("filter-range-start")}`).appendTo(a);return t=n._columnsController.columnOption(t.index),d=n._getEditorOptions(u,t),d.sharedData=i,n._renderEditor(u,d),x.on(u.find(Vt),"keydown",c=>{let h=e.find("[tabindex]").not(c.target).first();xe(c)==="tab"&&c.shiftKey&&(c.preventDefault(),n._hideFilterRange(),h.length||(h=e.prev().find("[tabindex]").last()),x.trigger(h,"focus"))}),u=g("<div>").addClass(`dx-editor-container ${n.addWidgetPrefix("filter-range-end")}`).appendTo(a),d=n._getEditorOptions(u,t),d.sharedData=i,n._renderEditor(u,d),x.on(u.find(Vt),"keydown",c=>{xe(c)==="tab"&&!c.shiftKey&&(c.preventDefault(),n._hideFilterRange(),x.trigger(e.next().find("[tabindex]").first(),"focus"))}),g(a).addClass(n.getWidgetContainerClass())},onShown(a){const d=a.component.$content().find(".dx-editor-container").first();x.trigger(d.find(Vt),"focus")},onHidden(){t=n._columnsController.columnOption(t.index),e.find(".dx-menu").parent().addClass("dx-editor-with-menu"),Ee(n,t)==="between"&&(n._updateFilterRangeContent(e,Vi(n,t)),n.component.updateDimensions())}})}_updateFilterRangeOverlay(e){const t=this._filterRangeOverlayInstance;t&&t.option(e)}_showFilterRange(e,t){const n=this,i=e.children(`.${n.addWidgetPrefix("filter-range-overlay")}`);let o=i.length&&i.data("dxOverlay");!o&&t&&(o=n._initFilterRangeOverlay(e,t)),o.option("visible")||(n._filterRangeOverlayInstance&&n._filterRangeOverlayInstance.hide(),n._filterRangeOverlayInstance=o,n._updateFilterRangeOverlay({width:ye(e,!0)+1}),n._filterRangeOverlayInstance&&n._filterRangeOverlayInstance.show())}_hideFilterRange(){const e=this._filterRangeOverlayInstance;e&&e.hide()}getFilterRangeOverlayInstance(){return this._filterRangeOverlayInstance}_createRow(e){const t=super._createRow(e);return e.rowType==="filter"&&(t.addClass(this.addWidgetPrefix("filter-row")),this.option("useLegacyKeyboardNavigation")||x.on(t,"keydown",n=>fo("filterRow",this,n))),t}_getRows(){const e=super._getRows();return this.isFilterRowVisible()&&e.push({rowType:"filter"}),e}_renderFilterCell(e,t){const n=this,{column:i}=t,o=g(e);n.component.option("showColumnHeaders")&&n.setAria("describedby",i.headerId,o),n.setAria("label",_.format("dxDataGrid-ariaFilterCell"),o),o.addClass("dx-editor-cell");const s=g("<div>").appendTo(o),l=g("<div>").addClass("dx-editor-container").appendTo(s);if(Ee(n,i)==="between")n._renderFilterRangeContent(o,i);else{const d=n._getEditorOptions(l,i);n._renderEditor(l,d)}const{alignment:a}=i;a&&a!=="center"&&o.find(Vt).first().css("textAlign",i.alignment),i.filterOperations&&i.filterOperations.length&&n._renderFilterOperationChooser(s,i,l)}_renderCellContent(e,t){const n=this,{column:i}=t;if(t.rowType==="filter"){if(i.command)e.html("&nbsp;");else if(i.allowFiltering){n.renderTemplate(e,n._renderFilterCell.bind(n),t).done(()=>{n._updateCell(e,t)});return}}super._renderCellContent.apply(this,arguments)}_getEditorOptions(e,t){const n=this,i={editorOptions:{inputAttr:n._getFilterInputAccessibilityAttributes(t)}},o=y(i,t,{value:Ji(n,t.index,e),parentType:"filterRow",showAllText:n.option("filterRow.showAllText"),updateValueTimeout:n.option("filterRow.applyFilter")==="onClick"?0:700,width:null,setValue(s,l){_g(n,{column:t,value:s,container:e,notFireEvent:l})}});return Ee(n,t)==="between"&&(e.hasClass(n.addWidgetPrefix("filter-range-start"))?o.placeholder=n.option("filterRow.betweenStartText"):o.placeholder=n.option("filterRow.betweenEndText")),o}_getFilterInputAccessibilityAttributes(e){const t=_.format("dxDataGrid-ariaFilterCell");return this.component.option("showColumnHeaders")?{"aria-label":t,"aria-describedby":e.headerId}:{"aria-label":t}}_renderEditor(e,t){e.empty();const n=g("<div>").appendTo(e),i=this._dataController.dataSource();if(t.lookup&&this.option("syncLookupFilterValues")){this._applyFilterViewController.setCurrentColumnForFiltering(t);const o=this._dataController.getCombinedFilter();this._applyFilterViewController.setCurrentColumnForFiltering(null);const s=v.getWrappedLookupDataSource(t,i,o),l=A({},t,{lookup:A({},t.lookup,{dataSource:s})});return this._editorFactoryController.createEditor(n,l)}return this._editorFactoryController.createEditor(n,t)}_renderFilterRangeContent(e,t){const n=this,i=e.find(".dx-editor-container").first();i.empty();const o=g("<div>").addClass("dx-filter-range-content").attr("tabindex",this.option("tabIndex"));x.on(o,"focusin",()=>{n._showFilterRange(e,t)}),o.appendTo(i),n._updateFilterRangeContent(e,Vi(n,t))}_updateFilterRangeContent(e,t){const n=e.find(".dx-filter-range-content");n.length&&(t===""?n.html("&nbsp;"):n.text(t))}_updateFilterOperationChooser(e,t,n){const i=this;let o;const s=function(){const a=Qi.getInstance(e);a&&a.option("focusedElement",null),o&&i._focusEditor(n)},l=this._editorFactoryController;i._createComponent(e,Qi,{integrationOptions:{},activeStateEnabled:!1,selectionMode:"single",cssClass:`${i.getWidgetContainerClass()} dx-cell-focus-disabled ${pg}`,showFirstSubmenuMode:"onHover",hideSubmenuOnMouseLeave:!0,items:[{disabled:!(t.filterOperations&&t.filterOperations.length),icon:Ri[Ee(i,t)||"default"],selectable:!1,items:i._getFilterOperationMenuItems(t)}],onItemRendered:a=>{let{itemElement:d}=a;this.setAria("label",mg,g(d))},onItemClick(a){const d=a.itemData.name,u=Ee(i,t);let c=!1;const h=_t(i),p={};if(!(a.itemData.items||d&&d===u)){if(d?(p[h?"bufferedSelectedFilterOperation":"selectedFilterOperation"]=d,(d==="between"||u==="between")&&(c=d==="between",p[h?"bufferedFilterValue":"filterValue"]=null)):(p[h?"bufferedFilterValue":"filterValue"]=null,p[h?"bufferedSelectedFilterOperation":"selectedFilterOperation"]=t.defaultSelectedFilterOperation||null),i._columnsController.columnOption(t.index,p),i._applyFilterViewController.setHighLight(n,!0),!d){const m=Ti(n);m&&m.NAME==="dxDateBox"&&!m.option("isValid")&&(m.clear(),m.option("isValid",!0))}c?i._showFilterRange(n.closest(".dx-editor-cell"),t):i._focusEditor(n)}},onSubmenuShowing(){o=i._isEditorFocused(n),l.loseFocus()},onSubmenuHiding(){x.trigger(e,"blur"),s()},onContentReady(a){x.on(e,"blur",()=>{a.component._hideSubmenuAfterTimeout(),s()})},rtlEnabled:i.option("rtlEnabled")})}_isEditorFocused(e){return e.hasClass("dx-focused")||e.parents(".dx-focused").length}_focusEditor(e){this._editorFactoryController.focus(e),x.trigger(e.find(Vt),"focus")}_renderFilterOperationChooser(e,t,n){const i=this;let o;i.option("filterRow.showOperationChooser")&&(e.addClass("dx-editor-with-menu"),o=g("<div>").prependTo(e),i._updateFilterOperationChooser(o,t,n))}_getFilterOperationMenuItems(e){const t=this;let n=[{}];const i=t.option("filterRow"),o=i&&i.operationDescriptions||{};if(e.filterOperations&&e.filterOperations.length){const s=e.filterOperations.filter(l=>f(Ys[l]));n=zn(s,l=>{const a=Ys[l];return{name:l,selected:(Ee(t,e)||e.defaultFilterOperation)===l,text:o[a],icon:Ri[l]}}),n.push({name:null,text:i&&i.resetOperationText,icon:Ri.default})}return n}_handleDataChanged(e){var t,n,i,o,s;const l=(t=this._dataController)===null||t===void 0||(n=t.dataSource)===null||n===void 0?void 0:n.call(t),a=l==null||(i=l.lastLoadOptions)===null||i===void 0?void 0:i.call(l);if(super._handleDataChanged.apply(this,arguments),(o=e.operationTypes)!==null&&o!==void 0&&o.filtering||(s=e.operationTypes)!==null&&s!==void 0&&s.fullReload){var d;this.updateLookupDataSource(((d=e.operationTypes)===null||d===void 0?void 0:d.filtering)||(a==null?void 0:a.filter))}}updateLookupDataSource(e){if(!this.option("syncLookupFilterValues")||!this.element())return;const t=this._columnsController.getVisibleColumns(),n=this._dataController.dataSource(),i=this._applyFilterViewController,o=this.element().find(`.${this.addWidgetPrefix("filter-row")}`).index();o!==-1&&t.forEach((s,l)=>{if(!s.lookup||s.calculateCellValue!==s.defaultCalculateCellValue)return;const a=this._getCellElement(o,l),d=Ti(a==null?void 0:a.find(".dx-editor-container"));if(d){i.setCurrentColumnForFiltering(s);const u=this._dataController.getCombinedFilter()||null;i.setCurrentColumnForFiltering(null);const c=d.option("dataSource");if(!e||!G(c.__dataGridSourceFilter||null,u)){const p=v.getWrappedLookupDataSource(s,n,u);d.option("dataSource",p)}}})}getColumnElements(e,t){var n;const i=this._getRows();return(i==null||(n=i[e])===null||n===void 0?void 0:n.rowType)==="filter"&&arguments.length<2?this.getCellElements(e):super.getColumnElements(e,t)}},xg=r=>class extends r{skipCalculateColumnFilters(){return!1}_calculateAdditionalFilter(){if(this.skipCalculateColumnFilters())return super._calculateAdditionalFilter();const e=[super._calculateAdditionalFilter()],t=this._columnsController.getVisibleColumns(null,!0),n=this._applyFilterController;return b(t,function(){var i;const o=((i=n.getCurrentColumnForFiltering())===null||i===void 0?void 0:i.index)===this.index;if(this.allowFiltering&&this.calculateFilterExpression&&f(this.filterValue)&&!o){const s=this.createFilterExpression(this.filterValue,this.selectedFilterOperation||this.defaultFilterOperation,"filterRow");e.push(s)}}),v.combineFilters(e)}};class vg extends L.ViewController{init(){this._columnsController=this.getController("columns")}_getHeaderPanel(){return this._headerPanel||(this._headerPanel=this.getView("headerPanel")),this._headerPanel}setHighLight(e,t){_t(this)&&(e&&e.toggleClass("dx-highlight-outline",t)&&e.closest(".dx-editor-cell").toggleClass("dx-filter-modified",t),this._getHeaderPanel().enableApplyButton(t))}applyFilter(){const e=this._columnsController.getColumns();this._columnsController.beginUpdate();for(let t=0;t<e.length;t++){const n=e[t];n.bufferedFilterValue!==void 0&&(this._columnsController.columnOption(t,"filterValue",n.bufferedFilterValue),n.bufferedFilterValue=void 0),n.bufferedSelectedFilterOperation!==void 0&&(this._columnsController.columnOption(t,"selectedFilterOperation",n.bufferedSelectedFilterOperation),n.bufferedSelectedFilterOperation=void 0)}this._columnsController.endUpdate(),this.removeHighLights()}removeHighLights(){if(_t(this)){const e=this.getView("columnHeadersView").element();e.find(`.${this.addWidgetPrefix("filter-row")} .dx-highlight-outline`).removeClass("dx-highlight-outline"),e.find(`.${this.addWidgetPrefix("filter-row")} .dx-filter-modified`).removeClass("dx-filter-modified"),this._getHeaderPanel().enableApplyButton(!1)}}setCurrentColumnForFiltering(e){this._currentColumn=e}getCurrentColumnForFiltering(){return this._currentColumn}}const yg=r=>class extends r{_startResizing(){const e=this;if(super._startResizing.apply(e,arguments),e.isResizing()){const t=e._columnHeadersView.getFilterRangeOverlayInstance();if(t){const n=t.$element().closest("td").index();(n===e._targetPoint.columnIndex||n===e._targetPoint.columnIndex+1)&&t.$content().hide()}}}_endResizing(){const e=this;let t;if(e.isResizing()){const n=e._columnHeadersView.getFilterRangeOverlayInstance();n&&(t=n.$element().closest("td"),e._columnHeadersView._updateFilterRangeOverlay({width:ye(t,!0)+1}),n.$content().show())}super._endResizing.apply(e,arguments)}},bg=r=>class extends r{updateFieldValue(e){return e.column.lookup&&(this._needUpdateLookupDataSource=!0),super.updateFieldValue.apply(this,arguments)}_afterSaveEditData(e){if(this._needUpdateLookupDataSource&&!e){var t;(t=this.getView("columnHeadersView"))===null||t===void 0||t.updateLookupDataSource()}return this._needUpdateLookupDataSource=!1,super._afterSaveEditData.apply(this,arguments)}_afterCancelEditData(){return this._needUpdateLookupDataSource=!1,super._afterCancelEditData.apply(this,arguments)}},Ig=r=>class extends r{init(){super.init(),this._dataController=this.getController("data"),this._applyFilterViewController=this.getController("applyFilter")}optionChanged(e){e.name==="filterRow"?(this._invalidate(),e.handled=!0):super.optionChanged(e)}_getToolbarItems(){const e=super._getToolbarItems();return this._prepareFilterItem().concat(e)}_prepareFilterItem(){const e=this,t=[];if(e._isShowApplyFilterButton()){const n=e.option("filterRow.applyFilterText"),a={widget:"dxButton",options:{icon:"apply-filter",disabled:!e._columnsController.getColumns().filter(d=>d.bufferedFilterValue!==void 0).length,onClick:function(){e._applyFilterViewController.applyFilter()},hint:n,text:n,onInitialized:function(d){g(d.element).addClass(e._getToolbarButtonClass("dx-apply-button"))}},showText:"inMenu",name:"applyFilterButton",location:"after",locateInMenu:"auto",sortIndex:10};t.push(a)}return t}_isShowApplyFilterButton(){const e=this.option("filterRow");return!!(e!=null&&e.visible)&&e.applyFilter==="onClick"}enableApplyButton(e){this.setToolbarItemDisabled("applyFilterButton",!e)}isVisible(){return super.isVisible()||this._isShowApplyFilterButton()}},Eg={defaultOptions:()=>({syncLookupFilterValues:!0,filterRow:{visible:!1,showOperationChooser:!0,showAllText:_.format("dxDataGrid-filterRowShowAllText"),resetOperationText:_.format("dxDataGrid-filterRowResetOperationText"),applyFilter:"auto",applyFilterText:_.format("dxDataGrid-applyFilterText"),operationDescriptions:{equal:_.format("dxDataGrid-filterRowOperationEquals"),notEqual:_.format("dxDataGrid-filterRowOperationNotEquals"),lessThan:_.format("dxDataGrid-filterRowOperationLess"),lessThanOrEqual:_.format("dxDataGrid-filterRowOperationLessOrEquals"),greaterThan:_.format("dxDataGrid-filterRowOperationGreater"),greaterThanOrEqual:_.format("dxDataGrid-filterRowOperationGreaterOrEquals"),startsWith:_.format("dxDataGrid-filterRowOperationStartsWith"),contains:_.format("dxDataGrid-filterRowOperationContains"),notContains:_.format("dxDataGrid-filterRowOperationNotContains"),endsWith:_.format("dxDataGrid-filterRowOperationEndsWith"),between:_.format("dxDataGrid-filterRowOperationBetween"),isBlank:_.format("dxFilterBuilder-filterOperationIsBlank"),isNotBlank:_.format("dxFilterBuilder-filterOperationIsNotBlank")},betweenStartText:_.format("dxDataGrid-filterRowOperationBetweenStartText"),betweenEndText:_.format("dxDataGrid-filterRowOperationBetweenEndText")}}),controllers:{applyFilter:vg},extenders:{controllers:{data:xg,columnsResizer:yg,editing:bg},views:{columnHeadersView:wg,headerPanel:Ig}}};T.registerModule("filterRow",Eg);const Sg={month:r=>zi.getMonthNames()[r-1],quarter:r=>zi.format(new Date(2e3,3*r-1),"quarter")};function Ql(r,e,t){return e=e||[],t=t||[],r.forEach(n=>{if(f(n.key)){const i=e.length===1;if(e.push(i?n.key-1:n.key),n.items)Ql(n.items,e,t);else{const o=new Date(Date.UTC.apply(Date,e));t.push(o)}e.pop()}else t.push(null)}),t}function Rg(r,e){const t=Ql(r),n=nn(t),i=v.getHeaderFilterGroupParameters(A({},e,{calculateCellValue:o=>o}));return Gn.queryByOptions(n,{group:i}).toArray()}function Tg(r){return(r==null?void 0:r.slice(-1))==="Z"||(r==null?void 0:r.slice(-3))==="'Z'"}const Vg=function(r,e,t){const n=yt.getGroupInterval(e),i=v.getFormatOptionsByColumn(e,"headerFilter");return n&&(i.groupInterval=n[t],v.isDateType(e.dataType)?i.format=Sg[n[t]]:e.dataType==="number"&&(i.getDisplayFormat=function(){const o={format:e.format,target:"headerFilter"},s=v.formatValue(r,o),l=r+n[t],a=v.formatValue(l,o);return s&&a?`${s} - ${a}`:""})),i};class Fg extends L.ViewController{init(){this._columnsController=this.getController("columns"),this._dataController=this.getController("data"),this._headerFilterView=this.getView("headerFilterView")}_updateSelectedState(e,t){let n=e.length;const i=t.filterType==="exclude";for(;n--;){const o=e[n];"items"in e[n]&&this._updateSelectedState(e[n].items,t),su(o,v.getIndexByKey(e[n].value,t.filterValues,null)>-1,i)}}_normalizeGroupItem(e,t,n){let i,o;const{path:s}=n,{valueSelector:l}=n,{displaySelector:a}=n,{column:d}=n;return l&&a?(i=l(e),o=a(e)):(i=e.key,o=i),Y(e)?e=y({},e):e={},s.push(i),s.length===1?e.value=s[0]:e.value=s.join("/"),e.text=this.getHeaderItemText(o,d,t,n.headerFilterOptions),e}getHeaderItemText(e,t,n,i){let o=v.formatValue(e,Vg(e,t,n));return o||(o=i.texts.emptyValue),o}_processGroupItems(e,t,n,i){const o=this;let s,l;const{column:a}=i,{lookup:d}=a,{level:u}=i;n=n||[],t=t||0,d&&(s=ce(d.displayExpr),l=ce(d.valueExpr));for(let c=0;c<e.length;c++)e[c]=o._normalizeGroupItem(e[c],t,{column:i.column,headerFilterOptions:i.headerFilterOptions,displaySelector:s,valueSelector:l,path:n}),"items"in e[c]&&(t===u||!f(e[c].value)?delete e[c].items:o._processGroupItems(e[c].items,t+1,n,i)),n.pop()}getDataSource(e){var t;const n=this._dataController.dataSource(),i=n==null?void 0:n.remoteOperations().grouping,o=v.getHeaderFilterGroupParameters(e,i),s=(t=e.headerFilter)===null||t===void 0?void 0:t.dataSource,l=this.option("headerFilter");let a=!1;const d={component:this.component};if(!n)return;if(f(s)&&!X(s))d.dataSource=Wn(s);else if(e.lookup)if(a=!0,this.option("syncLookupFilterValues")){this._currentColumn=e;const h=this._dataController.getCombinedFilter();this._currentColumn=null,d.dataSource=v.getWrappedLookupDataSource(e,n,h)}else d.dataSource=v.normalizeLookupDataSource(e.lookup);else{const h=Array.isArray(o)?o.length-1:0;this._currentColumn=e;const p=this._dataController.getCombinedFilter();this._currentColumn=null,d.dataSource={filter:p,group:o,useDefaultSearch:!0,load:m=>{const C=new E;return m.dataField=e.dataField||e.name,n.load(m).done(w=>{i&&Tg(e.serializationFormat)&&h>3&&(w=Rg(w,e)),c._processGroupItems(w,null,null,{level:h,column:e,headerFilterOptions:l}),C.resolve(w)}).fail(C.reject),C}}}X(s)&&s.call(e,d);const u=d.dataSource.postProcess,c=this;return d.dataSource.postProcess=function(h){let p=h;return a&&(p=p.filter(m=>m[e.lookup.valueExpr]!==null),this.pageIndex()===0&&!this.searchValue()&&(p=p.slice(0),p.unshift(null)),c._processGroupItems(p,null,null,{level:0,column:e,headerFilterOptions:l})),p=u&&u.call(this,p)||p,c._updateSelectedState(p,e),p},d.dataSource}getCurrentColumn(){return this._currentColumn}showHeaderFilterMenu(e,t){const n=this._columnsController,i=y(!0,{},this._columnsController.getColumns()[e]);if(i){const o=n.getVisibleIndex(e),l=(t?this.getView("headerPanel"):this.getView("columnHeadersView")).getColumnElements().eq(t?i.groupIndex:o);this.showHeaderFilterMenuBase({columnElement:l,column:i,applyFilter:!0,apply(){n.columnOption(e,{filterValues:this.filterValues,filterType:this.filterType})}})}}showHeaderFilterMenuBase(e){const t=this,{column:n}=e;if(n){const i=yt.getGroupInterval(n),o=t._dataController.dataSource(),s=o&&o.remoteOperations().filtering,l=e.onHidden;y(e,n,{type:i&&i.length>1?"tree":"list",remoteFiltering:s,onShowing:a=>{const d=a.component.$overlayContent().dxResizable("instance");d&&d.option("onResizeEnd",u=>{let c=this._columnsController.columnOption(e.dataField,"headerFilter");c=c||{},c.width=u.width,c.height=u.height,this._columnsController.columnOption(e.dataField,"headerFilter",c,!0)})},onHidden:()=>{l==null||l(),mo(this)}}),e.dataSource=t.getDataSource(e),e.isFilterBuilder&&(e.dataSource.filter=null,e.alignment="right"),t._headerFilterView.showHeaderFilterMenu(e.columnElement,e)}}hideHeaderFilterMenu(){this._headerFilterView.hideHeaderFilterMenu()}}const Og=r=>class extends Kr(r){_renderCellContent(e,t){const n=this;let i;const{column:o}=t;!o.command&&go(o)&&n.option("headerFilter.visible")&&t.rowType==="header"&&(i=n._applyColumnState({name:"headerFilter",rootElement:e,column:o,showColumnLines:n.option("showColumnLines")}),i&&n._subscribeToIndicatorEvent(i,o,"headerFilter")),super._renderCellContent.apply(this,arguments)}_subscribeToIndicatorEvent(e,t,n){n==="headerFilter"&&x.on(e,te,this.createAction(i=>{i.event.stopPropagation(),qr(e,this),this._headerFilterController.showHeaderFilterMenu(t.index,!1)}))}_updateIndicator(e,t,n){const i=super._updateIndicator(e,t,n);i&&this._subscribeToIndicatorEvent(i,t,n)}_updateHeaderFilterIndicators(){this.option("headerFilter.visible")&&this._updateIndicators("headerFilter")}_needUpdateFilterIndicators(){return!0}_columnOptionChanged(e){const{optionNames:t}=e,n=v.checkChanges(t,["filterValues","filterValue"]),i=v.checkChanges(t,["filterValues","filterType"]);(n||i)&&this._needUpdateFilterIndicators()&&this._updateHeaderFilterIndicators(),i||super._columnOptionChanged(e)}},Dg=r=>class extends Kr(r){_createGroupPanelItem(e,t){const n=this,i=super._createGroupPanelItem.apply(n,arguments);let o;return!t.command&&go(t)&&n.option("headerFilter.visible")&&(o=n._applyColumnState({name:"headerFilter",rootElement:i,column:{alignment:Zt(n.option("rtlEnabled")),filterValues:t.filterValues,allowHeaderFiltering:!0,caption:t.caption},showColumnLines:!0}),o&&x.on(o,te,n.createAction(s=>{const{event:l}=s;l.stopPropagation(),this._headerFilterController.showHeaderFilterMenu(t.index,!0)}))),i}},Pg=r=>class extends r{skipCalculateColumnFilters(){return!1}_calculateAdditionalFilter(){if(this.skipCalculateColumnFilters())return super._calculateAdditionalFilter();const e=[super._calculateAdditionalFilter()],t=this._columnsController.getVisibleColumns(null,!0),i=this._headerFilterController.getCurrentColumn();return b(t,(o,s)=>{let l;if(!(i&&i.index===s.index)&&go(s)&&s.calculateFilterExpression&&Array.isArray(s.filterValues)&&s.filterValues.length){let a=[];b(s.filterValues,(d,u)=>{Array.isArray(u)?l=u:(s.deserializeValue&&!v.isDateType(s.dataType)&&s.dataType!=="number"&&(u=s.deserializeValue(u)),l=s.createFilterExpression(u,"=","headerFilter")),l&&(l.columnIndex=s.index),a.push(l)}),a=v.combineFilters(a,"or"),e.push(s.filterType==="exclude"?["!",a]:a)}}),v.combineFilters(e)}},Ag={defaultOptions:()=>({syncLookupFilterValues:!0,headerFilter:{visible:!1,width:252,height:325,allowSelectAll:!0,search:{enabled:!1,timeout:500,mode:"contains",editorOptions:{}},texts:{emptyValue:_.format("dxDataGrid-headerFilterEmptyValue"),ok:_.format("dxDataGrid-headerFilterOK"),cancel:_.format("dxDataGrid-headerFilterCancel")}}}),controllers:{headerFilter:Fg},views:{headerFilterView:ru},extenders:{controllers:{data:Pg},views:{columnHeadersView:Og,headerPanel:Dg}}};T.registerModule("headerFilter",Ag);function kg(r,e){const t=g("<div>").addClass("dx-filterbuilder-range-start"),n=g("<div>").addClass("dx-filterbuilder-range-end");let i=r.value||[];const o=function(l){return l&&l.length>0?l[0]:null},s=function(l){return l&&l.length===2?l[1]:null};e.append(t),e.append(g("<span>").addClass("dx-filterbuilder-range-separator").text("–")),e.append(n),e.addClass("dx-filterbuilder-range"),this._editorFactory.createEditor.call(this,t,y({},r.field,r,{value:o(i),parentType:"filterBuilder",setValue(l){i=[l,s(i)],r.setValue(i)}})),this._editorFactory.createEditor.call(this,n,y({},r.field,r,{value:s(i),parentType:"filterBuilder",setValue(l){i=[o(i),l],r.setValue(i)}}))}function Qs(r,e){return{name:"between",caption:r,icon:"range",valueSeparator:"–",dataTypes:["number","date","datetime"],editorTemplate:kg.bind(e),notForLookup:!0}}const Bg={"=":"equal","<>":"notequal","<":"less","<=":"lessorequal",">":"greater",">=":"greaterorequal",notcontains:"doesnotcontain",contains:"contains",startswith:"startswith",endswith:"endswith",isblank:"isblank",isnotblank:"isnotblank"},Mg={"=":"equal","<>":"notEqual","<":"lessThan","<=":"lessThanOrEqual",">":"greaterThan",">=":"greaterThanOrEqual",startswith:"startsWith",contains:"contains",notcontains:"notContains",endswith:"endsWith",isblank:"isBlank",isnotblank:"isNotBlank",between:"between"},Jl={getIconByFilterOperation:r=>Bg[r],getNameByFilterOperation:r=>Mg[r]},Ng={number:["=","<>","<",">","<=",">=","isblank","isnotblank"],string:["contains","notcontains","startswith","endswith","=","<>","isblank","isnotblank"],date:["=","<>","<",">","<=",">=","isblank","isnotblank"],datetime:["=","<>","<",">","<=",">=","isblank","isnotblank"],boolean:["=","<>","isblank","isnotblank"],object:["isblank","isnotblank"]},Lg={date:"shortDate",datetime:"shortDateShortTime"},Hg=["=","<>","isblank","isnotblank"],zg=["caption","customizeText","dataField","dataType","editorTemplate","falseText","editorOptions","filterOperations","format","lookup","trueText","calculateFilterExpression","name"];function Wg(r,e){const t=r.format||Lg[r.dataType];return lu.format(e,t)}function it(r){return r&&r.length>1&&r[0]==="!"&&!ne(r)}function qe(r){return it(r)?r[1]:r}function $g(r,e){return it(r)?r[1]=e:r=e,r}function Gg(r,e){(function(t){return t.indexOf("!")!==-1})(e)?it(r)||function(t){const n=t.slice(0);t.length=0,t.push("!",n)}(r):it(r)&&function(t){const n=qe(t);t.length=0,[].push.apply(t,n)}(r)}function Kg(r,e){Gg(r,e);const t=qe(r);let n;return e=function(i){return i.indexOf("!")===-1?i:i.substring(1)}(e),function(i,o){for(n=0;n<i.length;n++)Array.isArray(i[n])||(i[n]=o)}(t,e),r}function Ug(r,e){const t=st(r);return e.filter(n=>n.value===t)[0]}function Zl(r){if(ne(r))return"and";let e="";for(let t=0;t<r.length;t++){const n=r[t];if(!Array.isArray(n)){if(e&&e!==n)throw $n.Error("E4019");n!=="!"&&(e=n)}}return e}function st(r){const e=qe(r);let t=Zl(e);return t||(t="and"),e!==r&&(t=`!${t}`),t}function jg(r){return r.lookup&&Hg||Ng[r.dataType||"string"]}function qg(r){return Array.isArray(r)&&r.length}function ea(r){const e=qg(r.filterOperations)?r.filterOperations:jg(r);return y([],e)}function Zi(r,e){const t=Jl.getNameByFilterOperation(r);return e&&e[t]?e[t]:t}function Xg(r,e){for(let t=0;t<e.length;t++)if(e[t].value===r)return e[t];throw new oe.Error("E1048",r)}function ke(r,e){const t=r.filter(n=>n.name===e);return t.length?t[0]:null}function Yg(r,e,t){const n=ea(r),i=!!r.lookup;return t.forEach(o=>{if(!r.filterOperations&&n.indexOf(o.name)===-1){const s=o&&o.dataTypes;!(i?!!o.notForLookup:!1)&&s&&s.indexOf(r.dataType||"string")>=0&&n.push(o.name)}}),n.map(o=>{const s=ke(t,o);return s?{icon:s.icon||"icon-none",text:s.caption||Ki(s.name),value:s.name,isCustom:!0}:{icon:Jl.getIconByFilterOperation(o)||"icon-none",text:Zi(o,e),value:o}})}function Oo(r){return r.defaultFilterOperation||ea(r)[0]}function Qg(r,e){const t=[r.dataField,"",""],n=Oo(r);return to(t,n,e),t}function eo(r,e){const t=qe(r),n=t.indexOf(e);return t.splice(n,1),t.length!==1&&t.splice(n,1),r}function ta(r){const e=Do(r),t=e?Po(r):r;return e?["!",[t]]:[t]}function Nn(r,e){const t=qe(e),n=st(t);return t.length===1?t.unshift(r):t.push(r,n),e}function Ln(r,e){for(let n=0;n<e.length;n++)if(e[n].name===r||e[n].dataField.toLowerCase()===r.toLowerCase())return e[n];const t=la(e,!0).filter(n=>n.dataField.toLowerCase()===r.toLowerCase());if(t.length>0)return t[0];throw new oe.Error("E1047",r)}function Xe(r){return Array.isArray(r)?r.length<2||Array.isArray(r[0])||Array.isArray(r[1]):!1}function ne(r){return Array.isArray(r)?r.length>1&&!Array.isArray(r[0])&&!Array.isArray(r[1]):!1}function Js(r,e,t){t=t||"and";const n=Zl(r).toLowerCase()||t;let i=[];for(let o=0;o<r.length;o++)Xe(r[o])?(i.push(Ao(r[o],e,t)),i=Oi(i,n)):ne(r[o])&&(i.push(Hn(r[o],e)),i=Oi(i,n));return i.length===0&&(i=Oi(i,n)),i}function Jg(r,e){const t=ke(e,r[1]);return t&&t.name===r[1]}function Hn(r,e){return Jg(r,e)||r.length<3&&(r[2]=r[1],r[1]="="),r}function Do(r){return r.indexOf("not")!==-1}function Po(r){return r.substring(3).toLowerCase()}function Fi(r,e){const t=Do(e);return e=t?Po(e):e,t?["!",r,e]:[r,e]}function Oi(r,e){const t=Do(e);e=t?Po(e):e,r.push(e);let n=r;return t&&(n=["!",n]),n}function Ao(r,e,t){return t=t||"and",r?(r=y(!0,[],r),ne(r)?Fi(Hn(r,e),t):it(r)?["!",ne(r[1])?Fi(Hn(r[1],e),t):it(r[1])?Fi(Ao(r[1],e),t):Js(r[1],e,t)]:Js(r,e,t)):ta(t)}function Zg(r){return r.reduce((e,t)=>{if(f(t.dataField)){const n={};for(const i in t)t[i]&&zg.includes(i)&&(n[i]=t[i]);n.defaultCalculateFilterExpression=yt.defaultCalculateFilterExpression,f(n.dataType)||(n.dataType="string"),f(n.trueText)||(n.trueText=_.format("dxDataGrid-trueText")),f(n.falseText)||(n.falseText=_.format("dxDataGrid-falseText")),e.push(n)}return e},[])}function Zs(r,e,t,n){const i=Ln(r[0],e),o=Hn(r,t),s=t.length&&ke(t,o[1]);return s&&s.calculateFilterExpression?s.calculateFilterExpression.apply(s,[o[2],i,e]):i.createFilterExpression?i.createFilterExpression.apply(i,[o[2],o[1],n]):i.calculateFilterExpression?i.calculateFilterExpression.apply(i,[o[2],o[1],n]):i.defaultCalculateFilterExpression.apply(i,[o[2],o[1],n])}function wt(r,e,t,n){if(!f(r))return null;if(it(r))return["!",wt(r[1],e,t,n)];const i=qe(r);if(ne(i))return Zs(i,e,t,n)||null;let o=[],s;const l=st(i);for(let a=0;a<i.length;a++)Xe(i[a])?(s=wt(i[a],e,t,n),s&&(a&&o.push(l),o.push(s))):ne(i[a])&&(s=Zs(i[a],e,t,n),s&&(o.length&&o.push(l),o.push(s)));return o.length===1&&(o=o[0]),o.length?o:null}function zt(r){const e=qe(r);let t;if(e.length===0)return null;const n=[];for(t=0;t<e.length;t++)if(Xe(e[t])){const i=zt(e[t]);i?e[t]=i:n.push(e[t])}else ne(e[t])&&(tm(e[t])||n.push(e[t]));for(t=0;t<n.length;t++)eo(e,n[t]);return e.length===1||(e.splice(e.length-1,1),e.length===1&&(r=$g(r,e[0])),r.length===0)?null:r}function na(r,e,t){if(e===""){t("");return}const{lookup:n}=r;if(n.items)t(n.calculateCellValue(e)||"");else{const i=X(n.dataSource)?n.dataSource({}):n.dataSource;new Kt(i).loadSingle(n.valueExpr,e).done(s=>{let l="";s&&(l=n.displayExpr?ce(n.displayExpr)(s):s),r.customizeText&&(l=r.customizeText({value:e,valueText:l})),t(l)}).fail(()=>{t("")})}}function ia(r,e,t,n,i){let o;return e===!0?o=r.trueText||_.format("dxDataGrid-trueText"):e===!1?o=r.falseText||_.format("dxDataGrid-falseText"):o=Wg(r,e),r.customizeText&&(o=r.customizeText.call(r,{value:e,valueText:o,target:n})),t&&t.customizeText&&(o=t.customizeText.call(t,{value:e,valueText:o,field:r,target:n},i)),o}function em(r,e,t,n){const i={values:e};return e.map(o=>ia(r,o,t,n,i))}function Di(r){return r===""||r===null}function oa(r,e,t){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"filterBuilder";if(Di(e))return"";if(Array.isArray(e)){const i=new E;return F.apply(this,em(r,e,t,n)).done(function(){for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];const a=s.some(d=>!Di(d))?s.map(d=>Di(d)?"?":d):"";i.resolve(a)}),i}return ia(r,e,t,n)}function er(r,e){return r.some(t=>t.dataField===e)}function sa(r,e,t){const{dataField:n}=t;ko(n)&&(t.parentId=aa(n),!er(e,t.parentId)&&!er(r,t.parentId)&&sa(r,e,{id:t.parentId,dataType:"object",dataField:t.parentId,caption:ra(t.parentId,!0),filterOperations:["isblank","isnotblank"],defaultCalculateFilterExpression:yt.defaultCalculateFilterExpression})),e.push(t)}function ra(r,e){let t="";if(e)r=r.substring(r.lastIndexOf(".")+1);else if(ko(r))return r.split(".").forEach((n,i,o)=>{t+=Ki(n),i!==o.length-1&&(t+=".")}),t;return Ki(r)}function la(r,e){const t=[];for(let n=0;n<r.length;n++){const i=y(!0,{caption:ra(r[n].dataField,e)},r[n]);i.id=i.name||i.dataField,e?sa(r,t,i):t.push(i)}return t}function ko(r){return r.lastIndexOf(".")!==-1}function aa(r){return r.substring(0,r.lastIndexOf("."))}function da(r,e){if(ko(r.dataField)){const t=aa(r.dataField);for(let n=0;n<e.length;n++)if(e[n].dataField===t)return`${da(e[n],e)}.${r.caption}`}return r.caption}function to(r,e,t){let n=ke(t,e);return n?(n.hasValue===!1?(r[1]=e,r.length=2):(r[1]=e,r[2]=""),r):(e==="isblank"?(r[1]="=",r[2]=null):e==="isnotblank"?(r[1]="<>",r[2]=null):(n=ke(t,r[1]),(n||r.length===2||r[2]===null)&&(r[2]=""),r[1]=e),r)}function tr(r){let e;return r[2]===null?r[1]==="="?e="isblank":e="isnotblank":e=r[1],e}function tm(r){return r[2]!==""}function nm(r,e,t){const n=y(!0,[],r);let i=-1;return n.some((o,s)=>{if(o.name==="between")return i=s,!0}),i!==-1?n[i]=y(Qs(e,t),n[i]):n.unshift(Qs(e,t)),n}function Qt(r,e){return r[0]===e}function no(r,e){return!r||r.length===0?null:ne(r)?Qt(r,e)?null:r:ua(r,[e],!1)}function ua(r,e,t){const n=[];return r.forEach(i=>{ne(i)?Qt(i,e[0])?t?(n.push(e),t=!1):n.splice(n.length-1,1):n.push(i):(n.length||Xe(i))&&n.push(i)}),n.length===0?null:(t&&(n.push("and"),n.push(e)),n.length===1?n[0]:n)}function nr(r,e){return r===null||r.length===0?e:ne(r)?Qt(r,e[0])?e:[r,"and",e]:st(r)!=="and"?[e,"and",r]:ua(r,e,!0)}function im(r,e){return r===null||r.length===0?[]:ne(r)?Qt(r,e)?[r]:[]:st(r)!=="and"?[]:r.filter(i=>ne(i)&&Qt(i,e))}function ca(r,e){return r===null||r.length===0?!1:ne(r)?r[0]===e:r.some(t=>(ne(t)||Xe(t))&&ca(t,e))}const io=function(r,e,t){if(Array.isArray(e)){const n=e.length-1;r.empty(),e.forEach((i,o)=>{g("<span>").addClass("dx-filterbuilder-text-part").text(i).appendTo(r),o!==n&&g("<span>").addClass("dx-filterbuilder-text-separator").text(t&&t.valueSeparator?t.valueSeparator:"|").addClass("dx-filterbuilder-text-separator-empty").appendTo(r)})}else e?r.text(e):r.text(_.format("dxFilterBuilder-enterValueText"))};function ha(r){const e=function(i,o){return o?`${o}/${i}`:i},t=function(i,o){let s=[];return i.forEach(l=>{if(l.items){const a=t(l.items,e(l.text,o));s=s.concat(a)}l.selected&&s.push(e(l.text,o))}),s},n=r&&r.getController("headerFilter");return{dataTypes:["string","date","datetime","number","boolean","object"],calculateFilterExpression:function(i,o,s){const l=[],a=i.length-1;return i&&i.forEach((d,u)=>{if(ne(d)||Xe(d)){const c=wt(d,s,[],"headerFilter");l.push(c)}else{const c=wt([o.dataField,"=",d],s,[],"headerFilter");l.push(c)}u!==a&&l.push("or")}),l.length===1?l[0]:l},editorTemplate(i,o){const s=g("<div>").addClass("dx-filterbuilder-item-value-text").appendTo(o),l=y(!0,{},r.columnOption(i.field.dataField));return io(s,i.text&&i.text.split("|")),l.filterType="include",l.filterValues=i.value?i.value.slice():[],n.showHeaderFilterMenuBase({columnElement:s,column:l,apply(){a=this.filterValues,i.setValue(a);var a;n.hideHeaderFilterMenu(),i.closeEditor()},onHidden(){i.closeEditor()},isFilterBuilder:!0}),o},customizeText:function(i,o){o=o||{};const{value:s}=i;let l=r.columnOption(i.field.dataField);const a=l&&l.headerFilter,d=l&&l.lookup,u=o.values||[s];if(a&&a.dataSource||d&&d.dataSource){const h=new E,p=o.items||new E;if(!o.items){l=y({},l,{filterType:"include",filterValues:u});const m=n.getDataSource(l);m.paginate=!1;const C=new Kt(m),w=C.store().key();if(w){const{values:S}=o;if(S&&S.length>1){const V=S.reduce((O,P)=>(O.length&&O.push("or"),O.push([w,"=",P]),O),[]);C.filter(V)}else C.filter([w,"=",i.value])}else i.field.calculateDisplayValue&&oe.log("W1017");o.items=p,C.load().done(p.resolve)}return p.done(m=>{const C=u.indexOf(i.value);h.resolve(t(m,null)[C])}),h}return n.getHeaderItemText(s,l,0,r.option("headerFilter"))}}}function om(r){return y(ha(r),{name:"anyof",icon:"selectall",caption:_.format("dxFilterBuilder-filterOperationAnyOf")})}function sm(r){const e=ha(r);return y({},e,{calculateFilterExpression(t,n,i){const o=e.calculateFilterExpression(t,n,i);return!o||o.length===0?null:o[0]==="!"?o:["!",o]},name:"noneof",icon:"unselectall",caption:_.format("dxFilterBuilder-filterOperationNoneOf")})}const rm=["=","<>","<","<=",">",">=","notcontains","contains","startswith","endswith","between"];function Te(r){return r.name||r.dataField}function lm(r){r.forEach(e=>{const t=Te(e);if(!f(t)&&e.allowFiltering)throw new oe.Error("E1049",e.caption)})}const Pi=function(){return{filterType:"include",filterValues:void 0}},pa=function(r){const e=r.filterValues||[];return!yt.getGroupInterval(r)&&!(r.headerFilter&&r.headerFilter.dataSource)||e.length===1&&e[0]===null},am=function(r,e){if(!r)return Pi();let t;const n=r[1],i=r[2],o=Array.isArray(i);if(!o&&!pa(e))return Pi();switch(n){case"anyof":case"=":t="include";break;case"noneof":case"<>":t="exclude";break;default:return Pi()}return{filterType:t,filterValues:o?i:[i]}},ir=function(r){const e=r.filterValue;if(f(e)){const t=r.selectedFilterOperation||r.defaultFilterOperation||Oo(r);return[Te(r),t,r.filterValue]}return null},or=function(r){let e,t;const{filterValues:n}=r;return n?(n.length===1&&pa(r)&&!Array.isArray(n[0])?(r.filterType==="exclude"?e="<>":e="=",t=n[0]):(r.filterType==="exclude"?e="noneof":e="anyof",t=n),[Te(r),e,t]):null},sr=function(r,e,t){const n=am(t,e);r.columnOption(Te(e),n)},rr=function(r,e,t){let n,i=t==null?void 0:t[1];const o=t==null?void 0:t[2],s=e.filterOperations||e.defaultFilterOperations;(!s||s.indexOf(i)>=0||i===e.defaultFilterOperation)&&rm.includes(i)&&o!==null?(i===e.defaultFilterOperation&&!f(e.selectedFilterOperation)&&(i=e.selectedFilterOperation),n={filterValue:o,selectedFilterOperation:i}):n={filterValue:void 0,selectedFilterOperation:void 0},r.columnOption(Te(e),n)};class dm extends L.Controller{init(){this._dataController=this.getController("data"),this._columnsController=this.getController("columns"),this._dataController.isFilterSyncActive()&&(this._columnsController.isAllDataTypesDefined()?this._initSync():this._dataController.dataSourceChanged.add(()=>this._initSync()))}publicMethods(){return["getCustomFilterOperations"]}syncFilterValue(){const e=this,t=this._columnsController.getFilteringColumns();this._skipSyncColumnOptions=!0,t.forEach(n=>{const i=im(e.option("filterValue"),Te(n));if(i.length===1){const o=i[0];sr(this._columnsController,n,o),rr(this._columnsController,n,o)}else f(n.filterValues)&&sr(this._columnsController,n,null),f(n.filterValue)&&rr(this._columnsController,n,null)}),this._skipSyncColumnOptions=!1}_initSync(){const e=this._columnsController.getColumns(),t=this._dataController.pageIndex();if(lm(e),!this.option("filterValue")){const n=this._columnsController.getFilteringColumns(),i=this.getFilterValueFromColumns(n);this._silentOption("filterValue",i)}this.syncFilterValue(),this._dataController.pageIndex(t)}_getSyncFilterRow(e,t){const n=ir(t);return f(n)?nr(e,n):no(e,Te(t))}_getSyncHeaderFilter(e,t){const n=or(t);return n?nr(e,n):no(e,Te(t))}getFilterValueFromColumns(e){if(!this._dataController.isFilterSyncActive())return null;const t=["and"];return e&&e.forEach(n=>{const i=or(n),o=ir(n);i&&Nn(i,t),o&&Nn(o,t)}),zt(t)}syncFilterRow(e,t){this.option("filterValue",this._getSyncFilterRow(this.option("filterValue"),e))}syncHeaderFilter(e){this.option("filterValue",this._getSyncHeaderFilter(this.option("filterValue"),e))}getCustomFilterOperations(){const e=this.option("filterBuilder.customOperations")??[];return[om(this.component),sm(this.component)].concat(e)}}const um=r=>class extends r{optionChanged(e){switch(e.name){case"filterValue":this._applyFilter(),this.isFilterSyncActive()&&this._filterSyncController.syncFilterValue(),e.handled=!0;break;case"filterSyncEnabled":e.handled=!0;break;case"columns":if(this.isFilterSyncActive()){const t=this._columnsController.getColumnByPath(e.fullName);if(t&&!this._filterSyncController._skipSyncColumnOptions){const n=this._parseColumnPropertyName(e.fullName);this._filterSyncController._skipSyncColumnOptions=!0,n==="filterType"?(e.value==="exclude"||e.previousValue==="exclude")&&this._filterSyncController.syncHeaderFilter(t):n==="filterValues"?this._filterSyncController.syncHeaderFilter(t):["filterValue","selectedFilterOperation"].includes(n)&&this._filterSyncController.syncFilterRow(t,t.filterValue),this._filterSyncController._skipSyncColumnOptions=!1}}super.optionChanged(e);break;default:super.optionChanged(e)}}isFilterSyncActive(){const e=this.option("filterSyncEnabled");return e==="auto"?this.option("filterPanel.visible"):e}skipCalculateColumnFilters(){return(f(this.option("filterValue"))||this._filterSyncController._skipSyncColumnOptions)&&this.isFilterSyncActive()}_calculateAdditionalFilter(){if(this.option("filterPanel.filterEnabled")===!1)return super._calculateAdditionalFilter();const e=[super._calculateAdditionalFilter()],t=this._columnsController.getFilteringColumns();let n=this.option("filterValue");if(this.isFilterSyncActive()){const s=this._headerFilterController.getCurrentColumn(),l=this._applyFilterController.getCurrentColumnForFiltering(),a=s||l;(s||f(l==null?void 0:l.filterValue))&&n&&(n=no(n,Te(a)))}const i=this._filterSyncController.getCustomFilterOperations(),o=wt(n,t,i,"filterBuilder");return o&&e.push(o),v.combineFilters(e)}_parseColumnPropertyName(e){const t=e.match(/.*\.(.*)/);return t?t[1]:null}clearFilter(e){this.component.beginUpdate(),arguments.length>0?(e==="filterValue"&&this.option("filterValue",null),super.clearFilter(e)):(this.option("filterValue",null),super.clearFilter()),this.component.endUpdate()}_applyFilter(){return this._filterSyncController._skipSyncColumnOptions?new E().resolve():super._applyFilter.apply(this,arguments)}},cm=r=>class extends r{optionChanged(e){e.name==="filterValue"?this._updateHeaderFilterIndicators():super.optionChanged(e)}_isHeaderFilterEmpty(e){return this._dataController.isFilterSyncActive()?!ca(this.option("filterValue"),Te(e)):super._isHeaderFilterEmpty(e)}_needUpdateFilterIndicators(){return!this._dataController.isFilterSyncActive()}},hm={defaultOptions:()=>({filterValue:null,filterSyncEnabled:"auto"}),controllers:{filterSync:dm},extenders:{controllers:{data:um},views:{columnHeadersView:cm}}};T.registerModule("filterSync",hm);const lr="dx-filterbuilder-action-icon",mn="dx-state-active",ar="filterBuilder",pm=[{name:"onEditorPreparing",config:{excludeValidators:["disabled","readOnly"],category:"rendering"}},{name:"onEditorPrepared",config:{excludeValidators:["disabled","readOnly"],category:"rendering"}},{name:"onValueChanged",config:{excludeValidators:["disabled","readOnly"]}}],dr={and:"and",or:"or",notAnd:"!and",notOr:"!or"},gm=Ml(class{});class ga extends Dr{_getDefaultOptions(){return y(super._getDefaultOptions(),{onEditorPreparing:null,onEditorPrepared:null,onValueChanged:null,fields:[],groupOperations:["and","or","notAnd","notOr"],maxGroupLevel:void 0,value:null,allowHierarchicalFields:!1,groupOperationDescriptions:{and:_.format("dxFilterBuilder-and"),or:_.format("dxFilterBuilder-or"),notAnd:_.format("dxFilterBuilder-notAnd"),notOr:_.format("dxFilterBuilder-notOr")},customOperations:[],closePopupOnTargetScroll:!0,filterOperationDescriptions:{between:_.format("dxFilterBuilder-filterOperationBetween"),equal:_.format("dxFilterBuilder-filterOperationEquals"),notEqual:_.format("dxFilterBuilder-filterOperationNotEquals"),lessThan:_.format("dxFilterBuilder-filterOperationLess"),lessThanOrEqual:_.format("dxFilterBuilder-filterOperationLessOrEquals"),greaterThan:_.format("dxFilterBuilder-filterOperationGreater"),greaterThanOrEqual:_.format("dxFilterBuilder-filterOperationGreaterOrEquals"),startsWith:_.format("dxFilterBuilder-filterOperationStartsWith"),contains:_.format("dxFilterBuilder-filterOperationContains"),notContains:_.format("dxFilterBuilder-filterOperationNotContains"),endsWith:_.format("dxFilterBuilder-filterOperationEndsWith"),isBlank:_.format("dxFilterBuilder-filterOperationIsBlank"),isNotBlank:_.format("dxFilterBuilder-filterOperationIsNotBlank")}})}_optionChanged(e){switch(e.name){case"closePopupOnTargetScroll":break;case"onEditorPreparing":case"onEditorPrepared":case"onValueChanged":this._initActions();break;case"customOperations":this._initCustomOperations(),this._invalidate();break;case"fields":case"maxGroupLevel":case"groupOperations":case"allowHierarchicalFields":case"groupOperationDescriptions":case"filterOperationDescriptions":this._invalidate();break;case"value":if(e.value!==e.previousValue){const t=this._disableInvalidateForValue;t||(this._initModel(),this._invalidate()),this._disableInvalidateForValue=!1,this.executeAction("onValueChanged",{value:e.value,previousValue:e.previousValue}),this._disableInvalidateForValue=t}break;default:super._optionChanged(e)}}getFilterExpression(){const e=this._getNormalizedFields(),t=y(!0,[],this._model);return wt(zt(t),e,this._customOperations,ar)}_getNormalizedFields(){return Zg(this.option("fields"))}_updateFilter(){this._disableInvalidateForValue=!0;const e=y(!0,[],this._model),t=zt(e),n=zt(this._getModel(this.option("value")));JSON.stringify(n)!==JSON.stringify(t)&&this.option("value",t),this._disableInvalidateForValue=!1,this._fireContentReadyAction()}_init(){this._initCustomOperations(),this._initModel(),this._initEditorFactory(),this._initActions(),super._init()}_initEditorFactory(){this._editorFactory=new gm}_initCustomOperations(){this._customOperations=nm(this.option("customOperations"),this.option("filterOperationDescriptions.between"),this)}_getDefaultGroupOperation(){var e;return((e=this.option("groupOperations"))===null||e===void 0?void 0:e[0])??dr.and}_getModel(e){return Ao(e,this._customOperations,this._getDefaultGroupOperation())}_initModel(){this._model=this._getModel(this.option("value"))}_initActions(){const e=this;e._actions={},pm.forEach(t=>{const n=y({},t.config);e._actions[t.name]=e._createActionByOption(t.name,n)})}executeAction(e,t){const n=this._actions[e];return n&&n(t)}_initMarkup(){this.$element().addClass("dx-filterbuilder"),super._initMarkup(),this._addAriaAttributes(this.$element(),_.format("dxFilterBuilder-filterAriaRootElement"),"tree"),this._createGroupElementByCriteria(this._model).appendTo(this.$element())}_addAriaAttributes(e,t,n,i,o,s){if(!e||!e.length)return;const l={role:n};t&&(e.text().length>0?l.title=t:l["aria-label"]=t),f(i)&&(l["aria-haspopup"]=`${i}`),f(o)&&(l["aria-expanded"]=`${o}`),f(s)&&(l["aria-level"]=`${s}`),e.attr(l)}_createConditionElement(e,t,n){return g("<div>").addClass("dx-filterbuilder-group").append(this._createConditionItem(e,t,n))}_createGroupElementByCriteria(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this._createGroupElement(e,t,n),o=i.find(".dx-filterbuilder-group-content"),s=qe(e);for(let l=0;l<s.length;l++){const a=s[l];Xe(a)?this._createGroupElementByCriteria(a,e,n+1).appendTo(o):ne(a)&&this._createConditionElement(a,e,`${n+1}`).appendTo(o)}return i}_createGroupElement(e,t,n){const i=new ot,o=g("<div>").addClass("dx-filterbuilder-group-item"),s=g("<div>").addClass("dx-filterbuilder-group-content").attr("id",`${i}`),l=g("<div>").addClass("dx-filterbuilder-group").append(o).append(s);return t!=null&&this._createRemoveButton(()=>{eo(t,e),l.remove(),this._updateFilter()},"group").appendTo(o),this._addAriaAttributes(o,_.format("dxFilterBuilder-filterAriaGroupItem"),"treeitem",null,null,`${n+1}`),this._addAriaAttributes(s,"","group"),o.attr("aria-owns",`${i}`),this._createGroupOperationButton(e).appendTo(o),this._createAddButton(()=>{const a=ta(this._getDefaultGroupOperation());Nn(a,e),this._createGroupElement(a,e,n+1).appendTo(s),this._updateFilter()},()=>{const a=this.option("fields")[0],d=Qg(a,this._customOperations);Nn(d,e),this._createConditionElement(d,e,n+1).appendTo(s),this._updateFilter()},n).appendTo(o),l}_createButton(e){return g("<div>").text(e)}_createGroupOperationButton(e){const t=this._getGroupOperations(e);let n=Ug(e,t);const i=n.text,o=t&&t.length<2?this._createButton(i).addClass("dx-state-disabled"):this._createButtonWithMenu({caption:i,menu:{items:t,displayExpr:"text",keyExpr:"value",onItemClick:s=>{n!==s.itemData&&(Kg(e,s.itemData.value),o.text(s.itemData.text),n=s.itemData,this._updateFilter())},onContentReady(s){s.component.selectItem(n)},cssClass:"dx-filterbuilder-group-operations"}});return this._addAriaAttributes(o,_.format("dxFilterBuilder-filterAriaOperationButton"),"combobox",!0,!1),o.addClass("dx-filterbuilder-text").addClass("dx-filterbuilder-group-operation").attr("tabindex",0)}_createButtonWithMenu(e){const t=this,n=function(){t.$element().find(`.${mn}`).removeClass(mn).attr("aria-expanded","false"),t.$element().find(".dx-overlay .dx-treeview").remove(),t.$element().find(".dx-overlay").remove()},i=this.option("rtlEnabled"),o=i?"right":"left",s=this._createButton(e.caption);y(e.menu,{focusStateEnabled:!0,selectionMode:"single",onItemClick:(l=e.menu.onItemClick,function(a){l(a),a.event.type==="dxclick"&&n()}),onHiding(){s.removeClass(mn).attr("aria-expanded","false")},position:{my:`${o} top`,at:`${o} bottom`,offset:"0 1",of:s,collision:"flip"},animation:null,onHidden(){n()},cssClass:`dx-filterbuilder-overlay ${e.menu.cssClass}`,rtlEnabled:i});var l;return e.popup={onShown(a){const d=g(a.component.content()).find(".dx-treeview"),u=d.dxTreeView("instance");x.on(d,"keyup keydown",c=>{const h=xe(c);(c.type==="keydown"&&h==="tab"||c.type==="keyup"&&(h==="escape"||h==="enter"))&&(a.component.hide(),x.trigger(e.menu.position.of,"focus"))}),u.focus(),u.option("focusedElement",null)}},this._subscribeOnClickAndEnterKey(s,()=>{n(),t._createPopupWithTreeView(e,t.$element()),s.addClass(mn).attr("aria-expanded","true")}),s}_hasValueButton(e){const t=ke(this._customOperations,e[1]);return t?t.hasValue!==!1:e[2]!==null}_createOperationButtonWithMenu(e,t){const n=this,i=Yg(t,this.option("filterOperationDescriptions"),this._customOperations);let o=Xg(tr(e),i);const s=this._createButtonWithMenu({caption:o.text,menu:{items:i,displayExpr:"text",onItemRendered(l){l.itemData.isCustom&&g(l.itemElement).addClass("dx-filterbuilder-menu-custom-operation")},onContentReady(l){l.component.selectItem(o)},onItemClick:l=>{if(o!==l.itemData){o=l.itemData,to(e,o.value,n._customOperations);const a=s.siblings().filter(".dx-filterbuilder-item-value");n._hasValueButton(e)?(a.length!==0&&a.remove(),n._createValueButton(e,t).appendTo(s.parent())):a.remove(),s.text(o.text),this._updateFilter()}},cssClass:"dx-filterbuilder-operations"}}).addClass("dx-filterbuilder-text").addClass("dx-filterbuilder-item-operation").attr("tabindex",0);return this._addAriaAttributes(s,_.format("dxFilterBuilder-filterAriaItemOperation"),"combobox",!0,!1),s}_createOperationAndValueButtons(e,t,n){this._createOperationButtonWithMenu(e,t).appendTo(n),this._hasValueButton(e)&&this._createValueButton(e,t).appendTo(n)}_createFieldButtonWithMenu(e,t,n){const i=this,o=this.option("allowHierarchicalFields"),s=la(e,o);let l=Ln(n.name||n.dataField,s);const a=function(u,c){return o?da(u,c):u.caption};t[0]=l.name||l.dataField;const d=this._createButtonWithMenu({caption:a(l,s),menu:{items:s,dataStructure:"plain",keyExpr:"id",parentId:"parentId",displayExpr:"caption",onItemClick:u=>{if(l!==u.itemData){l=u.itemData,t[0]=l.name||l.dataField,t[2]=l.dataType==="object"?null:"",to(t,Oo(l),i._customOperations),d.siblings().filter(".dx-filterbuilder-text").remove(),i._createOperationAndValueButtons(t,l,d.parent());const c=a(l,u.component.option("items"));d.text(c),this._updateFilter()}},onContentReady(u){u.component.selectItem(l)},cssClass:"dx-filterbuilder-fields"}}).addClass("dx-filterbuilder-text").addClass("dx-filterbuilder-item-field").attr("tabindex",0);return this._addAriaAttributes(d,_.format("dxFilterBuilder-filterAriaItemField"),"combobox",!0,!1),d}_createConditionItem(e,t,n){const i=g("<div>").addClass("dx-filterbuilder-group-item"),o=this._getNormalizedFields(),s=Ln(e[0],o);return this._addAriaAttributes(i,"","treeitem",null,null,n),this._createRemoveButton(()=>{eo(t,e),i.parent().children().length===1?i.parent().remove():i.remove(),this._updateFilter()},"condition").appendTo(i),this._createFieldButtonWithMenu(o,e,s).appendTo(i),this._createOperationAndValueButtons(e,s,i),i}_getGroupOperations(e){let t=this.option("groupOperations");const n=this.option("groupOperationDescriptions");return(!t||!t.length)&&(t=[st(e).replace("!","not")]),t.map(i=>({text:n[i],value:dr[i]}))}_createRemoveButton(e,t){const n=g("<div>").addClass(lr).addClass("dx-icon-remove").addClass("dx-filterbuilder-action").attr("tabindex",0);if(t){const i=_.format("dxFilterBuilder-filterAriaRemoveButton",t);this._addAriaAttributes(n,i,"button")}return this._subscribeOnClickAndEnterKey(n,e),n}_createAddButton(e,t,n){let i;const o=this.option("maxGroupLevel");return f(o)&&n>=o?(i=this._createButton(),this._subscribeOnClickAndEnterKey(i,t)):i=this._createButtonWithMenu({menu:{items:[{caption:_.format("dxFilterBuilder-addCondition"),click:t},{caption:_.format("dxFilterBuilder-addGroup"),click:e}],displayExpr:"caption",onItemClick(s){s.itemData.click()},cssClass:"dx-filterbuilder-add-condition"}}),this._addAriaAttributes(i,_.format("dxFilterBuilder-filterAriaAddButton"),"combobox",!0,!1),i.addClass(lr).addClass("dx-icon-plus").addClass("dx-filterbuilder-action").attr("tabindex",0)}_createValueText(e,t,n){const i=this,o=g("<div>").html("&nbsp;").addClass("dx-filterbuilder-item-value-text").attr("tabindex",0).appendTo(n);this._addAriaAttributes(o,_.format("dxFilterBuilder-filterAriaItemValue"),"button",!0);const s=e[2],l=ke(i._customOperations,e[1]);return!l&&t.lookup?na(t,s,a=>{io(o,a)}):F(oa(t,s,l)).done(a=>{io(o,a,l)}),i._subscribeOnClickAndEnterKey(o,a=>{a.type==="keyup"&&a.stopPropagation(),i._createValueEditorWithEvents(e,t,n)}),o}_updateConditionValue(e,t,n){e[2]!==t&&(e[2]=t),n(),this._updateFilter()}_addDocumentKeyUp(e,t){let n=!1,i=!1;const o=M.getDocument(),s=a=>{if(n||i){i=!1;return}t(a)};x.on(o,"keyup",s);const l=e.find("input");x.on(l,"compositionstart",()=>{n=!0}),x.on(l,"compositionend",()=>{n=!1,i=!0}),x.on(l,"keydown",a=>{a.which!==229&&(i=!1)}),this._documentKeyUpHandler=s}_addDocumentClick(e,t){const n=M.getDocument(),i=o=>{this._isFocusOnEditorParts(e,o.target)||(x.trigger(e.find("input"),"change"),t())};x.on(n,"dxpointerdown",i),this._documentClickHandler=i}_isFocusOnEditorParts(e,t){const n=t||M.getActiveElement();return g(n).closest(e.children()).length||g(n).closest(".dx-dropdowneditor-overlay").length}_removeEvents(){const e=M.getDocument();f(this._documentKeyUpHandler)&&x.off(e,"keyup",this._documentKeyUpHandler),f(this._documentClickHandler)&&x.off(e,"dxpointerdown",this._documentClickHandler)}_dispose(){this._removeEvents(),super._dispose()}_createValueEditorWithEvents(e,t,n){let i=e[2];const o=()=>(n.empty(),this._removeEvents(),this._createValueText(e,t,n)),s=()=>{this._updateConditionValue(e,i,()=>{o()})},l={value:i===""?null:i,filterOperation:tr(e),setValue(d){i=d===null?"":d},closeEditor:s,text:n.text()};n.empty();const a=this._createValueEditor(n,t,l);x.trigger(a.find("input").not(":hidden").eq(0),"focus"),this._removeEvents(),this._addDocumentClick(a,s),this._addDocumentKeyUp(a,d=>{const u=xe(d);if(u==="tab"){if(this._isFocusOnEditorParts(a))return;this._updateConditionValue(e,i,()=>{o(),d.shiftKey&&x.trigger(n.prev(),"focus")})}u==="escape"&&x.trigger(o(),"focus"),u==="enter"&&this._updateConditionValue(e,i,()=>{x.trigger(o(),"focus")})}),this._fireContentReadyAction()}_createValueButton(e,t){const n=g("<div>").addClass("dx-filterbuilder-text").addClass("dx-filterbuilder-item-value");return this._createValueText(e,t,n),n}_createValueEditor(e,t,n){const i=g("<div>").attr("tabindex",0).appendTo(e),o=ke(this._customOperations,n.filterOperation),s=o&&o.editorTemplate?o.editorTemplate:t.editorTemplate;return s?this._getTemplate(s).render({model:y({field:t},n),container:i}):this._editorFactory.createEditor.call(this,i,y({},t,n,{parentType:ar})),i}_createPopupWithTreeView(e,t){const n=this,i=g("<div>").addClass(e.menu.cssClass).appendTo(t);this._createComponent(i,tn,{onHiding:e.menu.onHiding,onHidden:e.menu.onHidden,rtlEnabled:e.menu.rtlEnabled,position:e.menu.position,animation:e.menu.animation,contentTemplate(o){const s=g("<div>").appendTo(o);n._createComponent(s,ho,e.menu),this.repaint()},_ignoreFunctionValueDeprecation:!0,maxHeight:()=>Yl(e.menu.position.of),visible:!0,focusStateEnabled:!1,preventScrollEvents:!1,hideOnParentScroll:this.option("closePopupOnTargetScroll"),hideOnOutsideClick:!0,onShown:e.popup.onShown,shading:!1,width:"auto",height:"auto",showTitle:!1,_wrapperClassExternal:e.menu.cssClass})}_subscribeOnClickAndEnterKey(e,t){x.on(e,"dxclick",t),x.on(e,"keyup",n=>{xe(n)==="enter"&&t(n)})}}uo("dxFilterBuilder",ga);class mm extends L.View{init(){super.init(),this._columnsController=this.getController("columns"),this._filterSyncController=this.getController("filterSync")}optionChanged(e){switch(e.name){case"filterBuilder":case"filterBuilderPopup":this._invalidate(),e.handled=!0;break;default:super.optionChanged(e)}}_renderCore(){this._updatePopupOptions()}_updatePopupOptions(){this.option("filterBuilderPopup.visible")?this._initPopup():this._filterBuilderPopup&&this._filterBuilderPopup.hide()}_disposePopup(){this._filterBuilderPopup&&(this._filterBuilderPopup.dispose(),this._filterBuilderPopup=void 0),this._filterBuilder&&(this._filterBuilder.dispose(),this._filterBuilder=void 0)}_initPopup(){const e=this;e._disposePopup(),e._filterBuilderPopup=e._createComponent(e.element(),tn,y({title:_.format("dxDataGrid-filterBuilderPopupTitle"),contentTemplate:t=>e._getPopupContentTemplate(t),onOptionChanged(t){t.name==="visible"&&e.option("filterBuilderPopup.visible",t.value)},toolbarItems:e._getPopupToolbarItems()},e.option("filterBuilderPopup"),{onHidden(){mo(e),e._disposePopup()}}))}_getPopupContentTemplate(e){const t=g(e),n=g("<div>").appendTo(g(e));this._filterBuilder=this._createComponent(n,ga,y({value:this.option("filterValue"),fields:this._columnsController.getFilteringColumns()},this.option("filterBuilder"),{customOperations:this._filterSyncController.getCustomFilterOperations()})),this._createComponent(t,kd,{direction:"both"})}_getPopupToolbarItems(){const e=this;return[{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:_.format("OK"),onClick(){const t=e._filterBuilder.option("value");e.option("filterValue",t),e._filterBuilderPopup.hide()}}},{toolbar:"bottom",location:"after",widget:"dxButton",options:{text:_.format("Cancel"),onClick(){e._filterBuilderPopup.hide()}}}]}}const fm={defaultOptions:()=>({filterBuilder:{groupOperationDescriptions:{and:_.format("dxFilterBuilder-and"),or:_.format("dxFilterBuilder-or"),notAnd:_.format("dxFilterBuilder-notAnd"),notOr:_.format("dxFilterBuilder-notOr")},filterOperationDescriptions:{between:_.format("dxFilterBuilder-filterOperationBetween"),equal:_.format("dxFilterBuilder-filterOperationEquals"),notEqual:_.format("dxFilterBuilder-filterOperationNotEquals"),lessThan:_.format("dxFilterBuilder-filterOperationLess"),lessThanOrEqual:_.format("dxFilterBuilder-filterOperationLessOrEquals"),greaterThan:_.format("dxFilterBuilder-filterOperationGreater"),greaterThanOrEqual:_.format("dxFilterBuilder-filterOperationGreaterOrEquals"),startsWith:_.format("dxFilterBuilder-filterOperationStartsWith"),contains:_.format("dxFilterBuilder-filterOperationContains"),notContains:_.format("dxFilterBuilder-filterOperationNotContains"),endsWith:_.format("dxFilterBuilder-filterOperationEndsWith"),isBlank:_.format("dxFilterBuilder-filterOperationIsBlank"),isNotBlank:_.format("dxFilterBuilder-filterOperationIsNotBlank")}},filterBuilderPopup:{}}),views:{filterBuilderView:mm}};T.registerModule("filterBuilder",fm);class Cm extends L.View{init(){this._dataController=this.getController("data"),this._columnsController=this.getController("columns"),this._filterSyncController=this.getController("filterSync"),this._dataController.dataSourceChanged.add(()=>this.render())}isVisible(){return this.option("filterPanel.visible")&&this._dataController.dataSource()}_renderCore(){const e=this.element();if(e.empty(),!!!this._columnsController.getColumns().length)return;e.addClass(this.addWidgetPrefix("filter-panel"));const n=g("<div>").addClass(this.addWidgetPrefix("filter-panel-left")).appendTo(e);this._renderFilterBuilderText(e,n)}_renderFilterBuilderText(e,t){const n=this._getFilterElement(),i=this._getTextElement();if(this.option("filterValue")||this._filterValueBuffer){const o=this._getCheckElement(),s=this._getRemoveButtonElement();t.append(o).append(n).append(i),e.append(s);return}t.append(n).append(i)}_getCheckElement(){const e=this,t=g("<div>").addClass(this.addWidgetPrefix("filter-panel-checkbox"));return e._createComponent(t,Bd,{value:e.option("filterPanel.filterEnabled"),onValueChanged(n){e.option("filterPanel.filterEnabled",n.value)}}),t.attr("title",this.option("filterPanel.texts.filterEnabledHint")),t}_getFilterElement(){const e=this,t=g("<div>").addClass("dx-icon-filter");return x.on(t,"click",()=>e._showFilterBuilder()),Nt("filterPanel",e,t,void 0,()=>e._showFilterBuilder()),e._addTabIndexToElement(t),t}_getTextElement(){const e=this,t=g("<div>").addClass(e.addWidgetPrefix("filter-panel-text"));let n;const i=e.option("filterValue");return i?F(e.getFilterText(i,this._filterSyncController.getCustomFilterOperations())).done(o=>{const s=e.option("filterPanel.customizeText");if(s){const l=s({component:e.component,filterValue:i,text:o});typeof l=="string"&&(o=l)}t.text(o)}):(n=e.option("filterPanel.texts.createFilter"),t.text(n)),x.on(t,"click",()=>e._showFilterBuilder()),Nt("filterPanel",e,t,void 0,()=>e._showFilterBuilder()),e._addTabIndexToElement(t),t}_showFilterBuilder(){this.option("filterBuilderPopup.visible",!0)}_getRemoveButtonElement(){const e=this,t=()=>e.option("filterValue",null),n=g("<div>").addClass(e.addWidgetPrefix("filter-panel-clear-filter")).text(e.option("filterPanel.texts.clearFilter"));return x.on(n,"click",t),Nt("filterPanel",this,n,void 0,t),e._addTabIndexToElement(n),n}_addTabIndexToElement(e){if(!this.option("useLegacyKeyboardNavigation")){const t=this.option("tabindex")||0;e.attr("tabindex",t)}}optionChanged(e){switch(e.name){case"filterValue":this._invalidate(),this.option("filterPanel.filterEnabled",!0),e.handled=!0;break;case"filterPanel":this._invalidate(),e.handled=!0;break;default:super.optionChanged(e)}}_getConditionText(e,t,n){let i=`[${e}] ${t}`;return f(n)&&(i+=n),i}_getValueMaskedText(e){return Array.isArray(e)?`('${e.join("', '")}')`:` '${e}'`}_getValueText(e,t,n){const i=new E,o=t&&t.customizeText;if(f(n)||o)if(!o&&e.lookup)na(e,n,s=>{i.resolve(this._getValueMaskedText(s))});else{const s=Array.isArray(n)?n:v.getDisplayValue(e,n,null);F(oa(e,s,t,"filterPanel")).done(l=>{i.resolve(this._getValueMaskedText(l))})}else i.resolve("");return i.promise()}getConditionText(e,t){const n=this,i=e[1],o=new E,s=ke(t.customOperations,i);let l;const a=Ln(e[0],t.columns),d=a.caption||"",u=e[2];return s?l=s.caption||Fr.captionize(s.name):u===null?l=Zi(i==="="?"isblank":"isnotblank",t.filterOperationDescriptions):l=Zi(i,t.filterOperationDescriptions),this._getValueText(a,s,u).done(c=>{o.resolve(n._getConditionText(d,l,c))}),o}getGroupText(e,t,n){const i=this,o=new E,s=[],l=st(e);return e.forEach(a=>{ne(a)?s.push(i.getConditionText(a,t)):Xe(a)&&s.push(i.getGroupText(a,t,!0))}),F.apply(this,s).done(function(){let a;for(var d=arguments.length,u=new Array(d),c=0;c<d;c++)u[c]=arguments[c];l.startsWith("!")?a=`${t.groupOperationDescriptions[`not${l.substring(1,2).toUpperCase()}${l.substring(2)}`].split(" ")[0]} ${u[0]}`:a=u.join(` ${t.groupOperationDescriptions[l]} `),n&&(a=`(${a})`),o.resolve(a)}),o}getFilterText(e,t){const n={customOperations:t,columns:this._columnsController.getFilteringColumns(),filterOperationDescriptions:this.option("filterBuilder.filterOperationDescriptions"),groupOperationDescriptions:this.option("filterBuilder.groupOperationDescriptions")};return ne(e)?this.getConditionText(e,n):this.getGroupText(e,n)}}const _m=r=>class extends r{optionChanged(e){e.name==="filterPanel"?(this._applyFilter(),e.handled=!0):super.optionChanged(e)}},wm={defaultOptions:()=>({filterPanel:{visible:!1,filterEnabled:!0,texts:{createFilter:_.format("dxDataGrid-filterPanelCreateFilter"),clearFilter:_.format("dxDataGrid-filterPanelClearFilter"),filterEnabledHint:_.format("dxDataGrid-filterPanelFilterEnabledHint")}}}),views:{filterPanelView:Cm},extenders:{controllers:{data:_m}}};T.registerModule("filterPanel",wm);function ma(r){return!!(r.allowSearch??r.allowFiltering)}function fa(r,e){const{lookup:t}=r;return r.parseValue?t?r.parseValue.call(t,e):r.parseValue(e):e}const xm=r=>class extends r{optionChanged(e){switch(e.fullName){case"searchPanel.text":case"searchPanel":this._applyFilter(),e.handled=!0;break;default:super.optionChanged(e)}}publicMethods(){return super.publicMethods().concat(["searchByText"])}_calculateAdditionalFilter(){const e=super._calculateAdditionalFilter(),t=this.calculateSearchFilter(this.option("searchPanel.text"));return v.combineFilters([e,t])}searchByText(e){this.option("searchPanel.text",e)}calculateSearchFilter(e){let t,n;const i=this._columnsController.getColumns(),o=this.option("searchPanel.searchVisibleColumnsOnly");let s;const l=[];if(!e)return null;function a(d){const u=ce(s.valueExpr);for(let c=0;c<d.length;c++){const h=u(d[c]);l.push(n.createFilterExpression(h,null,"search"))}}for(t=0;t<i.length;t++)if(n=i[t],!(o&&!n.visible)&&ma(n)&&n.calculateFilterExpression){s=n.lookup;const d=fa(n,e);s&&s.items?nn(s.items).filter(n.createFilterExpression.call({dataField:s.displayExpr,dataType:s.dataType,calculateFilterExpression:n.calculateFilterExpression},d,null,"search")).enumerate().done(a):d!==void 0&&l.push(n.createFilterExpression(d,null,"search"))}return l.length===0?["!"]:v.combineFilters(l,"or")}},vm=r=>class extends r{optionChanged(e){if(e.name==="searchPanel"){if(e.fullName==="searchPanel.text"){const t=this.getSearchTextEditor();t&&t.option("value",e.value)}else this._invalidate();e.handled=!0}else super.optionChanged(e)}_getToolbarItems(){const e=super._getToolbarItems();return this._prepareSearchItem(e)}_prepareSearchItem(e){const t=this,n=this._dataController,i=this.option("searchPanel");if(i&&i.visible){const o={template(s,l,a){const d=g("<div>").addClass(t.addWidgetPrefix("search-panel")).appendTo(a);t._editorFactoryController.createEditor(d,{width:i.width,placeholder:i.placeholder,parentType:"searchPanel",value:t.option("searchPanel.text"),updateValueTimeout:700,setValue(u){n.searchByText(u)},editorOptions:{inputAttr:{"aria-label":_.format(`${t.component.NAME}-ariaSearchInGrid`)}}}),t.resize()},name:"searchPanel",location:"after",locateInMenu:"never",sortIndex:40};e.push(o)}return e}getSearchTextEditor(){const e=this,t=e.element(),n=t.find(`.${e.addWidgetPrefix("search-panel")}`).filter(function(){return g(this).closest(`.${e.addWidgetPrefix("header-panel")}`).is(t)});return n.length?n.dxTextBox("instance"):null}isVisible(){const e=this.option("searchPanel");return super.isVisible()||!!(e!=null&&e.visible)}},ym=r=>class extends r{init(){super.init.apply(this,arguments),this._searchParams=[],this._dataController=this.getController("data")}dispose(){clearTimeout(this._highlightTimer),super.dispose()}_getFormattedSearchText(e,t){const n=fa(e,t),i=v.getFormatOptionsByColumn(e,"search");return v.formatValue(n,i)}_getStringNormalizer(){var e,t,n;const i=this.option("searchPanel.highlightCaseSensitive"),o=(e=this._dataController)===null||e===void 0||(t=e.getDataSource)===null||t===void 0?void 0:t.call(e),s=o==null||(n=o.loadOptions)===null||n===void 0||(n=n.call(o))===null||n===void 0?void 0:n.langParams;return l=>Wi(l,i,s)}_findHighlightingTextNodes(e,t,n){var i;const o=this;let s=t.parent(),l;const a=this._getStringNormalizer(),d=a(n),u=[];if(!s.length)s=g("<div>").append(t);else if(e)if(e.groupIndex>=0&&!e.showWhenGrouped)l=t;else{const c=o._columnsController.getVisibleIndex(e.index);l=s.children("td").eq(c).find("*")}return l=(i=l)!==null&&i!==void 0&&i.length?l:s.find("*"),l.each((c,h)=>{const p=g(h).contents();for(let m=0;m<p.length;m++){const C=p.get(m);C.nodeType===3&&a(C.textContent??C.nodeValue??"").includes(d)&&u.push(C)}}),u}_highlightSearchTextCore(e,t){const n=this,i=g("<span>").addClass(n.addWidgetPrefix("search-text")),o=e.text(),s=e[0],l=this._getStringNormalizer(),a=l(o).indexOf(l(t));if(a>=0)return s.textContent?s.textContent=o.substr(0,a):s.nodeValue=o.substr(0,a),e.after(i.text(o.substr(a,t.length))),e=g(M.createTextNode(o.substr(a+t.length))).insertAfter(i),n._highlightSearchTextCore(e,t)}_highlightSearchText(e,t,n){const i=this,o=this._getStringNormalizer();let s=i.option("searchPanel.text");t&&n&&(s=s&&i._getFormattedSearchText(n,s)),s&&i.option("searchPanel.highlightSearchText")&&i._findHighlightingTextNodes(n,e,s).forEach(a=>{t?o(g(a).text())===o(s??"")&&g(a).replaceWith(g("<span>").addClass(i.addWidgetPrefix("search-text")).text(g(a).text())):i._highlightSearchTextCore(g(a),s)})}_renderCore(){const e=super._renderCore.apply(this,arguments);return(this.option().rowTemplate||this.option("dataRowTemplate"))&&(this.option("templatesRenderAsynchronously")?(clearTimeout(this._highlightTimer),this._highlightTimer=setTimeout(()=>{this._highlightSearchText(this.getTableElement())})):this._highlightSearchText(this.getTableElement())),e}_updateCell(e,t){const{column:n}=t,o=(n.lookup&&n.lookup.dataType||n.dataType)!=="string";ma(n)&&!t.isOnForm&&(this.option("templatesRenderAsynchronously")?(this._searchParams.length||(clearTimeout(this._highlightTimer),this._highlightTimer=setTimeout(()=>{this._searchParams.forEach(s=>{this._highlightSearchText.apply(this,s)}),this._searchParams=[]})),this._searchParams.push([e,o,n])):this._highlightSearchText(e,o,n)),super._updateCell(e,t)}},bm={defaultOptions:()=>({searchPanel:{visible:!1,width:160,placeholder:_.format("dxDataGrid-searchPanelPlaceholder"),highlightSearchText:!0,highlightCaseSensitive:!1,text:"",searchVisibleColumnsOnly:!1}}),extenders:{controllers:{data:xm},views:{headerPanel:vm,rowsView:ym}}};T.registerModule("search",bm);const Im=A({},Mr,{isGridCompatibilityMode:!1,showInfo:!1,displayMode:"adaptive",maxPagesCount:10,pageCount:1,visible:!0,hasKnownLastPage:!0,pagesNavigatorVisible:"auto",showPageSizeSelector:!0,allowedPageSizes:[5,10],showNavigationButtons:!1,itemCount:1,label:_.format("dxPagination-ariaLabel")}),j=A({},Im,{pageSize:5,pageIndex:1,pageIndexChangedInternal:()=>{},pageSizeChangedInternal:()=>{}}),Em="dx-pager",Sm="dx-pagination",Rm="dx-light-mode",Tm="dx-pages",Vm="dx-page-indexes",Fm="dx-page",Om="dx-selection",Dm="dx-page-size",Pm="dx-page-sizes",Am="dx-page-size dx-selection",km="dx-first-child",Wt=Nr(void 0),$t=Nr(void 0),Bm={};class Ca extends je{constructor(){super(...arguments),this.state={}}getConfig(){return{isGridCompatibilityMode:this.props.isGridCompatibilityMode}}getChildContext(){return A({},this.context,{[$t.id]:this.getConfig()||$t.defaultValue})}render(){return this.props.children}}Ca.defaultProps=Bm;function Mm(r){return r[$t.id]?r[$t.id]:$t.defaultValue}function _a(r){var e;return!!((e=Mm(r))!==null&&e!==void 0&&e.isGridCompatibilityMode)}function Ve(r,e){let t=e;return _a(r)&&(t=e.replace("dxPagination","dxPager")),_.getFormatter(t)()}const Nm="dx-info",Lm={pageCount:j.pageCount,pageIndex:j.pageIndex,itemCount:j.itemCount};class wa extends je{constructor(){super(...arguments),this.state={},this.refs=null,this.rootElementRef=ge()}getInfoText(){return this.props.infoText??Ve(this.context,"dxPagination-infoText")}getText(){const{pageCount:e,pageIndex:t,itemCount:n}=this.props;return Yt(this.getInfoText(),(t+1).toString(),e==null?void 0:e.toString(),n==null?void 0:n.toString())}render(){return Ke(1,"div","dx-info",this.getText(),0,null,null,this.props.rootElementRef)}}wa.defaultProps=Lm;const Hm={className:"",label:"",tabIndex:0,selected:!1};class Jt extends vt{constructor(e){super(e),this.state={},this.refs=null,this.widgetRef=ge(),this.keyboardEffect=this.keyboardEffect.bind(this),this.subscribeToClick=this.subscribeToClick.bind(this)}getComponentProps(){return this.props}getKeyboardContext(){return this.context[Wt.id]?this.context[Wt.id]:Wt.defaultValue}componentWillUpdate(e,t,n){super.componentWillUpdate(e,t,n)}createEffects(){return[new Ue(this.keyboardEffect,[this.getKeyboardContext(),this.props.onClick]),new Ue(this.subscribeToClick,[this.props.onClick])]}updateEffects(){var e,t;(e=this._effects[0])===null||e===void 0||e.update([this.getKeyboardContext(),this.props.onClick]),(t=this._effects[1])===null||t===void 0||t.update([this.props.onClick])}keyboardEffect(){return this.getKeyboardContext().registerKeyboardAction(this.widgetRef.current,this.props.onClick)}subscribeToClick(){return Md(this.widgetRef.current,this.props.onClick)}render(){return Ke(1,"div",this.props.className,this.props.children,0,{tabIndex:this.props.tabIndex,role:"button","aria-label":this.props.label,"aria-current":this.props.selected?"page":void 0},null,this.widgetRef)}}Jt.defaultProps=Hm;const zm={allowedPageSizes:[],pageSize:j.pageSize,pageSizeChangedInternal:j.pageSizeChangedInternal};class xa extends je{constructor(e){super(e),this.state={},this.refs=null,this.__getterCache={pageSizesText:void 0},this.state={},this.onPageSizeChange=this.onPageSizeChange.bind(this)}getPageSizesText(){if(this.__getterCache.pageSizesText!==void 0)return this.__getterCache.pageSizesText;const e=(()=>{const{pageSize:t,allowedPageSizes:n}=this.props;return n.map((i,o)=>{const{text:s,value:l}=i;return{className:jn({[l===t?Am:Dm]:!0,[km]:o===0}),click:this.onPageSizeChange(l),label:Yt(Ve(this.context,"dxPagination-pageSize"),l||Ve(this.context,"dxPagination-pageSizesAllText")),text:s}})})();return this.__getterCache.pageSizesText=e,e}onPageSizeChange(e){return()=>(this.props.pageSizeChangedInternal(e),this.props.pageSize)}componentWillUpdate(e){(this.props.pageSize!==e.pageSize||this.props.allowedPageSizes!==e.allowedPageSizes||this.props.pageSizeChangedInternal!==e.pageSizeChangedInternal)&&(this.__getterCache.pageSizesText=void 0)}render(){return po(this.getPageSizesText().map(e=>{let{text:t,className:n,label:i,click:o}=e;return Q(2,Jt,{className:n,label:i,onClick:o,children:t},t)}),0)}}xa.defaultProps=zm;const va={label:"",labelMode:co(jt())?"floating":"static"},Wm={className:"",activeStateEnabled:!1,disabled:!1,focusStateEnabled:!1,hoverStateEnabled:!1,tabIndex:0,visible:!0,rtlEnabled:!1},ur=A({},Mr,{_feedbackHideTimeout:400,_feedbackShowTimeout:30,cssText:"",aria:{},classes:"",name:"",addWidgetClass:!0}),ya=A({},Wm,{aria:ur.aria,classes:ur.classes,readOnly:!1,name:"",value:null,validationError:null,validationErrors:null,validationMessageMode:"auto",validationMessagePosition:"bottom",validationStatus:"valid",isValid:!0,isDirty:!1,inputAttr:{}}),ba={hoverStateEnabled:!0,activeStateEnabled:!0,focusStateEnabled:me.real().deviceType==="desktop"&&!me.isSimulator()},$m=A({},ya,ba,va,{placeholder:"",hoverStateEnabled:!0,searchEnabled:!1,value:null,isReactComponentWrapper:!0});class Ia extends je{constructor(){super(...arguments),this.state={},this.refs=null}get componentProps(){return this.props}render(){return Q(2,Lr,{componentType:Nd,componentProps:this.componentProps,templateNames:["dropDownButtonTemplate","groupTemplate","itemTemplate"]})}}Ia.defaultProps=$m;function Ea(r,e){return r+10*Math.max(...e).toString().length}function Gm(r){var e;const t=ve();return r?(e=t.getComputedStyle)===null||e===void 0?void 0:e.call(t,r):null}function Km(r){return r?Number(r.replace("px","")):0}function Be(r,e){const t=Gm(e)??{};return Km(t[r])}function Um(r){const e=Be("paddingLeft",r)+Be("paddingRight",r);return Be("width",r)-e}function Rn(r){const e=Be("marginLeft",r)+Be("marginRight",r),t=Be("width",r);return e+t}function Sa(r){return Be("minWidth",r)}const jm={allowedPageSizes:[]},qm=A({},jm,{pageSize:j.pageSize,pageSizeChangedInternal:j.pageSizeChangedInternal});class Ra extends vt{constructor(e){super(e),this.state={minWidth:10},this.refs=null,this.updateWidth=this.updateWidth.bind(this)}componentWillUpdate(e,t,n){super.componentWillUpdate(e,t,n)}createEffects(){const e=[this.props,this.state.minWidth,this.props.pageSize,this.props.pageSizeChangedInternal,this.props.allowedPageSizes];return[new Ue(this.updateWidth,e)]}updateEffects(){var e;const t=[this.props,this.state.minWidth,this.props.pageSize,this.props.pageSizeChangedInternal,this.props.allowedPageSizes];(e=this._effects[0])===null||e===void 0||e.update(t)}updateWidth(){this.setState(e=>{var t;return{minWidth:Sa((t=this.props.parentRef)===null||t===void 0?void 0:t.current)||e.minWidth}})}getWidth(){var e;return Ea(this.state.minWidth,(e=this.props.allowedPageSizes)===null||e===void 0?void 0:e.map(t=>t.value))}getInputAttributes(){return{"aria-label":Ve(this.context,"dxPagination-ariaPageSize")}}render(){const{allowedPageSizes:e,pageSize:t,pageSizeChangedInternal:n}=this.props;return Q(2,Ia,{displayExpr:"text",valueExpr:"value",dataSource:e,value:t,valueChange:n,width:this.getWidth(),inputAttr:this.getInputAttributes()})}}Ra.defaultProps=qm;const Xm={isLargeDisplayMode:!0,pageSize:j.pageSize,pageSizeChangedInternal:j.pageSizeChangedInternal,allowedPageSizes:j.allowedPageSizes};class Ta extends vt{constructor(e){super(e),this.state={},this.refs=null,this.rootElementRef=ge(),this.htmlRef=ge(),this.__getterCache={normalizedPageSizes:void 0},this.setRootElementRef=this.setRootElementRef.bind(this)}createEffects(){return[new Ue(this.setRootElementRef,[])]}setRootElementRef(){const{rootElementRef:e}=this.props;e&&(e.current=this.htmlRef.current)}getAllText(){return Ve(this.context,"dxPagination-pageSizesAllText")}getNormalizedPageSizes(){if(this.__getterCache.normalizedPageSizes!==void 0)return this.__getterCache.normalizedPageSizes;const e=this.props.allowedPageSizes.map(t=>t==="all"||t===0?{text:this.getAllText(),value:0}:{text:String(t),value:t});return this.__getterCache.normalizedPageSizes=e,e}componentWillUpdate(e){super.componentWillUpdate(),this.props.allowedPageSizes!==e.allowedPageSizes&&(this.__getterCache.normalizedPageSizes=void 0)}render(){const e=this.getNormalizedPageSizes(),{pageSize:t,pageSizeChangedInternal:n,isLargeDisplayMode:i}=this.props;return Ke(1,"div",Pm,[i&&Q(2,xa,{allowedPageSizes:this.getNormalizedPageSizes(),pageSize:t,pageSizeChangedInternal:n}),!i&&Q(2,Ra,{parentRef:this.htmlRef,allowedPageSizes:e,pageSize:t,pageSizeChangedInternal:n})],0,null,null,this.htmlRef)}}Ta.defaultProps=Xm;const Ym={index:0,selected:!1,className:Fm};class Bo extends je{constructor(){super(...arguments),this.state={},this.refs=null}getLabel(){return Yt(Ve(this.context,"dxPagination-page"),this.getValue())}getValue(){return this.props.index+1}getClassName(){return jn({[`${this.props.className}`]:!!this.props.className,[Om]:!!this.props.selected})}render(){return Q(2,Jt,{className:this.getClassName(),label:this.getLabel(),onClick:this.props.onClick,selected:this.props.selected,children:this.getValue()})}}Bo.defaultProps=Ym;const Qm={maxPagesCount:j.maxPagesCount,pageCount:j.pageCount,pageIndex:j.pageIndex,pageIndexChangedInternal:j.pageIndexChangedInternal};function cr(r,e,t){switch(!0){case r===1:return"high";case r+e===t-1:return"low";default:return"both"}}function Va(r,e,t){let n=[],i=[];switch(t){case"none":n=[...r];break;case"both":n=[0,"low",...r,"high",e-1],i=r.slice(1,-1);break;case"high":n=[0,...r,"high",e-1],i=r.slice(0,-1);break;case"low":n=[0,"low",...r,e-1],i=r.slice(1)}return{slidingWindowIndexes:r,indexesForReuse:i,pageIndexes:n}}function hr(r,e,t,n){const i=[];for(let o=0;o<e;o+=1)i.push(o+r);return Va(i,t,n)}class Fa extends je{constructor(e){super(e),this.state={},this.refs=null,this.canReuseSlidingWindow=this.canReuseSlidingWindow.bind(this),this.generatePageIndexes=this.generatePageIndexes.bind(this),this.isSlidingWindowMode=this.isSlidingWindowMode.bind(this),this.onPageClick=this.onPageClick.bind(this)}getConfig(){return this.context[ze.id]?this.context[ze.id]:ze.defaultValue}getSlidingWindowState(){const e=this.slidingWindowStateHolder;return e||{indexesForReuse:[],slidingWindowIndexes:[]}}canReuseSlidingWindow(e,t){const{indexesForReuse:n}=this.getSlidingWindowState(),i=n.slice(-1)[0]<e-1,o=n.includes(t);return i&&o}generatePageIndexes(){const{pageCount:e,pageIndex:t}=this.props;let n=0;const{slidingWindowIndexes:i}=this.getSlidingWindowState();t===i[0]?n=t-1:t===i[i.length-1]?n=t+2-4:t<4?n=1:t>=e-4?n=e-4-1:n=t-1;const o=cr(n,4,e),s=hr(n,4,e,o),{pageIndexes:l}=s;return this.slidingWindowStateHolder=s,l}isSlidingWindowMode(){const{maxPagesCount:e,pageCount:t}=this.props;return t<=4||t<=e}onPageClick(e){this.props.pageIndexChangedInternal(e)}getPageIndexes(){const{pageCount:e}=this.props;if(this.isSlidingWindowMode())return hr(0,e,e,"none").pageIndexes;if(this.canReuseSlidingWindow(e,this.props.pageIndex)){const{slidingWindowIndexes:t}=this.getSlidingWindowState(),n=cr(t[0],4,e);return Va(t,e,n).pageIndexes}return this.generatePageIndexes()}getPages(){var e;const{pageIndex:t}=this.props,n=s=>{const l=s==="low"||s==="high"?null:{index:s,onClick:()=>this.onPageClick(s),selected:t===s};return{key:s.toString(),pageProps:l}},i=this.getPageIndexes();return((e=this.getConfig())!==null&&e!==void 0&&e.rtlEnabled?[...i].reverse():i).map(s=>n(s))}render(){const e=this.getPages().map(t=>{let{key:n,pageProps:i}=t;return i?Q(2,Bo,{index:i.index,selected:i.selected,onClick:i.onClick},n):Ke(1,"div","dx-separator",". . .",16,null,n)});return po(e,0)}}Fa.defaultProps=Qm;const Jm=A({},ya,ba,va,{value:0,isReactComponentWrapper:!0});class Oa extends je{constructor(){super(...arguments),this.state={},this.refs=null}get componentProps(){return this.props}render(){return Q(2,Lr,{componentType:Ld,componentProps:this.componentProps,templateNames:[]})}}Oa.defaultProps=Jm;const Zm=`${Nm}  dx-info-text`,ef={pageIndex:j.pageIndex,pageCount:j.pageCount,pageIndexChangedInternal:j.pageIndexChangedInternal};class Da extends vt{constructor(e){super(e),this.state={minWidth:10},this.refs=null,this.pageIndexRef=ge(),this.updateWidth=this.updateWidth.bind(this),this.selectLastPageIndex=this.selectLastPageIndex.bind(this),this.valueChange=this.valueChange.bind(this)}componentWillUpdate(e,t,n){super.componentWillUpdate(e,t,n)}createEffects(){return[new Ue(this.updateWidth,[this.state.minWidth])]}updateEffects(){var e;(e=this._effects[0])===null||e===void 0||e.update([this.state.minWidth])}updateWidth(){var e;const t=(e=this.pageIndexRef.current)===null||e===void 0?void 0:e.querySelector(".dx-page-index");this.setState(n=>({minWidth:t&&Sa(t)||n.minWidth}))}getValue(){return this.props.pageIndex+1}getWidth(){return Ea(this.state.minWidth,[this.props.pageCount])}getPagesCountText(){return(this.props.pagesCountText??"")||Ve(this.context,"dxPagination-pagesCountText")}getInputAttributes(){return{"aria-label":Ve(this.context,"dxPagination-ariaPageNumber")}}selectLastPageIndex(){this.props.pageIndexChangedInternal(this.props.pageCount-1)}valueChange(e){this.props.pageIndexChangedInternal(e-1)}render(){return Ke(1,"div","dx-light-pages",[Q(2,Oa,{className:"dx-page-index",min:1,max:Math.max(this.props.pageCount,this.getValue()),width:this.getWidth(),value:this.getValue(),valueChange:this.valueChange,inputAttr:this.getInputAttributes()}),Ke(1,"span",Zm,this.getPagesCountText(),0),Q(2,Bo,{className:"dx-pages-count",selected:!1,index:this.props.pageCount-1,onClick:this.selectLastPageIndex})],4,null,null,this.pageIndexRef)}}Da.defaultProps=ef;const tf={nextEnabledClass:"dx-navigate-button dx-next-button",prevEnabledClass:"dx-navigate-button dx-prev-button",nextDisabledClass:"dx-button-disable dx-navigate-button dx-next-button",prevDisabledClass:"dx-button-disable dx-navigate-button dx-prev-button"},nf={next:"prev",prev:"next"};function of(r){return r==="next"?1:-1}const sf={isLargeDisplayMode:!0,maxPagesCount:j.maxPagesCount,pageCount:j.pageCount,pageIndex:j.pageIndex,pageIndexChangedInternal:j.pageIndexChangedInternal,showNavigationButtons:j.showNavigationButtons,itemCount:j.itemCount};class Pa extends je{constructor(e){super(e),this.state={},this.refs=null,this.__getterCache={prevButtonProps:void 0,nextButtonProps:void 0},this.pageIndexChangedInternal=this.pageIndexChangedInternal.bind(this),this.getButtonProps=this.getButtonProps.bind(this),this.canNavigateToPage=this.canNavigateToPage.bind(this),this.getNextPageIndex=this.getNextPageIndex.bind(this),this.canNavigateTo=this.canNavigateTo.bind(this),this.navigateToPage=this.navigateToPage.bind(this)}getConfig(){return this.context[ze.id]?this.context[ze.id]:ze.defaultValue}pageIndexChangedInternal(e){this.canNavigateToPage(e)&&this.props.pageIndexChangedInternal(e)}getButtonProps(e){var t;const n=(t=this.getConfig())!==null&&t!==void 0&&t.rtlEnabled?nf[e]:e,i=this.canNavigateTo(n);return{className:tf[`${e}${i?"Enabled":"Disabled"}Class`],tabIndex:i?0:-1,navigate:()=>this.navigateToPage(n)}}canNavigateToPage(e){return this.props.hasKnownLastPage?e>=0&&e<=this.props.pageCount-1:e>=0}getNextPageIndex(e){return this.props.pageIndex+of(e)}canNavigateTo(e){return this.canNavigateToPage(this.getNextPageIndex(e))}navigateToPage(e){this.pageIndexChangedInternal(this.getNextPageIndex(e))}getRenderPrevButton(){const{isLargeDisplayMode:e,showNavigationButtons:t}=this.props;return(!e||t)??!1}getRenderNextButton(){return this.getRenderPrevButton()||!this.props.hasKnownLastPage}getPrevButtonProps(){if(this.__getterCache.prevButtonProps!==void 0)return this.__getterCache.prevButtonProps;const e=this.getButtonProps("prev");return this.__getterCache.prevButtonProps=e,e}getNextButtonProps(){if(this.__getterCache.nextButtonProps!==void 0)return this.__getterCache.nextButtonProps;const e=this.getButtonProps("next");return this.__getterCache.nextButtonProps=e,e}componentWillUpdate(e,t,n){(this.context[ze.id]!==n[ze.id]||this.props.hasKnownLastPage!==e.hasKnownLastPage||this.props.pageCount!==e.pageCount||this.props.pageIndex!==e.pageIndex||this.props.pageIndexChangedInternal!==e.pageIndexChangedInternal)&&(this.__getterCache.prevButtonProps=void 0,this.__getterCache.nextButtonProps=void 0)}getPrevButtonLabel(){return Ve(this.context,"dxPagination-prevPage")}getNextButtonLabel(){return Ve(this.context,"dxPagination-nextPage")}render(){const{className:e,tabIndex:t,navigate:n}=this.getPrevButtonProps(),{isLargeDisplayMode:i,maxPagesCount:o,pageCount:s,pageIndex:l,pagesCountText:a}=this.props;return po([this.getRenderPrevButton()&&Q(2,Jt,{label:this.getPrevButtonLabel(),className:e,tabIndex:t,onClick:n}),i&&Q(2,Fa,{maxPagesCount:o,pageCount:s,pageIndex:l,pageIndexChangedInternal:this.pageIndexChangedInternal}),!i&&Q(2,Da,{pageCount:s,pageIndex:l,pageIndexChangedInternal:this.pageIndexChangedInternal,pagesCountText:a}),this.getRenderNextButton()&&Q(2,Jt,{label:this.getNextButtonLabel(),className:this.getNextButtonProps().className,tabIndex:this.getNextButtonProps().tabIndex,onClick:this.getNextButtonProps().navigate})],0)}}Pa.defaultProps=sf;const rf=A({},j,{infoTextVisible:!0,isLargeDisplayMode:!0});class Aa extends vt{constructor(e){super(e),this.state={},this.refs=null,this.widgetElementRef=ge(),this.widgetRootElementRef=ge(),this.pagesRef=ge(),this.infoTextRef=ge(),this.__getterCache={keyboardAction:void 0},this.state={},this.__getterCache={},this.setRootElementRef=this.setRootElementRef.bind(this),this.createFakeInstance=this.createFakeInstance.bind(this)}createEffects(){return[new Ue(this.setRootElementRef,[])]}getChildContext(){return A({},this.context,{[Wt.id]:this.getKeyboardAction()||Wt.defaultValue})}setRootElementRef(){const{rootElementRef:e}=this.props;e&&this.widgetRootElementRef&&(e.current=this.widgetRootElementRef.current)}createFakeInstance(){return{option:()=>!1,element:()=>{var e;return(e=this.widgetRootElementRef)===null||e===void 0?void 0:e.current},_createActionByOption:()=>e=>{var t,n;(t=(n=this.props).onKeyDown)===null||t===void 0||t.call(n,e)}}}getKeyboardAction(){return{registerKeyboardAction:(e,t)=>{const n=this.createFakeInstance();return Qr("pager",n,e,void 0,t)}}}getInfoVisible(){const{infoTextVisible:e,showInfo:t}=this.props;return!!t&&e}getPageIndexSelectorVisible(){return this.props.pageSize!==0}getNormalizedDisplayMode(){const{displayMode:e,lightModeEnabled:t}=this.props;return e==="adaptive"&&t!==void 0?t?"compact":"full":e??"adaptive"}getPagesContainerVisible(){return!!this.props.pagesNavigatorVisible&&this.props.pageCount>0}getPagesContainerVisibility(){if(this.props.pagesNavigatorVisible==="auto"&&this.props.pageCount===1&&this.props.hasKnownLastPage)return"hidden"}getIsLargeDisplayMode(){const e=this.getNormalizedDisplayMode();let t=!1;return e==="adaptive"?t=this.props.isLargeDisplayMode:t=e==="full",t}getClasses(){const e={[`${this.props.className}`]:!!this.props.className,[Em]:!!this.props.isGridCompatibilityMode,[Sm]:!this.props.isGridCompatibilityMode,[Rm]:!this.getIsLargeDisplayMode()};return jn(e)}getAria(){return{role:"navigation",label:this.props.label??""}}componentWillUpdate(e){super.componentWillUpdate(),this.props.onKeyDown!==e.onKeyDown&&(this.__getterCache.keyboardAction=void 0)}render(){const{isGridCompatibilityMode:e,rtlEnabled:t,visible:n,showPageSizeSelector:i,allowedPageSizesRef:o,pageSize:s,pageSizeChangedInternal:l,allowedPageSizes:a,infoTextRef:d,infoText:u,pageCount:c,pageIndex:h,itemCount:p,pagesRef:m,hasKnownLastPage:C,maxPagesCount:w,pageIndexChangedInternal:S,pagesCountText:V,showNavigationButtons:O,style:P,width:k,height:B,elementAttr:$,hint:re,disabled:fe,tabIndex:ei,accessKey:ti,activeStateEnabled:ni,focusStateEnabled:ii,hoverStateEnabled:oi}=this.props,si=Hr(Q(2,Hd,A({rootElementRef:this.widgetRootElementRef,rtlEnabled:t,classes:this.getClasses(),visible:n,aria:this.getAria(),style:P,width:k,height:B,hint:re,disabled:fe,tabIndex:ei,accessKey:ti,activeStateEnabled:ni,focusStateEnabled:ii,hoverStateEnabled:oi},$,{children:[i&&Q(2,Ta,{rootElementRef:o,isLargeDisplayMode:this.getIsLargeDisplayMode(),pageSize:s,pageSizeChangedInternal:l,allowedPageSizes:a}),this.getPagesContainerVisible()&&Ke(1,"div",Tm,[this.getInfoVisible()&&Q(2,wa,{rootElementRef:d,infoText:u,pageCount:c,pageIndex:h,itemCount:p}),this.getPageIndexSelectorVisible()&&Ke(1,"div",Vm,Q(2,Pa,{hasKnownLastPage:C,isLargeDisplayMode:this.getIsLargeDisplayMode(),maxPagesCount:w,pageCount:c,pageIndex:h,pageIndexChangedInternal:S,pagesCountText:V,showNavigationButtons:O,itemCount:p}),2,null,null,m)],0,{style:{visibility:this.getPagesContainerVisibility()}})]})));return Q(2,Ca,{isGridCompatibilityMode:e,children:si})}}Aa.defaultProps=rf;function lf(r){let{parent:e,allowedPageSizes:t,pages:n}=r;return e-(t+n)>0}function af(r){let{parent:e,allowedPageSizes:t,pages:n,info:i}=r;const o=t+n+i;return e-o>0}function df(r){let{parent:e,allowedPageSizes:t,pages:n,info:i}=r;const o=Um(e),s=Rn(t),l=Rn(i),a=Rn(n);return{parent:o,allowedPageSizes:s,info:l+Be("marginLeft",i)+Be("marginRight",i),pages:a}}const uf={paginationProps:A({},j)};class ka extends vt{constructor(e){super(e),this.state={infoTextVisible:!0,isLargeDisplayMode:!0},this.refs=null,this.parentRef=ge(),this.infoTextRef=ge(),this.pagesRef=ge(),this.allowedPageSizesRef=ge(),this.elementsWidth={},this.actualIsLargeDisplayMode=!0,this.actualInfoTextVisible=!0,this.subscribeToResize=this.subscribeToResize.bind(this),this.effectUpdateChildProps=this.effectUpdateChildProps.bind(this),this.updateAdaptivityProps=this.updateAdaptivityProps.bind(this)}componentWillUpdate(e,t,n){super.componentWillUpdate(e,t,n)}createEffects(){return[new Ue(this.subscribeToResize,[this.state.infoTextVisible,this.state.isLargeDisplayMode]),new Ue(this.effectUpdateChildProps,[this.props,this.state.infoTextVisible,this.state.isLargeDisplayMode,this.props.paginationProps,this.props.contentTemplate])]}updateEffects(){var e,t;(e=this._effects[0])===null||e===void 0||e.update([this.state.infoTextVisible,this.state.isLargeDisplayMode]),(t=this._effects[1])===null||t===void 0||t.update([this.props,this.state.infoTextVisible,this.state.isLargeDisplayMode,this.props.paginationProps,this.props.contentTemplate])}subscribeToResize(){const e=()=>{this.getParentWidth()>0&&this.updateAdaptivityProps()};return Uo.add(e),()=>{Uo.remove(e)}}effectUpdateChildProps(){this.getParentWidth()>0&&this.updateAdaptivityProps()}getContentAttributes(){const{className:e,displayMode:t,isGridCompatibilityMode:n,hasKnownLastPage:i,infoText:o,label:s,lightModeEnabled:l,maxPagesCount:a,onKeyDown:d,pageCount:u,pageIndex:c,pageIndexChangedInternal:h,pageSize:p,pageSizeChangedInternal:m,allowedPageSizes:C,pagesCountText:w,pagesNavigatorVisible:S,rtlEnabled:V,showInfo:O,showNavigationButtons:P,showPageSizeSelector:k,itemCount:B,visible:$,style:re,width:fe,height:ei,elementAttr:ti,hint:ni,disabled:ii,tabIndex:oi,accessKey:si,activeStateEnabled:rd,focusStateEnabled:ld,hoverStateEnabled:ad}=this.props.paginationProps;return{pageSize:p,pageIndex:c,pageIndexChangedInternal:h,pageSizeChangedInternal:m,isGridCompatibilityMode:n,className:e,showInfo:O,infoText:o,lightModeEnabled:l,displayMode:t,maxPagesCount:a,pageCount:u,pagesCountText:w,visible:$,hasKnownLastPage:i,pagesNavigatorVisible:S,showPageSizeSelector:k,allowedPageSizes:C,rtlEnabled:V,showNavigationButtons:P,itemCount:B,onKeyDown:d,label:s,style:re,width:fe,height:ei,elementAttr:ti,hint:ni,disabled:ii,tabIndex:oi,accessKey:si,activeStateEnabled:rd,focusStateEnabled:ld,hoverStateEnabled:ad}}getParentWidth(){var e;return(e=this.parentRef)!==null&&e!==void 0&&e.current?Rn(this.parentRef.current):0}updateAdaptivityProps(){var e,t,n,i;const o=df({parent:(e=this.parentRef)===null||e===void 0?void 0:e.current,allowedPageSizes:(t=this.allowedPageSizesRef)===null||t===void 0?void 0:t.current,info:(n=this.infoTextRef)===null||n===void 0?void 0:n.current,pages:(i=this.pagesRef)===null||i===void 0?void 0:i.current});if(this.actualInfoTextVisible!==this.state.infoTextVisible||this.actualIsLargeDisplayMode!==this.state.isLargeDisplayMode)return;const s=!f(this.elementsWidth);s&&(this.elementsWidth={}),(s||this.state.isLargeDisplayMode)&&(this.elementsWidth.allowedPageSizes=o.allowedPageSizes,this.elementsWidth.pages=o.pages),(s||this.state.infoTextVisible)&&(this.elementsWidth.info=o.info),this.actualIsLargeDisplayMode=lf({parent:o.parent,allowedPageSizes:this.elementsWidth.allowedPageSizes,pages:this.elementsWidth.pages}),this.actualInfoTextVisible=af(A({},o,{info:this.elementsWidth.info})),this.setState(()=>({infoTextVisible:this.actualInfoTextVisible})),this.setState(()=>({isLargeDisplayMode:this.actualIsLargeDisplayMode}))}render(){const{infoTextVisible:e,isLargeDisplayMode:t}=this.state,{props:{contentTemplate:n}}=this;return Hr(Q(2,n,A({rootElementRef:this.parentRef,allowedPageSizesRef:this.allowedPageSizesRef,infoTextRef:this.infoTextRef,pagesRef:this.pagesRef,infoTextVisible:e,isLargeDisplayMode:t},this.getContentAttributes())))}}ka.defaultProps=uf;let Ba=class extends zd{constructor(e){super(e),this.__getterCache={},this.pageIndexChangedInternal=this.pageIndexChangedInternal.bind(this),this.pageSizeChangedInternal=this.pageSizeChangedInternal.bind(this)}createEffects(){return[Wd()]}pageIndexChangedInternal(e){const t=e+1;this.setState(()=>({pageIndex:t})),this.props.pageIndexChangedInternal(t)}getPageIndex(){return this.props.pageIndex-1}pageSizeChangedInternal(e){this.setState(()=>({pageSize:e})),this.props.pageSizeChangedInternal(e)}getClassName(){return jn({"dx-datagrid-pager":_a(this.context),[`${this.props.className}`]:!!this.props.className})}getPaginationProps(){return A({},this.props,{className:this.getClassName(),pageIndex:this.getPageIndex(),pageIndexChangedInternal:e=>this.pageIndexChangedInternal(e),pageSizeChangedInternal:e=>this.pageSizeChangedInternal(e)})}render(){return Q(2,ka,{contentTemplate:Aa,paginationProps:this.getPaginationProps()})}};Ba.defaultProps=j;function cf(r){return r<1?1:r}function hf(r){return r<0?0:r}function Ma(r,e){return r>0&&e>0?Math.max(1,Math.ceil(e/r)):1}function pf(r,e,t){if(r<1)return 1;const n=Ma(e,t);return Math.min(r,n)}function gf(r,e,t){const n=cf(r),i=hf(t),o=Ma(n,t),s=pf(e,n,i);return{pageSize:n,pageIndex:s,itemCount:i,pageCount:o}}const mf=["pageSize","pageIndex","itemCount"];class ff extends $d{_optionChanged(e){switch(e.name){case"pageIndex":{const t=this.option("pageIndexChanged");t&&t(e.value);break}case"pageSize":{const t=this.option("pageSizeChanged");t&&t(e.value);break}}super._optionChanged(e)}getPageCount(){return this.option("pageCount")}_validateOptions(e){if(e._skipValidation||this.option("_skipValidation"))return e;const t=super._validateOptions(e);let{pageSize:n,pageIndex:i,itemCount:o}=t,s=Gd(t,mf);n===void 0&&(n=this.option("pageSize")),i===void 0&&(i=this.option("pageIndex")),o===void 0&&(o=this.option("itemCount"));const l=gf(n,i,o);return A({},s,l)}}class Cf extends ff{getProps(){const e=super.getProps();return e.onKeyDown=this._wrapKeyDownHandler(e.onKeyDown),e}get _propsInfo(){return{twoWay:[["pageSize","defaultPageSize","pageSizeChangedInternal","pageSizeChanged"],["pageIndex","defaultPageIndex","pageIndexChangedInternal","pageIndexChanged"]],allowNull:[],elements:[],templates:[],props:["defaultPageSize","pageSizeChanged","pageSizeChangedInternal","defaultPageIndex","pageIndexChanged","pageIndexChangedInternal","isGridCompatibilityMode","className","showInfo","infoText","lightModeEnabled","displayMode","maxPagesCount","pageCount","pagesCountText","visible","hasKnownLastPage","pagesNavigatorVisible","showPageSizeSelector","allowedPageSizes","rtlEnabled","showNavigationButtons","itemCount","label","onKeyDown","pageSize","pageIndex","width","height","elementAttr","hint","disabled","tabIndex","accessKey","activeStateEnabled","focusStateEnabled","hoverStateEnabled","_skipValidation"]}}get _viewComponent(){return Ba}}const pr=function(r){return 1+(parseInt(r.pageIndex())||0)};class _f extends L.View{init(){const e=this.getController("data");e.changed.add(t=>{if(t&&t.repaintChangesOnly){const n=this._pager;n?n.option({pageIndex:pr(e),pageSize:e.pageSize(),pageCount:e.pageCount(),itemCount:e.totalCount(),hasKnownLastPage:e.hasKnownLastPage()}):this.render()}else(!t||t.changeType!=="update"&&t.changeType!=="updateSelection"&&t.changeType!=="updateFocusedRow")&&(this._pager=null,this.render())})}dispose(){this._pager=null}optionChanged(e){const{name:t}=e,n=t==="pager",i=t==="paging",o=t==="dataSource",s=t==="scrolling",l=this.getController("data");if(n||i||s||o){if(e.handled=!0,l.skipProcessingPagingChange(e.fullName))return;(n||i)&&(this._pageSizes=null),o||(this._pager=null,this._invalidate(),ft()&&n&&this.component&&this.component.resize())}}_renderCore(){const e=this,t=e.element().addClass(e.addWidgetPrefix("pager")),n=e.option("pager")??{},i=e.getController("data"),o=e.getController("keyboardNavigation"),s={maxPagesCount:10,pageIndex:pr(i),pageCount:i.pageCount(),pageSize:i.pageSize(),showPageSizeSelector:n.showPageSizeSelector,showInfo:n.showInfo,displayMode:n.displayMode,pagesNavigatorVisible:n.visible,showNavigationButtons:n.showNavigationButtons,label:n.label,allowedPageSizes:e.getPageSizes(),itemCount:i.totalCount(),hasKnownLastPage:i.hasKnownLastPage(),rtlEnabled:e.option("rtlEnabled"),isGridCompatibilityMode:!0,_skipValidation:!0,pageIndexChanged(l){i.pageIndex()!==l-1&&i.pageIndex(l-1)},pageSizeChanged(l){i.pageSize(l)},onKeyDown:l=>o&&o.executeAction("onKeyDown",l)};if(f(n.infoText)&&(s.infoText=n.infoText),this._pager){this._pager.repaint();return}ft()?this._pager=e._createComponent(t,Cf,s):t.addClass("dx-pager").html('<div class="dx-pages"><div class="dx-page"></div></div>')}getPager(){return this._pager}getPageSizes(){const e=this,t=e.getController("data"),n=e.option("pager"),i=n&&n.allowedPageSizes,o=t.pageSize();return(!f(e._pageSizes)||!e._pageSizes.includes(o))&&(e._pageSizes=[],n&&(Array.isArray(i)?e._pageSizes=i:i&&o>1&&(e._pageSizes=[Math.floor(o/2),o,2*o]))),e._pageSizes}isVisible(){const e=this.getController("data"),t=this.option("pager");let n=t&&t.visible;const i=this.option("scrolling");return n==="auto"&&(i&&(i.mode==="virtual"||i.mode==="infinite")?n=!1:n=e.pageCount()>1||e.isLoaded()&&!e.hasKnownLastPage()),!!n}getHeight(){return this.getElementHeight()}}const wf={defaultOptions:()=>({pager:{visible:"auto",showPageSizeSelector:!1,allowedPageSizes:"auto",label:_.format("dxPager-ariaLabel")}}),views:{pagerView:_f}};T.registerModule("pager",wf);const gr="columns-separator-transparent",ue="dxDataGridResizingReordering",Gt=function(r){return r.option("allowColumnResizing")||r.getController("columns").isColumnOptionUsed("allowResizing")},Na=function(r){return r.option("allowColumnReordering")||r.getController("columns").isColumnOptionUsed("allowReordering")};class xf extends L.View{init(){super.init(),this._tablePositionController=this.getController("tablePosition"),this._subscribeToCallback()}dispose(){this._unsubscribeFromCallback(),super.dispose()}optionChanged(e){e.name==="allowColumnResizing"&&(this._unsubscribeFromCallback(),e.value&&(this._subscribeToCallback(),this._invalidate())),super.optionChanged(e)}_renderCore(){const e=super._renderCore();return this.element().addClass(this.addWidgetPrefix("tracker")),this.hide(),e}_unsubscribeFromCallback(){this._positionChanged&&this._tablePositionController.positionChanged.remove(this._positionChanged)}_subscribeToCallback(){const e=this;e._positionChanged=function(t){const n=e.element();n&&n.hasClass(e.addWidgetPrefix("tracker"))&&(n.css({top:t.top}),tt(n,t.height))},this._tablePositionController.positionChanged.add(e._positionChanged)}isVisible(){return Gt(this)}show(){this.element().show()}hide(){this.element()&&this.element().hide()}setHeight(e){tt(this.element(),e)}}class La extends L.View{_renderSeparator(){}_renderCore(e){const t=super._renderCore(e);return this._isShown=!0,this._renderSeparator(),this.hide(),t}show(){this._isShown=!0}hide(){this._isShown=!1}height(e){const t=this.element();if(t)if(f(e))tt(t,e);else return J(t)}width(e){const t=this.element();if(t)if(f(e))Un(t,e);else return K(t)}}class vf extends La{init(){super.init(),this._tablePositionController=this.getController("tablePosition"),this._init()}dispose(){this._unsubscribeFromCallback(),super.dispose()}optionChanged(e){e.name==="allowColumnResizing"&&(e.value?(this._init(),this._invalidate(),this.hide(!0)):(this._unsubscribeFromCallback(),this._isTransparent=Gt(this),this.hide(!0))),super.optionChanged(e)}_renderSeparator(){super._renderSeparator(),this.element().addClass(this.addWidgetPrefix("columns-separator"))}_subscribeToCallback(){const e=this;let t;e._positionChanged=function(n){t=e.element(),t&&(t.css({top:n.top}),tt(t,n.height))},e._tablePositionController.positionChanged.add(e._positionChanged)}_unsubscribeFromCallback(){this._positionChanged&&this._tablePositionController.positionChanged.remove(this._positionChanged)}_init(){this._isTransparent=Gt(this),this.isVisible()&&this._subscribeToCallback()}isVisible(){return this.option("showColumnHeaders")&&(Na(this)||Gt(this))}show(){const e=this,t=this.element();t&&!e._isShown&&(e._isTransparent?t.removeClass(e.addWidgetPrefix(gr)):t.show()),super.show()}hide(e){const t=this.element(),n=this.addWidgetPrefix(gr);t&&(this._isShown||e)&&(this._isTransparent?(t.addClass(n),t.css("left",""),t.show()):(t.hasClass(n)&&t.removeClass(n),t.hide())),super.hide()}moveByX(e){const t=this.element();t&&t.css("left",e===null?0:e-this._parentElement().offset().left)}changeCursor(e){e=f(e)?e:"";const t=this.element();t&&t.css("cursor",e)}}class yf extends La{init(){super.init(),this.getController("data").loadingChanged.add(t=>{t||this.hide()})}_renderSeparator(){super._renderSeparator(),this.element().addClass("dx-block-separator").html("&nbsp;")}hide(){const e=this,t=this._parentElement(),n=this.element();n&&this._isShown&&n.css("display","none"),t&&!t.children(".dx-block-separator").length&&t.prepend(e.element()),super.hide()}isVisible(){const e=this.option("groupPanel"),t=this.option("columnChooser");return e&&e.visible||t&&t.enabled}show(e){const t=this.element();if(t&&!this._isShown)switch(e){case"group":this.element().css("display","block");break;case"columnChooser":(function(n){Yo.stop(t,!0),Yo.animate(t,{type:"slide",from:{width:0,display:n.display},to:n,duration:300,easing:"swing"})})({width:"100%",display:"block"});break;default:t.css("display","")}super.show()}}class bf extends L.View{init(){super.init();const e=this.getController("data");this._controller=this.getController("draggingHeader"),this._columnsResizerViewController=this.getController("columnsResizer"),this._columnsController=this.getController("columns"),this._isDragging=!1,e.loadingChanged.add(t=>{const n=this.element();!t&&n&&n.hide()})}isDragging(){return this._isDragging}_getDraggingPanelByPos(e){let t;return b(this._dragOptions.draggingPanels,(n,i)=>{if(i){const o=i.getBoundingRect();if(o&&(o.bottom===void 0||e.y<o.bottom)&&(o.top===void 0||e.y>o.top)&&(o.left===void 0||e.x>o.left)&&(o.right===void 0||e.x<o.right))return t=i,!1}}),t}_renderCore(){this.element().addClass(`${this.addWidgetPrefix("drag-header")} ${this.addWidgetPrefix("text-content")} dx-widget`).hide()}_resetTargetColumnOptions(){const e=this._dropOptions;e.targetColumnIndex=-1,delete e.targetColumnElement,delete e.isLast,delete e.posX,delete e.posY}_getVisibleIndexObject(e,t){return f(e)?{columnIndex:t,rowIndex:e}:t}dispose(){const e=this.element();this._dragOptions=null,e&&e.parent().find(`.${this.addWidgetPrefix("drag-header")}`).remove()}isVisible(){const e=this._columnsController.getCommonSettings();return this.option("showColumnHeaders")&&(Na(this)||e.allowGrouping||e.allowHiding)}dragHeader(e){const{columnElement:t}=e,n=!!e.sourceColumn.type;this._isDragging=!0,this._dragOptions=e,this._dropOptions={sourceIndex:e.index,sourceColumnIndex:this._getVisibleIndexObject(e.rowIndex,e.columnIndex),sourceColumnElement:e.columnElement,sourceLocation:e.sourceLocation};const i=M.getDocument();this._onSelectStart=i.onselectstart,i.onselectstart=function(){return!1},this._controller.drag(this._dropOptions),this.element().css({textAlign:t&&t.css("textAlign"),height:t&&(n&&t.get(0).clientHeight||J(t)),width:t&&(n&&t.get(0).clientWidth||K(t)),whiteSpace:t&&t.css("whiteSpace")}).addClass(this.addWidgetPrefix("drag-action")).toggleClass("dx-drag-command-cell",n).text(n?"":e.sourceColumn.caption),this.element().appendTo(Kd.getSwatchContainer(t))}moveHeader(e){const t=e.event,{that:n}=t.data,i=Dn(t),o=n._columnsResizerViewController?n._columnsResizerViewController.isResizing():!1,s=n._dragOptions;if(n._isDragging&&!o){const l=n.element(),a=Math.abs(i.x-s.columnElement.offset().left-s.deltaX),d=Math.abs(i.y-s.columnElement.offset().top-s.deltaY);if(l.is(":visible")||a>5||d>5){l.show();const u=i.x-s.deltaX,c=i.y-s.deltaY;l.css({left:u,top:c}),n.dockHeader(i)}t.preventDefault()}}dockHeader(e){const t=this,n=t._getDraggingPanelByPos(e),i=t._controller,o=t._dropOptions,s=t._dragOptions;if(n){const l=t.option("rtlEnabled"),a=n.getName()==="columnChooser",d=a?"y":"x",u=n.getName(),c=u==="headers"?s.rowIndex:void 0,{sourceColumn:h}=s,p=n.getColumnElements(c,h==null?void 0:h.ownerBand)||[],m=s.pointsByTarget=s.pointsByTarget||{},C=u==="columnChooser"?[]:m[u]||i._generatePointsByColumns(y({},s,{targetDraggingPanel:n,columns:n.getColumns(c),columnElements:p,isVerticalOrientation:a,startColumnIndex:u==="headers"?g(p[0]).index():0}));if(m[u]=C,o.targetLocation=u,C.length>0)for(let w=0;w<C.length;w++){const S=C[w+1]&&(C[w][d]+C[w+1][d])/2;if(S===void 0||(l&&d==="x"?e[d]>S:e[d]<S)){o.targetColumnIndex=t._getVisibleIndexObject(c,C[w].columnIndex),p[w]?(o.targetColumnElement=p.eq(w),o.isLast=!1):(o.targetColumnElement=p.last(),o.isLast=!0),o.posX=C[w].x,o.posY=C[w].y,i.dock(o);break}}else t._resetTargetColumnOptions(),i.dock(o)}}dropHeader(e){const t=e.event,{that:n}=t.data,i=n._controller;n.element().hide(),i&&n._isDragging&&i.drop(n._dropOptions),n.element().appendTo(n._parentElement()),n._dragOptions=null,n._dropOptions=null,n._isDragging=!1,M.getDocument().onselectstart=n._onSelectStart||null}}const Ft=function(r){return r.option("columnResizingMode")!=="widget"};class If extends L.ViewController{init(){this._subscribesToCallbacks=[],Gt(this)&&this._init()}dispose(){this._unsubscribes(),super.dispose()}optionChanged(e){super.optionChanged(e),e.name==="allowColumnResizing"&&(e.value?(this._init(),this._subscribeToEvents()):this._unsubscribes())}_isHeadersRowArea(e){if(this._columnHeadersView){const t=this._columnHeadersView.element();if(t){const n=t.offset().top,i=this._columnHeadersView.getHeadersRowHeight();return e>=n&&e<=n+i}}return!1}_isRtlParentStyle(){var e;return this.option("rtlEnabled")&&((e=this._$parentContainer)===null||e===void 0?void 0:e.parent().css("direction"))==="rtl"}_correctColumnIndexForPoint(e,t,n){e.columnIndex-=t}_pointCreated(e,t,n){const i=Ft(this),o=this.option("rtlEnabled"),s=this._isRtlParentStyle(),l=!i&&o&&!s?0:1;if(e.index>=l&&e.index<t+(!i&&(!o||s)?1:0)){this._correctColumnIndexForPoint(e,l,n);const a=n[e.columnIndex]||{},d=n[e.columnIndex+1]||{};return!(i?a.allowResizing&&d.allowResizing:a.allowResizing)}return!0}_getTargetPoint(e,t,n){if(e){for(let i=0;i<e.length;i++)if(!(e[i].x===e[0].x&&e[i+1]&&e[i].x===e[i+1].x)&&e[i].x-n<=t&&t<=e[i].x+n)return e[i]}return null}getSeparatorOffsetX(e){var t;const n=Ft(this),i=this.option("rtlEnabled"),o=this._isRtlParentStyle(),s=e[0].getBoundingClientRect().width;return(((t=e.offset())===null||t===void 0?void 0:t.left)??0)+((n||o)&&i?0:s)}_moveSeparator(e){var t;const n=e.event,i=n.data,o=i._columnsSeparatorView.width(),s=Ft(i),l=o/2,a=i._$parentContainer.offset(),d=a.left,u=Dn(n),c=this._isRtlParentStyle(),h=(t=i._draggingHeaderView)===null||t===void 0?void 0:t.isDragging();if(i._isResizing&&i._resizingInfo){if((d<=u.x||!s&&c)&&(!s||u.x<=d+K(i._$parentContainer))&&i._updateColumnsWidthIfNeeded(u.x)){const p=i._columnHeadersView.getColumnElements().eq(i._resizingInfo.currentColumnIndex);if(p.length){const m=this.getSeparatorOffsetX(p);i._columnsSeparatorView.moveByX(m),i._tablePositionController.update(i._targetPoint.y),n.preventDefault()}}}else h||(i._isHeadersRowArea(u.y)?(i._previousParentOffset&&(i._previousParentOffset.left!==a.left||i._previousParentOffset.top!==a.top)&&i.pointsByColumns(null),i._targetPoint=i._getTargetPoint(i.pointsByColumns(),u.x,o),i._previousParentOffset=a,i._isReadyResizing=!1,i._targetPoint?(i._columnsSeparatorView.changeCursor("col-resize"),i._columnsSeparatorView.moveByX(i._targetPoint.x-l),i._tablePositionController.update(i._targetPoint.y),i._isReadyResizing=!0,n.preventDefault()):(i._columnsSeparatorView.changeCursor(),i._columnsSeparatorView.moveByX(null))):(i.pointsByColumns(null),i._isReadyResizing=!1,i._columnsSeparatorView.changeCursor(),i._columnsSeparatorView.moveByX(null)))}_endResizing(e){const n=e.event.data;n._isResizing&&(n.pointsByColumns(null),n._resizingInfo=null,n._columnsSeparatorView.hide(),n._columnsSeparatorView.changeCursor(),n._trackerView.hide(),n._isReadyResizing=!1,n._isResizing=!1)}_getNextColumnIndex(e){return e+1}_setupResizingInfo(e){const t=this._targetPoint.columnIndex,n=this._getNextColumnIndex(t),i=this._columnHeadersView.getHeaderElement(t),o=this._columnHeadersView.getHeaderElement(n);this._resizingInfo={startPosX:e,currentColumnIndex:t,currentColumnWidth:i!=null&&i.length?Z(i[0]).width:0,nextColumnIndex:n,nextColumnWidth:o!=null&&o.length?Z(o[0]).width:0,needToInvertResizing:this._needToInvertResizing(i)}}_startResizing(e){const t=e.event,n=t.data,i=Dn(t);if(Ud(t)&&(n._isHeadersRowArea(i.y)?(n._targetPoint=n._getTargetPoint(n.pointsByColumns(),i.x,10),n._targetPoint&&(n._columnsSeparatorView.moveByX(n._targetPoint.x-n._columnsSeparatorView.width()/2),n._isReadyResizing=!0)):n._isReadyResizing=!1),n._isReadyResizing){n._setupResizingInfo(i.x),n._isResizing=!0,n._tablePositionController.update(n._targetPoint.y),n._columnsSeparatorView.show(),n._trackerView.show();const o=n.component.getScrollable();o&&n._isRtlParentStyle()&&(n._scrollRight=K(o.$content())-K(o.container())-o.scrollLeft()),t.preventDefault(),t.stopPropagation()}this.isResizing()&&this._editorFactoryController.loseFocus()}_generatePointsByColumns(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const t=this,n=t._columnsController?t._columnsController.getVisibleColumns():[],i=t._columnHeadersView.getColumnElements();let o=[];i&&i.length>0&&(o=v.getPointsByColumns(i,s=>t._pointCreated(s,i.length,n),!1,0,e)),t._pointsByColumns=o}_needToInvertResizing(e){const t=this.option("rtlEnabled"),n=this._isRtlParentStyle();return(Ft(this)||n)&&t}_unsubscribeFromEvents(){this._moveSeparatorHandler&&x.off(M.getDocument(),H(q.move,ue),this._moveSeparatorHandler),this._startResizingHandler&&x.off(this._$parentContainer,H(q.down,ue),this._startResizingHandler),this._endResizingHandler&&(x.off(this._columnsSeparatorView.element(),H(q.up,ue),this._endResizingHandler),x.off(M.getDocument(),H(q.up,ue),this._endResizingHandler))}_subscribeToEvents(){this._moveSeparatorHandler=this.createAction(this._moveSeparator),this._startResizingHandler=this.createAction(this._startResizing),this._endResizingHandler=this.createAction(this._endResizing),x.on(M.getDocument(),H(q.move,ue),this,this._moveSeparatorHandler),x.on(this._$parentContainer,H(q.down,ue),this,this._startResizingHandler),x.on(this._columnsSeparatorView.element(),H(q.up,ue),this,this._endResizingHandler),x.on(M.getDocument(),H(q.up,ue),this,this._endResizingHandler)}_updateColumnsWidthIfNeeded(e){let t,n=!1,i=this._rowsView.contentWidth();const o=this._resizingInfo,s=this._columnsController,l=s.getVisibleColumns(),a=this._columnsSeparatorView.width(),d=Ft(this),u=d&&this.option("adaptColumnWidthByRatio")&&!this.option("columnAutoWidth"),c=this._isRtlParentStyle(),h=l[o.currentColumnIndex],p=l[o.nextColumnIndex],{needToInvertResizing:m}=o;function C(O){return U(O)&&O.endsWith("%")}function w(O,P,k,B){if(O){const $=O.width;$&&(B=C($)),B?(s.columnOption(O.index,"visibleWidth",P),s.columnOption(O.index,"width",`${(P/k*100).toFixed(3)}%`)):(s.columnOption(O.index,"visibleWidth",null),s.columnOption(O.index,"width",P))}}t=e-o.startPosX,m&&(t=-t);let{cellWidth:S,nextCellWidth:V}=function(O){let P,k,B;const $=o.currentColumnWidth+O,re=h&&h.minWidth||a,fe={};return $>=re?fe.cellWidth=$:(fe.cellWidth=re,B=!0),d&&(k=o.nextColumnWidth-O,P=p&&p.minWidth||a,k>=P?B?fe.nextCellWidth=o.nextColumnWidth-(O+re-$):fe.nextCellWidth=k:(fe.nextCellWidth=P,fe.cellWidth=o.currentColumnWidth+(O-P+k))),fe}(t);if(n=h.width!==S,n){if(s.beginUpdate(),S=Math.floor(S),i=function(O,P){if(P.every(B=>B.width)){const B=P.reduce(($,re)=>(C(re.width)&&($+=parseFloat(re.width)),$),0);B>100&&(O=O/B*100)}return O}(i,l),w(h,S,i,u),d)V=Math.floor(V),w(p,V,i,u);else{const O=this._columnHeadersView.getColumnWidths();if(O[o.currentColumnIndex]=S,!(O.reduce((k,B)=>k+B,0)>this._rowsView.contentWidth())){const k=v.getLastResizableColumnIndex(l);k>=0&&s.columnOption(l[k].index,"visibleWidth","auto")}for(let k=0;k<O.length;k++)l[k]&&l[k]!==h&&l[k].width===void 0&&s.columnOption(l[k].index,"width",O[k])}if(s.endUpdate(),!d){this.component.updateDimensions();const O=this.component.getScrollable();if(O&&c){const P=K(O.$content())-K(O.container())-this._scrollRight;O.scrollTo({left:P})}}}return n}_subscribeToCallback(e,t){e.add(t),this._subscribesToCallbacks.push({callback:e,handler:t})}_unsubscribeFromCallbacks(){for(let e=0;e<this._subscribesToCallbacks.length;e++){const t=this._subscribesToCallbacks[e];t.callback.remove(t.handler)}this._subscribesToCallbacks=[]}_unsubscribes(){this._unsubscribeFromEvents(),this._unsubscribeFromCallbacks()}_init(){const e=()=>{this._isResizing||this.pointsByColumns(null)},t=o=>{this._scrollLeft!==o.left&&(this._scrollLeft=o.left,this.pointsByColumns(null))};this._columnsSeparatorView=this.getView("columnsSeparatorView"),this._columnHeadersView=this.getView("columnHeadersView"),this._trackerView=this.getView("trackerView"),this._rowsView=this.getView("rowsView"),this._columnsController=this.getController("columns"),this._tablePositionController=this.getController("tablePosition"),this._editorFactoryController=this.getController("editorFactory"),this._draggingHeaderView=this.component.getView("draggingHeaderView"),this._$parentContainer=this.component.$element(),this._subscribeToCallback(this._columnHeadersView.renderCompleted,e),this._subscribeToCallback(this._columnHeadersView.resizeCompleted,e),this._subscribeToCallback(this._columnsSeparatorView.renderCompleted,()=>{this._unsubscribeFromEvents(),this._subscribeToEvents()}),this._subscribeToCallback(this._rowsView.renderCompleted,()=>{this._rowsView.scrollChanged.remove(t),this._rowsView.scrollChanged.add(t)});let n=this._rowsView.getScrollbarWidth()!==0,i=0;this._subscribeToCallback(this._tablePositionController.positionChanged,o=>{if(this._isResizing&&!this._rowsView.isResizing){const s=this._rowsView.getScrollbarWidth()!==0;n!==s||i&&i!==o.height?(n=s,i=o.height,this.component.updateDimensions()):this._rowsView.updateFreeSpaceRowHeight()}i=o.height})}isResizing(){return this._isResizing}pointsByColumns(e){if(e!==void 0)this._pointsByColumns=e;else return this._pointsByColumns||this._generatePointsByColumns(),this._pointsByColumns}}class Ef extends L.ViewController{constructor(e){super(e),this.positionChanged=Le()}init(){super.init(),this._columnsResizerController=this.getController("columnsResizer"),this._columnHeadersView=this.getView("columnHeadersView"),this._rowsView=this.getView("rowsView"),this._pagerView=this.getView("pagerView"),this._rowsView.resizeCompleted.add(()=>{if(this.option("allowColumnResizing")){const e=this._columnsResizerController._targetPoint;this.update(e?e.y:null)}})}update(e){const t={},n=this._columnHeadersView.element(),i=n&&n.offset(),o=i&&i.top||0,s=f(e)?Math.abs(e-o):0,l=this._columnHeadersView?this._columnHeadersView.getHeight():0,a=this._rowsView.getScrollbarWidth(!0),d=this._rowsView?this._rowsView.height()-a:0,u=this.component.getView("draggingHeaderView");t.height=l,(this._columnsResizerController.isResizing()||u.isDragging())&&(t.height+=d-s),e!==null&&n&&n.length&&(t.top=n[0].offsetTop+s),this.positionChanged.fire(t)}}class Sf extends L.ViewController{init(){super.init(),this._columnsController=this.getController("columns"),this._tablePositionController=this.getController("tablePosition"),this._columnHeadersView=this.getView("columnHeadersView"),this._columnsSeparatorView=this.getView("columnsSeparatorView"),this._draggingHeaderView=this.getView("draggingHeaderView"),this._rowsView=this.getView("rowsView"),this._blockSeparatorView=this.getView("blockSeparatorView"),this._headerPanelView=this.getView("headerPanel"),this._columnChooserView=this.getView("columnChooserView");const e=()=>{if(this._draggingHeaderView){const t=[this._columnChooserView,this._columnHeadersView,this._headerPanelView];this._unsubscribeFromEvents(this._draggingHeaderView,t),this._subscribeToEvents(this._draggingHeaderView,t)}};this._columnHeadersView.renderCompleted.add(e),this._headerPanelView&&this._headerPanelView.renderCompleted.add(e),this._columnChooserView&&this._columnChooserView.renderCompleted.add(e)}dispose(){this._draggingHeaderView&&this._unsubscribeFromEvents(this._draggingHeaderView,[this._columnChooserView,this._columnHeadersView,this._headerPanelView])}_generatePointsByColumns(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this.isCustomGroupColumnPosition=this.checkIsCustomGroupColumnPosition(e),v.getPointsByColumns(e.columnElements,i=>this._pointCreated(i,e.columns,e.targetDraggingPanel.getName(),e.sourceColumn),e.isVerticalOrientation,e.startColumnIndex,t)}checkIsCustomGroupColumnPosition(e){let t=!0;for(let n=0;n<e.columns.length;n+=1){const i=e.columns[n];if(i.command==="expand"&&!t)return!0;i.command||(t=!1)}return!1}_pointCreated(e,t,n,i){const o=t[e.columnIndex],s=t[e.columnIndex-1],l=(s==null?void 0:s.command)==="expand",a=(o==null?void 0:o.command)==="expand"&&(s==null?void 0:s.command)!=="expand",d=i&&!i.allowReordering,u=!(o!=null&&o.allowReordering)&&!(s!=null&&s.allowReordering);switch(n){case"columnChooser":return!0;case"headers":if(d)return!0;if(!a)return l||u;if(this.isCustomGroupColumnPosition)return!1;for(;((c=t[e.columnIndex])===null||c===void 0?void 0:c.command)==="expand";){var c;e.columnIndex+=1}return!1;default:return t.length===0}}_subscribeToEvents(e,t){const n=this;b(t,(i,o)=>{if(o){let s;const l=o.getRowCount?o.getRowCount():1,a=o.getName(),d=function(u,c){if(!c)return;const h=g(c),p=s[u];p&&o.allowDragging(p)&&(h.addClass(n.addWidgetPrefix("drag-action")),x.on(h,H(jo,ue),n.createAction(m=>{const C=m.event,w=Dn(C);e.dragHeader({deltaX:w.x-g(C.currentTarget).offset().left,deltaY:w.y-g(C.currentTarget).offset().top,sourceColumn:p,index:p.index,columnIndex:u,columnElement:h,sourceLocation:a,draggingPanels:t,rowIndex:n._columnsController.getRowIndex(p.index,!0)})})),x.on(h,H(qo,ue),{that:e},n.createAction(e.moveHeader)),x.on(h,H(Xo,ue),{that:e},n.createAction(e.dropHeader)))};for(let u=0;u<l;u++){const c=o.getColumnElements(u)||[];c.length&&(s=o.getColumns(u)||[],b(c,d))}}})}_unsubscribeFromEvents(e,t){const n=this;b(t,(i,o)=>{if(o){const s=o.getColumnElements()||[];b(s,(l,a)=>{const d=g(a);x.off(d,H(jo,ue)),x.off(d,H(qo,ue)),x.off(d,H(Xo,ue)),d.removeClass(n.addWidgetPrefix("drag-action"))})}})}_getSeparator(e){return e==="headers"?this._columnsSeparatorView:this._blockSeparatorView}hideSeparators(e){const t=this._blockSeparatorView,n=this._columnsSeparatorView;this._animationColumnIndex=void 0,t&&t.hide(),e!=="block"&&n&&n.hide()}allowDrop(e){return this._columnsController.allowMoveColumn(e.sourceColumnIndex,e.targetColumnIndex,e.sourceLocation,e.targetLocation)}drag(e){const{sourceIndex:t}=e,{sourceLocation:n}=e,{sourceColumnElement:i}=e,o=this._columnHeadersView,s=this._rowsView;i&&(i.addClass(this.addWidgetPrefix(Pn.draggableColumn)),n==="headers"&&(o&&o.toggleDraggableColumnClass(t,!0),s&&s.toggleDraggableColumnClass(t,!0)))}dock(e){const t=this,n=Y(e.targetColumnIndex)?e.targetColumnIndex.columnIndex:e.targetColumnIndex,{sourceLocation:i}=e,{targetLocation:o}=e,s=t._getSeparator(o),l=n>=0;t._columnHeadersView.element().find(".dx-header-row").toggleClass(t.addWidgetPrefix("drop-highlight"),i!=="headers"&&o==="headers"&&!l),s&&(t.allowDrop(e)&&l?o==="group"||o==="columnChooser"?function(){t._animationColumnIndex!==n&&(t.hideSeparators(),s.element()[e.isLast?"insertAfter":"insertBefore"](e.targetColumnElement),t._animationColumnIndex=n,s.show(o))}():(t.hideSeparators("block"),t._tablePositionController.update(e.posY),s.moveByX(e.posX-s.width()),s.show()):t.hideSeparators())}drop(e){const{sourceColumnElement:t}=e;if(t&&(t.removeClass(this.addWidgetPrefix(Pn.draggableColumn)),this._columnHeadersView.toggleDraggableColumnClass(e.sourceIndex,!1),this._rowsView.toggleDraggableColumnClass(e.sourceIndex,!1),this._columnHeadersView.element().find(".dx-header-row").removeClass(this.addWidgetPrefix("drop-highlight"))),this.allowDrop(e)){const n=this._getSeparator(e.targetLocation);n&&n.hide(),this._columnsController.moveColumn(e.sourceColumnIndex,e.targetColumnIndex,e.sourceLocation,e.targetLocation)}}}const Rf=r=>class extends r{_needUpdateRowHeight(e){const t=this.option("wordWrapEnabled"),n=this._columnsResizerController.isResizing();return super._needUpdateRowHeight.apply(this,arguments)||e>0&&!!t&&!!n}},Tf=r=>class extends r{renderFocusOverlay(){if(!this._columnsResizerController.isResizing())return super.renderFocusOverlay.apply(this,arguments)}},rt={views:{columnsSeparatorView:vf,blockSeparatorView:yf,draggingHeaderView:bf,trackerView:xf},controllers:{draggingHeader:Sf,tablePosition:Ef,columnsResizer:If},extenders:{views:{rowsView:Rf},controllers:{editorFactory:Tf}}};rt.views.draggingHeaderView;rt.controllers.draggingHeader;rt.views.columnsSeparatorView;rt.controllers.tablePosition;rt.controllers.columnsResizer;rt.views.trackerView;T.registerModule("columnsResizingReordering",rt);const Vf=(r,e)=>r.length===e.length&&!Object.keys(r).some(t=>r[t]!==e[t]),Ff=(r,e)=>G(r,e,{maxDepth:4}),Of=(r,e,t,n)=>{let i=r,o=e;return function(){for(var s=arguments.length,l=new Array(s),a=0;a<s;a++)l[a]=arguments[a];return n(l,i)||(i=l,o=t(...i)),o}},Df={compareType:"reference"},mr=function(r){let{compareType:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Df,t=null;return function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];if(!t){const s=r(...i);return t=Of(i,s,r,e==="reference"?Vf:Ff),s}return t(...i)}},oo={ariaColIndex:"aria-colindex",dragCell:"dx-drag-cell"},Ai="rowsview",Pf="edit-form",Ha="dx-data-row",Af="dx-group-row",kf="dx-header-row",Bf="edit-form-item",za="dx-master-detail-row",Wa="dx-freespace-row",Mf="dx-virtual-row",ki="dx-master-detail-cell",Nf="dx-dropdowneditor-overlay",fn="dx-command-expand",Lf="dx-command-adaptive",Hf="dx-adaptive-item-text",$a="dx-command-select",Ga="dx-command-edit",Bi="[class^=dx-command]",Ot="dx-cell-focus-disabled",zf="dxDateBox",fr="dx-state-focused",Wf="dx-widget",$f="dx-revert-button",Cr="dx-focused",Mi="delete",Bt=`
  input:not([type="hidden"]):not([disabled]),
  textarea:not([disabled]),
  a:not([disabled]),
  select:not([disabled]),
  button:not([disabled]),
  [tabindex]:not([disabled]),
  .dx-checkbox:not([disabled],.dx-state-readonly)
`,_r=`${Bt}, .dx-dropdowneditor-icon`,wr="row",xr="cell",vr="columnHeadersView",Gf="rowsView",Kf=["shift","control","alt"],Uf=r=>r.attr(oo.dragCell)!==void 0,jf=r=>[`[${oo.ariaColIndex}="${r+1}"]`,`:not([${oo.dragCell}])`,":not([aria-hidden=true])"].join(""),qf=(r,e)=>r.filter(jf(e)).first(),Ka={isDragCell:Uf,getCellToFocus:qf};function pt(r){return r&&r.hasClass(Af)}function Ua(r){return r&&r.hasClass("dx-datagrid-group-footer")}function Xf(r){return r&&r.hasClass(za)}function Yf(r){return r&&r.hasClass(Hf)}function Qf(r){return r&&r.hasClass(za)&&r.hasClass(Pf)}function Dt(r){return r&&r.hasClass(Ha)}function Jf(r){return!r||r.hasClass(Wa)||r.hasClass(Mf)}function yr(r,e){return!r._isRowEditMode()&&e&&!e.hasClass($a)&&e.hasClass(Qn)}function Ce(r){return f(r)&&r.length>0}function so(){return me.current().deviceType!=="desktop"}function br(r){return!!r.parent(`.${kf}`).length}function Zf(r,e){return r.option("rtlEnabled")?!(e.fixedPosition==="right"||f(e.command)&&!f(e.fixedPosition)):!(!f(e.fixedPosition)||e.fixedPosition==="left")}function eC(r){const e=r.getController("keyboardNavigation");return e._isVirtualScrolling()?r.option("focusedRowIndex")===e.getRowIndex():!1}const tC=r=>class extends r{rowsViewFocusHandler(e){const t=g(e.target);this.translateFocusIfNeed(e,t),super.rowsViewFocusHandler(e)}rowsViewFocusOutHandler(){super.rowsViewFocusOutHandler(),this.makeScrollableFocusableIfNeed()}translateFocusIfNeed(e,t){const n=this.isScrollableNeedFocusable(),i=this._isFixedColumn(0);if(!n||!i)return;const o=this._rowsView.getCell({rowIndex:0,columnIndex:0}),s=!!o.attr("tabindex"),l=t.is(this._$firstNotFixedCell);s&&l&&(e.preventDefault(),this._focus(o))}rowsViewRenderCompleted(e){this._$firstNotFixedCell=this.getFirstNotFixedCell(),this.makeScrollableFocusableIfNeed(),super.rowsViewRenderCompleted(e)}_focus(e,t,n){super._focus(e,t,n),this.makeScrollableFocusableIfNeed()}_tabKeyHandler(e,t){const i=!(f(this._focusedCellPosition)&&!on(this._focusedCellPosition))||!e.shift&&this._isLastValidCell(this._focusedCellPosition)||e.shift&&this._isFirstValidCell(this._focusedCellPosition),o=this.isScrollableNeedFocusable();if(i&&o){var s;(s=this._$firstNotFixedCell)===null||s===void 0||s.removeAttr("tabIndex")}super._tabKeyHandler(e,t)}getFirstNotFixedCell(){var e;const n=this._columnsController.getVisibleColumns().findIndex(o=>{let{fixed:s}=o;return!s}),i=(e=this._editingController)===null||e===void 0?void 0:e.isEditing();return n===-1||i?void 0:this._rowsView._getCellElement(0,n)}isScrollableNeedFocusable(){var e,t;const n=!!this._rowsView.getScrollable(),i=!!((e=this._rowsView._fixedTableElement)!==null&&e!==void 0&&e.length),o=!!((t=this._rowsView.getCellElements(0))!==null&&t!==void 0&&t.length);return n&&i&&o}makeScrollableFocusableIfNeed(){!this.isScrollableNeedFocusable()||!this._$firstNotFixedCell||this._applyTabIndexToElement(this._$firstNotFixedCell)}};class nC extends L.ViewController{init(){if(this._dataController=this.getController("data"),this._selectionController=this.getController("selection"),this._editingController=this.getController("editing"),this._headerPanel=this.getView("headerPanel"),this._rowsView=this.getView("rowsView"),this._columnHeadersView=this.getView("columnHeadersView"),this._columnsController=this.getController("columns"),this._editorFactory=this.getController("editorFactory"),this._focusController=this.getController("focus"),this._adaptiveColumnsController=this.getController("adaptiveColumns"),this._columnResizerController=this.getController("columnsResizer"),this._memoFireFocusedCellChanged=mr(this._memoFireFocusedCellChanged.bind(this),{compareType:"value"}),this._memoFireFocusedRowChanged=mr(this._memoFireFocusedRowChanged.bind(this),{compareType:"value"}),this.focusedHandlerWithContext=this.focusedHandlerWithContext||this.focusedHandler.bind(this),this.columnHeadersViewRenderCompletedWithContext=this.columnHeadersViewRenderCompletedWithContext||this.columnHeadersViewRenderCompleted.bind(this),this.rowsViewRenderCompletedWithContext=this.rowsViewRenderCompletedWithContext||this.rowsViewRenderCompleted.bind(this),this.rowsViewFocusHandlerContext=this.rowsViewFocusHandlerContext||this.rowsViewFocusHandler.bind(this),this.rowsViewFocusOutHandlerContext=this.rowsViewFocusOutHandlerContext??this.rowsViewFocusOutHandler.bind(this),this._updateFocusTimeout=null,this._fastEditingStarted=!1,this._focusedCellPosition={},this._canceledCellPosition=null,this.isKeyboardEnabled()){var e;pu(),(e=this._editorFactory)===null||e===void 0||e.focused.add(this.focusedHandlerWithContext),this.createAction("onKeyDown")}else{var t;ts(),(t=this._editorFactory)===null||t===void 0||t.focused.remove(this.focusedHandlerWithContext)}this.initColumnHeadersViewHandler(),this.initRowsViewHandlers(),this.initDocumentHandlers()}dispose(){super.dispose(),this._resetFocusedView(),lt.off(this._rowsViewKeyDownListener),lt.off(this._columnHeadersViewKeyDownListener),x.off(M.getDocument(),H(q.down,"dxDataGridKeyboardNavigation"),this._documentClickHandler),clearTimeout(this._updateFocusTimeout),ts()}focusedHandler(e){this.setupFocusedView(),this._isNeedScroll&&e.is(":visible")&&this._focusedView&&this._focusedView.getScrollable()&&(this._focusedView._scrollToElement(e),this._isNeedScroll=!1)}rowsViewFocusHandler(e){const t=g(e.target),n=g(e.relatedTarget).closest(this._rowsView.element()).length,i=t.is("a");if(e.relatedTarget&&i&&!n&&this._isEventInCurrentGrid(e)){let l=this._getFocusedCell();l=Ce(l)?l:this._rowsView.getCellElements(0).filter("[tabindex]").eq(0),t.closest(l).length||(e.preventDefault(),x.trigger(l,"focus"))}const o=t.is("td"),s=(this.option("focusedRowIndex")??-1)<0;o&&s&&this._updateFocusedCellPosition(t)}rowsViewFocusOutHandler(){this._toggleInertAttr(!1)}subscribeToRowsViewFocusEvent(){var e;const t=(e=this._rowsView)===null||e===void 0?void 0:e.element();x.on(t,"focusin",this.rowsViewFocusHandlerContext),x.on(t,"focusout",this.rowsViewFocusOutHandlerContext)}unsubscribeFromRowsViewFocusEvent(){var e;const t=(e=this._rowsView)===null||e===void 0?void 0:e.element();x.off(t,"focusin",this.rowsViewFocusHandlerContext),x.off(t,"focusout",this.rowsViewFocusOutHandlerContext)}columnHeadersViewRenderCompleted(){this.initColumnHeadersViewKeyDownHandler()}rowsViewRenderCompleted(e){const t=this._rowsView.element(),n=!e||e.changeType==="refresh",i=this._focusedView&&this._focusedView.name===this._rowsView.name;let o=!1;const s=e&&(e.changeType==="append"||e.changeType==="prepend"),a=g(M.getRootNode(t.get&&t.get(0))).find(":focus"),d=!a.length||a.closest(t).length;this.unsubscribeFromRowsViewFocusEvent(),this.subscribeToRowsViewFocusEvent(),this.initPointerEventHandler(),this.initRowsViewKeyDownHandler(),this._setRowsViewAttributes(),i&&d&&(o=this._isNeedFocus?!s:this._isHiddenFocus&&n&&!(e!=null&&e.virtualColumnsScrolling),o&&this._updateFocus(!0))}initColumnHeadersViewHandler(){var e;if(this.unsubscribeFromColumnHeadersViewKeyDownEvent(),(e=this._columnHeadersView)===null||e===void 0||(e=e.renderCompleted)===null||e===void 0||e.remove(this.columnHeadersViewRenderCompletedWithContext),this.isKeyboardEnabled()){var t;(t=this._columnHeadersView)===null||t===void 0||(t=t.renderCompleted)===null||t===void 0||t.add(this.columnHeadersViewRenderCompletedWithContext)}}initRowsViewHandlers(){var e;this.unsubscribeFromRowsViewFocusEvent(),this.unsubscribeFromPointerEvent(),this.unsubscribeFromRowsViewKeyDownEvent(),(e=this._rowsView)===null||e===void 0||(e=e.renderCompleted)===null||e===void 0||e.remove(this.rowsViewRenderCompletedWithContext),this.isKeyboardEnabled()&&this._rowsView.renderCompleted.add(this.rowsViewRenderCompletedWithContext)}initDocumentHandlers(){const e=M.getDocument();this._documentClickHandler=this._documentClickHandler||this.createAction(t=>{const n=g(t.event.target),i=this._isEventInCurrentGrid(t.event)&&n.closest(`.${this.addWidgetPrefix(Ai)}`).length,o=n.closest(`.${Nf}`).length,s=!!this._columnResizerController&&this._columnResizerController.isResizing();!i&&!o&&!s&&(!(this._focusedView&&n.parents().filter(this._focusedView.element()).length>0)&&this._resetFocusedCell(!0),this._resetFocusedView())}),x.off(e,H(q.down,"dxDataGridKeyboardNavigation"),this._documentClickHandler),this.isKeyboardEnabled()&&x.on(e,H(q.down,"dxDataGridKeyboardNavigation"),this._documentClickHandler)}_setRowsViewAttributes(){const e=this._getRowsViewElement();!this._dataController.getVisibleRows().length&&this._applyTabIndexToElement(e)}unsubscribeFromPointerEvent(){const e=so()?te:q.down,t=this._getRowsViewElement();this._pointerEventAction&&x.off(t,H(e,"dxDataGridKeyboardNavigation"),this._pointerEventAction)}subscribeToPointerEvent(){const e=so()?te:q.down,t=this._getRowsViewElement(),n=`.${He} > td, .${He}`;x.on(t,H(e,"dxDataGridKeyboardNavigation"),n,this._pointerEventAction)}initPointerEventHandler(){this._pointerEventAction=this._pointerEventAction||this.createAction(this._pointerEventHandler),this.unsubscribeFromPointerEvent(),this.subscribeToPointerEvent()}unsubscribeFromColumnHeadersViewKeyDownEvent(){this._columnHeadersViewKeyDownListener&&lt.off(this._columnHeadersViewKeyDownListener)}subscribeToColumnHeadersViewKeyDownEvent(){const e=this._columnHeadersView.element();this._columnHeadersViewKeyDownListener=lt.on(e,null,t=>this._columnHeadersViewKeyDownHandler(t))}initColumnHeadersViewKeyDownHandler(){this.unsubscribeFromColumnHeadersViewKeyDownEvent(),this.subscribeToColumnHeadersViewKeyDownEvent()}unsubscribeFromRowsViewKeyDownEvent(){lt.off(this._rowsViewKeyDownListener)}subscribeToRowsViewKeyDownEvent(){const e=this._getRowsViewElement();this._rowsViewKeyDownListener=lt.on(e,null,t=>this._rowsViewKeyDownHandler(t))}initRowsViewKeyDownHandler(){this._rowsViewKeyDownListener&&this.unsubscribeFromRowsViewKeyDownEvent(),this.subscribeToRowsViewKeyDownEvent()}optionChanged(e){switch(e.name){case"keyboardNavigation":e.fullName==="keyboardNavigation.enabled"&&this.init(),e.handled=!0;break;case"useLegacyKeyboardNavigation":this.init(),e.handled=!0;break;default:super.optionChanged(e)}}isRowFocusType(){return this.focusType===wr}isCellFocusType(){return this.focusType===xr}setRowFocusType(){this.option("focusedRowEnabled")&&(this.focusType=wr)}setCellFocusType(){this.focusType=xr}headerTabKeyHandler(e){}_columnHeadersViewKeyDownHandler(e){e.keyName==="tab"&&this.headerTabKeyHandler(e)}_rowsViewKeyDownHandler(e){var t;let n=!0;this._isNeedFocus=!0,this._isNeedScroll=!0;let i=this._processOnKeyDown(e);const o=(t=this._editingController)===null||t===void 0?void 0:t.isEditing(),{originalEvent:s}=e;if(s.isDefaultPrevented()){this._isNeedFocus=!1,this._isNeedScroll=!1;return}if(!Kf.includes(e.keyName)&&this._updateFocusedCellPositionByTarget(s.target),!i){switch(e.keyName){case"leftArrow":case"rightArrow":this._leftRightKeysHandler(e,o),i=!0;break;case"upArrow":case"downArrow":e.ctrl?fo("rowsView",this,s):this._upDownKeysHandler(e,o),i=!0;break;case"pageUp":case"pageDown":this._pageUpDownKeyHandler(e),i=!0;break;case"space":i=this._spaceKeyHandler(e,o);break;case"A":On(e.originalEvent)?(this._ctrlAKeyHandler(e,o),i=!0):i=this._beginFastEditing(e.originalEvent);break;case"tab":this._tabKeyHandler(e,o),i=!0;break;case"enter":this._enterKeyHandler(e,o),i=!0;break;case"escape":i=this._escapeKeyHandler(e,o);break;case"F":On(e.originalEvent)?(this._ctrlFKeyHandler(e),i=!0):i=this._beginFastEditing(e.originalEvent);break;case"F2":this._f2KeyHandler(),i=!0;break;case"del":case"backspace":this._isFastEditingAllowed()&&!this._isFastEditingStarted()&&(i=this._beginFastEditing(s,!0))}!i&&!this._beginFastEditing(s)&&(this._isNeedFocus=!1,this._isNeedScroll=!1,n=!1),n&&s.stopPropagation()}}_processOnKeyDown(e){const{originalEvent:t}=e,n={handled:!1,event:t};return this.executeAction("onKeyDown",n),e.ctrl=t.ctrlKey,e.alt=t.altKey,e.shift=t.shiftKey,!!n.handled}_closeEditCell(){const e=E();return setTimeout(()=>{this._editingController.closeEditCell().always(e.resolve)}),e}_leftRightKeysHandler(e,t){const n=this.getVisibleRowIndex(),i=e.originalEvent,o=this._focusedView&&this._focusedView.getRow(n),s=this._getDirectionCodeByKey(e.keyName),l=this._isFastEditingStarted();if((!t||l)&&Dt(o)){this.setCellFocusType(),l&&this._closeEditCell(),this._isVirtualColumnRender()&&this._processVirtualHorizontalPosition(s);const d=this._getNextCell(s);Ce(d)&&this._arrowKeysHandlerFocusCell(i,d,s),i&&i.preventDefault()}}isInsideMasterDetail(e){const t=e.closest(`.${ki}`);return!!t.get(0)&&this.elementIsInsideGrid(t)&&!e.is(t)}_upDownKeysHandler(e,t){var n,i;const o=this.getVisibleRowIndex(),s=this._focusedView&&this._focusedView.getRow(o),l=e.originalEvent,a=e.keyName==="upArrow",d=this._dataController.dataSource(),u=(n=this._editingController)===null||n===void 0||(i=n.isEditRowByIndex)===null||i===void 0?void 0:i.call(n,o),c=this._isFastEditingStarted(),h=this.isInsideMasterDetail(g(l==null?void 0:l.target));if((!u||!t||c)&&s&&!Qf(s)&&!h){if(c&&this._closeEditCell(),!this._navigateNextCell(l,e.keyName)&&this._isVirtualRowRender()&&a&&d&&!d.isLoading()){const m=se(s),C=this._focusedCellPosition.rowIndex-1;this._scrollBy(0,-m,C,l)}l&&l.preventDefault()}}_pageUpDownKeyHandler(e){const t=this._dataController.pageIndex(),n=this._dataController.pageCount(),i=this.option("paging.enabled"),o=e.keyName==="pageUp",s=o?-1:1,l=this._rowsView.getScrollable();i&&!this._isVirtualScrolling()?(o?t>0:t<n-1)&&!this._isVirtualScrolling()&&(this._dataController.pageIndex(t+s),e.originalEvent.preventDefault()):l&&J(l.container())<J(l.$content())&&(this._scrollBy(0,J(l.container())*s),e.originalEvent.preventDefault())}_spaceKeyHandler(e,t){const n=this.getVisibleRowIndex(),i=g(e.originalEvent&&e.originalEvent.target);if(this.option("selection")&&this.option("selection").mode!=="none"&&!t){const o=this._getElementType(i)==="row"&&this.isRowFocusType()&&Dt(i);return i.hasClass($a)&&this.option("selection.showCheckBoxesMode")==="onClick"&&this._selectionController.startSelectionWithCheckboxes(),o||i.parent().hasClass(Ha)||i.hasClass(this.addWidgetPrefix(Ai))?(this._selectionController.changeItemSelection(n,{shift:e.shift,control:e.ctrl}),e.originalEvent.preventDefault(),!0):!1}return this._beginFastEditing(e.originalEvent)}_ctrlAKeyHandler(e,t){!t&&!e.alt&&this.option("selection.mode")==="multiple"&&this.option("selection.allowSelectAll")&&(this._selectionController.selectAll(),e.originalEvent.preventDefault())}_toggleInertAttr(e){}_tabKeyHandler(e,t){const n=this.option("editing"),i=e.shift?"previous":"next",o=f(this._focusedCellPosition)&&!on(this._focusedCellPosition),s=e.shift&&this._isFirstValidCell(this._focusedCellPosition),l=!e.shift&&this._isLastValidCell(this._focusedCellPosition);let a=!o||s||l;const d=e.originalEvent.target,u=this._focusedView&&this._focusedView.element();if(!this._handleTabKeyOnMasterDetailCell(d,i)){if(g(u).addClass(fr),n&&d&&!a)if(g(d).hasClass(this.addWidgetPrefix(Ai))&&this._resetFocusedCell(),this._isVirtualColumnRender()&&this._processVirtualHorizontalPosition(i),t){if(!this._editingCellTabHandler(e,i))return}else this._targetCellTabHandler(e,i)&&(a=!0);if(a){const h=this._getFocusedCell().is(Bi);l&&!h&&this._toggleInertAttr(!0),this._editorFactory.loseFocus(),this._editingController.isEditing()&&!this._isRowEditMode()&&(this._resetFocusedCell(!0),this._resetFocusedView(),this._closeEditCell())}else e.originalEvent.preventDefault()}}_getMaxHorizontalOffset(){const e=this.component.getScrollable();return e?e.scrollWidth()-K(this._rowsView.element()):0}_isColumnRendered(e){const t=this._columnsController.getVisibleColumns(null,!0),n=this._columnsController.getVisibleColumns(),i=t[e];let o=!1;return i&&(o=n.indexOf(i)>=0),o}_isFixedColumn(e){const n=this._columnsController.getVisibleColumns(null,!0)[e];return!!n&&!!n.fixed}_isColumnVirtual(e){const t=e-this._columnsController.getColumnIndexOffset(),i=this._columnsController.getVisibleColumns()[t];return!!i&&i.command==="virtual"}_processVirtualHorizontalPosition(e){const t=this.component.getScrollable(),n=this.getColumnIndex();let i,o=0,s=!1;switch(e){case"next":case"nextInRow":{const l=this._getVisibleColumnCount();i=n+1,o=this.option("rtlEnabled")?this._getMaxHorizontalOffset():0,e==="next"?s=l===i||this._isFixedColumn(n)&&!this._isColumnRendered(i):s=l>i&&this._isFixedColumn(n)&&!this._isColumnRendered(i);break}case"previous":case"previousInRow":if(i=n-1,o=this.option("rtlEnabled")?0:this._getMaxHorizontalOffset(),e==="previous"){const l=this._columnsController.getColumnIndexOffset();s=i<0&&l===0||this._isFixedColumn(n)&&!this._isColumnRendered(i)}else s=i>=0&&this._isFixedColumn(n)&&!this._isColumnRendered(i)}s?t.scrollTo({left:o}):f(i)&&f(e)&&this._isColumnVirtual(i)&&(o=this._getHorizontalScrollPositionOffset(e),o!==0&&t.scrollBy({left:o,top:0}))}_getHorizontalScrollPositionOffset(e){let t=0;const n=this._getCell(this._focusedCellPosition),i=n&&ye(n);if(i>0){const o=this.option("rtlEnabled")?-1:1;t=e==="nextInRow"||e==="next"?i*o:i*o*-1}return t}_editingCellTabHandler(e,t){const n=e.originalEvent.target;let i=this._getCellElementFromTarget(n),o;const s=e.originalEvent,l=this._getElementType(n);if(i.is(Bi))return!this._targetCellTabHandler(e,t);this._updateFocusedCellPosition(i);const a=this._getNextCellByTabKey(s,t,l);if(i=a.$cell,!i||this._handleTabKeyOnMasterDetailCell(i,t))return!1;const d=this._getColumnByCellElement(i),u=i.parent(),c=this._getRowIndex(u),h=this._dataController.items()[c],p=this._editingController;if(d&&d.allowEditing){const m=!h||h.rowType==="data";o=p.allowUpdating({row:h})?m:h&&h.isNewRow}return o||this._closeEditCell(),this._focusCell(i,!a.isHighlighted)&&(!this._isRowEditMode()&&o?this._editFocusedCell():this._focusInteractiveElement(i,e.shift)),!0}_targetCellTabHandler(e,t){const n=e.originalEvent;let i=n.target,o=this._getElementType(i),s=this._getCellElementFromTarget(i);const l=o==="cell"&&this._getInteractiveElement(s,!e.shift);let a=!1;if(!yr(this,s)&&l!==null&&l!==void 0&&l.length&&i!==l.get(0))a=!0;else{this._focusedCellPosition.rowIndex===void 0&&g(i).hasClass(He)&&this._updateFocusedCellPosition(s),o=this._getElementType(i),this.isRowFocusType()&&(this.setCellFocusType(),o==="row"&&Dt(g(i))&&(i=this.getFirstValidCellInRow(g(i)),o=this._getElementType(i)));const d=this._getNextCellByTabKey(n,t,o);if(s=d.$cell,!s||(s=this._checkNewLineTransition(n,s),!s))return!1;this._focusCell(s,!d.isHighlighted),yr(this,s)||this._focusInteractiveElement(s,e.shift)}return a}_getNextCellByTabKey(e,t,n){let i=this._getNextCell(t,n);const o=i&&this._fireFocusedCellChanging(e,i,!0);return!o||o.cancel?{}:(o.$newCellElement&&(i=o.$newCellElement),{$cell:i,isHighlighted:o.isHighlighted})}_checkNewLineTransition(e,t){const n=this.getVisibleRowIndex(),i=t.parent();if(n!==this._getRowIndex(i)){const o=this._getCellPosition(t),s=this._fireFocusedRowChanging(e,i);if(s.cancel)return;s.rowIndexChanged&&o&&(this.setFocusedColumnIndex(o.columnIndex),t=this._getFocusedCell())}return t}_enterKeyHandler(e,t){var n,i;const o=this.getVisibleRowIndex(),s=this._dataController.getKeyByRowIndex(o),l=(n=this._focusedView)===null||n===void 0?void 0:n.getRow(o),a=this._getFocusedCell(),d=this.option("grouping.allowCollapsing")&&pt(l),u=this.option("masterDetail.enabled")&&(a==null?void 0:a.hasClass(fn)),c=a==null?void 0:a.hasClass(Lf);if(d||u){const h=this._dataController.items()[o],p=(h==null?void 0:h.data)&&!h.data.isContinuation;f(s)&&p&&this._dataController.changeRowExpand(s)}else c?(this._adaptiveColumnsController.toggleExpandAdaptiveDetailRow(s),this._updateFocusedCellPosition(a)):(i=this.getMasterDetailCell(a))!==null&&i!==void 0&&i.is(a)?a.is(":focus")&&this.focusFirstInteractiveElementInside(a):a!=null&&a.hasClass(Ga)||this._processEnterKeyForDataCell(e,t)}focusFirstInteractiveElementInside(e){e.find(Bt).get(0).focus()}_processEnterKeyForDataCell(e,t){const n=this._getEnterKeyDirection(e),i=this._allowEditingOnEnterKey();t||!i&&n?this._handleEnterKeyEditingCell(e.originalEvent).done(()=>{n==="next"||n==="previous"?this._targetCellTabHandler(e,n):(n==="upArrow"||n==="downArrow")&&this._navigateNextCell(e.originalEvent,n)}):i&&this._startEditing(e)}_getEnterKeyDirection(e){const t=this.option("keyboardNavigation.enterKeyDirection"),n=e.shift;if(t==="column")return n?"upArrow":"downArrow";if(t==="row")return n?"previous":"next"}_handleEnterKeyEditingCell(e){const t=E(),{target:n}=e,i=this._getCellElementFromTarget(n),o=this._isRowEditMode();return this._updateFocusedCellPosition(i),o?(this._focusEditFormCell(i),setTimeout(this._editingController.saveEditData.bind(this._editingController)),t.resolve()):(x.trigger(g(n),"change"),this._closeEditCell().always(t.resolve),e.preventDefault()),t}_escapeKeyHandler(e,t){const n=this._getCellElementFromTarget(e.originalEvent.target);if(t)return this._updateFocusedCellPosition(n),this._isRowEditMode()?(this._focusEditFormCell(n),this._editingController.cancelEditData(),this._dataController.items().length===0&&(this._resetFocusedCell(),this._editorFactory.loseFocus())):this._editingController.getEditMode()==="cell"?this._editingController.cancelEditData():this._closeEditCell(),e.originalEvent.preventDefault(),!0;const i=this.getMasterDetailCell(n);return i?(this._focusCell(i),!0):!1}_ctrlFKeyHandler(e){if(this.option("searchPanel.visible")){const t=this._headerPanel.getSearchTextEditor();t&&(t.focus(),e.originalEvent.preventDefault())}}_f2KeyHandler(){const e=this._editingController.isEditing(),t=this.getVisibleRowIndex(),n=this._focusedView&&this._focusedView.getRow(t);!e&&Dt(n)&&this._startEditing()}_navigateNextCell(e,t){const n=this._getNextCell(t),i=this._getDirectionCodeByKey(t);return n&&this._isCellValid(n)?this._arrowKeysHandlerFocusCell(e,n,i):!1}_arrowKeysHandlerFocusCell(e,t,n){const i=n==="prevRow"||n==="nextRow",o=this._fireFocusChangingEvents(e,t,i,!0);return t=o.$newCellElement,!o.cancel&&this._isCellValid(t)?(this._focus(t,!o.isHighlighted),!0):!1}_beginFastEditing(e,t){if(!this._isFastEditingAllowed()||e.altKey||e.ctrlKey||this._editingController.isEditing())return!1;if(t)this._startEditing(e,Mi);else{const{key:n}=e,i=e.keyCode||e.which,o=n||i&&String.fromCharCode(i);o&&(o.length===1||o===Mi)&&this._startEditing(e,o)}return!0}_pointerEventHandler(e){var t;const n=e.event||e;let i=g(n.currentTarget);const o=(t=this._rowsView)===null||t===void 0?void 0:t.element(),s=i.parent(),l=g(n.target).is(Bt),a=!!g(n.target).closest(`.${$f}`).length,d=i.hasClass(fn);this._isEventInCurrentGrid(n)&&(!a&&(this._isCellValid(i,!l)||d)?(i=this._isInsideEditForm(i)?g(n.target):i,this._focusView(),g(o).removeClass(fr),s.hasClass(Wa)?(this._updateFocusedCellPosition(i),this._applyTabIndexToElement(this._focusedView.element()),this._focusedView.focus(!0)):this.getMasterDetailCell(i)?this._updateFocusedCellPosition(i):this._clickTargetCellHandler(n,i)):i.is("td")&&this._resetFocusedCell())}_clickTargetCellHandler(e,t){const n=this._getColumnByCellElement(t),i=this._isCellEditMode();this.setCellFocusType();const o=this._fireFocusChangingEvents(e,t,!0);if(t=o.$newCellElement,o.cancel)this.setRowFocusType(),this.setFocusedRowIndex(o.prevRowIndex),this._editingController.isEditing()&&i&&this._closeEditCell();else{if(o.resetFocusedRow){this._focusController._resetFocusedRow();return}if(o.rowIndexChanged&&(t=this._getFocusedCell()),!o.isHighlighted&&!i&&this.setRowFocusType(),this._updateFocusedCellPosition(t),this._allowRowUpdating()&&i&&n&&n.allowEditing)this._isNeedFocus=!1,this._isHiddenFocus=!1;else{t=this._getFocusedCell();const s=e&&g(e.target).closest(`${_r}, td`),l=s&&s.not(t).is(_r),d=!(!!n&&!n.command&&t.hasClass(Qn))&&(!o.isHighlighted||l);this._focus(t,d,l)}}}_allowRowUpdating(){const e=this.getVisibleRowIndex(),t=this._dataController.items()[e];return this._editingController.allowUpdating({row:t},"click")}focus(e){let t;const n=this.option("focusedRowEnabled"),i=this._isCellElement(g(e));e||(t=".dx-datagrid-rowsview .dx-row[tabindex]",n||(t+=", .dx-datagrid-rowsview .dx-row > td[tabindex]"),e=this.component.$element().find(t).first()),e&&this._focusElement(g(e),i)}getFocusedView(){return this._focusedView}setupFocusedView(){this.isKeyboardEnabled()&&!f(this._focusedView)&&this._focusView()}_focusElement(e,t){const n=g(this._getRowsViewElement()),i=e.closest(n),o=this.isRowFocusType();let s={};!i.length||this._isCellElement(e)&&!this._isCellValid(e)||(this._focusView(),this._isNeedFocus=!0,this._isNeedScroll=!0,(this._isCellElement(e)||pt(e))&&(this.setCellFocusType(),s=this._fireFocusChangingEvents(null,e,!0,t),e=s.$newCellElement,o&&!s.isHighlighted&&this.setRowFocusType()),s.cancel||(this._focus(e,!s.isHighlighted),this._focusInteractiveElement(e)))}_getFocusedViewByElement(e){const t=this.getFocusedView(),n=t&&g(t.element());return e&&e.closest(n).length!==0}_focusView(){this._focusedView=this._rowsView}_resetFocusedView(){this.setRowFocusType(),this._focusedView=null}_focusInteractiveElement(e,t){if(!e)return;const n=this._getInteractiveElement(e,t);v.focusAndSelectElement(this,n)}_focus(e,t,n){const i=e&&!e.hasClass(He)?e.closest(`.${He}`):e;if(i&&Jf(i))return;const o=this._focusedView,s=o&&o.element();let l;this._isHiddenFocus=t;const a=pt(i)||Ua(i)||this.isRowFocusType();a?(l=i,o&&this.setFocusedRowIndex(this._getRowIndex(i))):this._isCellElement(e)&&(l=e,this._updateFocusedCellPosition(e)),l&&(s&&s.find(".dx-row[tabindex], .dx-row > td[tabindex]").filter((d,u)=>v.isElementInCurrentGrid(this,g(u))).not(l).removeClass(Ot).removeClass(Cr).removeAttr("tabindex"),x.one(l,"blur",d=>{d.relatedTarget&&l.removeClass(Ot).removeClass(Cr)}),n||(this._applyTabIndexToElement(l),x.trigger(l,"focus")),t?(l.addClass(Ot),a&&e.addClass(Ot)):this._editorFactory.focus(l))}_updateFocus(e){this._updateFocusTimeout=setTimeout(()=>{if(this._needFocusEditingCell()){this._editingController._focusEditingCell();return}let t=this._getFocusedCell();const n=this._editingController.isEditing();if(!this.getMasterDetailCell(t)||this._isRowEditMode()){if(this._hasSkipRow(t.parent())){const i=this._focusedCellPosition&&this._focusedCellPosition.rowIndex>0?"upArrow":"downArrow";t=this._getNextCell(i)}if(Ce(t))if(t.is("td")||t.hasClass(this.addWidgetPrefix(Bf))){const i=t.is(Bi),o=t.find(":focus"),s=Ce(o),l=this._getColumnByCellElement(t);if((e||!i)&&this._editorFactory.focus()){if(i&&s){v.focusAndSelectElement(this,o);return}!s&&this._focus(t)}else!s&&(this._isNeedFocus||this._isHiddenFocus)&&this._focus(t,this._isHiddenFocus);n&&!(l!=null&&l.showEditorAlways)&&this._focusInteractiveElement.bind(this)(t)}else x.trigger(t,"focus")}})}_getColumnByCellElement(e){const n=this._rowsView.getCellIndex(e)+this._columnsController.getColumnIndexOffset();return this._columnsController.getVisibleColumns(null,!0)[n]}_needFocusEditingCell(){const e=this._editingController.getEditMode()===Yi,t=this._editingController.getEditMode()===Mn,n=e&&this._editingController.hasChanges(),i=t&&this._editingController.isNewRowInEditMode(),o=this._getFocusedCell();return(o.children().length===0||o.find(To).length>0)&&(n||i)}_getFocusedCell(){return g(this._getCell(this._focusedCellPosition))}_updateFocusedCellPositionByTarget(e){var t;if(this._getElementType(e)==="row"&&f((t=this._focusedCellPosition)===null||t===void 0?void 0:t.columnIndex)){const i=g(e);this._focusedView&&pt(i)&&this.setFocusedRowIndex(this._getRowIndex(i))}else this._updateFocusedCellPosition(this._getCellElementFromTarget(e))}_updateFocusedCellPosition(e,t){const n=this._getCellPosition(e,t);return n&&(!e.length||n.rowIndex>=0&&n.columnIndex>=0)&&this.setFocusedCellPosition(n.rowIndex,n.columnIndex),n}_getFocusedColumnIndexOffset(e){let t=0;const n=this._columnsController.getVisibleColumns()[e];return n&&n.fixed?t=this._getFixedColumnIndexOffset(n):e>=0&&(t=this._columnsController.getColumnIndexOffset()),t}_getFixedColumnIndexOffset(e){return Zf(this,e)?this._getVisibleColumnCount()-this._columnsController.getVisibleColumns().length:0}_getCellPosition(e,t){let n;const i=Ce(e)&&e.closest("tr");if(Ce(i)){const o=this._getRowIndex(i);return n=this._rowsView.getCellIndex(e,o),n+=this._getFocusedColumnIndexOffset(n),t&&(n=t==="previous"?n-1:n+1,n=this._applyColumnIndexBoundaries(n)),{rowIndex:o,columnIndex:n}}}_focusCell(e,t){if(this._isCellValid(e))return this._focus(e,t),!0}_focusEditFormCell(e){e.hasClass(ki)&&this._editorFactory.focus(e,!0)}_resetFocusedCell(e){var t;const n=this._getFocusedCell();Ce(n)&&n.removeAttr("tabindex").removeClass(Ot),this._isNeedFocus=!1,this._isNeedScroll=!1,this._focusedCellPosition={},clearTimeout(this._updateFocusTimeout),(t=this._focusedView)===null||t===void 0||t.renderFocusState({preventScroll:e})}restoreFocusableElement(e,t){const n=this;let i,o;const s=f(e),l=this._rowsView.element(),{columnIndex:a}=n._focusedCellPosition,d=n._dataController.getRowIndexOffset();e=s?e:this._rowsView.getTopVisibleItemIndex()+d,s?(o=this._rowsView.getRow(e-d),i=n._fireFocusedRowChanging(t,o),!i.cancel&&i.rowIndexChanged&&(e=i.newRowIndex)):(n._editorFactory.loseFocus(),n._applyTabIndexToElement(l),x.trigger(l,"focus")),(!s||!i.cancel)&&n.setFocusedCellPosition(e,a),s&&n._updateFocus()}_getNewPositionByCode(e,t,n){let{columnIndex:i}=e,{rowIndex:o}=e,s;if(e.rowIndex===void 0&&n==="next")return{columnIndex:0,rowIndex:0};switch(n){case"nextInRow":case"next":s=this._getVisibleColumnCount(),i<s-1&&t!=="row"&&this._hasValidCellAfterPosition({columnIndex:i,rowIndex:o})?i++:!this._isLastRow(o)&&n==="next"&&(i=0,o++);break;case"previousInRow":case"previous":i>0&&t!=="row"&&this._hasValidCellBeforePosition({columnIndex:i,rowIndex:o})?i--:o>0&&n==="previous"&&(o--,s=this._getVisibleColumnCount(),i=s-1);break;case"upArrow":o=o>0?o-1:o;break;case"downArrow":o=this._isLastRow(o)?o:o+1}return{columnIndex:i,rowIndex:o}}setFocusedCellPosition(e,t){this.setFocusedRowIndex(e),this.setFocusedColumnIndex(t)}setFocusedRowIndex(e){this._focusedCellPosition||(this._focusedCellPosition={}),this._focusedCellPosition.rowIndex=e}setFocusedColumnIndex(e){this._focusedCellPosition||(this._focusedCellPosition={}),this._focusedCellPosition.columnIndex=e}getRowIndex(){return this._focusedCellPosition?this._focusedCellPosition.rowIndex:-1}getColumnIndex(){return this._focusedCellPosition?this._focusedCellPosition.columnIndex:-1}getVisibleRowIndex(){var e;const t=(e=this._focusedCellPosition)===null||e===void 0?void 0:e.rowIndex;return!f(t)||t<0?-1:t-this._dataController.getRowIndexOffset()}getVisibleColumnIndex(){var e;const t=(e=this._focusedCellPosition)===null||e===void 0?void 0:e.columnIndex;return f(t)?t-this._columnsController.getColumnIndexOffset():-1}_applyColumnIndexBoundaries(e){const t=this._getVisibleColumnCount();return e<0?e=0:e>=t&&(e=t-1),e}_isCellByPositionValid(e){const t=g(this._getCell(e));return this._isCellValid(t)}_isLastRow(e){const t=this._dataController;if(this._isVirtualRowRender())return e>=t.getMaxRowIndex();const n=Math.max(...t.items().map((i,o)=>i.visible!==!1?o:-1));return e===n}_isFirstValidCell(e){let t=!1;return e.rowIndex===0&&e.columnIndex>=0&&(t=t||!this._hasValidCellBeforePosition(e)),t}_hasValidCellBeforePosition(e){let{columnIndex:t}=e,n=!1;for(;t>0&&!n;){const i={columnIndex:--t,rowIndex:e.rowIndex};n=this._isCellByPositionValid(i)}return n}_hasValidCellAfterPosition(e){let{columnIndex:t}=e,n=!1;const i=this._getVisibleColumnCount();for(;t<i-1&&!n;){const o={columnIndex:++t,rowIndex:e.rowIndex};n=this._isCellByPositionValid(o)}return n}_isLastValidCell(e){const t=e.columnIndex>=0?e.columnIndex+1:0,{rowIndex:n}=e,i={columnIndex:t,rowIndex:n},o=this._dataController.getVisibleRows(),s=o&&o[n];return this._isLastRow(n)?((s==null?void 0:s.rowType)==="group"||(s==null?void 0:s.rowType)==="groupFooter")&&e.columnIndex>0||e.columnIndex===this._getVisibleColumnCount()-1?!0:this._isCellByPositionValid(i)?!1:this._isLastValidCell(i):!1}_isCellValid(e,t){if(Ce(e)){const n=e.parent(),i=this._rowsView.getCellIndex(e)+this._columnsController.getColumnIndexOffset(),o=this._getColumnByCellElement(e),s=this._getVisibleColumnCount(),l=this._editingController,a=Xf(n),d=o&&o.showWhenGrouped,u=o&&!e.hasClass(fn)&&Dt(n),c=function(){return!a&&o&&(!f(o.groupIndex)||d&&u)||parseInt(e.attr("colspan"),10)>1};if(Ka.isDragCell(e))return!1;if(this.getMasterDetailCell(e))return!0;if(s>i&&c()){const p=this._dataController.items(),m=this._rowsView.getRowIndex(n),C=p[m],w=l&&this._isCellEditMode()&&l.isEditing(),S=l&&l.isEditRow(m),V=S||w;return o.command?this._isLegacyNavigation()?!V&&o.command==="expand":w?!1:S?o.command!=="select":!V:w&&C&&C.rowType!=="data"?!1:!V||o.allowEditing||t}}}getFirstValidCellInRow(e,t){const n=this,i=e.find("> td");let o,s;t=t||0;for(let l=t;l<i.length;++l)if(o=i.eq(l),n._isCellValid(o)){s=o;break}return s}_getNextCell(e,t,n){const i=n||this._focusedCellPosition,o=this.isRowFocusType(),s=o||["next","previous"].includes(e);let l,a;if(this._focusedView&&i){const d=this._getNewPositionByCode(i,t,e);l=g(this._getCell(d));const u=e==="previous"?this._isFirstValidCell(d):this._isLastValidCell(d);if(Ce(l)&&!this._isCellValid(l)&&this._isCellInRow(d,s)&&!u&&(o?l=this.getFirstValidCellInRow(l.parent(),d.columnIndex):l=this._getNextCell(e,"cell",d)),a=Ce(l)&&l.parent(),this._hasSkipRow(a)){const c=this._getRowIndex(a);if(!this._isLastRow(c))l=this._getNextCell(e,"row",{columnIndex:i.columnIndex,rowIndex:c});else return null}return Ce(l)?l:null}return null}_startEditing(e,t){const n=this._focusedCellPosition,i=this.getVisibleRowIndex(),o=this.getVisibleColumnIndex(),s=this._dataController.items()[i],l=this._columnsController.getVisibleColumns()[o];this._isAllowEditing(s,l)&&(this._isRowEditMode()?this._editingController.editRow(i):n&&this._startEditCell(e,t))}_isAllowEditing(e,t){return this._editingController.allowUpdating({row:e})&&t&&t.allowEditing}_editFocusedCell(){const e=this.getVisibleRowIndex(),t=this.getVisibleColumnIndex();return this._editingController.editCell(e,t)}_startEditCell(e,t){this._fastEditingStarted=f(t);const n=this._editFocusedCell(),i=jd(n);if(!this._isFastEditingStarted()||!i&&!n)return;const s=i&&t===Mi?"":t,l=i?n:E().resolve(),a=this._rowsView.waitAsyncTemplates(!0);F(l,a).done(()=>{this._editingCellHandler(e,s)})}_editingCellHandler(e,t){var n;const i=this._getFocusedCell().find(Bt).eq(0),o=i.get(0);if(!o)return;const s=At(e,{type:"keydown",target:o}),l=At(e,{type:"keypress",target:o}),a=At(e,{type:"input",target:o});if(a.originalEvent&&(a.originalEvent=At(a.originalEvent,{data:t})),(n=o.select)===null||n===void 0||n.call(o),x.trigger(i,s),!s.isDefaultPrevented()&&(x.trigger(i,l),!l.isDefaultPrevented())){const d=ee.mozilla?25:0;setTimeout(()=>{const u=this._getKeyPressInputValue(i,t);i.val(u);const c=i.closest(`.${Wf}`);x.off(c,"focusout"),x.one(c,"focusout",()=>{x.trigger(i,"change")}),x.trigger(i,a)},d)}}_getKeyPressInputValue(e,t){const n=e.val();return t==="-"&&n==="-0"?"-0":t}_fireFocusChangingEvents(e,t,n,i){let o={};const s=this._getCellPosition(t)??{};return this.isCellFocusType()&&(o=this._fireFocusedCellChanging(e,t,i),o.cancel||(s.columnIndex=o.newColumnIndex,s.rowIndex=o.newRowIndex,i=o.isHighlighted,t=g(this._getCell(s)))),!o.cancel&&n&&t&&(o=this._fireFocusedRowChanging(e,t.parent()),o.cancel||(s.rowIndex=o.newRowIndex,o.isHighlighted=i)),o.$newCellElement=g(this._getCell(s)),o.$newCellElement.length||(o.$newCellElement=t),o}_fireFocusedCellChanging(e,t,n){const i=this.option("focusedColumnIndex"),o=this.option("focusedRowIndex"),s=this._getCellPosition(t),l=s?s.columnIndex:-1,a=s?s.rowIndex:-1,d=this._dataController.getVisibleRows(),u=this._columnsController.getVisibleColumns(),c={cellElement:t,prevColumnIndex:i,prevRowIndex:o,newColumnIndex:l,newRowIndex:a,rows:d,columns:u,event:e,isHighlighted:n||!1,cancel:!1};return this._canceledCellPosition=null,this.executeAction("onFocusedCellChanging",c),(c.newColumnIndex!==l||c.newRowIndex!==a)&&(c.$newCellElement=g(this._getCell({columnIndex:c.newColumnIndex,rowIndex:c.newRowIndex}))),c.cancel&&(this._canceledCellPosition={rowIndex:a,columnIndex:l}),c}_fireFocusedCellChanged(e){const t=this._rowsView.getCellIndex(e),n=e==null?void 0:e.parent().data("options"),i=n==null?void 0:n.key;this._memoFireFocusedCellChanged(i,t)}_memoFireFocusedCellChanged(e,t){const n=this._getFocusedCell(),i=this._getRowIndex(n==null?void 0:n.parent()),o=Math.min(i-this._dataController.getRowIndexOffset(),this._dataController.items().length-1);if(this._editingController.isEditCell(o,t))return;const l=this._dataController.items()[o],a=this._columnsController.getVisibleColumns()[t];this.executeAction("onFocusedCellChanged",{cellElement:n?ie(n):void 0,columnIndex:t,rowIndex:i,row:l,column:a})}_fireFocusedRowChanging(e,t){const n=this._getRowIndex(t),i=this.option("focusedRowIndex"),o=this._dataController.loadingOperationTypes(),s={rowElement:t,prevRowIndex:i,newRowIndex:n,event:e,rows:this._dataController.getVisibleRows(),cancel:!1},l=o.sorting||o.grouping||o.filtering||o.paging;return!this._dataController||this._dataController.isLoading()&&l?(s.cancel=!0,s):(this.option("focusedRowEnabled")&&(this.executeAction("onFocusedRowChanging",s),!s.cancel&&s.newRowIndex!==n&&(s.resetFocusedRow=s.newRowIndex<0,s.resetFocusedRow||this.setFocusedRowIndex(s.newRowIndex),s.rowIndexChanged=!0)),s)}_fireFocusedRowChanged(){var e;const t=this.option("focusedRowEnabled"),n=this.option("focusedRowKey"),i=(e=this._focusController)===null||e===void 0?void 0:e.getFocusedRowIndexByKey(n);!t||f(n)&&i<0||this._memoFireFocusedRowChanged(n,i)}_memoFireFocusedRowChanged(e,t){const n=t-this._dataController.getRowIndexOffset();this.executeAction("onFocusedRowChanged",{rowElement:t<0?void 0:this._rowsView.getRowElement(n),rowIndex:t,row:t<0?void 0:this._dataController.getVisibleRows()[n]})}_isEventInCurrentGrid(e){return v.isElementInCurrentGrid(this,g(e.target))}_isRowEditMode(){const e=this._editingController.getEditMode();return e===Ht||e===Vo}_isCellEditMode(){const e=this._editingController.getEditMode();return e===Yi||e===Mn}_isFastEditingAllowed(){return this._isCellEditMode()&&this.option("keyboardNavigation.editOnKeyPress")}_getInteractiveElement(e,t){const n=e.find(Bt).filter(":visible");return t?n.last():n.first()}_applyTabIndexToElement(e){const t=this.option("tabIndex")??0;e.attr("tabindex",t)}_getCell(e){if(this._focusedView&&e){const t=this._dataController.getRowIndexOffset(),n=this._columnsController.getVisibleColumns(null,!0)[e.columnIndex],i=n&&n.fixed?this._getFixedColumnIndexOffset(n):this._columnsController.getColumnIndexOffset(),o=e.rowIndex>=0?e.rowIndex-t:-1,s=e.columnIndex>=0?e.columnIndex-i:-1;return this._focusedView.getCell({rowIndex:o,columnIndex:s})}}_getRowIndex(e){let t=this._rowsView.getRowIndex(e);return t>=0&&(t+=this._dataController.getRowIndexOffset()),t}_hasSkipRow(e){const t=e&&e.get(0);return t&&t.style.display==="none"}_allowEditingOnEnterKey(){return this.option("keyboardNavigation.enterKeyAction")==="startEdit"}_isLegacyNavigation(){return this.option("useLegacyKeyboardNavigation")}_getDirectionCodeByKey(e){let t;switch(e){case"upArrow":t="prevRow";break;case"downArrow":t="nextRow";break;case"leftArrow":t=this.option("rtlEnabled")?"nextInRow":"previousInRow";break;case"rightArrow":t=this.option("rtlEnabled")?"previousInRow":"nextInRow"}return t}_isVirtualScrolling(){const e=this.option("scrolling.mode");return e==="virtual"||e==="infinite"}_isVirtualRowRender(){return this._isVirtualScrolling()||v.isVirtualRowRendering(this)}_isVirtualColumnRender(){return this.option("scrolling.columnRenderingMode")==="virtual"}_scrollBy(e,t,n,i){const o=this,s=this._rowsView.getScrollable();if(o._focusedCellPosition){const l=function(){s.off("scroll",l),setTimeout(o.restoreFocusableElement.bind(o,n,i))};s.on("scroll",l)}return s.scrollBy({left:e,top:t})}_isInsideEditForm(e){const t=g(e).closest(`.${this.addWidgetPrefix(So)}`);return t.length&&this.elementIsInsideGrid(t)}getMasterDetailCell(e){const t=g(e).closest(`.${ki}`);return t.length&&this.elementIsInsideGrid(t)?t:null}_processNextCellInMasterDetail(e,t){!this._isInsideEditForm(e)&&e&&this._applyTabIndexToElement(e)}_handleTabKeyOnMasterDetailCell(e,t){if(this.getMasterDetailCell(e)){this._updateFocusedCellPosition(g(e),t);const n=this._getNextCell(t,"row");return this._processNextCellInMasterDetail(n,g(e)),!0}return!1}_getElementType(e){return g(e).is("tr")?"row":"cell"}_isFastEditingStarted(){return this._isFastEditingAllowed()&&this._fastEditingStarted}_getVisibleColumnCount(){return this._columnsController.getVisibleColumns(null,!0).length}_isCellInRow(e,t){const{columnIndex:n}=e,i=this._getVisibleColumnCount();return t?n>=0&&n<=i-1:n>0&&n<i-1}_isCellElement(e){return e.length&&e[0].tagName==="TD"}_getCellElementFromTarget(e){const t=this._getElementType(e),n=g(e);let i;return t==="cell"?i=n.closest(`.${He} > td`):i=n.children().not(`.${fn}`).first(),i}_getRowsViewElement(){var e;return(e=this._rowsView)===null||e===void 0?void 0:e.element()}isKeyboardEnabled(){return this.option("keyboardNavigation.enabled")}_processCanceledEditCellPosition(e,t){if(this._canceledCellPosition){const n=this._canceledCellPosition.rowIndex===e&&this._canceledCellPosition.columnIndex===t;return this._canceledCellPosition=null,n}}updateFocusedRowIndex(){const e=this._dataController,t=this.getVisibleRowIndex(),n=e.items(),i=n.length?n.length-1:-1,o=e.getRowIndexOffset();i>=0&&t>i&&this.setFocusedRowIndex(i+o)}}const iC=r=>class extends r{_rowClick(e){const t=this._editingController.getEditRowIndex(),n=this._keyboardNavigationController.isKeyboardEnabled();t===e.rowIndex&&this._keyboardNavigationController.setCellFocusType(),(so()||!n)&&this.option("focusedRowEnabled")&&this._triggerPointerDownEventHandler(e,!n),super._rowClick.apply(this,arguments)}_triggerPointerDownEventHandler(e,t){const{originalEvent:n}=e.event;if(n){const i=g(n.target),o=this.getCellIndex(i),s=this._columnsController.getVisibleColumns()[o],l=this._dataController.items()[e.rowIndex];if(this._keyboardNavigationController._isAllowEditing(l,s)||t){const a=At(n,{currentTarget:n.target});this._keyboardNavigationController._pointerEventHandler(a)}}}renderFocusState(e){super.renderFocusState(e);const{preventScroll:t,pageSizeChanged:n}=e??{},i=this.element();i&&!Br(i)&&i.attr("tabindex",null),n&&this._keyboardNavigationController.updateFocusedRowIndex();let o=this._keyboardNavigationController.getVisibleRowIndex();(!f(o)||o<0)&&(o=0);const s=this.getCellElements(o);this._keyboardNavigationController.isKeyboardEnabled()&&s!==null&&s!==void 0&&s.length&&this.updateFocusElementTabIndex(s,t)}updateFocusElementTabIndex(e,t){const n=e.eq(0).parent();if(pt(n))this._keyboardNavigationController._applyTabIndexToElement(n);else{let i=this._keyboardNavigationController.getColumnIndex();(!f(i)||i<0)&&(i=0),this._updateFocusedCellTabIndex(e,i)}}_updateFocusedCellTabIndex(e,t){const n=this._keyboardNavigationController,i=e?e.length:-1,o=function(l){const a=!!n.getMasterDetailCell(l),d=n._isCellValid(l);if(!a&&d&&n._isCellElement(l))return n._applyTabIndexToElement(l),n.setCellFocusType(),!0},s=Ka.getCellToFocus(e,t);if(s.length)o(s);else{i<=t&&(t=i-1);for(let l=t;l<i&&!o(g(e[l]));++l);}}renderDelayedTemplates(e){super.renderDelayedTemplates.apply(this,arguments),this.waitAsyncTemplates().done(()=>{this._renderFocusByChange(e)})}_renderFocusByChange(e){var t;const{operationTypes:n,repaintChangesOnly:i}=e??{},{fullReload:o,pageSize:s}=n??{},l=!!(e!=null&&(t=e.changeTypes)!==null&&t!==void 0&&t.find(a=>a==="insert"||a==="remove"));if(!e||!i||o||s||l){const a=eC(this);this.renderFocusState({preventScroll:a,pageSizeChanged:s})}}_renderCore(e){const t=super._renderCore.apply(this,arguments);return this._renderFocusByChange(e),t}_editCellPrepared(e){var t;const n=this._getEditorInstance(e),i=(t=this._keyboardNavigationController)===null||t===void 0?void 0:t._isFastEditingStarted();n&&i&&this._handleEditingNavigationMode(n),super._editCellPrepared.apply(this,arguments)}_handleEditingNavigationMode(e){["downArrow","upArrow"].forEach(n=>{const i=e._supportedKeys()[n];e.registerKeyHandler(n,o=>{if(e._input().attr("aria-expanded")==="true")return i&&i.call(e,o)})}),e.registerKeyHandler("leftArrow",We),e.registerKeyHandler("rightArrow",We),e.NAME===zf&&e.option("useMaskBehavior")&&e.registerKeyHandler("enter",We)}_getEditorInstance(e){const t=e.find(".dx-texteditor").eq(0);return v.getWidgetInstance(t)}},oC=r=>class extends r{editCell(e,t){if(this._keyboardNavigationController._processCanceledEditCellPosition(e,t))return!1;const n=super.editCell(e,t);return n&&this._keyboardNavigationController.setupFocusedView(),n}editRow(e){const t=this._keyboardNavigationController.getVisibleColumnIndex(),n=this._columnsController.getVisibleColumns()[t];(n&&n.type||this.option("editing.mode")===Vo)&&this._keyboardNavigationController._resetFocusedCell(),super.editRow(e)}addRow(e){return this._keyboardNavigationController.setupFocusedView(),this._keyboardNavigationController.setCellFocusType(),super.addRow.apply(this,arguments)}getFocusedCellInRow(e){let t=super.getFocusedCellInRow(e);const n=this._dataController.getRowIndexOffset(),i=this._keyboardNavigationController._focusedCellPosition.rowIndex-n;if(this._keyboardNavigationController.isKeyboardEnabled()&&i===e){const o=this._keyboardNavigationController._getFocusedCell();Ce(o)&&!o.hasClass(Ga)&&(t=o)}return t}_processCanceledEditingCell(){this.closeEditCell().done(()=>{this._keyboardNavigationController._updateFocus()})}closeEditCell(){const e=this._keyboardNavigationController;e._fastEditingStarted=!1;const t=super.closeEditCell.apply(this,arguments);return!!this._getFocusedElement().closest(`.${this.addWidgetPrefix(vp)}`).length||e._updateFocus(),t}_getFocusedElement(){var e,t;return g((e=(t=this.component).element)===null||e===void 0?void 0:e.call(t)).find(":focus")}_delayedInputFocus(){this._keyboardNavigationController._isNeedScroll=!0,super._delayedInputFocus.apply(this,arguments)}_isEditingStart(){const e=super._isEditingStart.apply(this,arguments);if(e&&!this._keyboardNavigationController._isNeedFocus){const t=this._keyboardNavigationController._getFocusedCell();this._keyboardNavigationController._focus(t,!0)}return e}},sC=r=>class extends r{_correctRowIndices(e){const t=this._keyboardNavigationController._focusedCellPosition;if(super._correctRowIndices.apply(this,arguments),t&&t.rowIndex>=0){const n=e(t.rowIndex);n&&(t.rowIndex+=n,this._editorFactoryController.refocus())}}getMaxRowIndex(){let e=this.items().length-1;const t=this.virtualItemsCount();if(t){const n=this.getRowIndexOffset();e+=n+t.end}return e}},rC=r=>class extends r{_showHiddenCellsInView(e){let{viewName:t,$cells:n,isCommandColumn:i}=e;super._showHiddenCellsInView.apply(this,arguments),t===vr&&!i&&n.each((o,s)=>{const l=g(s);br(l)&&l.attr("tabindex",0)})}_hideVisibleCellInView(e){let{viewName:t,$cell:n,isCommandColumn:i}=e;super._hideVisibleCellInView.apply(this,arguments),t===vr&&!i&&br(n)&&n.removeAttr("tabindex")}_hideVisibleColumnInView(e){let{view:t,isCommandColumn:n,visibleIndex:i}=e;super._hideVisibleColumnInView({view:t,isCommandColumn:n,visibleIndex:i}),t.name===Gf&&this._rowsView.renderFocusState(null)}},lC={defaultOptions:()=>({useLegacyKeyboardNavigation:!1,keyboardNavigation:{enabled:!0,enterKeyAction:"startEdit",enterKeyDirection:"none",editOnKeyPress:!1}}),controllers:{keyboardNavigation:nC},extenders:{views:{rowsView:iC},controllers:{editing:oC,data:sC,adaptiveColumns:rC,keyboardNavigation:tC}}};T.registerModule("keyboardNavigation",lC);function ro(r,e,t,n){let i=0;if(r<e)for(;i<t.items.length;i++)ro(r+1,e,t.items[i],n);r===e&&n(t)}function Cn(r,e){let t;if("map"in r)return r.map(e);const n=new Array(r.length);for(t in r)n[t]=e(r[t],t);return n}function aC(r){return r!==r||r===""||r===null||r===void 0}function dC(r){return r===zr.count}function Ir(r){const e=ce(r.selector),t="skipEmptyValues"in r?r.skipEmptyValues:!0;let{aggregator:n}=r;if(typeof n=="string"&&(n=zr[n],!n))throw $n.Error("E4001",r.aggregator);return{selector:e,aggregator:n,skipEmptyValues:t}}class uC{constructor(e){this._data=e.data,this._groupLevel=e.groupLevel||0,this._totalAggregates=Cn(e.totalAggregates||[],Ir),this._groupAggregates=Cn(e.groupAggregates||[],Ir),this._totals=[]}calculate(){this._totalAggregates.length&&this._calculateTotals(0,{items:this._data}),this._groupAggregates.length&&this._groupLevel>0&&this._calculateGroups({items:this._data})}totalAggregates(){return this._totals}_aggregate(e,t,n){const i=t.items?t.items.length:0;for(let o=0;o<e.length;o++){if(dC(e[o].aggregator)){n[o]=(n[o]||0)+i;continue}for(let s=0;s<i;s++)this._accumulate(o,e[o],n,t.items[s])}}_calculateTotals(e,t){if(e===0&&(this._totals=this._seed(this._totalAggregates)),e===this._groupLevel)this._aggregate(this._totalAggregates,t,this._totals);else for(let n=0;n<t.items.length;n++)this._calculateTotals(e+1,t.items[n]);e===0&&(this._totals=this._finalize(this._totalAggregates,this._totals))}_calculateGroups(e){const t=this._groupLevel;let n=t+1;const i=this._seed.bind(this,this._groupAggregates),o=this._aggregate.bind(this,this._groupAggregates),s=this._finalize.bind(this,this._groupAggregates);function l(a){a.aggregates=i(n-1),n===t?o(a,a.aggregates):ro(n,t,a,d=>{o(d,a.aggregates)}),a.aggregates=s(a.aggregates)}for(;--n>0;)ro(0,n,e,l)}_seed(e,t){return Cn(e,n=>{const{aggregator:i}=n;return"seed"in i?X(i.seed)?i.seed(t):i.seed:NaN})}_accumulate(e,t,n,i){const o=t.selector(i),{aggregator:s}=t,{skipEmptyValues:l}=t;l&&aC(o)||(n[e]!==n[e]?n[e]=o:n[e]=s.step(n[e],o))}_finalize(e,t){return Cn(e,(n,i)=>{const o=n.aggregator.finalize;return o?o(t[i]):t[i]})}}const cC="dx-cell-focus-disabled",ja=function(r,e){const t=g(r),{column:n}=e,{summaryItems:i}=e,o=[];if(!n.command&&i){for(let s=0;s<i.length;s++){const l=i[s],a=T.getSummaryText(l,e.summaryTexts);o.push(g("<div>").css("textAlign",l.alignment||n.alignment).addClass("dx-datagrid-summary-item").addClass("dx-datagrid-text-content").addClass(l.cssClass).toggleClass("dx-datagrid-group-text-content",e.rowType==="group").text(a).attr("aria-label",`${n.caption} ${a}`))}t.append(o)}},qa=function(r,e){const t=r.option("summary.texts")||{};return{totalItem:e.row,summaryItems:e.row.summaryCells[e.columnIndex],summaryTexts:t}},Ni=function(r){return r.summary||r.aggregates||[]},Mo=function(r){return r.option("summary.recalculateWhileEditing")},Xa=function(r,e,t,n){n=n||[];for(let i=0;i<r.length;i++)n.push(r[i].key),e===1?t(n,r[i].items):Xa(r[i].items,e-1,t,n),n.pop()},Ya=function(r,e,t){return t?Ya(r,e.map(n=>({items:[n]}),t-1)):r.concat(e)},Qa=function(r,e,t){return t?r.map(n=>{const i={},o=Qa(n.items||[],e,t-1);return Object.defineProperty(i,"aggregates",{get:()=>n.aggregates,set:s=>{n.aggregates=s}}),y(i,n,{items:o})}):r.filter(n=>e.indexOf(n)<0)},Ja=function(r,e,t){if(!r||!e.length)return r;const n=e[0],i=t[0];let o;return n&&i&&i.length&&(o=nn(r),b(i,function(s){s===0?o=o.sortBy(this.selector,this.desc):o=o.thenBy(this.selector,this.desc)}),o.enumerate().done(s=>{r=s})),e=e.slice(1),t=t.slice(1),e.length&&t.length&&b(r,function(){this.items=Ja(this.items,e,t)}),r},Er=function(r,e,t){const n=t&&t.sortByGroups&&t.sortByGroups();return n&&n.length?Ja(r,e,n):r},Sr=function(r,e,t,n){let i;if(Mo(r)){const o=r._editingController;if(o){const s=o.getInsertedData();s.length&&(t=Ya(t,s,n));const l=o.getRemovedData();l.length&&(t=Qa(t,l,n))}}return e&&(i=new uC({totalAggregates:e.totalAggregates,groupAggregates:e.groupAggregates,data:t,groupLevel:n}),i.calculate()),i?i.totalAggregates():[]};class hC extends sn{_getRows(){return this._dataController.footerItems()}_getCellOptions(e){return y(super._getCellOptions(e),qa(this,e))}_renderCellContent(e,t){ja(e,t),super._renderCellContent.apply(this,arguments)}_renderCore(e){let t=!1;const n=this._dataController.footerItems()[0];(!e||!e.columnIndices)&&(this.element().empty().addClass("dx-datagrid-total-footer").toggleClass("dx-datagrid-nowrap",!this.option("wordWrapEnabled")),t=!0),n&&n.summaryCells&&n.summaryCells.length&&(this._updateContent(this._renderTable({change:e}),e),t&&this._updateScrollLeftPosition())}_updateContent(e,t){return t&&t.changeType==="update"&&t.columnIndices?this.waitAsyncTemplates().done(()=>{const n=this.getTableElement().find(".dx-row"),i=e.find(".dx-row");this._updateCells(n,i,t.columnIndices[0])}):super._updateContent.apply(this,arguments)}_rowClick(e){const t=this._dataController.footerItems()[e.rowIndex]||{};this.executeAction("onRowClick",y({},e,t))}_columnOptionChanged(e){const{optionNames:t}=e;e.changeTypes.grouping||(t.width||t.visibleWidth)&&super._columnOptionChanged(e)}_handleDataChanged(e){const{changeType:t}=e;e.changeType==="update"&&e.repaintChangesOnly?e.totalColumnIndices?e.totalColumnIndices.length&&this.render(null,{changeType:"update",columnIndices:[e.totalColumnIndices]}):this.render():(t==="refresh"||t==="append"||t==="prepend")&&this.render()}_createRow(e){const t=super._createRow.apply(this,arguments);return e.rowType==="totalFooter"&&(t.addClass("dx-footer-row"),t.addClass(cC),t.attr("tabindex",0)),t}getHeight(){return this.getElementHeight()}isVisible(){return!!this._dataController.footerItems().length}}const pC=r=>class extends r{init(){super.init.apply(this,arguments),this._editingController=this.getController("editing"),this._totalAggregates=[],this._summaryGetter=We}summaryGetter(e){if(!arguments.length)return this._summaryGetter;X(e)&&(this._summaryGetter=e)}summary(e){if(!arguments.length)return this._summaryGetter();this._summaryGetter=function(){return e}}totalAggregates(){return this._totalAggregates}isLastLevelGroupItemsPagingLocal(){const e=this.summary(),t=e==null?void 0:e.sortByGroups();return t==null?void 0:t.length}sortLastLevelGroupItems(e,t,n){const i=Gn.multiLevelGroup(nn(e),t).toArray();let o=[];return n.forEach(s=>{Xa(i,t.length,(l,a)=>{s.toString()===l.toString()&&(o=o.concat(a))})}),o}_customizeRemoteOperations(e){const t=this.summary();t&&(e.remoteOperations.summary?(!e.isCustomLoading||e.storeLoadOptions.isLoadingAll)&&(e.storeLoadOptions.group&&(e.remoteOperations.grouping?e.storeLoadOptions.groupSummary=t.groupAggregates:t.groupAggregates.length&&(e.remoteOperations.paging=!1)),e.storeLoadOptions.totalSummary=t.totalAggregates):(t.totalAggregates.length||t.groupAggregates.length&&e.storeLoadOptions.group)&&(e.remoteOperations.paging=!1)),super._customizeRemoteOperations.apply(this,arguments);const n=e.cachedData.extra;n!=null&&n.summary&&!e.isCustomLoading&&(e.storeLoadOptions.totalSummary=void 0)}_handleDataLoadedCore(e){const t=qt(e.storeLoadOptions.group||e.loadOptions.group||[]),n=e.remoteOperations||{},i=this.summaryGetter()(n);if(!e.isCustomLoading||e.storeLoadOptions.isLoadingAll){if(n.summary)!n.paging&&t.length&&i&&(n.grouping||Sr(this,{groupAggregates:i.groupAggregates},e.data,t.length),e.data=Er(e.data,t,i));else if(!n.paging&&i){var o;const s=e.operationTypes||{};if(!Object.keys(s).some(a=>s[a])||!((o=e.cachedData)!==null&&o!==void 0&&(o=o.extra)!==null&&o!==void 0&&o.summary)||t.length&&i.groupAggregates.length){const a=Sr(this,i,e.data,t.length);e.extra=en(e.extra)?e.extra:{},e.extra.summary=a,e.cachedData&&(e.cachedData.extra=e.extra)}e.data=Er(e.data,t,i)}}e.isCustomLoading||(this._totalAggregates=e.extra&&e.extra.summary||this._totalAggregates),super._handleDataLoadedCore(e)}};Yn.extend(pC);const gC=r=>class extends r{_isDataColumn(e){return e&&(!f(e.groupIndex)||e.showWhenGrouped)}_isGroupFooterVisible(){const e=this.option("summary.groupItems")||[];for(let t=0;t<e.length;t++){const n=e[t],i=this._columnsController.columnOption(n.showInColumn||n.column);if(n.showInGroupFooter&&this._isDataColumn(i))return!0}return!1}_processGroupItems(e,t,n){const i=n&&n.data,o=super._processGroupItems.apply(this,arguments);return n&&(n.isGroupFooterVisible===void 0&&(n.isGroupFooterVisible=this._isGroupFooterVisible()),i&&i.items&&n.isGroupFooterVisible&&(n.collectContinuationItems||!i.isContinuationOnNextPage)&&o.push({rowType:"groupFooter",key:n.path.slice(),data:i,groupIndex:n.path.length-1,values:[]})),o}_processGroupItem(e,t){const n=this;if(t.summaryGroupItems||(t.summaryGroupItems=n.option("summary.groupItems")||[]),e.rowType==="group"){let i=-1,o=-1;b(t.visibleColumns,function(s){const l=t.visibleColumns[s-1];e.groupIndex===this.groupIndex&&(i=this.index),s>0&&l.command==="expand"&&this.command!=="expand"&&(o=this.index)}),e.summaryCells=this._calculateSummaryCells(t.summaryGroupItems,Ni(e.data),t.visibleColumns,(s,l)=>s.showInGroupFooter?-1:s.alignByColumn&&l&&!f(l.groupIndex)&&l.index!==o?l.index:i,!0)}return e.rowType==="groupFooter"&&(e.summaryCells=this._calculateSummaryCells(t.summaryGroupItems,Ni(e.data),t.visibleColumns,(i,o)=>i.showInGroupFooter&&n._isDataColumn(o)?o.index:-1)),e}_calculateSummaryCells(e,t,n,i,o){const s=this,l=[],a={};return b(e,(d,u)=>{const c=s._columnsController.columnOption(u.column),h=u.showInColumn&&s._columnsController.columnOption(u.showInColumn)||c,p=i(u,h);if(p>=0){a[p]||(a[p]=[]);const m=t[d];if(m===m){let C;f(u.valueFormat)?C=u.valueFormat:u.summaryType!=="count"&&(C=T.getFormatByDataType(c&&c.dataType)),a[p].push(y({},u,{value:U(m)&&c&&c.deserializeValue?c.deserializeValue(m):m,valueFormat:C,columnCaption:c&&c.index!==p?c.caption:void 0}))}}}),on(a)||n.forEach((d,u)=>{const c=n[u-1],h=o&&((c==null?void 0:c.command)==="expand"||d.command==="expand")?c==null?void 0:c.index:d.index;l.push(a[h]||[])}),l}_getSummaryCells(e,t){const n=this,i=n._columnsController;return n._calculateSummaryCells(e,t,i.getVisibleColumns(),(o,s)=>n._isDataColumn(s)?s.index:-1)}_updateItemsCore(e){const t=this;let n;const i=t._dataSource,o=t._footerItems,s=o&&o[0]&&o[0].summaryCells,l=t.option("summary.totalItems");if(t._footerItems=[],i&&l&&l.length){const a=i.totalAggregates();n=t._getSummaryCells(l,a),e&&e.repaintChangesOnly&&s&&(e.totalColumnIndices=n.map((d,u)=>JSON.stringify(d)!==JSON.stringify(s[u])?u:-1).filter(d=>d>=0)),n.length&&t._footerItems.push({rowType:"totalFooter",summaryCells:n})}super._updateItemsCore(e)}_prepareUnsavedDataSelector(e){if(Mo(this)){const t=this._editingController;if(t)return function(n){return n=t.getUpdatedData(n),e(n)}}return e}_prepareAggregateSelector(e,t){return e=this._prepareUnsavedDataSelector(e),t==="avg"||t==="sum"?function(n){const i=e(n);return f(i)?Number(i):i}:e}_getAggregates(e,t){const n=this;let i=n.option("summary.calculateCustomSummary");const o=n.option("summary.skipEmptyValues");return zn(e||[],s=>{const l=this._columnsController.columnOption(s.column),a=l&&l.calculateCellValue?l.calculateCellValue.bind(l):ce(l?l.dataField:s.column);let d=s.summaryType||"count";const u=f(s.skipEmptyValues)?s.skipEmptyValues:o;if(t)return{selector:s.column,summaryType:d};const c=n._prepareAggregateSelector(a,d);if(d==="custom"){i||(oe.log("E1026"),i=function(){});const h={component:n.component,name:s.name};i(h),h.summaryProcess="calculate",d={seed(p){return h.summaryProcess="start",h.totalValue=void 0,h.groupIndex=p,delete h.value,i(h),h.totalValue},step(p,m){return h.summaryProcess="calculate",h.totalValue=p,h.value=m,i(h),h.totalValue},finalize(p){return h.summaryProcess="finalize",h.totalValue=p,delete h.value,i(h),h.totalValue}}}return{selector:c,aggregator:d,skipEmptyValues:u}})}_addSortInfo(e,t,n,i){if(t){const{groupIndex:o}=t;i=i||t.sortOrder,f(o)&&(e[o]=e[o]||[],e[o].push({selector:n,desc:i==="desc"}))}}_findSummaryItem(e,t){let n=-1;return f(t)&&b(e||[],function(i){if(this.name===t||i===t||this.summaryType===t||this.column===t||function(o){const{summaryType:s}=o,{column:l}=o;return s&&l&&`${s}_${l}`}(this)===t)return n=i,!1}),n}_getSummarySortByGroups(e,t){const n=this,i=n._columnsController,o=i.getGroupColumns(),s=[];if(!(!t||!t.length))return b(e||[],function(){const{sortOrder:l}=this;let{groupColumn:a}=this;const d=n._findSummaryItem(t,this.summaryItem);if(d<0)return;const u=function(c){return Ni(c)[d]};f(a)?(a=i.columnOption(a),n._addSortInfo(s,a,u,l)):b(o,(c,h)=>{n._addSortInfo(s,h,u,l)})}),s}_createDataSourceAdapterCore(e,t){const n=this,i=super._createDataSourceAdapterCore(e,t);return i.summaryGetter(o=>n._getSummaryOptions(o||t)),i}_getSummaryOptions(e){const t=this,n=t.option("summary.groupItems"),i=t.option("summary.totalItems"),o=t.option("sortByGroupSummaryInfo"),s=t._getAggregates(n,e&&e.grouping&&e.summary),l=t._getAggregates(i,e&&e.summary),a=function(){return t._getSummarySortByGroups(o,n)};if(s.length||l.length)return{groupAggregates:s,totalAggregates:l,sortByGroups:a}}publicMethods(){const e=super.publicMethods();return e.push("getTotalSummaryValue"),e}getTotalSummaryValue(e){const t=this._findSummaryItem(this.option("summary.totalItems"),e),n=this._dataSource.totalAggregates();if(n.length&&t>-1)return n[t]}optionChanged(e){(e.name==="summary"||e.name==="sortByGroupSummaryInfo")&&(e.name="dataSource"),super.optionChanged(e)}init(){this._footerItems=[],super.init()}footerItems(){return this._footerItems}},mC=r=>class extends r{_refreshSummary(){Mo(this)&&!this.isSaving()&&this._dataController.refresh({load:!0,changesOnly:!0})}_addChange(e){const t=super._addChange.apply(this,arguments);return e.type&&this._refreshSummary(),t}_removeChange(){const e=super._removeChange.apply(this,arguments);return this._refreshSummary(),e}cancelEditData(){const e=super.cancelEditData.apply(this,arguments);return this._refreshSummary(),e}},fC=r=>class extends r{_createRow(e){const t=super._createRow.apply(this,arguments);return e&&t.addClass(e.rowType==="groupFooter"?"dx-datagrid-group-footer":""),t}_renderCells(e,t){super._renderCells.apply(this,arguments),t.row.rowType==="group"&&t.row.summaryCells&&t.row.summaryCells.length&&this._renderGroupSummaryCells(e,t)}_hasAlignByColumnSummaryItems(e,t){return!f(t.columns[e].groupIndex)&&t.row.summaryCells[e].length}_getAlignByColumnCellCount(e,t){let n=0;for(let i=1;i<e;i++){const o=t.row.summaryCells.length-i;n=this._hasAlignByColumnSummaryItems(o,t)?i:n}return n}_renderGroupSummaryCells(e,t){const n=e.children().last(),i=Number(n.attr("colSpan"))||1,o=this._getAlignByColumnCellCount(i,t);this._renderGroupSummaryCellsCore(n,t,i,o)}_renderGroupSummaryCellsCore(e,t,n,i){if(i>0){e.attr("colSpan",n-i);for(let o=0;o<i;o++){const s=t.columns.length-i+o;this._renderCell(e.parent(),y({column:t.columns[s],columnIndex:this._getSummaryCellIndex(s,t.columns)},t))}}}_getSummaryCellIndex(e,t){return e}_getCellTemplate(e){return!e.column.command&&!f(e.column.groupIndex)&&e.summaryItems&&e.summaryItems.length?ja:super._getCellTemplate(e)}_getCellOptions(e){const t=this,n=super._getCellOptions(e);return e.row.summaryCells?y(n,qa(t,e)):n}};T.registerModule("summary",{defaultOptions:()=>({summary:{groupItems:void 0,totalItems:void 0,calculateCustomSummary:void 0,skipEmptyValues:!0,recalculateWhileEditing:!1,texts:{sum:_.format("dxDataGrid-summarySum"),sumOtherColumn:_.format("dxDataGrid-summarySumOtherColumn"),min:_.format("dxDataGrid-summaryMin"),minOtherColumn:_.format("dxDataGrid-summaryMinOtherColumn"),max:_.format("dxDataGrid-summaryMax"),maxOtherColumn:_.format("dxDataGrid-summaryMaxOtherColumn"),avg:_.format("dxDataGrid-summaryAvg"),avgOtherColumn:_.format("dxDataGrid-summaryAvgOtherColumn"),count:_.format("dxDataGrid-summaryCount")}},sortByGroupSummaryInfo:void 0}),views:{footerView:hC},extenders:{controllers:{data:gC,editing:mC},views:{rowsView:fC}}});const CC={detailRow:"dx-master-detail-row"},_C=(r,e)=>{r.addClass(e(z.stickyColumnBorderLeft))},wC=(r,e)=>{r.addClass(e(z.stickyColumnBorderRight))},xC=(r,e,t)=>{switch(e){case N.Right:r.addClass(t(z.stickyColumnRight));break;case N.Sticky:r.addClass(t(z.stickyColumn));break;default:r.addClass(t(z.stickyColumnLeft))}},vC=(r,e,t)=>{r.toggleClass(t(z.firstHeader),e)},yC=(r,e,t)=>{r.toggleClass(t(z.columnNoBorder),e)},bC=(r,e,t)=>{r.toggleClass(t(z.stickyColumns),e)},Jn=(r,e,t)=>{if(!r.hasClass(t(z.stickyColumn)))return!1;const i=parseFloat(r[0].style.left),o=Z(r[0]),s=Z(e[0]),l=o.left-s.left;return Math.round(i)>=Math.round(l)},ln=(r,e,t)=>{if(!r.hasClass(t(z.stickyColumn)))return!1;const i=parseFloat(r[0].style.right),o=Z(r[0]),l=Z(e[0]).right-o.right;return Math.round(i)>=Math.round(l)},IC=(r,e,t)=>Jn(r,e,t)||ln(r,e,t),EC=(r,e,t)=>r.hasClass(t(z.stickyColumnRight))||ln(r,e,t),Za=(r,e)=>r.hasClass(e(z.stickyColumnLeft))&&r.hasClass(e(z.stickyColumnBorderRight)),ed=(r,e)=>r.hasClass(e(z.stickyColumnRight))&&r.hasClass(e(z.stickyColumnBorderLeft)),SC=(r,e)=>r.hasClass(e(z.stickyColumn)),td=(r,e)=>r.hasClass(e(z.stickyColumnLeft))||r.hasClass(e(z.stickyColumnRight))||r.hasClass(e(z.stickyColumn)),RC=(r,e)=>r.filter((t,n)=>g(n).hasClass(e(z.stickyColumnLeft))),TC=(r,e)=>r.filter((t,n)=>g(n).hasClass(e(z.stickyColumnRight))),VC=(r,e)=>r.filter((t,n)=>g(n).hasClass(e(z.stickyColumn))||!td(g(n),e)),FC=(r,e,t)=>{const o=(e.css("direction")==="rtl"?r.toArray():r.toArray().reverse()).find(s=>Jn(g(s),e,t)||Za(g(s),t));return g(o??"")},OC=(r,e,t)=>{const o=(e.css("direction")==="rtl"?r.toArray().reverse():r.toArray()).find(s=>ln(g(s),e,t)||ed(g(s),t));return g(o??"")},Zn=(r,e,t)=>{const n=Z(e.get(0)),i={left:n.left,right:n.right};if(r!=null&&r.length){const o=FC(r,e,t),s=OC(r,e,t);o!=null&&o.length&&(i.left=Math.round(Z(o[0]).right)),s!=null&&s.length&&(i.right=Math.round(Z(s[0]).left))}return i},DC=(r,e,t)=>{let{point:n,column:i,nextColumn:o}=e;const{item:s,isLeftBoundary:l,isRightBoundary:a}=n,d=g(s),u=Math.round(n.x),c=r.option("rtlEnabled"),h=f(l)||f(a),p=g(r.getColumnElements()??""),m=g(r.getContent()),C=(i==null?void 0:i.fixed)&&(o==null?void 0:o.fixed),w=Zn(p,m,t);if(C||sl(n,i,o))return!1;if(h){if(Za(d,t)||Jn(d,m,t))return l;if(ed(d,t)||ln(d,m,t))return a}const S=u<w.left||u>w.right,V=u===w.left||u===w.right,O=c?n.index===0:n.index===p.length;return S||!O&&V},PC=(r,e,t,n)=>{const{item:i,isLeftBoundary:o,isRightBoundary:s}=r,l=g(i),a=Math.round(r.x),d=f(o)||f(s),u=Zn(e,t,n);return Jn(l,t,n)?d&&!o:ln(l,t,n)?d&&!s:a<u.left||a>u.right},AC=r=>{const t=r.parent().children().filter(i=>i<r.index());return r.attr("colspan")-t.length===1},kC=(r,e,t)=>{const n=Z(e.get(0)),i=Zn(r,e,t);return{left:i.left-n.left,right:n.right-i.right}},BC=(r,e,t,n)=>{const i=Z(r.get(0)),o=Math.round(i.left),s=Math.round(i.right),l=Zn(e,t,n);return o<l.left||s>l.right},MC=r=>{if(!r.is("td"))return!1;const e=r.parent().children().last();return r[0]===e[0]},NC=r=>!r.is("[tabindex]"),LC=function(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"next",t=r,n=r.parent();do t=e==="next"?t.next():t.prev(),t.length||(n=e==="next"?n.next():n.prev(),n.length&&(t=e==="next"?n.children().first():n.children().last()));while(t.length&&NC(t));return t},W={toggleFirstHeaderClass:vC,toggleColumnNoBorderClass:yC,addStickyColumnClass:xC,addStickyColumnBorderLeftClass:_C,addStickyColumnBorderRightClass:wC,doesGroupCellEndInFirstColumn:AC,toggleStickyColumnsClass:bC,getLeftFixedCells:RC,getRightFixedCells:TC,getNonFixedAndStickyCells:VC,getScrollPadding:kC,getNextHeaderCell:LC,noNeedToCreateResizingPoint:DC,isFixedCellPinnedToRight:EC,noNeedToCreateReorderingPoint:PC,isFixedCell:td,isStickyCell:SC,isStickyCellPinned:IC,isOutsideVisibleArea:BC,isLastCell:MC},No=r=>class extends r{_addStickyColumnBorderLeftClass(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4?arguments[4]:void 0;Du(this._columnsController,t,n,i,o)&&W.addStickyColumnBorderLeftClass(e,this.addWidgetPrefix.bind(this))}_addStickyColumnBorderRightClass(e,t,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=arguments.length>4?arguments[4]:void 0;Pu(this._columnsController,t,n,i,o)&&W.addStickyColumnBorderRightClass(e,this.addWidgetPrefix.bind(this))}updateBorderCellClasses(e,t,n){const i=this._columnsController,o=this.name==="rowsView",s=Ou(i,t,n,o),l=i==null?void 0:i.isFirstColumn(t,n);W.toggleColumnNoBorderClass(e,s,this.addWidgetPrefix.bind(this)),W.toggleFirstHeaderClass(e,l,this.addWidgetPrefix.bind(this))}_updateBorderClasses(){const e=this.name==="columnHeadersView";this._getRowElementsCore().not(`.${CC.detailRow}`).toArray().forEach((n,i)=>{const o=e?i:null,s=g(n).children("td").toArray();let l=this.getColumns(o);l=is(this._columnsController,l),s.forEach((a,d)=>{const u=g(a),c=l[d];c.visibleWidth!==Co&&this.updateBorderCellClasses(u,c,o)})})}_renderCore(e){super._renderCore(e);const t=this.element(),n=this.hasStickyColumns();W.toggleStickyColumnsClass(t,n,this.addWidgetPrefix.bind(this))}_createCell(e){const{column:t}=e,{rowType:n}=e,i=super._createCell(e),o=this.hasStickyColumns(),s=n==="header"?e.rowIndex:null,l=n==="groupFooter"||n==="totalFooter"||n==="group",a=t.command&&t.command==="expand";if(o&&!_o(this._columnsController,t)&&(this.updateBorderCellClasses(i,t,s),t.fixed)){const d=Ct(this._columnsController,t);if(W.addStickyColumnClass(i,d,this.addWidgetPrefix.bind(this)),!l&&!a)switch(d){case N.Right:this._addStickyColumnBorderLeftClass(i,t,s,!1,N.Right);break;case N.Sticky:this._addStickyColumnBorderLeftClass(i,t,s,!0),this._addStickyColumnBorderRightClass(i,t,s,!0);break;default:this._addStickyColumnBorderRightClass(i,t,s,!1,N.Left)}}return i}setStickyOffsets(e,t){const n=this._columnsController,i=this.option("rtlEnabled"),o=this.option("showColumnHeaders");let s=this.getColumnWidths(void 0,e),l=this.getColumns(o?e:void 0);l=is(this._columnsController,l),i&&(l=i?[...l].reverse():l,s=i?[...s].reverse():s),l.forEach((a,d)=>{if(a.fixed){const u=i?l.length-d-1:d,c=il(n,l,s,d,t);t&&(t[a.index]=c);const h=ol(c);this.setCellProperties(h,u,e)}})}setColumnWidths(e){const t=this.hasStickyColumns(),n=this.getController("columnsResizer"),i=n==null?void 0:n.isResizing();super.setColumnWidths(e),t&&i&&this.setStickyOffsets()}_resizeCore(){const e=this.hasStickyColumns(),t=this.getController("adaptiveColumns"),n=t==null?void 0:t.getHidingColumnsQueue();super._resizeCore.apply(this,arguments),e&&(this.setStickyOffsets(),n!=null&&n.length&&this._updateBorderClasses())}hasStickyColumns(){var e;const t=(e=this._columnsController)===null||e===void 0?void 0:e.getStickyColumns();return this.option("columnFixing.legacyMode")!==!0&&!!t.length}},HC=r=>class extends No(r){setStickyOffsets(){const e={},t=this._getRows();for(let i=0;i<t.length;i++){var n;const o=(t==null||(n=t[i])===null||n===void 0?void 0:n.rowType)==="filter";super.setStickyOffsets(i,o?void 0:e)}}getContextMenuItems(e){const{column:t}=e,n=this._columnsController,i=this.option("columnFixing");let o=super.getContextMenuItems(e);if(e.row&&e.row.rowType==="header"&&i.enabled===!0&&t&&t.allowFixing){const s=a=>{switch(a.itemData.value){case"none":this._columnsController.columnOption(t.index,"fixed",!1);break;case"left":this._columnsController.columnOption(t.index,{fixed:!0,fixedPosition:"left"});break;case"right":this._columnsController.columnOption(t.index,{fixed:!0,fixedPosition:"right"});break;case"sticky":this._columnsController.columnOption(t.index,{fixed:!0,fixedPosition:"sticky"})}},l=[{text:i.texts.leftPosition,icon:i.icons.leftPosition,value:"left",disabled:t.fixed&&(!t.fixedPosition||t.fixedPosition==="left"),onItemClick:s},{text:i.texts.rightPosition,icon:i.icons.rightPosition,value:"right",disabled:t.fixed&&t.fixedPosition==="right",onItemClick:s}];this.option("columnFixing.legacyMode")!==!0&&!n.isVirtualMode()&&l.push({text:i.texts.stickyPosition,icon:i.icons.stickyPosition,value:"sticky",disabled:t.fixed&&t.fixedPosition===N.Sticky,onItemClick:s}),o=o||[],o.push({text:i.texts.fix,icon:i.icons.fix,beginGroup:!0,items:l},{text:i.texts.unfix,icon:i.icons.unfix,value:"none",disabled:!t.fixed,onItemClick:s})}return o}},zC=r=>class extends No(r){_getMasterDetailWidth(){var e,t;return(((e=(t=this.component.$element()).width)===null||e===void 0?void 0:e.call(t))??0)-v.getComponentBorderWidth(this,this._$element)-this.getScrollbarWidth()}_renderMasterDetailCell(e,t,n){const i=super._renderMasterDetailCell(e,t,n);return this.hasStickyColumns()&&i.addClass(this.addWidgetPrefix(z.stickyColumnLeft)).width(this._getMasterDetailWidth()),i}_updateMasterDetailWidths(){const e=this._getMasterDetailWidth(),t=this._getRowElements().children(".dx-master-detail-cell");Un(t,`${e}px`)}setStickyOffsets(e,t){super.setStickyOffsets(e,t),this.setStickyOffsetsForGroupCells()}setStickyOffsetsForGroupCells(){const e=this._columnsController.getGroupColumns();let t=this.getColumns(),n=this.getColumnWidths();const i=this._getColumnsCountBeforeGroups(t),o=this.option("rtlEnabled");o&&(t=o?[...t].reverse():t,n=o?[...n].reverse():n);const s=this.getTableElement();e.forEach(l=>{const a=i+l.groupIndex+1,d=o?t.length-a-1:a,u=il(this._columnsController,t,n,d),c=ol(u),h=s.children().children(".dx-group-row").find(`.dx-group-cell[aria-colindex='${a+1}']`);for(let p=0;p<h.length;p+=1){const m=h.get(p),C=g(m).find(".dx-datagrid-group-row-container").get(0);Object.assign(m.style,c),Object.assign(C.style,c)}})}_resizeCore(){const e=this.hasStickyColumns();super._resizeCore.apply(this,arguments),e&&this._updateMasterDetailWidths()}_renderCellContent(e,t,n){if(!ji(t)||!this.hasStickyColumns())return super._renderCellContent(e,t,n);const i=g("<div>").addClass(this.addWidgetPrefix(z.groupRowContainer)).appendTo(e);return super._renderCellContent(i,t,n)}_renderGroupSummaryCellsCore(e,t,n,i){super._renderGroupSummaryCellsCore(e,t,n,i);const o=`.${this.addWidgetPrefix(z.stickyColumn)}`;e.parent().find(o).length&&W.doesGroupCellEndInFirstColumn(e)&&W.addStickyColumnBorderRightClass(e,this.addWidgetPrefix.bind(this))}_handleScroll(e){const t=this.hasStickyColumns();if(super._handleScroll(e),t){const n=this.getController("editorFactory");if(n.hasOverlayElements()){const o=n.focus();n.focus(o)}}}_scrollToElement(e,t){let n=t;if(this.hasStickyColumns()){var o;const s=W.isFixedCell(e,this.addWidgetPrefix.bind(this));if(!e.is("td")||s)return;const l=e==null?void 0:e.closest("tr"),a=l==null?void 0:l.children(),d=(o=this.getScrollable())===null||o===void 0?void 0:o.container();n=W.getScrollPadding(a,d,this.addWidgetPrefix.bind(this))}super._scrollToElement(e,n)}},WC=r=>class extends No(r){},$C=r=>class extends r{getSeparatorOffsetX(e){var t;if((t=this._columnHeadersView)===null||t===void 0?void 0:t.hasStickyColumns()){const o=g(this._columnHeadersView.getContent()),s=W.isFixedCellPinnedToRight(e,o,this.addWidgetPrefix.bind(this));if(this.option("columnResizingMode")==="widget"&&s){var i;return((i=e.offset())===null||i===void 0?void 0:i.left)??0}}return super.getSeparatorOffsetX(e)}_correctColumnIndexForPoint(e,t,n){const i=this.option("rtlEnabled"),o=this.option("columnResizingMode")==="widget",s=Math.max(e.index-1,0),l=n[s],a=this._getNextColumnIndex(s),d=n[a];if(o&&!sl(e,l,d)){const u=g(this._columnHeadersView.getContent());if(W.isFixedCellPinnedToRight(g(e.item),u,this.addWidgetPrefix.bind(this))){e.columnIndex-=i?1:0;return}}super._correctColumnIndexForPoint(e,t,n)}_needToInvertResizing(e){const t=super._needToInvertResizing(e),n=this.option("columnResizingMode")==="widget";if(!t&&n){const i=g(this._columnHeadersView.getContent());return W.isFixedCellPinnedToRight(e,i,this.addWidgetPrefix.bind(this))}return t}_generatePointsByColumns(){var e;const t=(e=this._columnHeadersView)===null||e===void 0?void 0:e.hasStickyColumns();super._generatePointsByColumns(t)}_pointCreated(e,t,n){var i;const o=(i=this._columnHeadersView)===null||i===void 0?void 0:i.hasStickyColumns(),s=super._pointCreated(e,t,n);if(o&&t>0&&!s){const a=n[e.index-1],d=this._getNextColumnIndex(e.index-1),u=n[d];return W.noNeedToCreateResizingPoint(this._columnHeadersView,{point:e,column:a,nextColumn:u},this.addWidgetPrefix.bind(this))}return s}},GC=r=>class extends r{_generatePointsByColumns(e){var t;const n=(t=this._columnHeadersView)===null||t===void 0?void 0:t.hasStickyColumns(),{sourceLocation:i,sourceColumn:o,targetDraggingPanel:s}=e,l=i==="headers"&&(s==null?void 0:s.getName())==="headers";if(n&&l){const a=Ct(this._columnsController,o);switch(!0){case(o.fixed&&a===N.Left):e.columnElements=W.getLeftFixedCells(e.columnElements,this.addWidgetPrefix.bind(this)),e.startColumnIndex=e.columnElements.eq(0).index();break;case(o.fixed&&a===N.Right):e.columnElements=W.getRightFixedCells(e.columnElements,this.addWidgetPrefix.bind(this)),e.startColumnIndex=e.columnElements.eq(0).index();break;default:e.columnElements=W.getNonFixedAndStickyCells(e.columnElements,this.addWidgetPrefix.bind(this)),e.startColumnIndex=e.columnElements.eq(0).index()}}return super._generatePointsByColumns(e,n)}_pointCreated(e,t,n,i){const o=this._columnHeadersView.hasStickyColumns(),s=this._columnHeadersView.getColumnElements(),l=o&&n==="headers"&&(s==null?void 0:s.length)&&(!i.fixed||i.fixedPosition===N.Sticky),a=super._pointCreated(e,t,n,i);return l&&!a?W.noNeedToCreateReorderingPoint(e,s,g(this._columnHeadersView.getContent()),this.addWidgetPrefix.bind(this)):a}},KC=r=>class extends r{getOverlayContainerIfNeeded(e){const t=this._rowsView.hasStickyColumns(),n=W.isFixedCell(e,this.addWidgetPrefix.bind(this));if(t&&n)return e.closest(`.${this.addWidgetPrefix(z.stickyColumns)}`)}updateFocusOverlaySize(e,t){this._rowsView.hasStickyColumns()||super.updateFocusOverlaySize(e,t)}getFocusOverlaySize(e){if(this._rowsView.hasStickyColumns()){const n=Z(e.get(0)),i=W.isLastCell(e),o=W.isFixedCell(e,this.addWidgetPrefix.bind(this));return{width:n.right-n.left+(i||o?0:1),height:n.bottom-n.top}}return super.getFocusOverlaySize(e)}getValidationMessageContainer(e){return this.getOverlayContainerIfNeeded(e)??super.getValidationMessageContainer(e)}getRevertButtonContainer(e){return this.getOverlayContainerIfNeeded(e)??super.getRevertButtonContainer(e)}getFocusOverlayContainer(e){return this.getOverlayContainerIfNeeded(e)??super.getFocusOverlayContainer(e)}overlayPositionedHandler(e,t){const n=this.getView("columnHeadersView"),i=n.hasStickyColumns();if(super.overlayPositionedHandler(e,t),i){const o=g(e.element).closest("td");if(!W.isFixedCell(o,this.addWidgetPrefix.bind(this))){const s=e.component.$wrapper(),l=e.component.$content(),a=W.isOutsideVisibleArea(l,g(n.getColumnElements()),g(n.getContent()),this.addWidgetPrefix.bind(this));s.css("zIndex",a?1:(this===null||this===void 0?void 0:this.getOverlayBaseZIndex())??0)}}}updateFocusOverlay(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!t){const n=W.isFixedCell(e,this.addWidgetPrefix.bind(this));this._$focusOverlay.toggleClass(z.focusedFixedElement,n);const i=pt(e),o=Ua(e),s=Yf(e);(n||i||o||s)&&this._$focusOverlay.toggleClass(z.focusedFixedElement,!0)}super.updateFocusOverlay(e,t)}},UC=r=>class extends r{resize(){const e=super.resize();return this._columnHeadersView.hasStickyColumns()&&this!==null&&this!==void 0&&this.hasResizeTimeout()&&this._rowsView.setStickyOffsets(),e}},jC=r=>class extends r{headerTabKeyHandler(e){var t,n;let{originalEvent:i,shift:o}=e;const s=(t=this._columnHeadersView)===null||t===void 0?void 0:t.hasStickyColumns(),l=(n=this._rowsView)===null||n===void 0?void 0:n.getScrollable();if(s&&l){const a=g(i.target).closest("td"),d=W.getNextHeaderCell(a,o?"previous":"next"),u=W.isFixedCell(d,this.addWidgetPrefix.bind(this));if(d.length&&!u){const c=g(this._columnHeadersView.getColumnElements());if(W.isOutsideVisibleArea(d,c,g(this._columnHeadersView.getContent()),this.addWidgetPrefix.bind(this))){const p=W.getScrollPadding(c,l.container(),this.addWidgetPrefix.bind(this)),m=qd(d[0],"horizontal",g(this._columnHeadersView.getContent())[0],l.scrollOffset(),p,this.addWidgetPrefix("table"));l.scrollTo({x:m})}}}}},qC={extenders:{views:{columnHeadersView:HC,rowsView:zC,footerView:WC},controllers:{columnsResizer:$C,draggingHeader:GC,editorFactory:KC,resizing:UC,keyboardNavigation:jC}}};T.registerModule("stickyColumns",qC);const XC="dx-master-detail-row",Pe=function(r){let e=-1;return b(r,(t,n)=>{if(n.command==="transparent")return e=t,!1}),e},nd=function(r,e,t){let n=0;if(r&&e&&t)for(let i=0;i<r.length;i++)r[i].command==="transparent"?n+=r[i].colspan:(e[n]<t[i]&&(e[n]=t[i]),n++);return e},Lo=r=>class extends r{init(){super.init(),this._isFixedTableRendering=!1,this._isFixedColumns=!1}_createCol(e){return super._createCol(e).toggleClass("dx-col-fixed",!!(this._isFixedTableRendering&&(e.fixed||e.command&&e.command!=="transparent")))}isIndicesArray(e){return Array.isArray(e)&&e.length>0}_correctColumnIndicesForFixedColumns(e,t){var n;const i=t==null?void 0:t.columnIndices;if(!this.isIndicesArray(i))return;const o=Pe(e),s=e[o].colspan,l=o+s,a=t==null||(n=t.items)===null||n===void 0?void 0:n.map(d=>{let{rowType:u}=d;return u});t.columnIndices=i.map((d,u)=>this.isIndicesArray(d)?a&&a[u]==="group"?[...d]:d.reduce((h,p)=>{switch(!0){case p<o:h.push(p);break;case p>=l:h.push(p-s+1)}return h},[]):d)}_partialUpdateFixedTable(e,t){const n=this._fixedTableElement,i=this._getRowElementsCore(n);n.children("colgroup").replaceWith(this._createColGroup(e));for(let s=0;s<t.length;s++)this._partialUpdateFixedRow(g(i[s]),e,t[s])}_partialUpdateFixedRow(e,t,n){const i=e.get(0).childNodes,o=Pe(t),s=t[o],l=this._columnsController.getColumnIndexOffset();let a,d=l+1,{colspan:u}=s;if(e.hasClass(XC)){var c;i[0].setAttribute("colspan",(c=this._columnsController.getVisibleColumns())===null||c===void 0?void 0:c.length);return}if(e.hasClass("dx-group-row"))if(a=this._getGroupCellOptions({row:n,columns:this._columnsController.getVisibleColumns()}),n.summaryCells.length>0){const p=this._getAlignByColumnCellCount(a.colspan,{columns:this._columnsController.getVisibleColumns(),row:n,isFixed:!0});u=a.colspan-p}else u=a.colspan-Math.max(0,i.length-(a.columnIndex+2));for(let h=0;h<i.length;h++){const p=a?h===a.columnIndex+1:h===o;i[h].setAttribute("aria-colindex",d),p?(i[h].setAttribute("colspan",u),d+=u):d++}}_renderTable(e){let t;const n=this.getFixedColumns();this._isFixedColumns=this.isFixedColumns();const i=super._renderTable(e);if(this._isFixedColumns){var o;const l=e==null?void 0:e.change,a=this._getRowElements(this._fixedTableElement),d=(l==null?void 0:l.virtualColumnsScrolling)&&a.length===(l==null||(o=l.items)===null||o===void 0?void 0:o.length);if(this._isFixedTableRendering=!0,d&&this.option("scrolling.legacyMode")!==!0){var s;this._partialUpdateFixedTable(n,e==null||(s=e.change)===null||s===void 0?void 0:s.items),this._isFixedTableRendering=!1}else{const u=l==null?void 0:l.columnIndices;this._correctColumnIndicesForFixedColumns(n,l),t=this._createTable(n),this._renderRows(t,y({},e,{columns:n})),this._updateContent(t,l,!0),u&&(l.columnIndices=u),this._isFixedTableRendering=!1}}else this._fixedTableElement&&this._fixedTableElement.parent().remove(),this._fixedTableElement=null;return i}_renderRow(e,t){let n,{cells:i}=t.row;if(super._renderRow.apply(this,arguments),this._isFixedTableRendering&&i&&i.length){n=0;const o=t.row.cells||[];i=i.slice(),t.row.cells=i;for(let s=0;s<o.length;s++){if(o[s].column&&o[s].column.command==="transparent"){n=(o[s].column.colspan||1)-1;continue}i[s+n]=o[s]}}}_createCell(e){const t=this,{column:n}=e,i=n&&n.command,{rowType:o}=e,s=super._createCell.apply(t,arguments);let l,a,d;(t._isFixedTableRendering||o==="filter")&&(l=t.getFixedColumns(),d=Pe(l),a=l[d-1]),t._isFixedTableRendering?i==="transparent"&&(s.addClass("dx-pointer-events-none").toggleClass("dx-first-cell",d===0||a&&a.command==="expand").toggleClass("dx-last-cell",l.length&&d===l.length-1),o!=="freeSpace"&&v.setEmptyText(s)):o==="filter"&&s.toggleClass("dx-first-cell",e.columnIndex===d);const u=t.option("rowAlternationEnabled")&&e.isAltRow,c=t.option("selection.mode")==="multiple"&&e.columnIndex===0&&e.rowType==="header";return ee.mozilla&&e.column.fixed&&e.rowType!=="group"&&!u&&!c&&s.addClass("dx-col-fixed"),s}_wrapTableInScrollContainer(e,t){const n=super._wrapTableInScrollContainer.apply(this,arguments);return(this._isFixedTableRendering||t)&&n.addClass(this.addWidgetPrefix("content-fixed")),n}_renderCellContent(e,t){let n;const{column:i}=t,o=this._isFixedTableRendering,s=t.rowType==="group"&&f(i.groupIndex);if(o&&s&&!i.command&&!i.groupCellTemplate&&e.css("pointerEvents","none"),!o&&this._isFixedColumns){if(n=i.fixed||i.command&&i.fixed!==!1,s&&(n=!1,t.row.summaryCells&&t.row.summaryCells.length)){var l;const a=this._columnsController.getVisibleColumns(),d=((l=this._getAlignByColumnCellCount)===null||l===void 0?void 0:l.call(this,i.colspan,{columns:a,row:t.row,isFixed:!0}))??0;if(d>0){const u=Pe(this._columnsController.getFixedColumns());n=a.length-d<u}}if(n){if(i.command&&i.type!=="buttons"||t.rowType==="group"){e.html("&nbsp;").addClass(i.cssClass);return}e.addClass("dx-hidden-cell")}}i.command!=="transparent"&&super._renderCellContent.apply(this,arguments)}getContent(e){var t;return e?(t=this._fixedTableElement)===null||t===void 0?void 0:t.parent():super.getContent.apply(this,arguments)}_getCellElementsCore(e){const t=super._getCellElementsCore.apply(this,arguments),n=t==null?void 0:t.parent().hasClass("dx-group-row"),i=this.name==="columnHeadersView"?e:void 0;if(this._fixedTableElement&&t){const o=this.getFixedColumns(i),s=this._getRowElements(this._fixedTableElement).eq(e).children("td");b(s,(l,a)=>{if(n)t[l]&&a.style.visibility!=="hidden"&&(t[l]=a);else{const d=o[l];if(d)if(d.command==="transparent")s.eq(l).hasClass("dx-master-detail-cell")&&(t[l]=a||t[l]);else{const u=this._columnsController.getVisibleIndexByColumn(d,i);t[u]=a||t[u]}}})}return t}getColumnWidths(e,t){const n=super.getColumnWidths(e,t),i=this.getFixedColumns(),o=this._fixedTableElement&&n.length?super.getColumnWidths(this._fixedTableElement):void 0;return nd(i,n,o)}getTableElement(e){return e=this._isFixedTableRendering||e,e?this._fixedTableElement:super.getTableElement()}setTableElement(e,t){this._isFixedTableRendering||t?this._fixedTableElement=e.addClass("dx-pointer-events-none"):super.setTableElement(e)}getColumns(e){const t=this.getTableElement();return this._isFixedTableRendering?this.getFixedColumns(e):super.getColumns(e,t)}getRowIndex(e){const t=this._fixedTableElement;return t&&t.find(e).length?this._getRowElements(t).index(e):super.getRowIndex(e)}getTableElements(){let e=super.getTableElements.apply(this,arguments);return this._fixedTableElement&&(e=g([e.get(0),this._fixedTableElement.get(0)])),e}getFixedColumns(e){return this._columnsController.getFixedColumns(e)}getFixedColumnsOffset(){let e={left:0,right:0},t;if(this._fixedTableElement){t=this.getTransparentColumnElement();const n=t.position();e={left:n.left,right:ye(this.element(),!0)-(ye(t,!0)+n.left)}}return e}getTransparentColumnElement(){return this._fixedTableElement&&this._fixedTableElement.find(".dx-pointer-events-none").first()}getFixedTableElement(){return this._fixedTableElement}_resizeCore(){super._resizeCore(),this.synchronizeRows()}setColumnWidths(e){var t;const{widths:n}=e,i=this._columnsController.getVisibleColumns(),o=(n==null?void 0:n.length)&&i.some(d=>f(d.visibleWidth)),s=(t=e.optionNames)===null||t===void 0?void 0:t.width;if(super.setColumnWidths(e),this._fixedTableElement){const c=(n==null?void 0:n.some(h=>h==="auto"||!f(h)))&&(!o||!this.isScrollbarVisible(!0))?i:this.getFixedColumns();this.setFixedTableColumnWidths(c,n)}const l=this.option("wordWrapEnabled");(o||s&&l)&&this.synchronizeRows()}setFixedTableColumnWidths(e,t){if(!this._fixedTableElement||!t)return;const n=this._fixedTableElement.children("colgroup").children("col");n.toArray().forEach(o=>o.removeAttribute("style"));let i=0;e.forEach(o=>{if(o.colspan){i+=o.colspan;return}const s=Jr(t[i]);f(s)&&Hi(n.eq(i),s),i+=1})}_getClientHeight(e){const t=e.getBoundingClientRect&&Z(e);return t&&t.height?t.height:e.clientHeight}synchronizeRows(){const e=[],t=[];let n,i,o,s;this.waitAsyncTemplates(!0).done(()=>{if(this._isFixedColumns&&this._tableElement&&this._fixedTableElement){const l=this._getClientHeight(this._tableElement.get(0)),a=this._getClientHeight(this._fixedTableElement.get(0));if(i=this._getRowElements(this._tableElement),o=this._getRowElements(this._fixedTableElement),s=this._findContentElement(),l!==a){for(s&&s.css("height",l),i.css("height",""),o.css("height",""),n=0;n<i.length;n++)e.push(this._getClientHeight(i.get(n))),t.push(this._getClientHeight(o.get(n)));for(n=0;n<i.length;n++){const d=e[n],u=t[n];d>u?o.eq(n).css("height",d):d<u&&i.eq(n).css("height",u)}s&&s.css("height","")}}})}setScrollerSpacing(e,t){const n=this.option("rtlEnabled");super.setScrollerSpacing(e),this.element().children(`.${this.addWidgetPrefix("content-fixed")}`).css({paddingLeft:n?e:"",paddingRight:n?"":e})}isFixedColumns(){const e=this.getFixedColumns();return this.option("columnFixing.legacyMode")===!0&&!!e.length}},YC=r=>class extends Lo(r){_getRowVisibleColumns(e){return this._isFixedTableRendering?this.getFixedColumns(e):super._getRowVisibleColumns(e)}getFixedColumnElements(e){const t=this;if(!this._isFixedColumns)return;if(f(e))return this._fixedTableElement&&this._getRowElements(this._fixedTableElement).eq(e).children();const n=t.getColumnElements(),i=t.getTransparentColumnElement();if(n&&i&&i.length){var o;const s=Pe(t.getFixedColumns());[].splice.apply(n,[s,(o=i.get(0))===null||o===void 0?void 0:o.colSpan,i.get(0)])}return n}getColumnWidths(e,t){const n=this;let i;const o=super.getColumnWidths(e,t),s=n.getFixedColumnElements(),l=n.getFixedColumns();return n._fixedTableElement&&(s&&s.length?i=n._getWidths(s):i=super.getColumnWidths(n._fixedTableElement)),nd(l,o,i)}},QC=r=>class extends Lo(r){dispose(){super.dispose.apply(this,arguments),clearTimeout(this._fixedScrollTimeout)}optionChanged(e){super.optionChanged(e),e.name==="hoverStateEnabled"&&this._isFixedColumns&&(e.value?this._attachHoverEvents():this._detachHoverEvents())}_detachHoverEvents(){const e=this.element();this._fixedTableElement&&this._tableElement&&x.off(e,"mouseover mouseout",".dx-data-row")}_attachHoverEvents(){this._fixedTableElement&&this._tableElement&&x.on(this.element(),"mouseover mouseout",".dx-data-row",this.createAction(e=>{const{event:t}=e,n=this.getRowIndex(g(t.target).closest(".dx-row")),i=t.type==="mouseover";n>=0&&(this._tableElement&&this._getRowElements(this._tableElement).eq(n).toggleClass("dx-state-hover",i),this._fixedTableElement&&this._getRowElements(this._fixedTableElement).eq(n).toggleClass("dx-state-hover",i))}))}_getScrollDelay(){var e;return((e=this._resizingController)===null||e===void 0?void 0:e.hasResizeTimeout())?this.option("scrolling.updateTimeout"):ee.mozilla?60:0}_findContentElement(e){let t,n;const i=this.addWidgetPrefix("content"),o=this.element();if(e=this._isFixedTableRendering||e,o&&e){t=o.children(`.${i}`);const s=this.getScrollable();return!t.length&&s&&(t=g("<div>").addClass(i),x.on(t,"scroll",l=>{const{target:a}=l,d=this._getScrollDelay();clearTimeout(this._fixedScrollTimeout),this._fixedScrollTimeout=setTimeout(()=>{n=g(a).scrollTop(),s.scrollTo({y:n})},d)}),x.on(t,Xd,l=>{const a=g(l.target).closest(".dx-scrollable");let d=!1;if(s&&s.$element().is(a))d=!0;else{const u=a.length&&gt.getInstance(a.get(0)),c=u&&u.scrollHeight()-u.clientHeight()>0;d=u&&!c}if(d){n=s.scrollTop(),s.scrollTo({y:n-l.delta});const u=s.scrollTop()+s.clientHeight(),c=s.scrollHeight()+this.getScrollbarWidth();if(s.scrollTop()>0&&u<c)return!1}}),t.appendTo(o)),t}return super._findContentElement()}_updateScrollable(){super._updateScrollable();const e=this.getScrollable();if(e!=null&&e._disposed)return;const t=e&&e.scrollOffset().top;this._updateFixedTablePosition(t)}_renderContent(e,t,n){return this._isFixedTableRendering||n?e.empty().addClass(`${this.addWidgetPrefix("content")} ${this.addWidgetPrefix("content-fixed")}`).append(t):super._renderContent(e,t)}_getGroupCellOptions(e){return this._isFixedTableRendering?super._getGroupCellOptions(y({},e,{columns:this._columnsController.getVisibleColumns()})):super._getGroupCellOptions(e)}_renderGroupedCells(e,t){return super._renderGroupedCells(e,y({},t,{columns:this._columnsController.getVisibleColumns()}))}_renderGroupSummaryCells(e,t){this._isFixedTableRendering?super._renderGroupSummaryCells(e,y({},t,{columns:this._columnsController.getVisibleColumns()})):super._renderGroupSummaryCells(e,t)}_hasAlignByColumnSummaryItems(e,t){const n=super._hasAlignByColumnSummaryItems.apply(this,arguments),i=t.columns[e];return t.isFixed?i.fixed&&(n||i.fixedPosition==="right"):n&&(!this._isFixedColumns||!i.fixed)}_renderGroupSummaryCellsCore(e,t,n,i){let o;if(this._isFixedTableRendering){t.isFixed=!0,o=this._getAlignByColumnCellCount(n,t),t.isFixed=!1;const s=t.columns.length-o;t=y({},t,{columns:this.getFixedColumns()});const l=Pe(t.columns);s<l?(o-=t.columns[l].colspan-1||0,n-=t.columns[l].colspan-1||0):i>0&&e.css("visibility","hidden"),i=o}super._renderGroupSummaryCellsCore(e,t,n,i)}_getSummaryCellIndex(e,t){if(this._isFixedTableRendering){const n=Pe(t);return e>n&&(e+=t[n].colspan-1),e}return super._getSummaryCellIndex.apply(this,arguments)}_renderCore(e){this._detachHoverEvents();const t=super._renderCore(e),n=this._isFixedColumns;return this.element().toggleClass("dx-fixed-columns",n),this.option("hoverStateEnabled")&&n&&this._attachHoverEvents(),t}setAriaOwns(e,t,n){if(n){var i;const o=this.addWidgetPrefix("content-fixed"),s=(i=this.element())===null||i===void 0?void 0:i.children(`.${o}`),l=this.getFixedTableElement();s.length&&l!==null&&l!==void 0&&l.length&&this.setAria("owns",`${e??""} ${l.attr("id")??""} ${t??""}`.trim(),s)}else super.setAriaOwns.apply(this,arguments)}toggleDraggableColumnClass(e,t){if(super.toggleDraggableColumnClass(e,t),this.isFixedColumns()){const n=this._getRowElements(this._fixedTableElement);this._toggleDraggableSourceColumnClass(n,this.getFixedColumns(),e,t)}}getCellIndex(e){const t=this._fixedTableElement;let n=0;if(t&&e.is("td")&&e.closest(t).length){const i=this.getFixedColumns();return b(i,(o,s)=>{if(o===e[0].cellIndex)return!1;if(s.colspan){n+=s.colspan;return}n++}),n}return super.getCellIndex.apply(this,arguments)}_updateFixedTablePosition(e,t){if(this._fixedTableElement&&this._tableElement){let n;this._fixedTableElement.parent().scrollTop(e),t&&this._editorFactoryController&&(n=this._editorFactoryController.focus(),n&&this._editorFactoryController.focus(n))}}setScrollerSpacing(e,t){const n=this,i={marginBottom:0},o=n.element().children(`.${this.addWidgetPrefix("content-fixed")}`);o.length&&n._fixedTableElement&&(o.css(i),n._fixedTableElement.css(i),i[n.option("rtlEnabled")?"marginLeft":"marginRight"]=e,i.marginBottom=t,(n._scrollable&&n._scrollable.option("useNative")?o:n._fixedTableElement).css(i))}_getElasticScrollTop(e){let t=0;if(e.scrollOffset.top<0)t=-e.scrollOffset.top;else if(e.reachedBottom){const n=g(e.component.content()),i=g(e.component.container()),o=Math.max(n.get(0).clientHeight-i.get(0).clientHeight,0);t=Math.min(o-e.scrollOffset.top,0)}return Math.floor(t)}_applyElasticScrolling(e){if(this._fixedTableElement){const t=this._getElasticScrollTop(e);Math.ceil(t)!==0?Yd(this._fixedTableElement,{top:t}):this._fixedTableElement.css("transform","")}}_handleScroll(e){this._updateFixedTablePosition(e.scrollOffset.top,!0),this._applyElasticScrolling(e),super._handleScroll(e)}_updateContentPosition(e){super._updateContentPosition.apply(this,arguments),e||this._updateFixedTablePosition(this._scrollTop)}_afterRowPrepared(e){this._isFixedTableRendering||super._afterRowPrepared(e)}_scrollToElement(e,t){const n=this.isFixedColumns()?this.getFixedColumnsOffset():t;super._scrollToElement(e,n)}},JC=r=>class extends Lo(r){},ZC=function(r,e,t){const n=Pe(e),i=r.length-e.length;return b(t,(o,s)=>{s.index>n&&(s.columnIndex+=i,s.index+=i)}),t},e_=r=>class extends r{_generatePointsByColumns(e,t){const n=e.columns,{targetDraggingPanel:i}=e;if(i&&i.getName()==="headers"&&i.isFixedColumns()&&e.sourceColumn.fixed){e.rowIndex||(e.columnElements=i.getFixedColumnElements(0)),e.columns=i.getFixedColumns(e.rowIndex);const o=super._generatePointsByColumns(e,t);return ZC(n,e.columns,o),o}return super._generatePointsByColumns(e,t)}_pointCreated(e,t,n,i){const o=super._pointCreated.apply(this,arguments),s=t[e.columnIndex],l=this._columnHeadersView.getTransparentColumnElement();if(!o&&n==="headers"&&l&&l.length){const a=Z(l.get(0));return i&&i.fixed?i.fixedPosition==="right"?e.x<a.right:e.x>a.left:s&&s.fixed&&s.fixedPosition!=="right"?!0:e.x<a.left||e.x>a.right}return o}},t_=r=>class extends r{_generatePointsByColumns(e){const t=this,n=t._columnsController,i=n&&t._columnsController.getVisibleColumns(),o=n&&t._columnsController.getFixedColumns(),s=Pe(o),l=i.length-o.length,a=t._columnHeadersView.getFixedColumnElements();super._generatePointsByColumns(e),a&&a.length>0&&(t._pointsByFixedColumns=v.getPointsByColumns(a,d=>(d.index>s&&(d.columnIndex+=l,d.index+=l),t._pointCreated(d,i.length,i))))}_getTargetPoint(e,t,n){const i=this._columnHeadersView.getTransparentColumnElement();if(i&&i.length){const o=Z(i.get(0));if(t<=o.left||t>=o.right)return super._getTargetPoint(this._pointsByFixedColumns,t,n)}return super._getTargetPoint(e,t,n)}},n_=r=>class extends r{_setAriaOwns(){var e,t,n;super._setAriaOwns.apply(this,arguments);const i=(e=this._columnHeadersView)===null||e===void 0?void 0:e.getFixedTableElement(),o=(t=this._footerView)===null||t===void 0?void 0:t.getFixedTableElement();(n=this._rowsView)===null||n===void 0||n.setAriaOwns(i==null?void 0:i.attr("id"),o==null?void 0:o.attr("id"),!0)}},i_=r=>class extends r{_toggleInertAttr(e){var t;const n=(t=this._rowsView)===null||t===void 0?void 0:t.getFixedContentElement();e?n==null||n.attr("inert",!0):n==null||n.removeAttr("inert")}},o_=r=>class extends r{getValidationMessageContainer(e){return this._rowsView.isFixedColumns()?this._rowsView.element():super.getValidationMessageContainer(e)}},s_={defaultOptions:()=>({columnFixing:{enabled:!1,legacyMode:!1,texts:{fix:_.format("dxDataGrid-columnFixingFix"),unfix:_.format("dxDataGrid-columnFixingUnfix"),leftPosition:_.format("dxDataGrid-columnFixingLeftPosition"),rightPosition:_.format("dxDataGrid-columnFixingRightPosition"),stickyPosition:_.format("dxDataGrid-columnFixingStickyPosition")},icons:{fix:"fix-column",unfix:"unfix-column",leftPosition:"fix-column-left",rightPosition:"fix-column-right",stickyPosition:"stick-column"}}}),extenders:{views:{columnHeadersView:YC,rowsView:QC,footerView:JC},controllers:{draggingHeader:e_,columnsResizer:t_,resizing:n_,keyboardNavigation:i_,editorFactory:o_}}};T.registerModule("columnFixing",s_);const id="rowsView",r_="footerView",Li=["columnHeadersView",id,r_],l_="dxDataGridAdaptivity",od="dxDataGrid-ariaAdaptiveExpand",a_="dxDataGrid-ariaAdaptiveCollapse",d_="scrolling.legacyMode";function _n(r,e){return r._columnsController.getColumnId(e)}function u_(r){return r.find("td:not(.dx-datagrid-hidden-column):not([class*='dx-command-'])")}function c_(r,e){let t;const n=g(r),i=e.component.getController("adaptiveColumns");e.rowType==="data"?(t=g("<span>").addClass(i.addWidgetPrefix("adaptive-more")),x.on(t,H(te,l_),i.createAction(()=>{i.toggleExpandAdaptiveDetailRow(e.key)})),t.appendTo(n)):v.setEmptyText(n)}function lo(r){var e;const t=(e=r.data)===null||e===void 0?void 0:e.$nextCell;x.off(t,"focus",lo),x.trigger(t,"dxclick")}class h_ extends L.ViewController{init(){this._columnsController=this.getController("columns"),this._dataController=this.getController("data"),this._editingController=this.getController("editing"),this._keyboardNavigationController=this.getController("keyboardNavigation"),this._rowsView=this.getView("rowsView"),this._columnsController.addCommandColumn({type:"adaptive",command:"adaptive",visible:!0,adaptiveHidden:!0,cssClass:"dx-command-adaptive",alignment:"center",width:"auto",cellTemplate:c_,fixedPosition:"right"}),this._columnsController.columnsChanged.add(()=>{const e=!!this.updateHidingQueue(this._columnsController.getColumns()).length;this._columnsController.columnOption("command:adaptive","adaptiveHidden",!e,!0)}),this._hidingColumnsQueue=[],this._hiddenColumns=[],this.createAction("onAdaptiveDetailRowPreparing"),super.init()}optionChanged(e){e.name==="columnHidingEnabled"&&this._columnsController.columnOption("command:adaptive","adaptiveHidden",!e.value),super.optionChanged(e)}publicMethods(){return["isAdaptiveDetailRowExpanded","expandAdaptiveDetailRow","collapseAdaptiveDetailRow"]}_isRowEditMode(){return this._getEditMode()==="row"}_isItemModified(e,t){const n=this._columnsController.getVisibleIndex(e.column.index),i=this._dataController.getRowIndexByKey(t.key),o=this._dataController.items()[i+1];return o&&o.modifiedValues&&f(o.modifiedValues[n])}_renderFormViewTemplate(e,t,n){const i=this,{column:o}=e,s=i.createAction(()=>{i._editingController.isEditing()&&x.trigger(n,te)}),l=t.row.data,a=o.calculateCellValue(l),d=v.getDisplayValue(o,a,l,t.rowType),u=v.formatValue(d,o),c=this._editingController.isCellOrBatchEditMode(),h=i._rowsView;if(o.allowEditing&&this._keyboardNavigationController.isKeyboardEnabled()&&(n.attr("tabIndex",i.option("tabIndex")),c&&(x.off(n,"focus",s),x.on(n,"focus",s))),o.cellTemplate){const p=y({},t,{value:a,displayValue:d,text:u,column:o});h.renderTemplate(n,o.cellTemplate,p,Kn(n)).done(()=>{h._cellPrepared(n,t)})}else{const p=n.get(0);o.encodeHtml?p.textContent=u:p.innerHTML=u,n.addClass("dx-adaptive-item-text"),(!f(u)||u==="")&&n.html("&nbsp;"),i._isRowEditMode()||i._isItemModified(e,t)&&n.addClass("dx-item-modified"),h._cellPrepared(n,t)}}_getTemplate(e,t,n){const i=this,{column:o}=e,s=this._editingController;return function(l,a){const d=g(a),u=i._columnsController.getVisibleIndex(o.index),c=y({},t),h=function(){const p=i._isItemEdited(e);c.value=t.row.values[u],p||o.showEditorAlways?s.renderFormEditorTemplate(c,e,l,d,!p):(c.column=o,c.columnIndex=u,i._renderFormViewTemplate(e,c,d))};if(h(),c.watch){const p=c.watch(()=>({isItemEdited:i._isItemEdited(e),value:t.row.values[u]}),()=>{d.contents().remove(),d.removeClass("dx-adaptive-item-text"),h()});x.on(d,xt,p)}}}_isVisibleColumnsValid(e){return!(e<2||e.length-function(){let t=0;for(let n=0;n<e.length;n++)e[n].command&&t++;return t}()<=1)}_calculatePercentWidths(e,t){const n=this;let i=0;return t.forEach((o,s)=>{e[s]!=="adaptiveHidden"&&(i+=n._getItemPercentWidth(o))}),i}_isPercentWidth(e){return U(e)&&e.endsWith("%")}_isColumnHidden(e){return this._hiddenColumns.filter(t=>t.index===e.index).length>0}_getAverageColumnsWidth(e,t,n){const i=this;let o=0,s=0;return t.forEach(l=>{if(!i._isColumnHidden(l)){const{width:a}=l;f(a)&&!isNaN(parseFloat(a))?o+=i._isPercentWidth(a)?i._calculatePercentWidth({visibleIndex:l.visibleIndex,columnsCount:t.length,columnsCanFit:n,bestFitWidth:l.bestFitWidth,columnWidth:a,containerWidth:e}):parseFloat(a):s++}}),(e-o)/s}_calculateColumnWidth(e,t,n,i){const o=_n(this,e),s=this._columnsController.columnOption(o,"width"),l=this._columnsController.columnOption(o,"bestFitWidth"),a=n.length;let d;if(s&&s!=="auto")if(this._isPercentWidth(s))d=this._calculatePercentWidth({visibleIndex:e.visibleIndex,columnsCount:a,columnsCanFit:i,bestFitWidth:l,columnWidth:s,containerWidth:t});else return parseFloat(s);else d=this.option("columnAutoWidth")||e.command?l:this._getAverageColumnsWidth(t,n,i);return d}_calculatePercentWidth(e){const t=e.visibleIndex<e.columnsCount-1&&e.columnsCanFit,n=e.containerWidth*parseFloat(e.columnWidth)/100,i=e.columnsCanFit&&n<e.bestFitWidth?e.bestFitWidth:n;return t?e.containerWidth*parseFloat(e.columnWidth)/100:i}_getNotTruncatedColumnWidth(e,t,n,i){const o=_n(this,e),s=this._columnsController.columnOption(o,"width"),l=this._columnsController.columnOption(o,"bestFitWidth");if(s&&s!=="auto"&&!this._isPercentWidth(s))return parseFloat(s);const a=this._calculateColumnWidth(e,t,n,i);return a<l?null:a}_getItemPercentWidth(e){let t=0;return e.width&&this._isPercentWidth(e.width)&&(t=parseFloat(e.width)),t}_getCommandColumnsWidth(){const e=this,t=e._columnsController.getVisibleColumns();let n=0;return b(t,(i,o)=>{(o.index<0||o.command)&&(n+=e._columnsController.columnOption(_n(e,o),"bestFitWidth")||0)}),n}_isItemEdited(e){if(this.isFormOrPopupEditMode())return!1;if(this._isRowEditMode()){const t=this.option("editing.editRowKey");if(G(t,this._dataController.adaptiveExpandedKey()))return!0}else{const t=this._dataController.getRowIndexByKey(this._dataController.adaptiveExpandedKey())+1,n=this._columnsController.getVisibleIndex(e.column.index);return this._editingController.isEditCell(t,n)}}_getFormItemsByHiddenColumns(e){const t=[];return b(e,(n,i)=>{t.push({column:i,name:i.name,dataField:i.dataField,visibleIndex:i.visibleIndex})}),t}_getAdaptiveColumnVisibleIndex(e){for(let t=0;t<e.length;t++)if(e[t].command==="adaptive")return t}_hideAdaptiveColumn(e,t){const n=this._getAdaptiveColumnVisibleIndex(t);f(n)&&(e[n]="adaptiveHidden",this._hideVisibleColumn({isCommandColumn:!0,visibleIndex:n}))}_showHiddenCellsInView(e){let{$cells:t,isCommandColumn:n}=e,i=this.addWidgetPrefix("hidden-column");n?(i="dx-command-adaptive-hidden",t.attr({tabIndex:0,"aria-hidden":null}).removeClass(i)):t.removeClass(i)}_showHiddenColumns(){for(let e=0;e<Li.length;e++){const t=this.getView(Li[e]);if(t&&t.isVisible()&&t.element()){const n=t.name,i=t.element().find(".dx-command-adaptive-hidden");this._showHiddenCellsInView({viewName:n,$cells:i,isCommandColumn:!0});const o=t.element().find(`.${this.addWidgetPrefix("hidden-column")}`);this._showHiddenCellsInView({viewName:n,$cells:o})}}}_isCellValid(e){return e&&e.length&&!e.hasClass("dx-master-detail-cell")&&!e.hasClass("dx-group-cell")}_hideVisibleColumn(e){let{isCommandColumn:t,visibleIndex:n}=e;const i=this;Li.forEach(o=>{const s=i.getView(o);s&&i._hideVisibleColumnInView({view:s,isCommandColumn:t,visibleIndex:n})})}_hideVisibleColumnInView(e){let{view:t,isCommandColumn:n,visibleIndex:i}=e;const o=t.name;let s;const l=this._columnsController.getVisibleColumns()[i],a=this._editingController&&this._editingController.getEditFormRowIndex();if(t&&t.isVisible()&&l){const d=t.getRowsCount(),u=t._getRowElements();for(let c=0;c<d;c++)if(!(c===a&&o===id&&this.option("editing.mode")!=="popup")){const p=o==="columnHeadersView"?this._columnsController.getVisibleIndex(l.index,c):i;if(p>=0){const m=u.eq(c);s=this._findCellElementInRow(m,p),this._isCellValid(s)&&this._hideVisibleCellInView({viewName:o,isCommandColumn:n,$cell:s})}}}}_findCellElementInRow(e,t){const n=e.children();let i=t,o=!1;if(e.hasClass("dx-group-row")){const l=e.find(".dx-group-cell"),a=l.attr("colspan");if(l.length&&f(a)){const d=parseInt(a),u=l.index()+d-1;t>u?i=t-d+1:o=!0}}return o?void 0:n.eq(i)}_hideVisibleCellInView(e){let{$cell:t,isCommandColumn:n}=e;const i=n?"dx-command-adaptive-hidden":this.addWidgetPrefix("hidden-column");t.attr({tabIndex:-1,"aria-hidden":!0}).addClass(i)}_getEditMode(){return this._editingController.getEditMode()}isFormOrPopupEditMode(){const e=this._getEditMode();return e==="form"||e==="popup"}hideRedundantColumns(e,t,n){const i=this;if(this._hiddenColumns=[],i._isVisibleColumnsValid(t)&&n.length){let o=0;const s=i.component.$element();let l=K(s)-i._getCommandColumnsWidth();const a=(function(){return t.filter(m=>!m.command&&this._hiddenColumns.filter(C=>C.index===m.index).length===0)}).bind(this);let d=a();const u=d.length;let c,h,p;do{p=!1,o=0;const m=i._calculatePercentWidths(e,t),C=m<100&&m!==0;for(c=0;c<t.length;c++){const w=t[c];let S=i._getNotTruncatedColumnWidth(w,l,d,C);const V=_n(i,w),O=i._columnsController.columnOption(V,"width"),P=i._columnsController.columnOption(V,"minWidth"),k=i._columnsController.columnOption(V,"bestFitWidth");if(e[c]==="adaptiveHidden"){h=!0;continue}if(!S&&!w.command&&!w.fixed){p=!0;break}(!O||O==="auto")&&(S=Math.max(k||0,P||0)),(w.command!=="adaptive"||h)&&(o+=S)}if(p=p||o>K(s),p){const w=n.pop(),S=i._columnsController.getVisibleIndex(w.index);l+=i._calculateColumnWidth(w,l,d,C),i._hideVisibleColumn({visibleIndex:S}),e[S]="adaptiveHidden",this._hiddenColumns.push(w),d=a()}}while(p&&d.length>1&&n.length);u===d.length&&i._hideAdaptiveColumn(e,t)}else i._hideAdaptiveColumn(e,t)}getAdaptiveDetailItems(){return this._$itemContents}getItemContentByColumnIndex(e){let t;for(let n=0;n<this._$itemContents.length;n++){t=this._$itemContents.eq(n);const i=t.data("dx-form-item");if(i&&i.column&&this._columnsController.getVisibleIndex(i.column.index)===e)return t}}toggleExpandAdaptiveDetailRow(e,t){this.isFormOrPopupEditMode()&&this._editingController.isEditing()||this._dataController.toggleExpandAdaptiveDetailRow(e,t)}createFormByHiddenColumns(e,t){const n=this,i=g(e),o={items:n._getFormItemsByHiddenColumns(n._hiddenColumns),formID:`dx-${new ot}`},s=co()?{colCount:2}:{};this.executeAction("onAdaptiveDetailRowPreparing",{formOptions:o}),n._$itemContents=null,n._form=n._createComponent(g("<div>").appendTo(i),kr,y(s,o,{customizeItem(l){const a=l.column||n._columnsController.columnOption(l.name||l.dataField);a&&(l.label=l.label||{},l.label.text=l.label.text||a.caption,l.column=a,l.template=n._getTemplate(l,t,n.updateForm.bind(n))),o.customizeItem&&o.customizeItem.call(this,l)},onContentReady(l){o.onContentReady&&o.onContentReady.call(this,l),n._$itemContents=i.find(".dx-field-item-content")}}))}hasAdaptiveDetailRowExpanded(){return f(this._dataController.adaptiveExpandedKey())}updateForm(e){this.hasAdaptiveDetailRowExpanded()&&this._form&&f(this._form._contentReadyAction)&&(e&&e.length?this._form.option("items",this._getFormItemsByHiddenColumns(e)):this._form.repaint())}updateHidingQueue(e){const t=this,n=e.filter(s=>s.visible&&!s.type&&!s.fixed&&!(f(s.groupIndex)&&s.groupIndex>=0));let i,o;if(t._hidingColumnsQueue=[],t.option("allowColumnResizing")&&t.option("columnResizingMode")==="widget")return t._hidingColumnsQueue;for(o=0;o<n.length;o++)f(n[o].hidingPriority)&&n[o].hidingPriority>=0&&(i=!0,t._hidingColumnsQueue[n[o].hidingPriority]=n[o]);if(i)t._hidingColumnsQueue.reverse();else if(t.option("columnHidingEnabled"))for(o=0;o<n.length;o++){const s=t._columnsController.getVisibleIndex(n[o].index);t._hidingColumnsQueue[s]=n[o]}return t._hidingColumnsQueue=t._hidingColumnsQueue.filter(Object),t._hidingColumnsQueue}getHiddenColumns(){return this._hiddenColumns}hasHiddenColumns(){return this._hiddenColumns.length>0}getHidingColumnsQueue(){return this._hidingColumnsQueue}isAdaptiveDetailRowExpanded(e){const t=this._dataController;return t.adaptiveExpandedKey()&&G(t.adaptiveExpandedKey(),e)}expandAdaptiveDetailRow(e){this.hasAdaptiveDetailRowExpanded()||this.toggleExpandAdaptiveDetailRow(e)}collapseAdaptiveDetailRow(){this.hasAdaptiveDetailRowExpanded()&&this.toggleExpandAdaptiveDetailRow()}updateCommandAdaptiveAriaLabel(e,t){const n=this._dataController.getRowIndexByKey(e);if(n===-1)return;const i=g(this.component.getRowElement(n));this.setCommandAdaptiveAriaLabel(i,t)}setCommandAdaptiveAriaLabel(e,t){e.find(".dx-command-adaptive").attr("aria-label",_.format(t))}}const p_=r=>class extends r{_isCellValid(e,t){return super._isCellValid(e,t)&&!e.hasClass(this.addWidgetPrefix("hidden-column"))&&!e.hasClass("dx-command-adaptive-hidden")}_processNextCellInMasterDetail(e,t){super._processNextCellInMasterDetail(e,t);const n=this._editingController.isCellOrBatchEditMode();this._editingController.isEditing()&&e&&n&&!this._isInsideEditForm(e)&&(x.off(e,"focus",lo),x.on(e,"focus",{$nextCell:e},lo),x.trigger(t,"focus"))}_isCellElement(e){return super._isCellElement(e)||e.hasClass("dx-adaptive-item-text")}},g_=r=>class extends r{_getCellTemplate(e){const t=this,{column:n}=e;return e.rowType==="detailAdaptive"&&n.command==="detail"?function(i,o){t._adaptiveColumnsController.createFormByHiddenColumns(g(i),o)}:super._getCellTemplate(e)}_createRow(e){const t=super._createRow.apply(this,arguments);return e&&e.rowType==="detailAdaptive"&&e.key===this._dataController.adaptiveExpandedKey()&&t.addClass("dx-adaptive-detail-row"),t}_renderCells(e,t){super._renderCells(e,t);const n=this._adaptiveColumnsController,i=n.getHidingColumnsQueue().length,o=n.getHiddenColumns().length;i&&!o&&u_(e).last().addClass("dx-last-data-cell"),t.row.rowType==="data"&&n.setCommandAdaptiveAriaLabel(e,od)}_getColumnIndexByElementCore(e){const t=e.closest(".dx-field-item-content");if(t.length&&t.closest(this.component.$element()).length){const n=t.length?t.first().data("dx-form-item"):null;return n&&n.column&&this._columnsController.getVisibleIndex(n.column.index)}return super._getColumnIndexByElementCore(e)}_cellPrepared(e,t){super._cellPrepared.apply(this,arguments),t.row.rowType!=="detailAdaptive"&&t.column.visibleWidth==="adaptiveHidden"&&e.addClass(this.addWidgetPrefix("hidden-column"))}getCell(e,t){const n=this._dataController.items()[e==null?void 0:e.rowIndex];if((n==null?void 0:n.rowType)==="detailAdaptive"){const i=this._adaptiveColumnsController.getAdaptiveDetailItems();return super.getCell(e,t,i)}return super.getCell.apply(this,arguments)}_getCellElement(e,t){const n=this._dataController.items()[e];return n&&n.rowType==="detailAdaptive"?this._adaptiveColumnsController.getItemContentByColumnIndex(t):super._getCellElement.apply(this,arguments)}getContextMenuItems(e){var t;if(e.row&&e.row.rowType==="detailAdaptive"){const n=this._columnHeadersView,i=g(e.targetElement).closest(".dx-field-item-label").next().data("dx-form-item");return e.column=i?i.column:e.column,n.getContextMenuItems&&n.getContextMenuItems(e)}return(t=super.getContextMenuItems)===null||t===void 0?void 0:t.call(this,e)}isClickableElement(e){var t;return(((t=super.isClickableElement)===null||t===void 0?void 0:t.call(this,e))??!1)||!!e.closest(".dx-command-adaptive").length}},m_=r=>class extends r{_updateColumnWidth(e,t){super._updateColumnWidth(e,e.visibleWidth==="adaptiveHidden"?e.bestFitWidth:t)}},f_=r=>class extends r{_pointCreated(e,t,n){const i=super._pointCreated(e,t,n),o=n[e.columnIndex]||{},s=this._getNextColumnIndex(e.columnIndex),l=n[s]||{},a=s!==e.columnIndex+1&&l.command,d=o.visibleWidth==="adaptiveHidden"||a;return i||d}_getNextColumnIndex(e){const t=this._columnsController.getVisibleColumns();let n=super._getNextColumnIndex(e);for(;t[n]&&t[n].visibleWidth==="adaptiveHidden";)n++;return n}},C_=r=>class extends r{_pointCreated(e,t,n,i){const o=super._pointCreated(e,t,n,i),l=(t[e.columnIndex-1]||{}).visibleWidth==="adaptiveHidden";return o||l}},__=r=>class extends r{_isRowEditMode(){return this.getEditMode()==="row"}_getFormEditItemTemplate(e,t){return this.getEditMode()!=="row"&&e.rowType==="detailAdaptive"?(e.columnIndex=this._columnsController.getVisibleIndex(t.index),this.getColumnTemplate(e)):super._getFormEditItemTemplate(e,t)}_closeEditItem(e){const t=e.closest(".dx-field-item-content"),n=this._dataController.getRowIndexByKey(this._dataController.adaptiveExpandedKey())+1,i=t.length?t.first().data("dx-form-item"):null,o=i&&i.column&&this._columnsController.getVisibleIndex(i.column.index);this.isEditCell(n,o)||super._closeEditItem(e)}_beforeUpdateItems(e,t){if(!this._adaptiveColumnsController.isFormOrPopupEditMode()&&this._adaptiveColumnsController.hasHiddenColumns()){const n=this._dataController.items(),i=n[t],o=v.getIndexByKey(this._dataController.adaptiveExpandedKey(),n);this._isForceRowAdaptiveExpand=!this._adaptiveColumnsController.hasAdaptiveDetailRowExpanded(),o>=0&&e.push(o+1),e.push(t+1),this._dataController.adaptiveExpandedKey(i.key)}}_afterInsertRow(e){super._afterInsertRow.apply(this,arguments),this._adaptiveColumnsController.hasHiddenColumns()&&(this._adaptiveColumnsController.toggleExpandAdaptiveDetailRow(e,this.isRowEditMode()),this._isForceRowAdaptiveExpand=!0)}_collapseAdaptiveDetailRow(){this._isRowEditMode()&&this._isForceRowAdaptiveExpand&&(this._adaptiveColumnsController.collapseAdaptiveDetailRow(),this._isForceRowAdaptiveExpand=!1)}_cancelEditAdaptiveDetailRow(){this._adaptiveColumnsController.hasHiddenColumns()&&this._collapseAdaptiveDetailRow()}_afterSaveEditData(){super._afterSaveEditData.apply(this,arguments);const e=new E;return this._isRowEditMode()&&this._adaptiveColumnsController.hasHiddenColumns()?F(this._validatingController.validate(!0)).done(t=>{t&&this._cancelEditAdaptiveDetailRow(),e.resolve()}):e.resolve(),e.promise()}_beforeCancelEditData(){super._beforeCancelEditData(),this._cancelEditAdaptiveDetailRow()}_getRowIndicesForCascadeUpdating(e){const t=super._getRowIndicesForCascadeUpdating.apply(this,arguments);return this._adaptiveColumnsController.isAdaptiveDetailRowExpanded(e.key)&&t.push(e.rowType==="detailAdaptive"?e.rowIndex-1:e.rowIndex+1),t}_beforeCloseEditCellInBatchMode(e){const t=this._dataController._adaptiveExpandedKey;if(t){const n=v.getIndexByKey(t,this._dataController.items());n>-1&&e.unshift(n)}}editRow(e){return this._adaptiveColumnsController.isFormOrPopupEditMode()&&this._adaptiveColumnsController.collapseAdaptiveDetailRow(),super.editRow(e)}deleteRow(e){const t=this._dataController.getKeyByRowIndex(e);this.getEditMode()==="batch"&&this._adaptiveColumnsController.isAdaptiveDetailRowExpanded(t)&&this._adaptiveColumnsController.collapseAdaptiveDetailRow(),super.deleteRow(e)}},w_=r=>class extends r{init(){super.init(),this._adaptiveExpandedKey=void 0}_processItems(e,t){const{changeType:n}=t;if(e=super._processItems.apply(this,arguments),n==="loadingAll"||!f(this._adaptiveExpandedKey))return e;const i=v.getIndexByKey(this._adaptiveExpandedKey,e),o=this.option(d_)===!1;if(i>=0){const s=e[i];e.splice(i+1,0,{visible:!0,rowType:"detailAdaptive",key:s.key,data:s.data,node:s.node,modifiedValues:s.modifiedValues,isNewRow:s.isNewRow,values:s.values})}else n==="refresh"&&!(o&&t.repaintChangesOnly)&&(this._adaptiveExpandedKey=void 0);return e}_getRowIndicesForExpand(e){const t=super._getRowIndicesForExpand.apply(this,arguments);if(this._adaptiveColumnsController.isAdaptiveDetailRowExpanded(e)){const n=t[t.length-1];t.push(n+1)}return t}adaptiveExpandedKey(e){if(f(e))this._adaptiveExpandedKey=e;else return this._adaptiveExpandedKey}toggleExpandAdaptiveDetailRow(e,t){let n=v.getIndexByKey(this._adaptiveExpandedKey,this._items),i=v.getIndexByKey(e,this._items);n>=0&&n===i&&!t&&(e=void 0,i=-1);const o=this._adaptiveExpandedKey;this._adaptiveExpandedKey=e,n>=0&&n++,i>=0&&i++;const s=this.getRowIndexDelta();this.updateItems({allowInvisibleRowIndices:!0,changeType:"update",rowIndices:[n-s,i-s]}),this._adaptiveColumnsController.updateCommandAdaptiveAriaLabel(e,a_),this._adaptiveColumnsController.updateCommandAdaptiveAriaLabel(o,od)}},x_=r=>class extends r{_needHideBorder(e){return super._needHideBorder(e)||(e==null?void 0:e.hasClass("dx-field-item-content"))&&(e==null?void 0:e.find(".dx-checkbox").length)}_getFocusCellSelector(){return`${super._getFocusCellSelector()}, .dx-adaptive-detail-row .dx-field-item > .dx-field-item-content`}_getRevertTooltipsSelector(){return`${super._getRevertTooltipsSelector()}, .dx-field-item-content .${this.addWidgetPrefix("revert-tooltip")}`}},v_=r=>class extends r{_isColumnVisible(e){return super._isColumnVisible(e)&&!e.adaptiveHidden}getVisibleDataColumnsByBandColumn(e){return super.getVisibleDataColumnsByBandColumn(e).filter(t=>t.visibleWidth!=="adaptiveHidden")}},y_=r=>class extends r{dispose(){super.dispose.apply(this,arguments),clearTimeout(this._updateScrollableTimeoutID)}_needBestFit(){return super._needBestFit()||!!this._adaptiveColumnsController.getHidingColumnsQueue().length}_correctColumnWidths(e,t){const n=this._adaptiveColumnsController,i=n.getHiddenColumns(),o=n.updateHidingQueue(this._columnsController.getColumns());n.hideRedundantColumns(e,t,o);const s=n.getHiddenColumns();return n.hasAdaptiveDetailRowExpanded()&&i.length!==s.length&&n.updateForm(s),!s.length&&n.collapseAdaptiveDetailRow(),super._correctColumnWidths.apply(this,arguments)}_toggleBestFitMode(e){e&&this._adaptiveColumnsController._showHiddenColumns(),super._toggleBestFitMode(e)}_needStretch(){const e=this._adaptiveColumnsController;return super._needStretch.apply(this,arguments)||e.getHidingColumnsQueue().length||e.hasHiddenColumns()}},b_={defaultOptions:()=>({columnHidingEnabled:!1,onAdaptiveDetailRowPreparing:null}),controllers:{adaptiveColumns:h_},extenders:{views:{rowsView:g_},controllers:{export:m_,columnsResizer:f_,draggingHeader:C_,editing:__,resizing:y_,data:w_,editorFactory:x_,columns:v_,keyboardNavigation:p_}}};T.registerModule("adaptivity",b_);const sd=r=>class extends r{_needToSetCellWidths(){let e=super._needToSetCellWidths();return!e&&this._columnsController.isVirtualMode()&&(e=this._columnsController.getColumns().some(n=>n.width==="auto")),e}},I_=r=>class extends sd(r){_resizeCore(){super._resizeCore.apply(this,arguments),this._columnsController.resize()}_handleScroll(e){const t=this.getScrollable();let{left:n}=e.scrollOffset;super._handleScroll.apply(this,arguments),this.option("rtlEnabled")&&t&&(n=K(t.$content())-K(t.$element())-n),this._columnsController.setScrollPosition(n)}_renderCore(e){if(e!=null&&e.virtualColumnsScrolling){var t,n;const i=this._findContentElement(),o=(t=this._columnsController)===null||t===void 0?void 0:t.getFixedColumns(),s=(n=this._scrollable)===null||n===void 0?void 0:n.option("useNative");if(o!=null&&o.length){i.css({minHeight:s?J(i):v.getContentHeightLimit(ee)});const l=()=>{this.resizeCompleted.remove(l),i.css({minHeight:""})};this.resizeCompleted.add(l)}}return super._renderCore.apply(this,arguments)}},E_=r=>class extends sd(r){_renderCore(){const e=super._renderCore.apply(this,arguments);return this._columnsController.isVirtualMode()&&this._updateScrollLeftPosition(),e}},wn=function(r){return r.map(e=>e.visibleWidth||parseFloat(e.width)||50)},S_=r=>class extends r{init(){super.init.apply(this,arguments),this._resizingController=this.getController("resizing"),this._beginPageIndex=null,this._endPageIndex=null,this._position??(this._position=0),this._virtualVisibleColumns={}}dispose(){clearTimeout(this._changedTimeout),super.dispose.apply(this,arguments)}resetColumnsCache(){super.resetColumnsCache(),this._virtualVisibleColumns={}}getBeginPageIndex(e){const t=this.getVisibleColumns(void 0,!0),n=wn(t);let i=0;for(let o=0;o<n.length;o++){if(i>=e)return Math.floor(o/this.getColumnPageSize());i+=n[o]}return 0}getTotalWidth(){const e=this.option("width");return typeof e=="number"?e:this._resizingController._lastWidth||ye(this.component.$element())}getEndPageIndex(e){const t=this.getVisibleColumns(void 0,!0),n=wn(t);let i=0;e+=this.getTotalWidth();for(let o=0;o<n.length;o++){if(i>=e)return Math.ceil(o/this.getColumnPageSize());i+=n[o]}return Math.ceil(n.length/this.getColumnPageSize())}getColumnPageSize(){return this.option("scrolling.columnPageSize")}_fireColumnsChanged(){const e=new Date;this.columnsChanged.fire({optionNames:{all:!0,length:1},changeTypes:{columns:!0,virtualColumnsScrolling:!0,length:2}}),this._renderTime=new Date-e}getScrollingTimeout(){const e=this.option("scrolling.columnRenderingThreshold"),t=this.option("scrolling.renderAsync");let n=0;return(!f(t)&&this._renderTime>e||t)&&(n=this.option("scrolling.timeout")),n}setScrollPosition(e){const t=this.getScrollingTimeout();t>0?(clearTimeout(this._changedTimeout),this._changedTimeout=setTimeout(()=>{this._setScrollPositionCore(e)},t)):this._setScrollPositionCore(e)}resize(){this._setScrollPositionCore(this._position)}_setScrollPositionCore(e){const t=this;if(t.isVirtualMode()){const n=t.getBeginPageIndex(e),i=t.getEndPageIndex(e),o=e<t._position?t._beginPageIndex>n:t._endPageIndex<i;t._position=e,o&&(t._beginPageIndex=n,t._endPageIndex=i,t._fireColumnsChanged())}}getFixedColumns(e,t){const n=super.getFixedColumns(e);if(this.isVirtualMode()&&!t&&n.length){const i=n.map(o=>o.command).indexOf("transparent");return n[i].colspan=this.getVisibleColumns().length-super.getFixedColumns().length+1,n}return n}_compileVisibleColumns(e,t){var n;if(t||!this.isVirtualMode()||!this._shouldReturnVisibleColumns())return super._compileVisibleColumns(e);(n=this._columns)!==null&&n!==void 0&&n.length&&!f(this._beginPageIndex)&&!f(this._endPageIndex)&&(this._beginPageIndex=this.getBeginPageIndex(this._position),this._endPageIndex=this.getEndPageIndex(this._position));const i=this._beginPageIndex,o=this._endPageIndex,s=`${e}-${i}-${o}`;if(this._virtualVisibleColumns[s])return this._virtualVisibleColumns[s];let l=super._compileVisibleColumns();const a=this.getRowCount(),d=this.getColumnPageSize();let u=i*d,c=o*d;const h=this.getFixedColumns(void 0,!0),p=h.map(B=>B.command).indexOf("transparent"),m=h.length?p:0;let C=l.slice(0,m);const w=l.slice(m,u),S=wn(w).reduce((B,$)=>B+$,0);S||(u=0);const V=h.length?h.length-p-1:0;let O=l.slice(l.length-V);const P=l.slice(c,l.length-V),k=wn(P).reduce((B,$)=>B+$,0);if(k||(c=l.length),a>1&&typeof e=="number"){const B=[];for(let $=0;$<=a;$++)B.push(super._compileVisibleColumns($));C=ai(B,0,C.length)[e]||[],O=ai(B,l.length-O.length,l.length)[e]||[],l=ai(B,u,c)[e]||[]}else l=l.slice(u,c);return S&&(l.unshift({command:"virtual",type:"virtual",width:S}),l=C.concat(l)),k&&(l.push({command:"virtual",type:"virtual",width:k}),l=l.concat(O)),this._virtualVisibleColumns[s]=l,l}getColumnIndexOffset(){let e=0;if(this._beginPageIndex>0){const n=this.getFixedColumns().map(o=>o.command).indexOf("transparent"),i=n>=0?n:0;e=this._beginPageIndex*this.getColumnPageSize()-i-1}return e>0?e:0}isVirtualMode(){return ft()&&this.option("scrolling.columnRenderingMode")==="virtual"}},R_={defaultOptions:()=>({scrolling:{columnRenderingMode:"standard",columnPageSize:5,columnRenderingThreshold:300}}),extenders:{controllers:{columns:S_},views:{columnHeadersView:E_,rowsView:I_}}};T.registerModule("virtualColumns",R_);class T_{constructor(e,t,n){this._exportController=e,this._initialColumnWidthsByColumnIndex=t,this._selectedRowsOnly=n}_getGroupValue(e){const{key:t,data:n,rowType:i,groupIndex:o,summaryCells:s}=e,l=this._options.groupColumns[o],a=T.getDisplayValue(l,l.deserializeValue?l.deserializeValue(t[o]):t[o],n,i);let d=`${l.caption}: ${T.formatValue(a,l)}`;return s&&s[0]&&s[0].length&&(d+=` ${T.getGroupRowSummaryText(s[0],this._options.summaryTexts)}`),d}_correctCellIndex(e){return e}_initOptions(){const e=this._exportController,t=e._columnsController.getGroupColumns();this._options={columns:e._getColumns(this._initialColumnWidthsByColumnIndex),groupColumns:t,items:this._selectedRowsOnly||e._selectionOnly?e._getSelectedItems():e._getAllItems(),isHeadersVisible:e.option("showColumnHeaders"),summaryTexts:e.option("summary.texts"),rtlEnabled:e.option("rtlEnabled")}}getHeaderStyles(){return[{bold:!0,alignment:"center"},{bold:!0,alignment:"left"},{bold:!0,alignment:"right"}]}getGroupRowStyle(){return{bold:!0,alignment:Zt(this._options.rtlEnabled)}}getColumnStyles(){const e=[];return this.getColumns().forEach(t=>{e.push({alignment:t.alignment||"left",format:t.format,dataType:t.dataType})}),e}getStyles(){return[...this.getHeaderStyles(),...this.getColumnStyles(),this.getGroupRowStyle()]}_getTotalCellStyleId(e){var t;const n=((t=this.getColumns()[e])===null||t===void 0?void 0:t.alignment)||"right";return this.getHeaderStyles().map(i=>i.alignment).indexOf(n)}getStyleId(e,t){return e<this.getHeaderRowCount()?0:this.isTotalCell(e-this.getHeaderRowCount(),t)?this._getTotalCellStyleId(t):this.isGroupRow(e-this.getHeaderRowCount())?this.getHeaderStyles().length+this.getColumns().length:t+this.getHeaderStyles().length}getColumns(e){const{columns:t}=this._options;return e?t:t[t.length-1]}getColumnsWidths(){const e=this.getColumns();return f(e)?e.map(t=>t.width):void 0}getRowsCount(){return this._options.items.length+this.getHeaderRowCount()}getHeaderRowCount(){return this.isHeadersVisible()?this._options.columns.length-1:0}isGroupRow(e){return e<this._options.items.length&&this._options.items[e].rowType==="group"}getGroupLevel(e){const t=this._options.items[e-this.getHeaderRowCount()],n=t&&t.groupIndex;return t&&t.rowType==="totalFooter"?0:f(n)?n:this._options.groupColumns.length}getCellType(e,t){const n=this.getColumns();if(e<this.getHeaderRowCount())return"string";if(e-=this.getHeaderRowCount(),t<n.length){const i=this._options.items.length&&this._options.items[e],o=n[t];return i&&i.rowType==="data"&&isFinite(i.values[this._correctCellIndex(t)])&&!f(o.customizeText)?f(o.lookup)?o.lookup.dataType:o.dataType:"string"}}ready(){this._initOptions();const e=this._options;return F(e.items).done(t=>{e.items=t}).fail(()=>{e.items=[]})}_convertFromGridGroupSummaryItems(e){if(f(e)&&e.length>0)return e.map(t=>({value:t.value,name:t.name}))}getCellData(e,t,n){let i,o;const s={cellSourceData:{},value:i},l=this.getColumns(),a=this._correctCellIndex(t);if(e<this.getHeaderRowCount())o=this.getColumns(!0)[e][t],s.cellSourceData.rowType="header",s.cellSourceData.column=o&&o.gridColumn,s.value=o&&o.caption;else{e-=this.getHeaderRowCount();const d=this._options.items.length&&this._options.items[e];if(d){const u=d.values;switch(s.cellSourceData.rowType=d.rowType,s.cellSourceData.column=l[t]&&l[t].gridColumn,d.rowType){case"groupFooter":case"totalFooter":a<u.length&&(i=u[a],f(i)?(s.cellSourceData.value=i.value,s.cellSourceData.totalSummaryItemName=i.name,s.value=T.getSummaryText(i,this._options.summaryTexts)):s.cellSourceData.value=void 0);break;case"group":if(s.cellSourceData.groupIndex=d.groupIndex,t<1)s.cellSourceData.column=this._options.groupColumns[d.groupIndex],s.cellSourceData.value=d.key[d.groupIndex],s.cellSourceData.groupSummaryItems=this._convertFromGridGroupSummaryItems(d.summaryCells[0]),s.value=this._getGroupValue(d);else{const c=d.values[a];if(Array.isArray(c)){s.cellSourceData.groupSummaryItems=this._convertFromGridGroupSummaryItems(c),i="";for(let h=0;h<c.length;h++)i+=(h>0?n?`
`:` 
 `:"")+T.getSummaryText(c[h],this._options.summaryTexts);s.value=i}else s.cellSourceData.value=void 0}break;default:if(o=l[t],o){const c=u[a],h=T.getDisplayValue(o,c,d.data,d.rowType);!isFinite(h)||f(o.customizeText)?n&&f(o.customizeText)&&o.customizeText===this._exportController._columnsController.getCustomizeTextByDataType("boolean")?s.value=h:s.value=T.formatValue(h,o):s.value=h,s.cellSourceData.value=c}s.cellSourceData.data=d.data}}}return s}isHeadersVisible(){return this._options.isHeadersVisible}isTotalCell(e,t){const{items:n}=this._options,i=n[e],o=this._correctCellIndex(t),s=i.summaryCells&&i.summaryCells[o]&&i.summaryCells[o].length>0&&i.summaryCells[o][0].alignByColumn;return i&&i.rowType==="groupFooter"||i.rowType==="totalFooter"||s}getCellMerging(e,t){const{columns:n}=this._options,i=n[e]&&n[e][t];return i?{colspan:(i.exportColspan||1)-1,rowspan:(i.rowspan||1)-1}:{colspan:0,rowspan:0}}getFrozenArea(){return{x:0,y:this.getHeaderRowCount()}}}class V_ extends T.ViewController{init(){this.throwWarningIfNoOnExportingEvent(),this._columnsController=this.getController("columns"),this._dataController=this.getController("data"),this._selectionController=this.getController("selection"),this._rowsView=this.getView("rowsView"),this._headersView=this.getView("columnHeadersView"),this.createAction("onExporting",{excludeValidators:["disabled","readOnly"]})}_getEmptyCell(){return{caption:"",colspan:1,rowspan:1}}_updateColumnWidth(e,t){e.width=t}_getColumns(e){let t=[],n,i;const o=this._columnsController,s=o.getRowCount();for(n=0;n<=s;n++){const l=[];i=o.getVisibleColumns(n,!0);let a;if(n===s)if(this._updateLockCount)a=e;else{const d=this._getColumnWidths(this._headersView,this._rowsView);if(d&&d.length){a={};for(let u=0;u<i.length;u++)a[i[u].index]=d[u]}}for(let d=0;d<i.length;d++){const u=y({},i[d],{dataType:i[d].dataType==="datetime"?"date":i[d].dataType,gridColumn:i[d]});if(this._needColumnExporting(u)){const c=this._calculateExportColspan(u);f(c)&&(u.exportColspan=c),a&&this._updateColumnWidth(u,a[u.index]),l.push(u)}}t.push(l)}return i=t[s],t=au(t.slice(0,-1),this._getEmptyCell()),t.push(i),t}_calculateExportColspan(e){if(!e.isBand)return;const t=this._columnsController.getChildrenByBandColumn(e.index,!0);if(f(t))return t.reduce((n,i)=>this._needColumnExporting(i)?n+(this._calculateExportColspan(i)||1):n,0)}_needColumnExporting(e){return!e.command&&(e.allowExporting||e.allowExporting===void 0)}_getFooterSummaryItems(e,t){const n=[];let i=1,o=0;do{const s=[];for(let l=0;l<e.length;l++){const a=e[l],d=a.length;i<d&&(i=d),s.push(a[o])}n.push({values:s,rowType:t?"totalFooter":"groupFooter"})}while(o++<i-1);return n}_hasSummaryGroupFooters(){const e=this.option("summary.groupItems");if(f(e)){for(let t=0;t<e.length;t++)if(e[t].showInGroupFooter)return!0}return!1}_getItemsWithSummaryGroupFooters(e){let t=[],n=[],i=[];for(let o=0;o<e.length;o++){const s=e[o];s.rowType==="groupFooter"?(i=this._getFooterSummaryItems(s.summaryCells),t=t.concat(n,i),n=[]):n.push(s)}return t.length?t:n}_updateGroupValuesWithSummaryByColumn(e){let t=[];for(let n=0;n<e.length;n++){const i=e[n],{summaryCells:o}=i;if(i.rowType==="group"&&o&&o.length>1){const s=i.values.length;for(let l=1;l<o.length;l++)for(let a=0;a<o[l].length;a++){const d=o[l][a];d&&d.alignByColumn&&(Array.isArray(t[l-s])||(t[l-s]=[]),t[l-s].push(d))}t.length>0&&(i.values.push(...t),t=[])}}}_processUnExportedItems(e){const t=this._columnsController.getVisibleColumns(null,!0),n=this._columnsController.getGroupColumns();let i,o;for(let s=0;s<e.length;s++){const l=e[s];let a=!1;i=[],o=[];for(let d=0;d<t.length;d++){const u=t[d];if(a||(a=["detailExpand","buttons"].includes(u.type)),this._needColumnExporting(u)&&(l.values&&(l.rowType==="group"&&!i.length?i.push(l.key[l.groupIndex]):i.push(l.values[d])),l.summaryCells))if(l.rowType==="group"&&!o.length){const c=d-n.length+l.groupIndex;o.push(l.summaryCells[a?c:c+1])}else o.push(l.summaryCells[d])}i.length&&(l.values=i),o.length&&(l.summaryCells=o)}}_getAllItems(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this,i=new E,o=this._dataController.footerItems(),s=o.length&&o[0],l=n.option("summary.totalItems");let a;return F(e).done(d=>{this._dataController.loadAll(d,t).done((u,c)=>{n._updateGroupValuesWithSummaryByColumn(u),n._hasSummaryGroupFooters()&&(u=n._getItemsWithSummaryGroupFooters(u)),a=s&&s.summaryCells,f(c)&&l&&(a=n._getSummaryCells(l,c));const h=s&&n._getFooterSummaryItems(a,!0);h&&(u=u.concat(h)),n._processUnExportedItems(u),i.resolve(u)}).fail(i.reject)}).fail(i.reject),i}_getSummaryCells(e,t){return this._dataController._calculateSummaryCells(e,t,this._columnsController.getVisibleColumns(null,!0),(n,i)=>this._dataController._isDataColumn(i)?i.index:-1)}_getSelectedItems(){return this.needLoadItemsOnExportingSelectedItems()?this._getAllItems(this._selectionController.loadSelectedItemsWithFilter(),!0):this._getAllItems(this._selectionController.getSelectedRowsData())}_getColumnWidths(e,t){return e&&e.isVisible()?e.getColumnWidths():t.getColumnWidths()}throwWarningIfNoOnExportingEvent(){var e,t;const n=(e=(t=this.component).hasActionSubscription)===null||e===void 0?void 0:e.call(t,"onExporting");this.option("export.enabled")&&!n&&oe.log("W1024")}callbackNames(){return["selectionOnlyChanged"]}getDataProvider(e){const t=this._getColumnWidths(this._headersView,this._rowsView);let n;if(t&&t.length){n={};const i=this._columnsController.getVisibleColumns(this._columnsController.getRowCount(),!0);for(let o=0;o<i.length;o++)n[i[o].index]=t[o]}return new T_(this,n,e)}exportTo(e,t){this._selectionOnly=e;const n=this.getAction("onExporting"),i={rtlEnabled:this.option("rtlEnabled"),selectedRowsOnly:!!e,format:t,fileName:"DataGrid",cancel:!1};X(n)&&n(i)}publicMethods(){return["getDataProvider"]}selectionOnly(e){if(f(e))this._isSelectedRows=e,this.selectionOnlyChanged.fire();else return this._isSelectedRows}optionChanged(e){super.optionChanged(e),e.name==="export"&&this.throwWarningIfNoOnExportingEvent()}needLoadItemsOnExportingSelectedItems(){return this.option("loadItemsOnExportingSelectedItems")??this._dataController._dataSource.remoteOperations().filtering}}const F_=r=>class extends r{callbackNames(){const e=super.callbackNames();return f(e)?e.push("editingButtonsUpdated"):["editingButtonsUpdated"]}_updateEditButtons(){super._updateEditButtons(),this.editingButtonsUpdated.fire()}},O_=r=>class extends r{_getToolbarItems(){const e=super._getToolbarItems(),t=this._getExportToolbarButton();return t&&(e.push(t),this._correctItemsPosition(e)),e}_getExportToolbarButton(){const e=this._getExportToolbarItems();if(e.length===0)return null;const t=this._needDisableExportButton(),n={name:"exportButton",location:"after",locateInMenu:"auto",sortIndex:30,options:{items:e},disabled:t};if(e.length===1){const i=A({},e[0],{hint:e[0].text,elementAttr:{class:"dx-datagrid-export-button"}});n.widget="dxButton",n.showText="inMenu",n.options=i}else{const i={icon:"export",displayExpr:"text",items:e,hint:this.option("export.texts.exportTo"),elementAttr:{class:"dx-datagrid-export-button"},dropDownOptions:{width:"auto",_wrapperClassExternal:"dx-datagrid-export-menu"}};n.options=i,n.widget="dxDropDownButton",n.menuItemTemplate=(o,s,l)=>{this._createComponent(g(l),Qd,{items:e})}}return n}_getExportToolbarItems(){const e=this.option("export"),t=this.option("export.texts"),n=this.option("export.formats")??[];if(!e.enabled)return[];const i=[];return n.forEach(o=>{let s=o.toUpperCase(),l="export";o==="xlsx"&&(s="Excel",l="xlsxfile"),o==="pdf"&&(l="pdffile"),i.push({text:Yt(t.exportAll,s),icon:l,onClick:()=>{this._exportController.exportTo(!1,o)}}),e.allowExportSelectedData&&i.push({text:Yt(t.exportSelectedRows,s),icon:"exportselected",onClick:()=>{this._exportController.exportTo(!0,o)}})}),i}_correctItemsPosition(e){e.sort((t,n)=>t.sortIndex-n.sortIndex)}_isExportButtonVisible(){return this.option("export.enabled")}optionChanged(e){super.optionChanged(e),e.name==="export"&&(e.handled=!0,this._invalidate())}_needDisableExportButton(){const e=!this._columnsController.hasVisibleDataColumns(),t=this._editingController.hasChanges();return e||t}_columnOptionChanged(e){if(super._columnOptionChanged(e),T.checkChanges(e.optionNames,["groupIndex","visible","all"])){const n=this._needDisableExportButton();this.setToolbarItemDisabled("exportButton",n)}}init(){super.init(),this._exportController=this.getController("export"),this._editingController.editingButtonsUpdated.add(()=>{const e=this._needDisableExportButton();this.setToolbarItemDisabled("exportButton",e)})}isVisible(){return super.isVisible()||this._isExportButtonVisible()}};T.registerModule("export",{defaultOptions:()=>({export:{enabled:!1,fileName:"DataGrid",formats:["xlsx"],allowExportSelectedData:!1,texts:{exportTo:_.format("dxDataGrid-exportTo"),exportAll:_.format("dxDataGrid-exportAll"),exportSelectedRows:_.format("dxDataGrid-exportSelectedRows")}}}),controllers:{export:V_},extenders:{controllers:{editing:F_},views:{headerPanel:O_}}});const D_=(r,e,t)=>{let{isRemoteFiltering:n,dateSerializationFormat:i,getSelector:o}=t;const{selector:s}=r,l=X(s)?s:o(s),a=l?l(e):e[s],d=n&&Jd(a)?Fn.serializeDate(a,i):a;return{getter:l,rawValue:a,safeValue:d}},P_={getSortFilterValue:D_},A_=".dx-row.dx-row-focused";class k_ extends L.ViewController{getKeyboardController(){return this.getController("keyboardNavigation")}getDataController(){return this.getController("data")}init(){this.component._optionsByReference.focusedRowKey=!0}optionChanged(e){const{name:t,value:n,previousValue:i}=e;switch(t){case"focusedRowIndex":this._focusRowByIndex(n),this.getKeyboardController()._fireFocusedRowChanged(),e.handled=!0;break;case"focusedRowKey":if(Array.isArray(n)&&JSON.stringify(n)===JSON.stringify(i))return;this._focusRowByKey(n),this.getKeyboardController()._fireFocusedRowChanged(),e.handled=!0;break;case"focusedColumnIndex":case"focusedRowEnabled":case"autoNavigateToFocusedRow":e.handled=!0;break;default:super.optionChanged(e)}}publicMethods(){return["navigateToRow","isRowFocused"]}isAutoNavigateToFocusedRow(){return this.option("scrolling.mode")!=="infinite"&&this.option("autoNavigateToFocusedRow")}_focusRowByIndex(e,t){this.option("focusedRowEnabled")&&(e=e!==void 0?e:this.option("focusedRowIndex"),e<0?this.isAutoNavigateToFocusedRow()&&this._resetFocusedRow():this._focusRowByIndexCore(e,t))}_focusRowByIndexCore(e,t){const n=this.getDataController().pageSize(),i=()=>{if(this._isValidFocusedRowIndex(e)){let o=e-this.getDataController().getRowIndexOffset(!0);if(!t||t.paging&&!t.filtering){const l=this.getDataController()._getLastItemIndex();o=Math.min(o,l)}const s=this.getDataController().getKeyByRowIndex(o,!0);f(s)&&!this.isRowFocused(s)&&this.option("focusedRowKey",s)}};if(n>=0)if(this._isLocalRowIndex(e))i();else{const o=Math.floor(e/this.getDataController().pageSize());F(this.getDataController().pageIndex(o),this.getDataController().waitReady()).done(()=>{i()})}}_isLocalRowIndex(e){if(this.getKeyboardController()._isVirtualScrolling()){const n=Math.floor(e/this.getDataController().pageSize()),i=this.getDataController().virtualItemsCount(),o=i?i.begin:-1,s=this.getDataController().getVisibleRows().length+this.getDataController().getRowIndexOffset(),l=Math.ceil(s/this.getDataController().pageSize());return o<=e&&l>n}return!0}_setFocusedRowKeyByIndex(e){if(this._isValidFocusedRowIndex(e)){const t=Math.min(e-this.getDataController().getRowIndexOffset(),this.getDataController().items().length-1),n=this.getDataController().getKeyByRowIndex(t);f(n)&&!this.isRowFocused(n)&&this.option("focusedRowKey",n)}}_focusRowByKey(e){f(e)?this._navigateToRow(e,!0):this._resetFocusedRow()}_resetFocusedRow(){const e=this.option("focusedRowKey"),t=f(e);!t&&this.option("focusedRowIndex")<0||(t&&this.option("focusedRowKey",null),this.getKeyboardController().setFocusedRowIndex(-1),this.option("focusedRowIndex",-1),this.getDataController().updateItems({changeType:"updateFocusedRow",focusedRowKey:null}),this.getKeyboardController()._fireFocusedRowChanged())}_isValidFocusedRowIndex(e){const t=this.getDataController().getVisibleRows()[e];return!t||t.rowType==="data"||t.rowType==="group"}navigateToRow(e){return this.isAutoNavigateToFocusedRow()||this.option("focusedRowIndex",-1),this._navigateToRow(e)}_navigateToRow(e,t){const n=this,i=n.isAutoNavigateToFocusedRow(),o=new E;if(e===void 0||!this.getDataController().dataSource())return o.reject().promise();const s=n.getFocusedRowIndexByKey(e);return!i&&t||s>=0?n._navigateTo(e,o,t):this.getDataController().getPageIndexByKey(e).done(l=>{if(l<0){o.resolve(-1);return}l===this.getDataController().pageIndex()?this.getDataController().reload().done(()=>{n.isRowFocused(e)&&this.getDataController().getRowIndexByKey(e)>=0?o.resolve(n.getFocusedRowIndexByKey(e)):n._navigateTo(e,o,t)}).fail(o.reject):this.getDataController().pageIndex(l).done(()=>{n._navigateTo(e,o,t)}).fail(o.reject)}).fail(o.reject),o.promise()}_navigateTo(e,t,n){const i=this.getDataController().getRowIndexByKey(e),o=v.isVirtualRowRendering(this);this.isAutoNavigateToFocusedRow()&&o&&i<0?this._navigateToVirtualRow(e,t,n):this._navigateToVisibleRow(e,t,n)}_navigateToVisibleRow(e,t,n){if(n)this._triggerUpdateFocusedRow(e,t);else{const i=this.getFocusedRowIndexByKey(e);this.getView("rowsView").scrollToRowElement(e,t).done(()=>{t.resolve(i)})}}_navigateToVirtualRow(e,t,n){const i=this.getDataController()._rowsScrollController,o=v.getIndexByKey(e,this.getDataController().items(!0)),s=this.getView("rowsView").getScrollable();if(i&&s&&o>=0){const l=o+this.getDataController().getRowIndexOffset(!0),a=i.getItemOffset(l),d=()=>{this.getDataController().totalCount()&&!this.getDataController().items().length||(this.component.off("contentReady",d),n?this._triggerUpdateFocusedRow(e,t):t.resolve(l))};this.component.on("contentReady",d),this.getView("rowsView").scrollTopPosition(a)}else t.resolve(-1)}_triggerUpdateFocusedRow(e,t){const n=this.getFocusedRowIndexByKey(e);if(this._isValidFocusedRowIndex(n)){let i;this.option("focusedRowEnabled")?this.getDataController().updateItems({changeType:"updateFocusedRow",focusedRowKey:e}):i=this.getView("rowsView").scrollToRowElement(e),F(i).done(()=>{this.getKeyboardController().setFocusedRowIndex(n),t&&t.resolve(n)})}else t&&t.resolve(-1)}getFocusedRowIndexByKey(e){const t=this.getDataController().getRowIndexByKey(e,!0);return t>=0?t+this.getDataController().getRowIndexOffset(!0):-1}_focusRowByKeyOrIndex(){const e=this.option("focusedRowKey");let t=this.option("focusedRowIndex");if(f(e)){const n=this.getDataController().getRowIndexByKey(e);n>=0?(this.getKeyboardController()._isVirtualScrolling()&&(t=n+this.getDataController().getRowIndexOffset()),this.getKeyboardController().setFocusedRowIndex(t),this._triggerUpdateFocusedRow(e)):this._navigateToRow(e,!0).done(i=>{t>=0&&i<0?this._focusRowByIndex():t<0&&i>=0&&this.getKeyboardController().setFocusedRowIndex(i)})}else t>=0&&this._focusRowByIndex(t)}isRowFocused(e){const t=this.option("focusedRowKey");if(f(t))return G(e,this.option("focusedRowKey"))}updateFocusedRow(e){const t=this,n=t.getDataController().getRowIndexByKey(e.focusedRowKey),i=t.getView("rowsView");let o,s;b(i.getTableElements(),(l,a)=>{const d=l===0;o=g(a),t._clearPreviousFocusedRow(o,n);const u=t._prepareFocusedRow({changedItem:t.getDataController().getVisibleRows()[n],$tableElement:o,focusedRowIndex:n});d&&(s=u)}),!e.preventScroll&&s&&i.scrollToElementVertically(s)}_clearPreviousFocusedRow(e,t){const n=e.find(A_).filter((i,o)=>{const s=g(o).closest(`.${this.addWidgetPrefix("table")}`);return e.is(s)});n.removeClass("dx-row-focused").removeClass("dx-cell-focus-disabled").removeAttr("tabindex"),n.children("td").removeAttr("tabindex"),t!==0&&g(this.getView("rowsView").getRowElement(0)).removeClass("dx-cell-focus-disabled").removeAttr("tabIndex")}_prepareFocusedRow(e){let t;const{changedItem:n}=e;if(n&&(n.rowType==="data"||n.rowType==="group")){const{focusedRowIndex:i}=e,{$tableElement:o}=e,s=this.option("tabindex")||0,l=this.getView("rowsView");t=g(l._getRowElements(o).eq(i)),t.addClass("dx-row-focused").attr("tabindex",s)}return t}}const B_=r=>class extends r{init(){const e=this.option("focusedRowIndex"),t=this.option("focusedColumnIndex");this.createAction("onFocusedRowChanging",{excludeValidators:["disabled","readOnly"]}),this.createAction("onFocusedRowChanged",{excludeValidators:["disabled","readOnly"]}),this.createAction("onFocusedCellChanging",{excludeValidators:["disabled","readOnly"]}),this.createAction("onFocusedCellChanged",{excludeValidators:["disabled","readOnly"]}),super.init(),this.setRowFocusType(),this._focusedCellPosition={},f(e)&&e>=0&&(this._focusedCellPosition.rowIndex=e),f(t)&&t>=0&&(this._focusedCellPosition.columnIndex=t)}setFocusedRowIndex(e){super.setFocusedRowIndex(e),this.option("focusedRowIndex",e)}setFocusedColumnIndex(e){super.setFocusedColumnIndex(e),this.option("focusedColumnIndex",e)}_escapeKeyHandler(e,t){return t||!this.option("focusedRowEnabled")?super._escapeKeyHandler(e,t):this.isCellFocusType()?(this.setRowFocusType(),this._focus(this._getCellElementFromTarget(e.originalEvent.target),!0),!0):!1}_updateFocusedCellPosition(e,t){const n=super._updateFocusedCellPosition(e,t);return n&&n.columnIndex>=0&&this._fireFocusedCellChanged(e),n}},M_=r=>class extends r{renderFocusOverlay(e,t){var n;const i=this.option("focusedRowEnabled");let o;!i||!((n=this._keyboardNavigationController)!==null&&n!==void 0&&n.isRowFocusType())||this._editingController.isEditing()?super.renderFocusOverlay(e,t):i&&this._keyboardNavigationController._getElementType(e)==="row"&&!e.hasClass("dx-row-focused")&&(o=this._keyboardNavigationController.getFirstValidCellInRow(e),this._keyboardNavigationController.focus(o))}},N_=r=>class extends r{getSortDataSourceParameters(e,t){let n=super.getSortDataSourceParameters.apply(this,arguments);const i=this._dataController._dataSource,o=this._dataController.store();let s=o&&o.key();const l=i&&i.remoteOperations()||{},a=Object.keys(l).every(d=>!l[d]);if(s&&(this.option("focusedRowEnabled")&&this._focusController.isAutoNavigateToFocusedRow()!==!1||t)){s=Array.isArray(s)?s:[s];const d=s.filter(u=>!this.columnOption(u,"sortOrder"));d.length&&(n=n||[],a?n.push({selector:i.getDataIndexGetter(),desc:!1}):d.forEach(u=>n.push({selector:u,desc:!1})))}return n}},L_=r=>class extends r{constructor(){super(...arguments),this._needToUpdateFocusedRowByIndex=!1}_applyChange(e){if(!(e&&e.changeType==="updateFocusedRow"))return super._applyChange.apply(this,arguments)}_fireChanged(e){if(super._fireChanged(e),this.option("focusedRowEnabled")&&this._dataSource){const n=e.changeType==="update"&&e.repaintChangesOnly&&e.changeTypes&&e.changeTypes.indexOf("remove")>=0;this._needToUpdateFocusedRowByIndex?(this._needToUpdateFocusedRowByIndex=!1,this._focusController._focusRowByIndex()):e.changeType==="refresh"&&e.items.length||n?(this._updatePageIndexes(),this._updateFocusedRow(e)):e.changeType==="append"||e.changeType==="prepend"?this._updatePageIndexes():e.changeType==="update"&&e.repaintChangesOnly&&this._updateFocusedRow(e)}}_handleDataPushed(e){super._handleDataPushed(e);const t=this.option("focusedRowKey");this._needToUpdateFocusedRowByIndex=e==null?void 0:e.some(n=>n.type==="remove"&&G(n.key,t))}_updatePageIndexes(){const e=this._lastRenderingPageIndex||0,t=this._rowsScrollController?this._rowsScrollController.pageIndex():0;this._lastRenderingPageIndex=t,this._isPagingByRendering=t!==e}isPagingByRendering(){return this._isPagingByRendering}_updateFocusedRow(e){const t=e.operationTypes||{},{reload:n,fullReload:i,pageIndex:o,paging:s}=t,l=this._keyboardNavigationController._isVirtualScrolling(),a=s&&!l,d=this.option("focusedRowKey"),u=this._focusController.isAutoNavigateToFocusedRow();if(n&&o===!1&&!i&&f(d))this._focusController._navigateToRow(d,!0).done(h=>{h<0&&this._focusController._focusRowByIndex(void 0,t)});else if(a&&u){const h=this.getRowIndexByKey(d),p=this.option("focusedRowIndex"),m=h>=0;p>=0&&(p===h||!m)&&this._focusController._focusRowByIndex(p,t)}else a&&!u&&this.getRowIndexByKey(d)<0?this.option("focusedRowIndex",-1):t.fullReload&&this._focusController._focusRowByKeyOrIndex()}getPageIndexByKey(e){const t=this,n=new E;return t.getGlobalRowIndexByKey(e).done(i=>{n.resolve(i>=0?Math.floor(i/t.pageSize()):-1)}).fail(n.reject),n.promise()}getGlobalRowIndexByKey(e){return this._dataSource.group()?this._calculateGlobalRowIndexByGroupedData(e):this._calculateGlobalRowIndexByFlatData(e)}_calculateGlobalRowIndexByFlatData(e,t,n){const i=this,o=new E,s=i._dataSource;if(Array.isArray(e)||Fp(e))return o.resolve(-1).promise();let l=i._generateFilterByKey(e);return s.load({filter:i._concatWithCombinedFilter(l),skip:0,take:1}).done(a=>{a.length>0?(l=i._generateOperationFilterByKey(e,a[0],n),s.load({filter:i._concatWithCombinedFilter(l,t),skip:0,take:1,requireTotalCount:!0}).done((d,u)=>{o.resolve(u.totalCount)})):o.resolve(-1)}),o.promise()}_concatWithCombinedFilter(e,t){const n=this.getCombinedFilter();return v.combineFilters([e,n,t])}_generateBooleanFilter(e,t,n){const{desc:i}=n;switch(!0){case(t===!1&&i):return[e,"=",!0];case(t===!1&&!i):return[e,"=",null];case(t===!0&&!i):case(!Qo(t)&&i):return[e,"<>",t];default:return}}_generateOperationFilterByKey(e,t,n){const i=this,o=i.option("dateSerializationFormat"),s=i._dataSource.remoteOperations().filtering,l=i._dataSource.remoteOperations().sorting;let a=i._generateFilterByKey(e,"<"),d=i._columnsController.getSortDataSourceParameters(!s,!0);if(n){const u=i._columnsController.getGroupDataSourceParameters(!s);u&&(d=d?u.concat(d):u)}return d&&d.slice().reverse().forEach(u=>{const{selector:c,desc:h,compare:p}=u,{getter:m,rawValue:C,safeValue:w}=P_.getSortFilterValue(u,t,{isRemoteFiltering:s,dateSerializationFormat:o,getSelector:S=>i._columnsController.columnOption(S,"selector")});if(a=[[c,"=",w],"and",a],C===null||Qo(C)){const S=i._generateBooleanFilter(c,w,h);S&&(a=[S,"or",a])}else{const S=h?">":"<";let V;p&&!l?V=O=>S==="<"?p(C,m(O))>=1:p(C,m(O))<=-1:(V=[c,S,w],h||(V=[V,"or",[c,"=",null]])),a=[V,"or",a]}}),a}_generateFilterByKey(e,t){const n=this._dataSource.key();let i=[];if(t||(t="="),Array.isArray(n))for(let o=0;o<n.length;++o){const s=e[n[o]];s&&(i.length>0&&i.push("and"),i.push([n[o],t,s]))}else i=[n,t,e];return i}_getLastItemIndex(){return this.items(!0).length-1}},H_=r=>class extends r{_deleteRowCore(e){const t=super._deleteRowCore.apply(this,arguments),n=this._dataController.getKeyByRowIndex(e);t.done(()=>{const i=this._dataController.getRowIndexByKey(n),o=this._dataController.getVisibleRows();i===-1&&!o.length&&this._focusController._resetFocusedRow()})}},z_=r=>class extends r{_createRow(e){const t=super._createRow.apply(this,arguments);return this.option("focusedRowEnabled")&&e&&this._focusController.isRowFocused(e.key)&&t.addClass("dx-row-focused"),t}_checkRowKeys(e){if(super._checkRowKeys.apply(this,arguments),this.option("focusedRowEnabled")&&this.option("dataSource")){const t=this._dataController.store();t&&!t.key()&&this._dataController.fireError("E1042","Row focusing")}}_update(e){e.changeType==="updateFocusedRow"?this.option("focusedRowEnabled")&&this._focusController.updateFocusedRow(e):super._update(e)}updateFocusElementTabIndex(e,t){this.option("focusedRowEnabled")?this._setFocusedRowElementTabIndex(t):super.updateFocusElementTabIndex(e)}_setFocusedRowElementTabIndex(e){const t=this.option("focusedRowKey"),n=this.option("tabIndex")??0,i=this._columnsController;let o=this._dataController.getRowIndexByKey(t),s=this.option("focusedColumnIndex");const l=this._findRowElementForTabIndex(),a=this._dataController.dataSource(),d=a==null?void 0:a.operationTypes(),u=!d||d.paging;f(this._scrollToFocusOnResize)||(this._scrollToFocusOnResize=()=>{this.scrollToElementVertically(this._findRowElementForTabIndex()),this.resizeCompleted.remove(this._scrollToFocusOnResize)}),l.attr("tabIndex",n);const c=this.option("focusedRowIndex")-this._dataController.getRowIndexOffset(!0);!u&&o<0&&c>=0&&this._focusController.updateFocusedRow({focusedRowKey:t,preventScroll:e}),o>=0&&!e&&(s<0&&(s=0),o+=this._dataController.getRowIndexOffset(),s+=i.getColumnIndexOffset(),this._keyboardNavigationController.setFocusedCellPosition(o,s),this._focusController.isAutoNavigateToFocusedRow()&&!u&&!this._dataController.isPagingByRendering()&&(this.resizeCompleted.remove(this._scrollToFocusOnResize),this.resizeCompleted.add(this._scrollToFocusOnResize)))}_findRowElementForTabIndex(){const e=this.option("focusedRowKey"),t=this._dataController.getRowIndexByKey(e);return g(this.getRowElement(t>=0?t:0))}scrollToRowElement(e){const t=this._dataController.getRowIndexByKey(e),n=g(this.getRow(t));return this.scrollToElementVertically(n)}scrollToElementVertically(e){const t=this.getScrollable();if(t&&e.length){const n=t.getScrollElementPosition(e,"vertical");return this.scrollTopPosition(n)}return new E().resolve()}scrollTopPosition(e){const t=new E,n=this.getScrollable();if(n){const i=n.scrollTop(),o=()=>{n.off("scroll",o),t.resolve()};if(e!==i)return n.on("scroll",o),this._dataController.resetFilterApplying(),n.scrollTo({top:e}),t.promise()}return t.resolve()}},Tn={defaultOptions:()=>({focusedRowEnabled:!1,autoNavigateToFocusedRow:!0,focusedRowKey:null,focusedRowIndex:-1,focusedColumnIndex:-1}),controllers:{focus:k_},extenders:{controllers:{keyboardNavigation:B_,editorFactory:M_,columns:N_,data:L_,editing:H_},views:{rowsView:z_}}},W_=Number.MAX_SAFE_INTEGER||9007199254740991,$_=r=>class extends Tn.extenders.controllers.data(r){changeRowExpand(e,t){return this.option("focusedRowEnabled")&&Array.isArray(e)&&this.isRowExpanded(e)&&(!t||!this._keyboardNavigationController.isKeyboardEnabled())&&this._isFocusedRowInsideGroup(e)&&this.option("focusedRowKey",e),super.changeRowExpand(e,t)}_isFocusedRowInsideGroup(e){const t=this.option("focusedRowKey"),n=this.getRowIndexByKey(t),i=n>=0&&this.getVisibleRows()[n],o=this._columnsController.getGroupDataSourceParameters(!0);if(i){for(let s=0;s<e.length;++s)if(ce(o[s]&&o[s].selector)(i.data)!==e[s])return!1}return!0}_getGroupPath(e,t){const n=[];let i=[e];for(;i&&i[0]&&t;){const o=i[0];o.key!==void 0&&n.push(o.key),i=o.items,t--}return n}_expandGroupByPath(e,t,n){const i=new E;return n++,e.expandRow(t.slice(0,n)).done(()=>{n===t.length?i.resolve():e._expandGroupByPath(e,t,n).done(i.resolve).fail(i.reject)}).fail(i.reject),i.promise()}_calculateGlobalRowIndexByGroupedData(e){const t=this,n=t._dataSource,i=t._generateFilterByKey(e),o=new E,s=Array.isArray(e),l=n.group();return s?o.resolve(-1).promise():n._grouping._updatePagingOptions?(n.load({filter:t._concatWithCombinedFilter(i),group:l}).done(a=>{if(!a||a.length===0||!f(a[0].key)||a[0].key===-1)return o.resolve(-1).promise();const d=t._getGroupPath(a[0],l.length);t._expandGroupByPath(t,d,0).done(()=>{t._calculateExpandedRowGlobalIndex(o,e,d,l)}).fail(o.reject)}).fail(o.reject),o.promise()):(t._calculateGlobalRowIndexByFlatData(e,null,!0).done(o.resolve).fail(o.reject),o)}_calculateExpandedRowGlobalIndex(e,t,n,i){const o=nt(n,{group:i}),s=this._dataSource,l=this.option("scrolling.mode"),a=l==="virtual"||l==="infinite",d=s.pageSize();let u;s._grouping._updatePagingOptions({skip:0,take:W_},(c,h)=>{G(c.path,n)&&(u=h)}),this._calculateGlobalRowIndexByFlatData(t,o).done(c=>{let h,p;if(c<0){e.resolve(-1);return}h=(u%d||d)+c-n.length,a?p=0:p=Math.floor(h/(d-n.length))*n.length,h=u+c+p,e.resolve(h)}).fail(e.reject)}};T.registerModule("focus",A({},Tn,{extenders:A({},Tn.extenders,{controllers:A({},Tn.extenders.controllers,{data:$_})})}));const G_={dragCell:"dx-drag-cell"},Je={cellFocusDisabled:"dx-cell-focus-disabled",handleIcon:"drag-icon",commandDrag:"dx-command-drag",sortableWithoutHandle:"dx-sortable-without-handle",rowsView:"rowsview",dragView:"dragview"},K_=r=>(e,t)=>{const n=g(e);if(t.rowType==="data")return n.addClass(Je.cellFocusDisabled),g("<span>").addClass(r(Je.handleIcon));v.setEmptyText(n)},U_={createHandleTemplateFunc:K_},j_=r=>class extends r{init(){super.init.apply(this,arguments),this._updateHandleColumn()}optionChanged(e){e.name==="rowDragging"&&(this._updateHandleColumn(),this._invalidate(!0,!0),e.handled=!0),super.optionChanged.apply(this,arguments)}_allowReordering(){const e=this.option("rowDragging");return!!(e&&(e.allowReordering||e.allowDropInsideItem||e.group))}_updateHandleColumn(){const e=this.option("rowDragging"),t=this._allowReordering(),n=this._columnsController,i=t&&e.showDragIcons;n==null||n.addCommandColumn({type:"drag",command:"drag",visibleIndex:-2,alignment:"center",elementAttr:[{name:G_.dragCell,value:""}],cssClass:Je.commandDrag,width:"auto",cellTemplate:this._getHandleTemplate(),visible:i}),n==null||n.columnOption("type:drag","visible",i)}_renderContent(){const e=this.option("rowDragging"),t=this._allowReordering(),n=super._renderContent.apply(this,arguments),i=this._isFixedTableRendering,o=i?"_sortableFixed":"_sortable",s=i?"_sortable":"_sortableFixed",l=u=>{var c;(c=this._sortableFixed)===null||c===void 0||c.$element().css("pointerEvents",u?"auto":"")},a=".dx-row:not(.dx-freespace-row):not(.dx-virtual-row):not(.dx-header-row):not(.dx-footer-row)",d=this.option("dataRowTemplate")?`> table > tbody${a}`:`> table > tbody > ${a}`;return(t||this[o])&&n.length&&(this[o]=this._createComponent(n,Zd,y({component:this.component,contentTemplate:null,filter:d,cursorOffset:u=>{const{event:c}=u,h=g(this.element()).offset();return{x:c.pageX-h.left}},onDraggableElementShown:u=>{if(e.dragTemplate)return;const h=g(u.dragElement).children(".dx-widget").data(this.component.NAME);this._synchronizeScrollLeftPosition(h)},dragTemplate:this._getDraggableRowTemplate(),handle:e.showDragIcons&&`.${Je.commandDrag}`,dropFeedbackMode:"indicate"},e,{onDragStart:u=>{var c,h;(c=this.getController("keyboardNavigation"))===null||c===void 0||c._resetFocusedCell();const p=u.component.getVisibleRows()[u.fromIndex];u.itemData=p&&p.data;const m=p&&p.rowType==="data";u.cancel=!t||!m,(h=e.onDragStart)===null||h===void 0||h.call(e,u)},onDragEnter:u=>{u.fromComponent!==u.toComponent&&l(!0)},onDragLeave:()=>{l(!1)},onDragEnd:u=>{var c;l(!1),(c=e.onDragEnd)===null||c===void 0||c.call(e,u)},onAdd:u=>{var c;l(!1),(c=e.onAdd)===null||c===void 0||c.call(e,u)},dropFeedbackMode:e.dropFeedbackMode,onOptionChanged:u=>{this._sortableFixed&&(u.name==="fromIndex"||u.name==="toIndex")&&this[s].option(u.name,u.value)}})),n.toggleClass("dx-scrollable-container",i),n.toggleClass(Je.sortableWithoutHandle,t&&!e.showDragIcons)),n}_renderCore(e){super._renderCore.apply(this,arguments),e&&e.changeType==="update"&&e.repaintChangesOnly&&v.isVirtualRowRendering(this)&&_e(()=>{this._updateSortable()})}_updateSortable(){const e=this._dataController.getRowIndexOffset(),t=e-this._previousOffset;[this._sortable,this._sortableFixed].forEach(n=>{const i=n==null?void 0:n.option("toIndex");f(i)&&f(this._previousOffset)&&(n==null||n.option("toIndex",i-t)),n==null||n.option("offset",e),n==null||n.update()}),this._previousOffset=e}_resizeCore(){super._resizeCore.apply(this,arguments),this._updateSortable()}_getDraggableGridOptions(e){const t=this.option(),n=this.getColumns(),i=g(this.getRowElement(e.rowIndex));return{dataSource:[{id:1,parentId:0}],showBorders:!0,showColumnHeaders:!1,scrolling:{useNative:!1,showScrollbar:"never"},pager:{visible:!1},loadingTimeout:null,columnFixing:t.columnFixing,columnAutoWidth:t.columnAutoWidth,showColumnLines:t.showColumnLines,columns:n.map(o=>({width:o.width||o.visibleWidth,fixed:o.fixed,fixedPosition:o.fixedPosition})),onRowPrepared:o=>{const s=o.component.getView("rowsView");g(o.rowElement).replaceWith(i.eq(s._isFixedTableRendering?1:0).clone())}}}_synchronizeScrollLeftPosition(e){const t=e==null?void 0:e.getScrollable();t==null||t.scrollTo({x:this._scrollLeft})}_getDraggableRowTemplate(){return e=>{const t=this.component.$element(),n=g("<div>");Un(n,K(t));const i=this._dataController.items(),o=i&&i[e.fromIndex],s=this._getDraggableGridOptions(o);return this._createComponent(n,this.component.NAME,s),n.find(".dx-gridbase-container").children(`:not(.${this.addWidgetPrefix(Je.rowsView)})`).hide(),n.addClass(this.addWidgetPrefix(Je.dragView)),n}}_getHandleTemplate(){return U_.createHandleTemplateFunc(e=>this.addWidgetPrefix(e))}},q_={defaultOptions:()=>({rowDragging:{showDragIcons:!0,dropFeedbackMode:"indicate",allowReordering:!1,allowDropInsideItem:!1}}),extenders:{views:{rowsView:j_}}};T.registerModule("rowDragging",q_);/*!
 * devextreme-react
 * Version: 24.2.3
 * Build date: Fri Dec 06 2024
 *
 * Copyright (c) 2012 - 2024 Developer Express Inc. ALL RIGHTS RESERVED
 *
 * This software may be modified and distributed under the terms
 * of the MIT license. See the LICENSE file in the root of the project for details.
 *
 * https://github.com/DevExpress/devextreme-react
 */const kx=I.memo(I.forwardRef((r,e)=>{const t=I.useRef(null);I.useImperativeHandle(e,()=>({instance(){var a;return(a=t.current)==null?void 0:a.getInstance()}}),[t.current]);const n=I.useMemo(()=>["columns","editing","editing.changes","editing.editColumnName","editing.editRowKey","filterPanel","filterPanel.filterEnabled","filterValue","focusedColumnIndex","focusedRowIndex","focusedRowKey","groupPanel","groupPanel.visible","paging","paging.pageIndex","paging.pageSize","searchPanel","searchPanel.text","selectedRowKeys","selectionFilter"],[]),i=I.useMemo(()=>["onAdaptiveDetailRowPreparing","onCellClick","onCellDblClick","onCellPrepared","onContentReady","onContextMenuPreparing","onDataErrorOccurred","onDisposing","onEditCanceled","onEditCanceling","onEditingStart","onEditorPrepared","onEditorPreparing","onExporting","onFocusedCellChanging","onFocusedRowChanging","onInitialized","onInitNewRow","onKeyDown","onRowClick","onRowCollapsed","onRowCollapsing","onRowDblClick","onRowExpanded","onRowExpanding","onRowInserted","onRowInserting","onRowPrepared","onRowRemoved","onRowRemoving","onRowUpdated","onRowUpdating","onRowValidating","onSaved","onSaving","onToolbarPreparing"],[]),o=I.useMemo(()=>({defaultColumns:"columns",defaultEditing:"editing",defaultFilterPanel:"filterPanel",defaultFilterValue:"filterValue",defaultFocusedColumnIndex:"focusedColumnIndex",defaultFocusedRowIndex:"focusedRowIndex",defaultFocusedRowKey:"focusedRowKey",defaultGroupPanel:"groupPanel",defaultPaging:"paging",defaultSearchPanel:"searchPanel",defaultSelectedRowKeys:"selectedRowKeys",defaultSelectionFilter:"selectionFilter"}),[]),s=I.useMemo(()=>({column:{optionName:"columns",isCollectionItem:!0},columnChooser:{optionName:"columnChooser",isCollectionItem:!1},columnFixing:{optionName:"columnFixing",isCollectionItem:!1},dataGridHeaderFilter:{optionName:"headerFilter",isCollectionItem:!1},dataGridSelection:{optionName:"selection",isCollectionItem:!1},editing:{optionName:"editing",isCollectionItem:!1},export:{optionName:"export",isCollectionItem:!1},filterBuilder:{optionName:"filterBuilder",isCollectionItem:!1},filterBuilderPopup:{optionName:"filterBuilderPopup",isCollectionItem:!1},filterPanel:{optionName:"filterPanel",isCollectionItem:!1},filterRow:{optionName:"filterRow",isCollectionItem:!1},grouping:{optionName:"grouping",isCollectionItem:!1},groupPanel:{optionName:"groupPanel",isCollectionItem:!1},headerFilter:{optionName:"headerFilter",isCollectionItem:!1},keyboardNavigation:{optionName:"keyboardNavigation",isCollectionItem:!1},loadPanel:{optionName:"loadPanel",isCollectionItem:!1},masterDetail:{optionName:"masterDetail",isCollectionItem:!1},pager:{optionName:"pager",isCollectionItem:!1},paging:{optionName:"paging",isCollectionItem:!1},remoteOperations:{optionName:"remoteOperations",isCollectionItem:!1},rowDragging:{optionName:"rowDragging",isCollectionItem:!1},scrolling:{optionName:"scrolling",isCollectionItem:!1},searchPanel:{optionName:"searchPanel",isCollectionItem:!1},selection:{optionName:"selection",isCollectionItem:!1},sortByGroupSummaryInfo:{optionName:"sortByGroupSummaryInfo",isCollectionItem:!0},sorting:{optionName:"sorting",isCollectionItem:!1},stateStoring:{optionName:"stateStoring",isCollectionItem:!1},summary:{optionName:"summary",isCollectionItem:!1},toolbar:{optionName:"toolbar",isCollectionItem:!1}}),[]),l=I.useMemo(()=>[{tmplOption:"dataRowTemplate",render:"dataRowRender",component:"dataRowComponent"},{tmplOption:"rowTemplate",render:"rowRender",component:"rowComponent"}],[]);return I.createElement(eu,{WidgetClass:xl,ref:t,useRequestAnimationFrameFlag:!0,subscribableOptions:n,independentEvents:i,defaults:o,expectedChildren:s,templateProps:l,...r})})),X_=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"animation",ExpectedChildren:{hide:{optionName:"hide",isCollectionItem:!1},show:{optionName:"show",isCollectionItem:!1}}}});Object.assign(X_,{componentType:"option"});const Y_=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"validationRules",IsCollectionItem:!0,PredefinedProps:{type:"async"}}});Object.assign(Y_,{componentType:"option"});const Q_=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"at"}});Object.assign(Q_,{componentType:"option"});const J_=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"boundaryOffset"}});Object.assign(J_,{componentType:"option"});const Z_=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"buttons",IsCollectionItem:!0,TemplateProps:[{tmplOption:"template",render:"render",component:"component"}]}}),Bx=Object.assign(Z_,{componentType:"option"}),ew=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"changes",IsCollectionItem:!0}});Object.assign(ew,{componentType:"option"});const tw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"colCountByScreen"}});Object.assign(tw,{componentType:"option"});const nw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"collision"}});Object.assign(nw,{componentType:"option"});const iw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"columns",IsCollectionItem:!0,DefaultsProps:{defaultFilterValue:"filterValue",defaultFilterValues:"filterValues",defaultGroupIndex:"groupIndex",defaultSelectedFilterOperation:"selectedFilterOperation",defaultSortIndex:"sortIndex",defaultSortOrder:"sortOrder",defaultVisible:"visible",defaultVisibleIndex:"visibleIndex"},ExpectedChildren:{AsyncRule:{optionName:"validationRules",isCollectionItem:!0},button:{optionName:"buttons",isCollectionItem:!0},columnHeaderFilter:{optionName:"headerFilter",isCollectionItem:!1},columnLookup:{optionName:"lookup",isCollectionItem:!1},CompareRule:{optionName:"validationRules",isCollectionItem:!0},CustomRule:{optionName:"validationRules",isCollectionItem:!0},EmailRule:{optionName:"validationRules",isCollectionItem:!0},format:{optionName:"format",isCollectionItem:!1},formItem:{optionName:"formItem",isCollectionItem:!1},headerFilter:{optionName:"headerFilter",isCollectionItem:!1},lookup:{optionName:"lookup",isCollectionItem:!1},NumericRule:{optionName:"validationRules",isCollectionItem:!0},PatternRule:{optionName:"validationRules",isCollectionItem:!0},RangeRule:{optionName:"validationRules",isCollectionItem:!0},RequiredRule:{optionName:"validationRules",isCollectionItem:!0},StringLengthRule:{optionName:"validationRules",isCollectionItem:!0},validationRule:{optionName:"validationRules",isCollectionItem:!0}},TemplateProps:[{tmplOption:"cellTemplate",render:"cellRender",component:"cellComponent"},{tmplOption:"editCellTemplate",render:"editCellRender",component:"editCellComponent"},{tmplOption:"groupCellTemplate",render:"groupCellRender",component:"groupCellComponent"},{tmplOption:"headerCellTemplate",render:"headerCellRender",component:"headerCellComponent"}]}}),Mx=Object.assign(iw,{componentType:"option"}),ow=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"columnChooser",ExpectedChildren:{columnChooserSearch:{optionName:"search",isCollectionItem:!1},columnChooserSelection:{optionName:"selection",isCollectionItem:!1},position:{optionName:"position",isCollectionItem:!1},search:{optionName:"search",isCollectionItem:!1},selection:{optionName:"selection",isCollectionItem:!1}}}});Object.assign(ow,{componentType:"option"});const sw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"search"}});Object.assign(sw,{componentType:"option"});const rw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"selection"}});Object.assign(rw,{componentType:"option"});const lw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"columnFixing",ExpectedChildren:{columnFixingTexts:{optionName:"texts",isCollectionItem:!1},icons:{optionName:"icons",isCollectionItem:!1},texts:{optionName:"texts",isCollectionItem:!1}}}});Object.assign(lw,{componentType:"option"});const aw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"texts"}});Object.assign(aw,{componentType:"option"});const dw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"headerFilter",ExpectedChildren:{columnHeaderFilterSearch:{optionName:"search",isCollectionItem:!1},search:{optionName:"search",isCollectionItem:!1}}}});Object.assign(dw,{componentType:"option"});const uw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"search"}});Object.assign(uw,{componentType:"option"});const cw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"lookup"}});Object.assign(cw,{componentType:"option"});const hw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"validationRules",IsCollectionItem:!0,PredefinedProps:{type:"compare"}}});Object.assign(hw,{componentType:"option"});const pw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"cursorOffset"}});Object.assign(pw,{componentType:"option"});const gw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"customOperations",IsCollectionItem:!0,TemplateProps:[{tmplOption:"editorTemplate",render:"editorRender",component:"editorComponent"}]}});Object.assign(gw,{componentType:"option"});const mw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"validationRules",IsCollectionItem:!0,PredefinedProps:{type:"custom"}}});Object.assign(mw,{componentType:"option"});const fw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"headerFilter",ExpectedChildren:{dataGridHeaderFilterSearch:{optionName:"search",isCollectionItem:!1},dataGridHeaderFilterTexts:{optionName:"texts",isCollectionItem:!1},search:{optionName:"search",isCollectionItem:!1},texts:{optionName:"texts",isCollectionItem:!1}}}});Object.assign(fw,{componentType:"option"});const Cw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"search"}});Object.assign(Cw,{componentType:"option"});const _w=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"texts"}});Object.assign(_w,{componentType:"option"});const ww=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"selection"}});Object.assign(ww,{componentType:"option"});const xw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"editing",DefaultsProps:{defaultChanges:"changes",defaultEditColumnName:"editColumnName",defaultEditRowKey:"editRowKey"},ExpectedChildren:{change:{optionName:"changes",isCollectionItem:!0},editingTexts:{optionName:"texts",isCollectionItem:!1},form:{optionName:"form",isCollectionItem:!1},popup:{optionName:"popup",isCollectionItem:!1},texts:{optionName:"texts",isCollectionItem:!1}}}}),Nx=Object.assign(xw,{componentType:"option"}),vw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"texts"}});Object.assign(vw,{componentType:"option"});const yw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"validationRules",IsCollectionItem:!0,PredefinedProps:{type:"email"}}});Object.assign(yw,{componentType:"option"});const bw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"export",ExpectedChildren:{exportTexts:{optionName:"texts",isCollectionItem:!1},texts:{optionName:"texts",isCollectionItem:!1}}}}),Lx=Object.assign(bw,{componentType:"option"}),Iw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"texts"}});Object.assign(Iw,{componentType:"option"});const Ew=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"fields",IsCollectionItem:!0,ExpectedChildren:{fieldLookup:{optionName:"lookup",isCollectionItem:!1},format:{optionName:"format",isCollectionItem:!1},lookup:{optionName:"lookup",isCollectionItem:!1}},TemplateProps:[{tmplOption:"editorTemplate",render:"editorRender",component:"editorComponent"}]}});Object.assign(Ew,{componentType:"option"});const Sw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"lookup"}});Object.assign(Sw,{componentType:"option"});const Rw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"filterBuilder",DefaultsProps:{defaultValue:"value"},ExpectedChildren:{customOperation:{optionName:"customOperations",isCollectionItem:!0},field:{optionName:"fields",isCollectionItem:!0},filterOperationDescriptions:{optionName:"filterOperationDescriptions",isCollectionItem:!1},groupOperationDescriptions:{optionName:"groupOperationDescriptions",isCollectionItem:!1}}}});Object.assign(Rw,{componentType:"option"});const Tw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"filterBuilderPopup",DefaultsProps:{defaultHeight:"height",defaultPosition:"position",defaultVisible:"visible",defaultWidth:"width"},TemplateProps:[{tmplOption:"contentTemplate",render:"contentRender",component:"contentComponent"},{tmplOption:"titleTemplate",render:"titleRender",component:"titleComponent"}]}});Object.assign(Tw,{componentType:"option"});const Vw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"filterOperationDescriptions"}});Object.assign(Vw,{componentType:"option"});const Fw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"filterPanel",DefaultsProps:{defaultFilterEnabled:"filterEnabled"},ExpectedChildren:{filterPanelTexts:{optionName:"texts",isCollectionItem:!1},texts:{optionName:"texts",isCollectionItem:!1}}}});Object.assign(Fw,{componentType:"option"});const Ow=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"texts"}});Object.assign(Ow,{componentType:"option"});const Dw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"filterRow",ExpectedChildren:{operationDescriptions:{optionName:"operationDescriptions",isCollectionItem:!1}}}}),Hx=Object.assign(Dw,{componentType:"option"}),Pw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"form",DefaultsProps:{defaultFormData:"formData"},ExpectedChildren:{colCountByScreen:{optionName:"colCountByScreen",isCollectionItem:!1}}}});Object.assign(Pw,{componentType:"option"});const Aw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"format"}});Object.assign(Aw,{componentType:"option"});const kw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"formItem",ExpectedChildren:{AsyncRule:{optionName:"validationRules",isCollectionItem:!0},CompareRule:{optionName:"validationRules",isCollectionItem:!0},CustomRule:{optionName:"validationRules",isCollectionItem:!0},EmailRule:{optionName:"validationRules",isCollectionItem:!0},label:{optionName:"label",isCollectionItem:!1},NumericRule:{optionName:"validationRules",isCollectionItem:!0},PatternRule:{optionName:"validationRules",isCollectionItem:!0},RangeRule:{optionName:"validationRules",isCollectionItem:!0},RequiredRule:{optionName:"validationRules",isCollectionItem:!0},StringLengthRule:{optionName:"validationRules",isCollectionItem:!0},validationRule:{optionName:"validationRules",isCollectionItem:!0}},TemplateProps:[{tmplOption:"template",render:"render",component:"component"}]}});Object.assign(kw,{componentType:"option"});const Bw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"from",ExpectedChildren:{position:{optionName:"position",isCollectionItem:!1}}}});Object.assign(Bw,{componentType:"option"});const Mw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"grouping",ExpectedChildren:{groupingTexts:{optionName:"texts",isCollectionItem:!1},texts:{optionName:"texts",isCollectionItem:!1}}}});Object.assign(Mw,{componentType:"option"});const Nw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"texts"}});Object.assign(Nw,{componentType:"option"});const Lw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"groupItems",IsCollectionItem:!0,ExpectedChildren:{valueFormat:{optionName:"valueFormat",isCollectionItem:!1}}}});Object.assign(Lw,{componentType:"option"});const Hw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"groupOperationDescriptions"}});Object.assign(Hw,{componentType:"option"});const zw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"groupPanel",DefaultsProps:{defaultVisible:"visible"}}});Object.assign(zw,{componentType:"option"});const Ww=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"headerFilter",ExpectedChildren:{columnHeaderFilterSearch:{optionName:"search",isCollectionItem:!1},dataGridHeaderFilterSearch:{optionName:"search",isCollectionItem:!1},dataGridHeaderFilterTexts:{optionName:"texts",isCollectionItem:!1}}}});Object.assign(Ww,{componentType:"option"});const $w=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"hide",ExpectedChildren:{from:{optionName:"from",isCollectionItem:!1},to:{optionName:"to",isCollectionItem:!1}}}});Object.assign($w,{componentType:"option"});const Gw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"icons"}});Object.assign(Gw,{componentType:"option"});const Kw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"items",IsCollectionItem:!0,TemplateProps:[{tmplOption:"menuItemTemplate",render:"menuItemRender",component:"menuItemComponent"},{tmplOption:"template",render:"render",component:"component"}]}}),zx=Object.assign(Kw,{componentType:"option"}),Uw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"keyboardNavigation"}});Object.assign(Uw,{componentType:"option"});const jw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"label",TemplateProps:[{tmplOption:"template",render:"render",component:"component"}]}});Object.assign(jw,{componentType:"option"});const qw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"loadPanel"}});Object.assign(qw,{componentType:"option"});const Xw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"lookup"}}),Wx=Object.assign(Xw,{componentType:"option"}),Yw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"masterDetail",TemplateProps:[{tmplOption:"template",render:"render",component:"component"}]}});Object.assign(Yw,{componentType:"option"});const Qw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"my"}});Object.assign(Qw,{componentType:"option"});const Jw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"validationRules",IsCollectionItem:!0,PredefinedProps:{type:"numeric"}}});Object.assign(Jw,{componentType:"option"});const Zw=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"offset"}});Object.assign(Zw,{componentType:"option"});const ex=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"operationDescriptions"}});Object.assign(ex,{componentType:"option"});const tx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"pager"}});Object.assign(tx,{componentType:"option"});const nx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"paging",DefaultsProps:{defaultPageIndex:"pageIndex",defaultPageSize:"pageSize"}}});Object.assign(nx,{componentType:"option"});const ix=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"validationRules",IsCollectionItem:!0,PredefinedProps:{type:"pattern"}}});Object.assign(ix,{componentType:"option"});const ox=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"popup",DefaultsProps:{defaultHeight:"height",defaultPosition:"position",defaultVisible:"visible",defaultWidth:"width"},ExpectedChildren:{animation:{optionName:"animation",isCollectionItem:!1},position:{optionName:"position",isCollectionItem:!1},toolbarItem:{optionName:"toolbarItems",isCollectionItem:!0}},TemplateProps:[{tmplOption:"contentTemplate",render:"contentRender",component:"contentComponent"},{tmplOption:"titleTemplate",render:"titleRender",component:"titleComponent"}]}}),$x=Object.assign(ox,{componentType:"option"}),sx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"position"}});Object.assign(sx,{componentType:"option"});const rx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"validationRules",IsCollectionItem:!0,PredefinedProps:{type:"range"}}});Object.assign(rx,{componentType:"option"});const lx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"remoteOperations"}});Object.assign(lx,{componentType:"option"});const ax=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"validationRules",IsCollectionItem:!0,PredefinedProps:{type:"required"}}});Object.assign(ax,{componentType:"option"});const dx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"rowDragging",ExpectedChildren:{cursorOffset:{optionName:"cursorOffset",isCollectionItem:!1}},TemplateProps:[{tmplOption:"dragTemplate",render:"dragRender",component:"dragComponent"}]}});Object.assign(dx,{componentType:"option"});const ux=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"scrolling"}});Object.assign(ux,{componentType:"option"});const cx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"search"}});Object.assign(cx,{componentType:"option"});const hx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"searchPanel",DefaultsProps:{defaultText:"text"}}});Object.assign(hx,{componentType:"option"});const px=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"selection"}});Object.assign(px,{componentType:"option"});const gx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"show"}});Object.assign(gx,{componentType:"option"});const mx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"sortByGroupSummaryInfo",IsCollectionItem:!0}});Object.assign(mx,{componentType:"option"});const fx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"sorting"}});Object.assign(fx,{componentType:"option"});const Cx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"stateStoring"}});Object.assign(Cx,{componentType:"option"});const _x=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"validationRules",IsCollectionItem:!0,PredefinedProps:{type:"stringLength"}}});Object.assign(_x,{componentType:"option"});const wx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"summary",ExpectedChildren:{groupItem:{optionName:"groupItems",isCollectionItem:!0},summaryTexts:{optionName:"texts",isCollectionItem:!1},texts:{optionName:"texts",isCollectionItem:!1},totalItem:{optionName:"totalItems",isCollectionItem:!0}}}});Object.assign(wx,{componentType:"option"});const xx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"texts"}});Object.assign(xx,{componentType:"option"});const vx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"texts"}});Object.assign(vx,{componentType:"option"});const yx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"to"}});Object.assign(yx,{componentType:"option"});const bx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"toolbar",ExpectedChildren:{item:{optionName:"items",isCollectionItem:!0}}}}),Gx=Object.assign(bx,{componentType:"option"}),Ix=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"toolbarItems",IsCollectionItem:!0,TemplateProps:[{tmplOption:"menuItemTemplate",render:"menuItemRender",component:"menuItemComponent"},{tmplOption:"template",render:"render",component:"component"}]}}),Kx=Object.assign(Ix,{componentType:"option"}),Ex=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"totalItems",IsCollectionItem:!0,ExpectedChildren:{valueFormat:{optionName:"valueFormat",isCollectionItem:!1}}}});Object.assign(Ex,{componentType:"option"});const Sx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"validationRules",IsCollectionItem:!0,PredefinedProps:{type:"required"}}});Object.assign(Sx,{componentType:"option"});const Rx=r=>I.createElement(R,{...r,elementDescriptor:{OptionName:"valueFormat"}});Object.assign(Rx,{componentType:"option"});export{Bx as B,Mx as C,kx as D,Nx as E,Hx as F,zx as I,Wx as L,$x as P,Kx as T,Gx as a,Lx as b};
