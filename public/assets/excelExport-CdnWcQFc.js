import{e as u}from"./exceljs.min-PHSjMNuq.js";import{E as s,M as d,s as f}from"./export_merged_ranges_manager-BevM5aOS.js";import{i as o,y as l,O as c}from"./index-n7jYywel.js";import"./m_export-DV8LyD9i.js";class m{constructor(e,r,i,a){this.component=e,this.dataProvider=r,this.worksheet=i,this.mergedRangesManager=new d(r,i),this.topLeftCell=a.topLeftCell,this.customizeCell=a.customizeCell,this.autoFilterEnabled=a.autoFilterEnabled}_getFirstColumnIndex(){return this.topLeftCell.column}_getFieldHeaderRowsCount(){return 0}_trySetAutoFilter(e){if(this.autoFilterEnabled&&!o(this.worksheet.autoFilter)&&this.dataProvider.getRowsCount()>0){const r={from:{row:e.from.row+this.dataProvider.getHeaderRowCount()-1,column:e.from.column},to:e.to};this.worksheet.autoFilter=r}}_trySetFont(e,r){o(r)&&(e.font=e.font||{},e.font.bold=r)}_getWorksheetFrozenState(e){return{state:"frozen",ySplit:e.from.row+this.dataProvider.getFrozenArea().y-1}}_trySetOutlineLevel(e,r){r>=this.dataProvider.getHeaderRowCount()&&(e.outlineLevel=this.dataProvider.getGroupLevel(r))}_isFrozenZone(e){return e.getHeaderRowCount()>0}_isHeaderCell(e){return e<this.dataProvider.getHeaderRowCount()}_isInfoCell(){return!1}_allowToMergeRange(){return!0}_getAllFieldHeaders(){return[]}_customizeCell(e,r){c(this.customizeCell)&&this.customizeCell({excelCell:e,gridCell:r})}_exportFieldHeaders(){}_exportAllFieldHeaders(){}_isRowFieldHeadersRow(){}}function h(t){return s.export(w(t),m,g,C)}function w(t){if(!(o(t)&&l(t)))throw Error('The "exportDataGrid" method requires a configuration object.');if(!(o(t.component)&&l(t.component)&&t.component.NAME==="dxDataGrid"))throw Error('The "component" field must contain a DataGrid instance.');return o(t.selectedRowsOnly)||(t.selectedRowsOnly=!1),o(t.autoFilterEnabled)||(t.autoFilterEnabled=!1),s.getFullOptions(t)}function g(t){return t.getView("rowsView").element()}function C(t){return t.getView("rowsView").element().parent()}async function E(t,e="DataGrid.xlsx"){const r=new u.Workbook,i=r.addWorksheet("Main sheet");await h({component:t,worksheet:i,customizeCell:function(n){n.excelCell.font={name:"Arial",size:12},n.excelCell.alignment={horizontal:"left"}}});const a=await r.xlsx.writeBuffer();f(new Blob([a],{type:"application/octet-stream"}),e)}export{E as e};
