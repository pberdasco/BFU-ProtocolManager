import{r as c,j as s}from"./index-n7jYywel.js";import{G as m}from"./GenericGrid-CFcR16Uf.js";import{u as g}from"./compuestos-BCgBe3hm.js";import{u as f}from"./matrices-DZTbWwKF.js";import{u as C}from"./useQuery-ZPMZsnsY.js";import{a as x}from"./apiResource-CLOj6waL.js";import"./data-grid-CgvYN-1L.js";import"./m_export-DV8LyD9i.js";import"./localization-D3bklY4G.js";import"./excelExport-CdnWcQFc.js";import"./exceljs.min-PHSjMNuq.js";import"./export_merged_ranges_manager-BevM5aOS.js";const b=async()=>(await new x("grupoCompuestos").fetch({sort:[{selector:"nombre",desc:!1}]})).data,E=()=>{const{data:t=[],isLoading:e,error:r,...i}=C({queryKey:["grupoCompuestos"],queryFn:b});return{grupoCompuestos:t,isLoadingGrupoCompuestos:e,errorGrupoCompuestos:r,...i}},y=(t,e)=>t?e.filter(r=>r.matrizCodigo===t):[],F=(t,e)=>t?e.filter(r=>r.matrizCodigo===t):[];function M(){const{matrices:t}=f(),{compuestos:e}=g(),{grupoCompuestos:r}=E(),i=c.useCallback(o=>{o.parentType==="dataRow"&&o.dataField==="matrizCodigo"&&!o.row.data.matrizCodigo&&t.length>0&&o.setValue(t[0].codigo),o.parentType==="dataRow"&&o.dataField==="compuestoId"&&(o.editorOptions.dataSource=y(o.row.data.matrizCodigo,e),o.editorOptions.disabled=!o.row.data.matrizCodigo),o.parentType==="dataRow"&&o.dataField==="grupoId"&&(o.editorOptions.dataSource=F(o.row.data.matrizCodigo,r),o.editorOptions.disabled=!o.row.data.matrizCodigo)},[t,e,r]),p=[{dataField:"id",width:90,caption:"ID",allowFiltering:!1,allowSearch:!1},{dataField:"matrizCodigo",visible:!1,lookup:{dataSource:t,valueExpr:"codigo",displayExpr:"nombre"},setCellValue:(o,a,l)=>{o.matrizCodigo=a,o.agrupaEn=null}},{dataField:"matrizGrupo",caption:"Matriz",width:150},{dataField:"grupoId",visible:!1,setCellValue:(o,a,l)=>{o.grupoId=a;const d=r.find(n=>n.id===a);d&&(o.metodo=d.metodo)},validationRules:[{type:"required",message:"El Grupo es obligatorio"}]},{dataField:"grupo",caption:"Grupo"},{dataField:"metodo",caption:"Metodo"},{dataField:"compuestoId",visible:!1,lookup:{dataSource:e,valueExpr:"id",displayExpr:"nombre"}},{dataField:"compuesto",caption:"Compuesto"}],u={colCount:8,items:[{dataField:"id",colSpan:1,editorOptions:{disabled:!0}},{dataField:"matrizCodigo",caption:"Matriz",colSpan:2,editorType:"dxSelectBox",editorOptions:{dataSource:t,displayExpr:"nombre",valueExpr:"codigo",searchEnabled:!0}},{dataField:"grupoId",colSpan:3,editorType:"dxSelectBox",editorOptions:{displayExpr:"nombre",valueExpr:"id",searchEnabled:!0}},{dataField:"metodo",colSpan:2,editorOptions:{disabled:!0}},{dataField:"compuestoId",colSpan:3,editorType:"dxSelectBox",editorOptions:{displayExpr:"nombre",valueExpr:"id",searchEnabled:!0}}]};return s.jsx("div",{children:s.jsx(m,{title:"Relacion Compuesto Grupo",resource:"relCompuestoGrupo",columns:p,keyExpr:"id",editable:!0,form:u,size:"mediumShort",onEditorPreparing:i})})}export{M as default};
