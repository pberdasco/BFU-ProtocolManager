import{aj as v,ak as B,cY as G,i as f,aA as N,y as x,o as M,aq as P,cZ as q,aJ as Z,K as W,a7 as K,m as T,c_ as Y,a3 as X,b8 as V,h as I}from"./index-CUZSR6jm.js";import{g as $}from"./m_export-CLlCNyBP.js";var A={exports:{}},J=A.exports,D;function Q(){return D||(D=1,function(t,e){(function(n,o){o()})(J,function(){function n(r,a){return typeof a>"u"?a={autoBom:!1}:typeof a!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob(["\uFEFF",r],{type:r.type}):r}function o(r,a,c){var s=new XMLHttpRequest;s.open("GET",r),s.responseType="blob",s.onload=function(){h(s.response,a,c)},s.onerror=function(){console.error("could not download file")},s.send()}function u(r){var a=new XMLHttpRequest;a.open("HEAD",r,!1);try{a.send()}catch{}return 200<=a.status&&299>=a.status}function i(r){try{r.dispatchEvent(new MouseEvent("click"))}catch{var a=document.createEvent("MouseEvents");a.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(a)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof v=="object"&&v.global===v?v:void 0,m=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),h=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!m?function(r,a,c){var s=l.URL||l.webkitURL,d=document.createElement("a");a=a||r.name||"download",d.download=a,d.rel="noopener",typeof r=="string"?(d.href=r,d.origin===location.origin?i(d):u(d.href)?o(r,a,c):i(d,d.target="_blank")):(d.href=s.createObjectURL(r),setTimeout(function(){s.revokeObjectURL(d.href)},4e4),setTimeout(function(){i(d)},0))}:"msSaveOrOpenBlob"in navigator?function(r,a,c){if(a=a||r.name||"download",typeof r!="string")navigator.msSaveOrOpenBlob(n(r,c),a);else if(u(r))o(r,a,c);else{var s=document.createElement("a");s.href=r,s.target="_blank",setTimeout(function(){i(s)})}}:function(r,a,c,s){if(s=s||open("","_blank"),s&&(s.document.title=s.document.body.innerText="downloading..."),typeof r=="string")return o(r,a,c);var d=r.type==="application/octet-stream",E=/constructor/i.test(l.HTMLElement)||l.safari,w=/CriOS\/[\d]+/.test(navigator.userAgent);if((w||d&&E||m)&&typeof FileReader<"u"){var y=new FileReader;y.onloadend=function(){var p=y.result;p=w?p:p.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=p:location=p,s=null},y.readAsDataURL(r)}else{var g=l.URL||l.webkitURL,R=g.createObjectURL(r);s?s.location=R:location.href=R,s=null,setTimeout(function(){g.revokeObjectURL(R)},4e4)}});l.saveAs=h.saveAs=h,t.exports=h})}(A)),A.exports}var ee=Q();const Re=B(ee),te={ar:1,bg:2,ca:3,"zh-Hans":4,cs:5,da:6,de:7,el:8,en:9,es:10,fi:11,fr:12,he:13,hu:14,is:15,it:16,ja:17,ko:18,nl:19,no:20,pl:21,pt:22,rm:23,ro:24,ru:25,hr:26,sk:27,sq:28,sv:29,th:30,tr:31,ur:32,id:33,uk:34,be:35,sl:36,et:37,lv:38,lt:39,tg:40,fa:41,vi:42,hy:43,az:44,eu:45,hsb:46,mk:47,tn:50,xh:52,zu:53,af:54,ka:55,fo:56,hi:57,mt:58,se:59,ga:60,ms:62,kk:63,ky:64,sw:65,tk:66,uz:67,tt:68,bn:69,pa:70,gu:71,or:72,ta:73,te:74,kn:75,ml:76,as:77,mr:78,sa:79,mn:80,bo:81,cy:82,km:83,lo:84,gl:86,kok:87,syr:90,si:91,iu:93,am:94,tzm:95,ne:97,fy:98,ps:99,fil:100,dv:101,ha:104,yo:106,quz:107,nso:108,ba:109,lb:110,kl:111,ig:112,ii:120,arn:122,moh:124,br:126,ug:128,mi:129,oc:130,co:131,gsw:132,sah:133,qut:134,rw:135,wo:136,prs:140,gd:145,"ar-SA":1025,"bg-BG":1026,"ca-ES":1027,"zh-TW":1028,"cs-CZ":1029,"da-DK":1030,"de-DE":1031,"el-GR":1032,"en-US":1033,"fi-FI":1035,"fr-FR":1036,"he-IL":1037,"hu-HU":1038,"is-IS":1039,"it-IT":1040,"ja-JP":1041,"ko-KR":1042,"nl-NL":1043,"nb-NO":1044,"pl-PL":1045,"pt-BR":1046,"rm-CH":1047,"ro-RO":1048,"ru-RU":1049,"hr-HR":1050,"sk-SK":1051,"sq-AL":1052,"sv-SE":1053,"th-TH":1054,"tr-TR":1055,"ur-PK":1056,"id-ID":1057,"uk-UA":1058,"be-BY":1059,"sl-SI":1060,"et-EE":1061,"lv-LV":1062,"lt-LT":1063,"tg-Cyrl-TJ":1064,"fa-IR":1065,"vi-VN":1066,"hy-AM":1067,"az-Latn-AZ":1068,"eu-ES":1069,"hsb-DE":1070,"mk-MK":1071,"tn-ZA":1074,"xh-ZA":1076,"zu-ZA":1077,"af-ZA":1078,"ka-GE":1079,"fo-FO":1080,"hi-IN":1081,"mt-MT":1082,"se-NO":1083,"ms-MY":1086,"kk-KZ":1087,"ky-KG":1088,"sw-KE":1089,"tk-TM":1090,"uz-Latn-UZ":1091,"tt-RU":1092,"bn-IN":1093,"pa-IN":1094,"gu-IN":1095,"or-IN":1096,"ta-IN":1097,"te-IN":1098,"kn-IN":1099,"ml-IN":1100,"as-IN":1101,"mr-IN":1102,"sa-IN":1103,"mn-MN":1104,"bo-CN":1105,"cy-GB":1106,"km-KH":1107,"lo-LA":1108,"gl-ES":1110,"kok-IN":1111,"syr-SY":1114,"si-LK":1115,"iu-Cans-CA":1117,"am-ET":1118,"ne-NP":1121,"fy-NL":1122,"ps-AF":1123,"fil-PH":1124,"dv-MV":1125,"ha-Latn-NG":1128,"yo-NG":1130,"quz-BO":1131,"nso-ZA":1132,"ba-RU":1133,"lb-LU":1134,"kl-GL":1135,"ig-NG":1136,"ii-CN":1144,"arn-CL":1146,"moh-CA":1148,"br-FR":1150,"ug-CN":1152,"mi-NZ":1153,"oc-FR":1154,"co-FR":1155,"gsw-FR":1156,"sah-RU":1157,"qut-GT":1158,"rw-RW":1159,"wo-SN":1160,"prs-AF":1164,"gd-GB":1169,"ar-IQ":2049,"zh-CN":2052,"de-CH":2055,"en-GB":2057,"es-MX":2058,"fr-BE":2060,"it-CH":2064,"nl-BE":2067,"nn-NO":2068,"pt-PT":2070,"sr-Latn-CS":2074,"sv-FI":2077,"az-Cyrl-AZ":2092,"dsb-DE":2094,"se-SE":2107,"ga-IE":2108,"ms-BN":2110,"uz-Cyrl-UZ":2115,"bn-BD":2117,"mn-Mong-CN":2128,"iu-Latn-CA":2141,"tzm-Latn-DZ":2143,"quz-EC":2155,"ar-EG":3073,"zh-HK":3076,"de-AT":3079,"en-AU":3081,"es-ES":3082,"fr-CA":3084,"sr-Cyrl-CS":3098,"se-FI":3131,"quz-PE":3179,"ar-LY":4097,"zh-SG":4100,"de-LU":4103,"en-CA":4105,"es-GT":4106,"fr-CH":4108,"hr-BA":4122,"smj-NO":4155,"ar-DZ":5121,"zh-MO":5124,"de-LI":5127,"en-NZ":5129,"es-CR":5130,"fr-LU":5132,"bs-Latn-BA":5146,"smj-SE":5179,"ar-MA":6145,"en-IE":6153,"es-PA":6154,"fr-MC":6156,"sr-Latn-BA":6170,"sma-NO":6203,"ar-TN":7169,"en-ZA":7177,"es-DO":7178,"sr-Cyrl-BA":7194,"sma-SE":7227,"ar-OM":8193,"en-JM":8201,"es-VE":8202,"bs-Cyrl-BA":8218,"sms-FI":8251,"ar-YE":9217,"en-029":9225,"es-CO":9226,"sr-Latn-RS":9242,"smn-FI":9275,"ar-SY":10241,"en-BZ":10249,"es-PE":10250,"sr-Cyrl-RS":10266,"ar-JO":11265,"en-TT":11273,"es-AR":11274,"sr-Latn-ME":11290,"ar-LB":12289,"en-ZW":12297,"es-EC":12298,"sr-Cyrl-ME":12314,"ar-KW":13313,"en-PH":13321,"es-CL":13322,"ar-AE":14337,"es-UY":14346,"ar-BH":15361,"es-PY":15370,"ar-QA":16385,"en-IN":16393,"es-BO":16394,"en-MY":17417,"es-SV":17418,"en-SG":18441,"es-HN":18442,"es-NI":19466,"es-PR":20490,"es-US":21514,"bs-Cyrl":25626,"bs-Latn":26650,"sr-Cyrl":27674,"sr-Latn":28698,smn:28731,"az-Cyrl":29740,sms:29755,zh:30724,nn:30740,bs:30746,"az-Latn":30764,sma:30779,"uz-Cyrl":30787,"mn-Cyrl":30800,"iu-Cans":30813,"zh-Hant":31748,nb:31764,sr:31770,"tg-Cyrl":31784,dsb:31790,smj:31803,"uz-Latn":31811,"mn-Mong":31824,"iu-Latn":31837,"tzm-Latn":31839,"ha-Latn":31848};function ne(){return te[G.locale()]}const z={thousands:"#,##0{0},&quot;K&quot;",millions:"#,##0{0},,&quot;M&quot;",billions:"#,##0{0},,,&quot;B&quot;",trillions:"#,##0{0},,,,&quot;T&quot;",percent:"0{0}%",decimal:"#{0}",fixedpoint:"#,##0{0}",exponential:"0{0}E+00",currency:" "},oe=/a+/g,re=/E/g,se=/dE+/g,ae=/L/g,le=/h/g,ie=/./g;function ce(t,e){let n,o;if(e>0){for(n=t!=="decimal"?".":"",o=0;o<e;o++)n+="0";return n}return""}function ue(t){let e;for(let n=0;n<t.length;n++)if(e=t.charCodeAt(n),e>=1632&&e<1642)return!0;return!1}function de(t){const e=(P.format(new Date(2009,8,8,6,5,4),t)||"").toString();let n=q(o=>P.format(o,t));return n&&(n=me(n),n=fe(e)+n),n}function fe(t){const e=ne();let n=e?e.toString(16):"",o="";if(ue(t)){for(;n.length<3;)n="0"+n;o="[$-2010"+n+"]"}else n&&(o="[$-"+n+"]");return o}function me(t){return t.split("/").join("\\/").split("'").map(function(e,n){return n%2===0?e.replace(oe,"AM/PM").replace(se,"d").replace(re,"d").replace(ae,"M").replace(le,"H").split("[").join("\\[").split("]").join("\\]"):e?e.replace(ie,"\\$&"):"'"}).join("")}function ge(t,e,n){let o,u;return t==="currency"?u=Z.getOpenXmlCurrencyFormat(n):u=z[t.toLowerCase()],u&&(o=W(u,ce(t,e))),o}function pe(t){return!t||t.length<2?!1:j(t)}function he(t,e){return!t||t.length<4||t[0]!==e?!1:j(t.substring(1,t.length-1))}function j(t){return t?/^[@=\t\r]/.test(t)?!0:/^[+-]/.test(t)?!K(t):!1:!1}const _={formatObjectConverter(t,e){const n={format:t,precision:t&&t.precision,dataType:e};return x(t)?M(n,t,{format:t.formatter||t.type,currency:t.currency}):n},convertFormat(t,e,n,o){if(f(t)){if(n==="date")return de(t);if(N(t)&&z[t.toLowerCase()])return ge(t,e,o)}},encode(t){let e=!1;return pe(t)?e=!0:he(t,'"')&&(t=t.substring(1,t.length-1),e=!0),e?`"'`+t.replaceAll('"','""')+'"':t}};class Ce{constructor(e,n,o,u){this._$targetElement=n,this._$container=o,this._loadPanel=e._createComponent(T("<div>").addClass("dx-export-loadpanel").appendTo(this._$container),Y,this.getOptions(u))}getDefaultOptions(){return{animation:null,shading:!1,height:90,width:200,container:this._$container}}getOptions(e){return f(e.text)?e.message=e.text:e.message=X.format("dxDataGrid-exporting"),M(this.getDefaultOptions(),e)}show(){this._loadPanel.option("position",$.calculateLoadPanelPosition(this._$targetElement)),this._loadPanel.show()}dispose(){T(this._loadPanel.element()).remove(),delete this._loadPanel}}const be={getFullOptions(t){const e=M({},t);if(!(f(e.worksheet)&&x(e.worksheet)))throw Error('The "worksheet" field must contain an object.');if(!f(e.topLeftCell))e.topLeftCell={row:1,column:1};else if(N(e.topLeftCell)){const{row:n,col:o}=e.worksheet.getCell(e.topLeftCell);e.topLeftCell={row:n,column:o}}return f(e.keepColumnWidths)||(e.keepColumnWidths=!0),f(e.loadPanel)||(e.loadPanel={}),f(e.loadPanel.enabled)||(e.loadPanel.enabled=!0),f(e.encodeExecutableContent)||(e.encodeExecutableContent=!1),e},convertDateForExcelJS:t=>new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())),setNumberFormat(t,e){t.numFmt=e},getCellStyles(t){const e=t.getStyles();return e.forEach(n=>{let o=this.tryConvertToExcelNumberFormat(n.format,n.dataType);f(o)&&(o=o.replace(/&quot;/g,'"')),n.numberFormat=o}),e},tryConvertToExcelNumberFormat(t,e){const n=_.formatObjectConverter(t,e),o=n.currency;return t=n.format,e=n.dataType,_.convertFormat(t,n.precision,e,o)},setAlignment(t,e,n){t.alignment=t.alignment??{},f(e)&&(t.alignment.wrapText=e),f(n)&&(t.alignment.horizontal=n),t.alignment.vertical="top"},setColumnsWidth(t,e,n){if(f(e))for(let o=0;o<e.length;o++){const u=e[o];typeof u=="number"&&isFinite(u)&&(t.getColumn(n+o).width=Math.min(255,Math.floor(u/7*100)/100))}},export(t,e,n,o){var u;const{component:i,worksheet:l,topLeftCell:m,keepColumnWidths:h,selectedRowsOnly:r,loadPanel:a,encodeExecutableContent:c}=t,s=i.getDataProvider(r),d=((u=i._getInternalInstance)===null||u===void 0?void 0:u.call(i))||i,E=d.option("loadPanel")&&d.option("loadPanel").enabled;E&&i.option("loadPanel.enabled",!1);let w;if(a.enabled&&I()){const R=n(i),p=o(i);w=new Ce(i,R,p,a),w.show()}const y=!!i.option("wordWrapEnabled");l.properties.outlineProperties={summaryBelow:!1,summaryRight:!1};const g={from:{row:m.row,column:m.column},to:{row:m.row,column:m.column}};return new Promise(R=>{s.ready().done(()=>{const p=s.getColumns(),H=s.getRowsCount(),C=new e(i,s,l,t);h&&this.setColumnsWidth(l,s.getColumnsWidths(),g.from.column),C._exportAllFieldHeaders(p,this.setAlignment);const k=C._getFieldHeaderRowsCount();g.to.row=g.from.row+k;const U=this.getCellStyles(s);for(let b=0;b<H;b++){const F=g.from.row+k+b,O=l.getRow(F);let S=0;C._isRowFieldHeadersRow(b)&&(S=s.getRowAreaColCount(),C._exportFieldHeaders("row",F,0,S,this.setAlignment)),C._trySetOutlineLevel(O,b),this.exportRow(s,C,O,b,S,p.length,y,U,c),g.to.row=F}C.mergedRangesManager.applyMergedRages(),g.to.column+=p.length>0?p.length-1:0;const L=l.views[0]||{};i.option("rtlEnabled")&&(L.rightToLeft=!0),C._isFrozenZone(s)&&(Object.keys(L).indexOf("state")===-1&&M(L,C._getWorksheetFrozenState(g)),C._trySetAutoFilter(g)),Object.keys(L).length>0&&(l.views=[L]),R(g)}).always(()=>{E&&i.option("loadPanel.enabled",E),a.enabled&&I()&&w.dispose()})})},exportRow(t,e,n,o,u,i,l,m,h){for(let r=u;r<i;r++){const a=t.getCellData(o,r,!0),c=n.getCell(e._getFirstColumnIndex()+r);e.mergedRangesManager.updateMergedRanges(c,o,r,e);const s=e.mergedRangesManager.findMergedCellInfo(o,r,e._isHeaderCell(o,r));if(f(s)&&c!==s.masterCell)c.style=s.masterCell.style,c.value=s.masterCell.value;else if(V(a.value)?c.value=this.convertDateForExcelJS(a.value):c.value=a.value,f(c.value)){const{bold:d,alignment:E,numberFormat:w}=m[t.getStyleId(o,r)];f(w)?this.setNumberFormat(c,w):N(c.value)&&/^[@=+-]/.test(c.value)&&this.setNumberFormat(c,"@"),e._trySetFont(c,d),this.setAlignment(c,l,E)}e._customizeCell(c,a.cellSourceData),h&&(c.value=_.encode(c.value))}}};class ye{constructor(e,n){this.dataProvider=e,this.worksheet=n,this.mergedCells=[],this.mergedRanges=[]}updateMergedRanges(e,n,o,u){if(u._isHeaderCell(n,o)&&!this.isCellInMergedRanges(n,o)){const{rowspan:i,colspan:l}=this.dataProvider.getCellMerging(n,o);if(l||i){const h=u._allowToMergeRange(n,o,i,l);if(this.updateMergedCells(e,n,o,i,l),h){const r=u._isInfoCell(n,o)&&u._allowExportRowFieldHeaders();this.mergedRanges.push({masterCell:e,rowspan:i-(r&&i>0),colspan:l})}}}}isCellInMergedRanges(e,n){return this.mergedCells[e]&&this.mergedCells[e][n]}findMergedCellInfo(e,n,o){if(o&&this.isCellInMergedRanges(e,n))return this.mergedCells[e][n]}updateMergedCells(e,n,o,u,i){for(let l=n;l<=n+u;l++)for(let m=o;m<=o+i;m++)this.mergedCells[l]||(this.mergedCells[l]=[]),this.mergedCells[l][m]={masterCell:e}}addMergedRange(e,n,o){this.mergedRanges.push({masterCell:e,rowspan:n,colspan:o})}applyMergedRages(){this.mergedRanges.forEach(e=>{const n=e.masterCell.fullAddress.row,o=e.masterCell.fullAddress.col,u=n+e.rowspan,i=o+e.colspan;this.worksheet.mergeCells(n,o,u,i)})}}export{be as E,ee as F,ye as M,ne as g,Re as s};
