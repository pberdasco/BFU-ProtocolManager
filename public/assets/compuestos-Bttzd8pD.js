import{r as n,j as d}from"./index-GqupdZ-j.js";import{G as s}from"./GenericGrid-UMQVRR98.js";import{u as p}from"./compuestos-Dq8iYB15.js";import{u}from"./matrices-BPbEAP9x.js";import"./data-grid-fYFHKVyO.js";import"./m_export-DgYMl9EH.js";import"./apiResource-CLOj6waL.js";import"./localization-BEaNgB8f.js";import"./excelExport-bW0oPaid.js";import"./exceljs.min-M1l6ISgF.js";import"./export_merged_ranges_manager-BkW8cCkf.js";import"./useQuery-Cu8cFUK3.js";const l=[{value:0,text:"Nunca"},{value:1,text:"Siempre"},{value:2,text:"Si >LQ"}],c=(e,i)=>[{dataField:"id",width:90,caption:"ID",allowFiltering:!1,allowSearch:!1},{dataField:"codigo",caption:"Codigo",width:150,validationRules:[{type:"required",message:"El codigo es obligatorio"}],customizeText:a=>{const o=a.value;return o?o.padEnd(8,"_").replace(/(\d|_)(\d|_)?(\d|_)?\/?(\d|_)?(\d|_)?\/?(\d|_)?(\d|_)?\/?(\d|_)?/,"$1/$2$3/$4$5/$6$7/$8"):""}},{dataField:"nombre",caption:"Nombre",validationRules:[{type:"required",message:"El Nombre es obligatorio"}]},{dataField:"matrizCodigo",caption:"Matriz",visible:!1,width:100,lookup:{dataSource:e,valueExpr:"codigo",displayExpr:"nombre"},setCellValue:(a,o,r)=>{a.matrizCodigo=o,a.agrupaEn=null}},{dataField:"matriz",caption:"Matriz",validationRules:[{type:"required",message:"La matriz es obligatoria"}]},{dataField:"agrupaEn",caption:"Agrupa en",alignment:"left",calculateDisplayValue:a=>{if(a.agrupaEn===null)return"No Agrupa";const o=i.find(r=>r.id===a.agrupaEn);return(o==null?void 0:o.nombre)||"No Agrupa"}},{dataField:"exponeId",caption:"Expone",validationRules:[{type:"required",message:"El campo Expone es obligatorio"}],lookup:{dataSource:l,valueExpr:"value",displayExpr:"text"}}],m=e=>({colCount:8,items:[{dataField:"id",colSpan:2,editorOptions:{disabled:!0}},{dataField:"codigo",colSpan:2,editorOptions:{mask:"?/??/??/??/?",maskRules:{"?":/[0-9]/},maskInvalidMessage:"Ingrese un código en formato válido: ?/??/??/??/?"}},{dataField:"nombre",colSpan:4,editorOptions:{maxLength:45,focusStateEnabled:!0}},{dataField:"matrizCodigo",colSpan:2,editorType:"dxSelectBox",editorOptions:{dataSource:e,displayExpr:"nombre",valueExpr:"codigo",searchEnabled:!0}},{dataField:"agrupaEn",colSpan:4,editorType:"dxSelectBox",editorOptions:{displayExpr:"nombre",valueExpr:"id",searchEnabled:!0}},{dataField:"exponeId",colspan:2,editorType:"dxSelectBox",editorOptions:{dataSource:l,displayExpr:"text",valueExpr:"value"}}]}),g=(e,i)=>e?[{id:null,nombre:"No Agrupa",matrizCodigo:e},...i.filter(a=>a.matrizCodigo===e)]:[];function w(){const{matrices:e}=u(),{compuestos:i}=p(),a=c(e,i),o=m(e),r=n.useCallback(t=>{t.parentType==="dataRow"&&t.dataField==="matrizCodigo"&&!t.row.data.matrizCodigo&&e.length>0&&t.setValue(e[0].codigo),t.parentType==="dataRow"&&t.dataField==="agrupaEn"&&(t.editorOptions.dataSource=g(t.row.data.matrizCodigo,i),t.editorOptions.disabled=!t.row.data.matrizCodigo)},[e,i]);return d.jsx("div",{children:d.jsx(s,{title:"Compuestos",resource:"compuestos",columns:a,keyExpr:"id",editable:!0,form:o,gridHeight:"full",size:"mediumShort",onEditorPreparing:r})})}export{w as default};
