import{bI as G,n as V,m as h,V as b,bJ as j,bK as k,E as T,aA as D,aU as F,bL as A,bM as W,y as O,i as d,e as K,a3 as v,G as B,au as y,D as _,bN as U,aC as q,bq as z,bO as Q,aS as I,o as S,f as C,d as g,bP as J,bQ as X,a6 as Y,ad as Z,bR as ee,h as te,bS as se,q as ie,r as o,C as ne,b2 as r}from"./index-CUZSR6jm.js";import{a as ae}from"./m_utils.scroll-D49eWnGj.js";function x(e,t){return(e||t)&&!(e&&t)}const $=G.inherit({_supportedKeys(){const e=this.callBase(),t=i=>this._list._keyboardHandler(i),s=this.option("rtlEnabled");return S({},e,{backspace(i){if(!this._isCaretAtTheStart())return;this._processKeyboardEvent(i),this._isTagRemoved=!0;const n=this._$focusedTag||this._tagElements().last();this._$focusedTag&&this._moveTagFocus("prev",!0),n.length!==0&&(this._preserveFocusedTag=!0,this._removeTagElement(n),delete this._preserveFocusedTag)},upArrow:(i,n)=>i.altKey||!this._list?e.upArrow.call(this,i):t(n),downArrow:(i,n)=>i.altKey||!this._list?e.downArrow.call(this,i):t(n),del(i){if(!this._$focusedTag||!this._isCaretAtTheStart())return;this._processKeyboardEvent(i),this._isTagRemoved=!0;const n=this._$focusedTag;this._moveTagFocus("next",!0),this._preserveFocusedTag=!0,this._removeTagElement(n),delete this._preserveFocusedTag},enter(i,n){const a=this._list&&this._list.option("focusedElement")!==null;if(this.option("acceptCustomValue")&&!a){i.preventDefault(),this._searchValue()!==""&&this._customItemAddedHandler(i);return}this.option("opened")&&(this._saveValueChangeEvent(i),t(n),i.preventDefault())},space(i,n){const a=this.option("opened"),l=this._shouldRenderSearchEvent();a&&!l&&(this._saveValueChangeEvent(i),t(n),i.preventDefault())},leftArrow(i){if(!this._isCaretAtTheStart()||this._isEmpty()||this._isEditable()&&s&&!this._$focusedTag)return;i.preventDefault();const n=s?"next":"prev";this._moveTagFocus(n),!this.option("multiline")&&this._scrollContainer(n)},rightArrow(i){if(!this._isCaretAtTheStart()||this._isEmpty()||this._isEditable()&&!s&&!this._$focusedTag)return;i.preventDefault();const n=s?"prev":"next";this._moveTagFocus(n),!this.option("multiline")&&this._scrollContainer(n)}})},_processKeyboardEvent(e){e.preventDefault(),e.stopPropagation(),this._saveValueChangeEvent(e)},_isEmpty(){return this._getValue().length===0},_updateTagsContainer(e){this._$tagsContainer=e.addClass("dx-tag-container")},_allowSelectItemByTab:()=>!1,_isCaretAtTheStart(){const e=se(this._input());return(e==null?void 0:e.start)===0&&e.end===0},_updateInputAriaActiveDescendant(e){this.setAria("activedescendant",e,this._input())},_moveTagFocus(e,t){if(!this._$focusedTag){const i=this._tagElements();this._$focusedTag=e==="next"?i.first():i.last(),this._toggleFocusClass(!0,this._$focusedTag),this._updateInputAriaActiveDescendant(this._$focusedTag.attr("id"));return}const s=this._$focusedTag[e](".dx-tag");s.length>0?(this._replaceFocusedTag(s),this._updateInputAriaActiveDescendant(s.attr("id"))):(t||e==="next"&&this._isEditable())&&(this._clearTagFocus(),this._updateInputAriaActiveDescendant())},_replaceFocusedTag(e){this._toggleFocusClass(!1,this._$focusedTag),this._$focusedTag=e,this._toggleFocusClass(!0,this._$focusedTag)},_clearTagFocus(){this._$focusedTag&&(this._toggleFocusClass(!1,this._$focusedTag),this._updateInputAriaActiveDescendant(),delete this._$focusedTag)},_focusClassTarget(e){return e&&e.length&&e[0]!==this._focusTarget()[0]?e:this.callBase()},_getLabelContainer(){return this._$tagsContainer},_getFieldElement(){return this._input()},_scrollContainer(e){if(this.option("multiline")||!te()||!this._$tagsContainer)return;const t=this._getScrollPosition(e);this._$tagsContainer.scrollLeft(t)},_getScrollPosition(e){return e==="start"||e==="end"?this._getBorderPosition(e):this._$focusedTag?this._getFocusedTagPosition(e):this._getBorderPosition("end")},_getBorderPosition(e){const t=this.option("rtlEnabled"),s=x(e==="end",t),i=t?-1:1;return x(s,!t)?0:i*(this._$tagsContainer.get(0).scrollWidth-I(this._$tagsContainer))},_getFocusedTagPosition(e){const t=this.option("rtlEnabled"),s=x(e==="next",t);let{left:i}=this._$focusedTag.position(),n=this._$tagsContainer.scrollLeft();return s&&(i+=I(this._$focusedTag,!0)-I(this._$tagsContainer)),x(s,i<0)&&(n+=i),n},_setNextValue:V,_getDefaultOptions(){return S(this.callBase(),{value:[],showDropDownButton:!1,maxFilterQueryLength:1500,tagTemplate:"tag",selectAllText:v.format("dxList-selectAll"),hideSelectedItems:!1,selectedItems:[],selectAllMode:"page",onSelectAllValueChanged:null,maxDisplayedTags:void 0,showMultiTagOnly:!0,onMultiTagPreparing:null,multiline:!0,useSubmitBehavior:!0})},_init(){this.callBase(),this._selectedItems=[],this._initSelectAllValueChangedAction()},_initActions(){this.callBase(),this._initMultiTagPreparingAction()},_initMultiTagPreparingAction(){this._multiTagPreparingAction=this._createActionByOption("onMultiTagPreparing",{beforeExecute:e=>{this._multiTagPreparingHandler(e.args[0])},excludeValidators:["disabled","readOnly"]})},_multiTagPreparingHandler(e){const{length:t}=this._getValue();this.option("showMultiTagOnly")?e.text=v.getFormatter("dxTagBox-selected")(t):e.text=v.getFormatter("dxTagBox-moreSelected")(t-this.option("maxDisplayedTags")+1)},_initDynamicTemplates(){this.callBase(),this._templateManager.addDefaultTemplates({tag:new ee((e,t)=>{const s=h("<div>").addClass("dx-tag-content");h("<span>").text(t.text??t).appendTo(s),h("<div>").addClass("dx-tag-remove-button").appendTo(s),e.append(s)},["text"],this.option("integrationOptions.watchMethod"),{text:this._displayGetter})})},_toggleSubmitElement(e){e?(this._renderSubmitElement(),this._setSubmitValue()):(this._$submitElement&&this._$submitElement.remove(),delete this._$submitElement)},_renderSubmitElement(){this.option("useSubmitBehavior")&&(this._$submitElement=h("<select>").attr({multiple:"multiple","aria-label":"Selected items"}).css("display","none").appendTo(this.$element()))},_setSubmitValue(){if(!this.option("useSubmitBehavior"))return;const e=this._getValue(),t=[];for(let s=0,i=e.length;s<i;s++){const n=this._shouldUseDisplayValue(e[s]);t.push(h("<option>").val(n?this._displayGetter(e[s]):e[s]).attr("selected","selected"))}this._getSubmitElement().empty().append(t)},_initMarkup(){this._tagElementsCache=h();const e=!this.option("multiline");this.$element().addClass("dx-tagbox").toggleClass("dx-tagbox-only-select",!(this.option("searchEnabled")||this.option("acceptCustomValue"))).toggleClass("dx-tagbox-single-line",e),this.setAria({role:"application",roledescription:"tagbox"},this.$element()),this._initTagTemplate(),this.callBase()},_getNewLabelId(e,t,s){return e?s?e===t?void 0:e.split(" ").filter(i=>i!==t).join(" "):`${e} ${t}`:t},_updateElementAria(e,t){if(!e){this.setAria("labelledby",void 0,this.$element());return}const i=this.$element().attr("aria-labelledby"),n=this._getNewLabelId(i,e,t);this.setAria("labelledby",n,this.$element())},_render(){this.callBase(),this._renderTagRemoveAction(),this._renderSingleLineScroll(),this._scrollContainer("start")},_initTagTemplate(){this._tagTemplate=this._getTemplateByOption("tagTemplate")},_renderField(){const e=!d(this.option("fieldTemplate"));this.$element().toggleClass("dx-tagbox-default-template",e).toggleClass("dx-tagbox-custom-template",!e),this.callBase()},_renderTagRemoveAction(){const e=this._createAction(this._removeTagHandler.bind(this)),t=C(Z,"dxTagBoxTagRemove");g.off(this._$tagsContainer,t),g.on(this._$tagsContainer,t,".dx-tag-remove-button",s=>{e({event:s})})},_renderSingleLineScroll(){const e=C("dxmousewheel",this.NAME),t=this.$element(),s=this.option("multiline");if(g.off(t,e),Y.real().deviceType!=="desktop"){this._$tagsContainer&&this._$tagsContainer.css("overflowX",s?"":"auto");return}s||g.on(t,e,this._tagContainerMouseWheelHandler.bind(this))},_tagContainerMouseWheelHandler(e){const t=this._$tagsContainer.scrollLeft(),s=-.3*e.delta;if(!X(e)&&ae(this._$tagsContainer,s,!0))return this._$tagsContainer.scrollLeft(t+s),!1},_renderEvents(){this.callBase();const e=this._input(),t=C("keydown",this.NAME);g.on(e,t,s=>{const i=J(s);!this._isControlKey(i)&&this._isEditable()&&this._clearTagFocus()})},_popupWrapperClass(){return`${this.callBase()} dx-tagbox-popup-wrapper`},_renderInput(){this.callBase(),this._renderPreventBlurOnInputClick()},_renderPreventBlurOnInputClick(){const e=C("mousedown","dxTagBox");g.off(this._inputWrapper(),e),g.on(this._inputWrapper(),e,t=>{t.target!==this._input()[0]&&this._isFocused()&&t.preventDefault()})},_renderInputValueImpl(){return this._renderMultiSelect()},_loadInputValue:()=>b(),_clearTextValue(){this._input().val(""),this._toggleEmptinessEventHandler(),this.option("text","")},_focusInHandler(e){this._preventNestedFocusEvent(e)||this._scrollContainer("end"),this.callBase(e)},_renderInputValue(){return this.option("displayValue",this._searchValue()),this.callBase()},_restoreInputText(e){e||this._clearTextValue()},_focusOutHandler(e){this._preventNestedFocusEvent(e)||(this._clearTagFocus(),this._scrollContainer("start")),this.callBase(e)},_initSelectAllValueChangedAction(){this._selectAllValueChangeAction=this._createActionByOption("onSelectAllValueChanged")},_renderList(){this.callBase(),this._setListDataSourceFilter()},_canListHaveFocus(){return this.option("applyValueMode")==="useButtons"},_listConfig(){const e=this.option("showSelectionControls")?"all":"multiple";return S(this.callBase(),{maxFilterLengthInRequest:this.option("maxFilterQueryLength"),selectionMode:e,selectAllText:this.option("selectAllText"),onSelectAllValueChanged:t=>{let{value:s}=t;this._selectAllValueChangeAction({value:s})},selectAllMode:this.option("selectAllMode"),selectedItems:this._selectedItems,onFocusedItemChanged:null})},_renderMultiSelect(){const e=_();return this._updateTagsContainer(this._$textEditorInputContainer),this._renderInputSize(),this._renderTags().done(()=>{this._popup&&this._popup.refreshPosition(),e.resolve()}).fail(e.reject),e.promise()},_listItemClickHandler(e){!this.option("showSelectionControls")&&this._clearTextValue(),this.option("applyValueMode")!=="useButtons"&&(this.callBase(e),this._saveValueChangeEvent(void 0))},_shouldClearFilter(){const e=this.callBase();return!this.option("showSelectionControls")&&e},_renderInputSize(){const e=this._input(),t=e.val(),s=D(t)&&t;let i="",n;const a=this.option("searchEnabled")||this.option("acceptCustomValue");if(s&&a){const l=Q(e,t,{includePaddings:!0});l.insertAfter(e),i=I(l)+5,l.remove()}else t||(n=1);e.css("width",i),e.attr("size",n??"")},_renderInputSubstitution(){this.callBase(),this._updateWidgetHeight()},_getValue(){return this.option("value")||[]},_multiTagRequired(){const e=this._getValue(),t=this.option("maxDisplayedTags");return d(t)&&e.length>t},_renderMultiTag(e){const t=`dx-${new B}`,s=h("<div>").attr("id",t).addClass("dx-tag").addClass("dx-tagbox-multi-tag"),i={multiTagElement:y(s),selectedItems:this.option("selectedItems")};if(this._multiTagPreparingAction(i),i.cancel)return!1;s.data("dxTagData",i.text),s.insertBefore(e),this._tagTemplate.render({model:i.text,container:y(s)});const n=i.text;return this._setTagAria(s,n),this._updateElementAria(t),s},_getFilter(e){const t=this._dataController.filter(),s=e.getCombinedFilter(this.option("valueExpr"),t),i=encodeURI(JSON.stringify(s)).length,n=this.option("maxFilterQueryLength");if(i<=n)return s;z.log("W1019",n)},_getFilteredItems(e){var t,s;(t=this._loadFilteredItemsPromise)===null||t===void 0||t.reject();const i=new U(e),n=(s=this._list)===null||s===void 0?void 0:s.option("selectedItems"),a=!!n&&this._list._dataController.isLoaded(),l=n||this.option("selectedItems"),p=i.getLocalFilter(this._valueGetter),c=l.filter(p),f=c.length===e.length,u=_(),m=this._dataController;if((!this._isDataSourceChanged||a)&&f)return u.resolve(c).promise();const{customQueryParams:E,expand:L,select:P}=m.loadOptions(),w=this._getFilter(i);return m.loadFromStore({filter:w,customQueryParams:E,expand:L,select:P}).done((M,N)=>{if(this._isDataSourceChanged=!1,this._disposed){u.reject();return}const{data:R}=q(M,N),H=m.applyMapFunction(R);u.resolve(H.filter(p))}).fail(u.reject),this._loadFilteredItemsPromise=u,u.promise()},_createTagsData(e,t){const s=[],i={},n=this._valueGetterExpr()==="this",a={};t.forEach(c=>{const f=n?JSON.stringify(c):this._valueGetter(c);a[f]=c});const l=[];e.forEach((c,f)=>{const u=a[n?JSON.stringify(c):c];if(n&&!d(u))l.push(this._loadItem(c,i).always(m=>{const E=this._createTagData(m,c);s.splice(f,0,E)}));else{const m=this._createTagData(u,c);s.splice(f,0,m)}});const p=_();return b.apply(this,l).always(()=>{p.resolve(s)}),p.promise()},_createTagData(e,t){if(d(e))return this._selectedItems.push(e),e;const s=this.option("selectedItem");return this._valueGetter(s)===t?s:t},_isGroupedData(){return this.option("grouped")&&!this._dataController.group()},_getItemsByValues(e){const t=[];return e.forEach(s=>{const i=this._getItemFromPlain(s);d(i)&&t.push(i)}),t},_getFilteredGroupedItems(e){const t=_();return this._filteredGroupedItemsLoadPromise&&this._dataController.cancel(this._filteredGroupedItemsLoadPromise.operationId),this._dataController.items().length?t.resolve(this._getItemsByValues(e)):this._filteredGroupedItemsLoadPromise=this._dataController.load().done(()=>{t.resolve(this._getItemsByValues(e))}).fail(()=>{t.resolve([])}).always(()=>{this._filteredGroupedItemsLoadPromise=void 0}),t.promise()},_loadTagsData(){const e=this._getValue(),t=_();return this._selectedItems=[],(this._isGroupedData()?this._getFilteredGroupedItems(e):this._getFilteredItems(e)).done(i=>{this._createTagsData(e,i).always(a=>{t.resolve(a)})}).fail(t.reject.bind(this)),t.promise()},_renderTags(){const e=_();let t=!1;return this._shouldGetItemsFromPlain(this._valuesToUpdate)&&(this._selectedItems=this._getItemsFromPlain(this._valuesToUpdate),this._selectedItems.length===this._valuesToUpdate.length&&(this._renderTagsImpl(this._selectedItems),t=!0,e.resolve())),t||this._loadTagsData().done(s=>{if(this._disposed){e.reject();return}this._renderTagsImpl(s),e.resolve()}).fail(e.reject),e.promise()},_renderTagsImpl(e){this._renderTagsCore(e),this._renderEmptyState(),this._preserveFocusedTag||this._clearTagFocus()},_shouldGetItemsFromPlain(e){return e&&this._dataController.isLoaded()&&e.length<=this._getPlainItems().length},_getItemsFromPlain(e){let t=this._getSelectedItemsFromList(e);if(t.length===0&&e.length>0||t.length<e.length){const i=this._getPlainItems();t=this._filterSelectedItems(i,e)}return t},_getSelectedItemsFromList(e){var t;const s=(t=this._list)===null||t===void 0?void 0:t.option("selectedItems");let i=[];return e.length===(s==null?void 0:s.length)&&(i=this._filterSelectedItems(s,e)),i},_filterSelectedItems(e,t){return e.filter(i=>{let n;for(let a=0;a<t.length;a++)if(n=t[a],O(n)){if(this._isValueEquals(i,n))return!0}else if(this._isValueEquals(this._valueGetter(i),n))return!0;return!1},this)},_integrateInput(){this._isInputReady.resolve(),this.callBase();const e=this.$element().find(".dx-texteditor-input-container");this._updateTagsContainer(e),this._renderTagRemoveAction()},_renderTagsCore(e){var t;(t=this._isInputReady)===null||t===void 0||t.reject(),this._isInputReady=_(),this._renderField(),this.option("selectedItems",this._selectedItems.slice()),this._cleanTags(),this._input().length>0&&this._isInputReady.resolve(),b(this._isInputReady).done(()=>{this._renderTagsElements(e)})},_renderTagsElements(e){const t=this._multiTagRequired()&&this._renderMultiTag(this._input()),s=this.option("showMultiTagOnly"),i=this.option("maxDisplayedTags");e.forEach((n,a)=>{if(t&&s||t&&!s&&a-i>=-1)return!1;this._renderTag(n,t||this._input())}),this._isFocused()&&this._scrollContainer("end"),this._refreshTagElements()},_cleanTags(){if(this._multiTagRequired())this._tagElements().remove();else{const e=this._tagElements(),t=this._getValue();T(e,(s,i)=>{const n=h(i),a=n.data("dxTagData");t!=null&&t.includes(a)||n.remove()})}this._updateElementAria()},_renderEmptyState(){const e=!(this._getValue().length||this._selectedItems.length||this._searchValue());this._toggleEmptiness(e),this._renderDisplayText()},_renderDisplayText(){this._renderInputSize()},_refreshTagElements(){this._tagElementsCache=this.$element().find(".dx-tag")},_tagElements(){return this._tagElementsCache},_applyTagTemplate(e,t){this._tagTemplate.render({model:e,container:y(t)})},_renderTag(e,t){const s=this._valueGetter(e);if(!d(s))return;let i=this._getTag(s);const n=this._displayGetter(e),a=this._getItemModel(e,n);if(i)d(n)&&(i.empty(),this._applyTagTemplate(a,i)),i.removeClass("dx-tag-custom"),this._updateElementAria(i.attr("id"));else{const l=`dx-${new B}`;i=this._createTag(s,t,l),this._setTagAria(i,d(n)?n:s),d(e)?this._applyTagTemplate(a,i):(i.addClass("dx-tag-custom"),this._applyTagTemplate(s,i)),this._updateElementAria(l)}},_setTagAria(e,t){const s={role:"button",label:t,roledescription:v.format("dxTagBox-tagRoleDescription")};this.setAria(s,e)},_getItemModel(e,t){return O(e)&&d(t)?e:K(t,"")},_getTag(e){const t=this._tagElements(),s=t.length;let i=!1;for(let n=0;n<s;n++){const a=t[n],l=W(a,"dxTagData");if(e===l||A(e,l)){i=h(a);break}}return i},_createTag:(e,t,s)=>h("<div>").attr("id",s).addClass("dx-tag").data("dxTagData",e).insertBefore(t),_toggleEmptinessEventHandler(){this._toggleEmptiness(!this._getValue().length&&!this._searchValue().length)},_customItemAddedHandler(e){this.callBase(e),this._clearTextValue()},_removeTagHandler(e){const t=e.event;t.stopPropagation(),this._saveValueChangeEvent(t);const s=h(t.target).closest(".dx-tag");this._removeTagElement(s)},_removeTagElement(e){if(e.hasClass("dx-tagbox-multi-tag")){this.option("showMultiTagOnly")?this.clear():this.option("value",this._getValue().slice(0,this.option("maxDisplayedTags")));return}const t=e.data("dxTagData"),s=e.attr("id");this._removeTagWithUpdate(t),this._updateElementAria(s,!0),this._refreshTagElements()},_updateField:V,_removeTagWithUpdate(e){const t=this._getValue().slice();this._removeTag(t,e),this.option("value",t),this.option("selectedItem",null),t.length===0&&this._clearTagFocus()},_getCurrentValue(){return this._lastValue()},_selectionChangeHandler(e){if(this.option("applyValueMode")==="useButtons")return;const t=this._getValue().slice();if(T(e.removedItems||[],(s,i)=>{this._removeTag(t,this._valueGetter(i))}),T(e.addedItems||[],(s,i)=>{this._addTag(t,this._valueGetter(i))}),this._updateWidgetHeight(),!A(this._list.option("selectedItemKeys"),this.option("value"))){const s=this._list._getSelectionChangeEvent();s&&this._saveValueChangeEvent(s),this.option("value",t)}this._list._saveSelectionChangeEvent(void 0)},_removeTag(e,t){const s=this._valueIndex(t,e);s>=0&&e.splice(s,1)},_addTag(e,t){this._valueIndex(t)<0&&e.push(t)},_fieldRenderData(){return this._selectedItems.slice()},_completeSelection(e){this.option("showSelectionControls")||this._setValue(e)},_setValue(e){var t;if(e===null)return;const s=this.option("applyValueMode")==="useButtons",i=this._valueIndex(e),n=(s?((t=this._list)===null||t===void 0?void 0:t.option("selectedItemKeys"))||[]:this._getValue()).slice();if(i>=0?n.splice(i,1):n.push(e),s){var a;(a=this._list)===null||a===void 0||a.option("selectedItemKeys",n)}else this.option("value",n)},_isSelectedValue(e,t){return this._valueIndex(e,null,t)>-1},_valueIndex(e,t,s){let i=-1;return s&&typeof e!="object"&&(s.indexByValues||(s.indexByValues={},t=t||this._getValue(),t.forEach((n,a)=>{s.indexByValues[n]=a})),e in s.indexByValues)?s.indexByValues[e]:(t=t||this._getValue(),T(t,(n,a)=>{if(this._isValueEquals(e,a))return i=n,!1}),i)},_lastValue(){const e=this._getValue();return e[e.length-1]??null},_shouldRenderSearchEvent(){return this.option("searchEnabled")||this.option("acceptCustomValue")},_searchHandler(e){this.option("searchEnabled")&&e&&!this._isTagRemoved&&(this.callBase(arguments),this._setListDataSourceFilter()),this._updateWidgetHeight(),delete this._isTagRemoved},_updateWidgetHeight(){const e=this.$element(),t=F(e);this._renderInputSize();const s=F(e);this._popup&&this.option("opened")&&this._isEditable()&&s!==t&&this._popup.repaint()},_refreshSelected(){var e;!((e=this._list)===null||e===void 0)&&e.getDataSource()&&this._list.option("selectedItems",this._selectedItems)},_resetListDataSourceFilter(){const e=this._dataController;delete this._userFilter,e.filter(null),e.reload()},_setListDataSourceFilter(){if(!this.option("hideSelectedItems")||!this._list)return;const e=this._dataController,t=this._valueGetterExpr();if(D(t)&&t!=="this"){const s=this._dataSourceFilterExpr();this._userFilter===void 0&&(this._userFilter=e.filter()||null),this._userFilter&&s.push(this._userFilter),s.length?e.filter(s):e.filter(null)}else e.filter(this._dataSourceFilterFunction.bind(this));e.load()},_dataSourceFilterExpr(){const e=[];return this._getValue().forEach(t=>e.push(["!",[this._valueGetterExpr(),t]])),e},_dataSourceFilterFunction(e){const t=this._valueGetter(e);let s=!0;return T(this._getValue(),(i,n)=>{if(this._isValueEquals(n,t))return s=!1,!1}),s},_dataSourceChangedHandler(){this._isDataSourceChanged=!0,this.callBase.apply(this,arguments)},_applyButtonHandler(e){this._saveValueChangeEvent(e.event),this.option("value",this._getSortedListValues()),this._clearTextValue(),this.callBase(),this._cancelSearchIfNeed()},_getSortedListValues(){const e=this._getListValues(),t=this.option("value")||[],s=e.length?j(t,e):[],i=s.length?k(e,t):e;return s.concat(i)},_getListValues(){return this._list?this._getPlainItems(this._list.option("selectedItems")).map(e=>this._valueGetter(e)):[]},_setListDataSource(){const e=this._getValue();this.callBase(),e!==this.option("value")&&this.option("value",e),this._refreshSelected()},_renderOpenedState(){this.callBase(),this.option("applyValueMode")==="useButtons"&&!this.option("opened")&&this._refreshSelected()},clear(){this._restoreInputText();const e=this._getDefaultOptions().value,t=this.option("value");e&&e.length===0&&t&&e.length===t.length||this.callBase()},_clean(){this.callBase(),delete this._defaultTagTemplate,delete this._valuesToUpdate,delete this._tagTemplate},_getSelectedItemsDifference(e,t){if(!e.length)return{addedItems:[],removedItems:t.slice()};if(!t.length)return{addedItems:e.slice(),removedItems:[]};const s=t.reduce((n,a)=>{const l=this._valueGetter(a);return n[l]=a,n},{}),i=[];return e.forEach(n=>{const a=this._valueGetter(n);s[a]||i.push(n),delete s[a]}),{addedItems:i,removedItems:Object.values(s)}},_optionChanged(e){const{name:t,value:s,previousValue:i}=e;switch(t){case"onSelectAllValueChanged":this._initSelectAllValueChangedAction();break;case"onMultiTagPreparing":this._initMultiTagPreparingAction(),this._renderTags();break;case"hideSelectedItems":s?this._setListDataSourceFilter():this._resetListDataSourceFilter();break;case"useSubmitBehavior":this._toggleSubmitElement(s);break;case"displayExpr":this.callBase(e),this._initTemplates(),this._invalidate();break;case"tagTemplate":this._initTagTemplate(),this._invalidate();break;case"selectAllText":this._setListOption("selectAllText",this.option("selectAllText"));break;case"readOnly":case"disabled":this.callBase(e),!s&&this._refreshEvents();break;case"value":this._valuesToUpdate=s,this.callBase(e),this._valuesToUpdate=void 0,this._setListDataSourceFilter();break;case"maxDisplayedTags":case"showMultiTagOnly":this._renderTags();break;case"selectAllMode":this._setListOption(t,s);break;case"selectedItem":case"maxFilterQueryLength":break;case"selectedItems":this._selectionChangedAction(this._getSelectedItemsDifference(s,i));break;case"multiline":this.$element().toggleClass("dx-tagbox-single-line",!s),this._renderSingleLineScroll();break;default:this.callBase(e)}},_getActualSearchValue(){return this.callBase()||this._searchValue()},_popupHidingHandler(){this.callBase(),this._clearFilter()}});ie("dxTagBox",$);/*!
 * devextreme-react
 * Version: 24.2.3
 * Build date: Fri Dec 06 2024
 *
 * Copyright (c) 2012 - 2024 Developer Express Inc. ALL RIGHTS RESERVED
 *
 * This software may be modified and distributed under the terms
 * of the MIT license. See the LICENSE file in the root of the project for details.
 *
 * https://github.com/DevExpress/devextreme-react
 */o.memo(o.forwardRef((e,t)=>{const s=o.useRef(null);o.useImperativeHandle(t,()=>({instance(){var c;return(c=s.current)==null?void 0:c.getInstance()}}),[s.current]);const i=o.useMemo(()=>["opened","value"],[]),n=o.useMemo(()=>["onChange","onClosed","onContentReady","onCustomItemCreating","onDisposing","onEnterKey","onFocusIn","onFocusOut","onInitialized","onInput","onItemClick","onKeyDown","onKeyUp","onMultiTagPreparing","onOpened","onSelectAllValueChanged","onValueChanged"],[]),a=o.useMemo(()=>({defaultOpened:"opened",defaultValue:"value"}),[]),l=o.useMemo(()=>({button:{optionName:"buttons",isCollectionItem:!0},dropDownOptions:{optionName:"dropDownOptions",isCollectionItem:!1},item:{optionName:"items",isCollectionItem:!0}}),[]),p=o.useMemo(()=>[{tmplOption:"dropDownButtonTemplate",render:"dropDownButtonRender",component:"dropDownButtonComponent"},{tmplOption:"fieldTemplate",render:"fieldRender",component:"fieldComponent"},{tmplOption:"groupTemplate",render:"groupRender",component:"groupComponent"},{tmplOption:"itemTemplate",render:"itemRender",component:"itemComponent"},{tmplOption:"tagTemplate",render:"tagRender",component:"tagComponent"}],[]);return o.createElement(ne,{WidgetClass:$,ref:s,subscribableOptions:i,independentEvents:n,defaults:a,expectedChildren:l,templateProps:p,...e})}));const oe=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"animation",ExpectedChildren:{hide:{optionName:"hide",isCollectionItem:!1},show:{optionName:"show",isCollectionItem:!1}}}});Object.assign(oe,{componentType:"option"});const le=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"at"}});Object.assign(le,{componentType:"option"});const re=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"boundaryOffset"}});Object.assign(re,{componentType:"option"});const ce=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"buttons",IsCollectionItem:!0,ExpectedChildren:{options:{optionName:"options",isCollectionItem:!1}}}});Object.assign(ce,{componentType:"option"});const he=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"collision"}});Object.assign(he,{componentType:"option"});const de=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"dropDownOptions",DefaultsProps:{defaultHeight:"height",defaultPosition:"position",defaultVisible:"visible",defaultWidth:"width"},ExpectedChildren:{animation:{optionName:"animation",isCollectionItem:!1},position:{optionName:"position",isCollectionItem:!1},toolbarItem:{optionName:"toolbarItems",isCollectionItem:!0}},TemplateProps:[{tmplOption:"contentTemplate",render:"contentRender",component:"contentComponent"},{tmplOption:"titleTemplate",render:"titleRender",component:"titleComponent"}]}});Object.assign(de,{componentType:"option"});const ue=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"from",ExpectedChildren:{position:{optionName:"position",isCollectionItem:!1}}}});Object.assign(ue,{componentType:"option"});const pe=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"hide",ExpectedChildren:{from:{optionName:"from",isCollectionItem:!1},to:{optionName:"to",isCollectionItem:!1}}}});Object.assign(pe,{componentType:"option"});const me=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"items",IsCollectionItem:!0,TemplateProps:[{tmplOption:"template",render:"render",component:"component"}]}});Object.assign(me,{componentType:"option"});const _e=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"my"}});Object.assign(_e,{componentType:"option"});const ge=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"offset"}});Object.assign(ge,{componentType:"option"});const fe=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"options",TemplateProps:[{tmplOption:"template",render:"render",component:"component"}]}});Object.assign(fe,{componentType:"option"});const Te=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"position"}});Object.assign(Te,{componentType:"option"});const ve=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"show"}});Object.assign(ve,{componentType:"option"});const Ie=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"to"}});Object.assign(Ie,{componentType:"option"});const Ce=e=>o.createElement(r,{...e,elementDescriptor:{OptionName:"toolbarItems",IsCollectionItem:!0,TemplateProps:[{tmplOption:"menuItemTemplate",render:"menuItemRender",component:"menuItemComponent"},{tmplOption:"template",render:"render",component:"component"}]}});Object.assign(Ce,{componentType:"option"});
